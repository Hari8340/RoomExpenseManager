'use strict'; 
"use strict";
this.parseTimeMarkers = this.parseTimeMarkers || {};
var marker = this.parseTimeMarkers['powerbiportal.explore.bundle.min.js'] || (this.parseTimeMarkers['powerbiportal.explore.bundle.min.js'] = {});
marker.startEval = window.jsCommon && window.jsCommon.performance && window.jsCommon.performance.now ? window.jsCommon.performance.now() : Date.now(); marker.isExternal = false;
if (window.perfTracking && window.perfTracking.startBundleEval) window.perfTracking.startBundleEval('powerbiportal.explore.bundle.min.js');var powerbi,__spreadArray=this&&this.__spreadArray||function(e,t,r){if(r||2===arguments.length)for(var i,a=0,n=t.length;a<n;a++)!i&&a in t||((i=i||Array.prototype.slice.call(t,0,a))[a]=t[a]);return e.concat(i||Array.prototype.slice.call(t))},__extends=this&&this.__extends||(function(){var i=function(e,t){return(i=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(e,t){e.__proto__=t}:function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])}))(e,t)};return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}})(),__assign=this&&this.__assign||function(){return(__assign=Object.assign||function(e){for(var t,r=1,i=arguments.length;r<i;r++)for(var a in t=arguments[r])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e}).apply(this,arguments)},__decorate=this&&this.__decorate||function(e,t,r,i){var a,n=arguments.length,o=n<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,r):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,r,i);else for(var s=e.length-1;0<=s;s--)(a=e[s])&&(o=(n<3?a(o):3<n?a(t,r,o):a(t,r))||o);return 3<n&&o&&Object.defineProperty(t,r,o),o},__awaiter=this&&this.__awaiter||function(e,o,s,l){return new(s=s||Promise)(function(r,t){function i(e){try{n(l.next(e))}catch(e){t(e)}}function a(e){try{n(l.throw(e))}catch(e){t(e)}}function n(e){var t;e.done?r(e.value):((t=e.value)instanceof s?t:new s(function(e){e(t)})).then(i,a)}n((l=l.apply(e,o||[])).next())})},__generator=this&&this.__generator||function(i,a){var n,o,s,l={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]},e={next:t(0),throw:t(1),return:t(2)};return"function"==typeof Symbol&&(e[Symbol.iterator]=function(){return this}),e;function t(r){return function(e){var t=[r,e];if(n)throw new TypeError("Generator is already executing.");for(;l;)try{if(n=1,o&&(s=2&t[0]?o.return:t[0]?o.throw||((s=o.return)&&s.call(o),0):o.next)&&!(s=s.call(o,t[1])).done)return s;switch(o=0,(t=s?[2&t[0],s.value]:t)[0]){case 0:case 1:s=t;break;case 4:return l.label++,{value:t[1],done:!1};case 5:l.label++,o=t[1],t=[0];continue;case 7:t=l.ops.pop(),l.trys.pop();continue;default:if(!(s=0<(s=l.trys).length&&s[s.length-1])&&(6===t[0]||2===t[0])){l=0;continue}if(3===t[0]&&(!s||t[1]>s[0]&&t[1]<s[3]))l.label=t[1];else if(6===t[0]&&l.label<s[1])l.label=s[1],s=t;else{if(!(s&&l.label<s[2])){s[2]&&l.ops.pop(),l.trys.pop();continue}l.label=s[2],l.ops.push(t)}}t=a.call(i,l)}catch(e){t=[6,e],o=0}finally{n=s=0}if(5&t[0])throw t[1];return{value:t[0]?t[1]:void 0,done:!0}}}};!(function(t){var r,e;r=t.telemetry||(t.telemetry={}),(e=r.OpenExplorationSource||(r.OpenExplorationSource={})).Normal="Normal",e.EmailSubscription="EmailSubscription",e.ReportInvitation="ReportInvitation",e.SubscribeOthers="SubscribeOthers",e.Commenting="Commenting",e.Invalid="Invalid",r.EXRetrieveFromVisualContainerCacheEventName="PBI.EX.RetrieveFromVisualContainerCache",r.EXRetrieveFromVisualContainerCache=window.updatedTelemetryFunction?t.generateTelemetryEvent(r.EXRetrieveFromVisualContainerCacheEventName):r.EventFactories[r.EXRetrieveFromVisualContainerCacheEventName]=function(e){return t.telemetryEventFactory({name:r.EXRetrieveFromVisualContainerCacheEventName,info:e})},r.EXRunQueryEventName="PBI.EX.RunQuery",r.EXRunQuery=window.updatedTelemetryFunction?t.generateTelemetryEvent(r.EXRunQueryEventName,{logRatio:0}):r.EventFactories[r.EXRunQueryEventName]=function(e){return t.telemetryEventFactory({name:r.EXRunQueryEventName,info:e,logRatio:0})},r.EXRunQueryImplEventName="PBI.EX.RunQueryImpl",r.EXRunQueryImpl=window.updatedTelemetryFunction?t.generateTelemetryEvent(r.EXRunQueryImplEventName,{logRatio:0}):r.EventFactories[r.EXRunQueryImplEventName]=function(e){return t.telemetryEventFactory({name:r.EXRunQueryImplEventName,info:e,logRatio:0})},r.EXGetCachedQueryOrGenerateEventName="PBI.EX.GetCachedQueryOrGenerate",r.EXGetCachedQueryOrGenerate=window.updatedTelemetryFunction?t.generateTelemetryEvent(r.EXGetCachedQueryOrGenerateEventName,{logRatio:0}):r.EventFactories[r.EXGetCachedQueryOrGenerateEventName]=function(e){return t.telemetryEventFactory({name:r.EXGetCachedQueryOrGenerateEventName,info:e,logRatio:0})},r.EXVisualFirstLoadEventName="PBI.EX.VisualFirstLoad",r.EXVisualFirstLoad=window.updatedTelemetryFunction?t.generateTelemetryEvent(r.EXVisualFirstLoadEventName):r.EventFactories[r.EXVisualFirstLoadEventName]=function(e){return t.telemetryEventFactory({name:r.EXVisualFirstLoadEventName,info:e})},r.EXToggleVisualDisplayEventName="PBI.EX.ToggleVisualDisplay",r.EXToggleVisualDisplay=window.updatedTelemetryFunction?t.generateTelemetryEvent(r.EXToggleVisualDisplayEventName,{logExpAssignment:!0}):r.EventFactories[r.EXToggleVisualDisplayEventName]=function(e){return t.telemetryEventFactory({name:r.EXToggleVisualDisplayEventName,info:e,logExpAssignment:!0})},r.EXGetExplorationEventName="PBI.EX.GetExploration",r.EXGetExploration=window.updatedTelemetryFunction?t.generateTelemetryEvent(r.EXGetExplorationEventName):r.EventFactories[r.EXGetExplorationEventName]=function(e){return t.telemetryEventFactory({name:r.EXGetExplorationEventName,info:e})},r.EXDeserializeExplorationEventName="PBI.EX.DeserializeExploration",r.EXDeserializeExploration=window.updatedTelemetryFunction?t.generateTelemetryEvent(r.EXDeserializeExplorationEventName):r.EventFactories[r.EXDeserializeExplorationEventName]=function(e){return t.telemetryEventFactory({name:r.EXDeserializeExplorationEventName,info:e})},r.EXOpenExplorationEventName="PBI.EX.OpenExploration",r.EXOpenExploration=window.updatedTelemetryFunction?t.generateTelemetryEvent(r.EXOpenExplorationEventName,{shouldLogStartEnd:!0,logExpAssignment:!0}):r.EventFactories[r.EXOpenExplorationEventName]=function(e){return t.telemetryEventFactory({name:r.EXOpenExplorationEventName,info:e,shouldLogStartEnd:!0,logExpAssignment:!0})},r.EXExplorationStateApplyImpactEventName="PBI.EX.ExplorationStateApplyImpact",r.EXExplorationStateApplyImpact=window.updatedTelemetryFunction?t.generateTelemetryEvent(r.EXExplorationStateApplyImpactEventName):r.EventFactories[r.EXExplorationStateApplyImpactEventName]=function(e){return t.telemetryEventFactory({name:r.EXExplorationStateApplyImpactEventName,info:e})},r.EXExplorationStateApplyImpactIssuesEventName="PBI.EX.ExplorationStateApplyImpactIssues",r.EXExplorationStateApplyImpactIssues=window.updatedTelemetryFunction?t.generateTelemetryEvent(r.EXExplorationStateApplyImpactIssuesEventName):r.EventFactories[r.EXExplorationStateApplyImpactIssuesEventName]=function(e){return t.telemetryEventFactory({name:r.EXExplorationStateApplyImpactIssuesEventName,info:e})},r.EXSwitchSectionEventName="PBI.EX.SwitchSection",r.EXSwitchSection=window.updatedTelemetryFunction?t.generateTelemetryEvent(r.EXSwitchSectionEventName):r.EventFactories[r.EXSwitchSectionEventName]=function(e){return t.telemetryEventFactory({name:r.EXSwitchSectionEventName,info:e})},r.EXSwitchToAdjacentSectionEventName="PBI.EX.SwitchToAdjacentSection",r.EXSwitchToAdjacentSection=window.updatedTelemetryFunction?t.generateTelemetryEvent(r.EXSwitchToAdjacentSectionEventName):r.EventFactories[r.EXSwitchToAdjacentSectionEventName]=function(e){return t.telemetryEventFactory({name:r.EXSwitchToAdjacentSectionEventName,info:e})},r.EXNavigateBackEventName="PBI.EX.NavigateBack",r.EXNavigateBack=window.updatedTelemetryFunction?t.generateTelemetryEvent(r.EXNavigateBackEventName,{logExpAssignment:!0}):r.EventFactories[r.EXNavigateBackEventName]=function(e){return t.telemetryEventFactory({name:r.EXNavigateBackEventName,info:e,logExpAssignment:!0})},r.EXNavigationButtonClickedEventName="PBI.EX.NavigationButtonClicked",r.EXNavigationButtonClicked=window.updatedTelemetryFunction?t.generateTelemetryEvent(r.EXNavigationButtonClickedEventName,{logExpAssignment:!0}):r.EventFactories[r.EXNavigationButtonClickedEventName]=function(e){return t.telemetryEventFactory({name:r.EXNavigationButtonClickedEventName,info:e,logExpAssignment:!0})},r.EXVisualQueryGeneratorWarningEventName="PBI.EX.VisualQueryGeneratorWarning",r.EXVisualQueryGeneratorWarning=window.updatedTelemetryFunction?t.generateTelemetryEvent(r.EXVisualQueryGeneratorWarningEventName):r.EventFactories[r.EXVisualQueryGeneratorWarningEventName]=function(e){return t.telemetryEventFactory({name:r.EXVisualQueryGeneratorWarningEventName,info:e})},r.EXVisualQueryGeneratorErrorEventName="PBI.EX.VisualQueryGeneratorError",r.EXVisualQueryGeneratorError=window.updatedTelemetryFunction?t.generateTelemetryEvent(r.EXVisualQueryGeneratorErrorEventName):r.EventFactories[r.EXVisualQueryGeneratorErrorEventName]=function(e){return t.telemetryEventFactory({name:r.EXVisualQueryGeneratorErrorEventName,info:e})},r.EXGroupsGroupsActionEventName="PBI.EX.Groups.GroupsAction",r.EXGroupsGroupsAction=window.updatedTelemetryFunction?t.generateTelemetryEvent(r.EXGroupsGroupsActionEventName):r.EventFactories[r.EXGroupsGroupsActionEventName]=function(e){return t.telemetryEventFactory({name:r.EXGroupsGroupsActionEventName,info:e})},r.EXGroupsBinBySizeActionEventName="PBI.EX.Groups.BinBySizeAction",r.EXGroupsBinBySizeAction=window.updatedTelemetryFunction?t.generateTelemetryEvent(r.EXGroupsBinBySizeActionEventName):r.EventFactories[r.EXGroupsBinBySizeActionEventName]=function(e){return t.telemetryEventFactory({name:r.EXGroupsBinBySizeActionEventName,info:e})},r.EXGroupsBinByCountActionEventName="PBI.EX.Groups.BinByCountAction",r.EXGroupsBinByCountAction=window.updatedTelemetryFunction?t.generateTelemetryEvent(r.EXGroupsBinByCountActionEventName):r.EventFactories[r.EXGroupsBinByCountActionEventName]=function(e){return t.telemetryEventFactory({name:r.EXGroupsBinByCountActionEventName,info:e})},r.EXGroupsUsageEventName="PBI.EX.Groups.Usage",r.EXGroupsUsage=window.updatedTelemetryFunction?t.generateTelemetryEvent(r.EXGroupsUsageEventName):r.EventFactories[r.EXGroupsUsageEventName]=function(e){return t.telemetryEventFactory({name:r.EXGroupsUsageEventName,info:e})},r.EXGroupsErrorEventName="PBI.EX.Groups.Error",r.EXGroupsError=window.updatedTelemetryFunction?t.generateTelemetryEvent(r.EXGroupsErrorEventName):r.EventFactories[r.EXGroupsErrorEventName]=function(e){return t.telemetryEventFactory({name:r.EXGroupsErrorEventName,info:e})},r.EXModelChangeEventName="PBI.EX.ModelChange",r.EXModelChange=window.updatedTelemetryFunction?t.generateTelemetryEvent(r.EXModelChangeEventName):r.EventFactories[r.EXModelChangeEventName]=function(e){return t.telemetryEventFactory({name:r.EXModelChangeEventName,info:e})},r.EXMeasuresEventName="PBI.EX.Measures",r.EXMeasures=window.updatedTelemetryFunction?t.generateTelemetryEvent(r.EXMeasuresEventName):r.EventFactories[r.EXMeasuresEventName]=function(e){return t.telemetryEventFactory({name:r.EXMeasuresEventName,info:e})},r.EXReportMeasureDataTypeChangeEventName="PBI.EX.ReportMeasureDataTypeChange",r.EXReportMeasureDataTypeChange=window.updatedTelemetryFunction?t.generateTelemetryEvent(r.EXReportMeasureDataTypeChangeEventName):r.EventFactories[r.EXReportMeasureDataTypeChangeEventName]=function(e){return t.telemetryEventFactory({name:r.EXReportMeasureDataTypeChangeEventName,info:e})},r.EXReportMeasureDataCategoryChangeEventName="PBI.EX.ReportMeasureDataCategoryChange",r.EXReportMeasureDataCategoryChange=window.updatedTelemetryFunction?t.generateTelemetryEvent(r.EXReportMeasureDataCategoryChangeEventName):r.EventFactories[r.EXReportMeasureDataCategoryChangeEventName]=function(e){return t.telemetryEventFactory({name:r.EXReportMeasureDataCategoryChangeEventName,info:e})},r.EXReportMeasureMoveRoleKindEventName="PBI.EX.ReportMeasureMoveRoleKind",r.EXReportMeasureMoveRoleKind=window.updatedTelemetryFunction?t.generateTelemetryEvent(r.EXReportMeasureMoveRoleKindEventName):r.EventFactories[r.EXReportMeasureMoveRoleKindEventName]=function(e){return t.telemetryEventFactory({name:r.EXReportMeasureMoveRoleKindEventName,info:e})},r.EXQuickCalcMeasureEditedEventName="PBI.EX.QuickCalcMeasureEdited",r.EXQuickCalcMeasureEdited=window.updatedTelemetryFunction?t.generateTelemetryEvent(r.EXQuickCalcMeasureEditedEventName):r.EventFactories[r.EXQuickCalcMeasureEditedEventName]=function(e){return t.telemetryEventFactory({name:r.EXQuickCalcMeasureEditedEventName,info:e})},r.EXQuickCalcMeasureDeletedEventName="PBI.EX.QuickCalcMeasureDeleted",r.EXQuickCalcMeasureDeleted=window.updatedTelemetryFunction?t.generateTelemetryEvent(r.EXQuickCalcMeasureDeletedEventName):r.EventFactories[r.EXQuickCalcMeasureDeletedEventName]=function(e){return t.telemetryEventFactory({name:r.EXQuickCalcMeasureDeletedEventName,info:e})},r.EXVisualDrillableRoleActiveItemsFixedEventName="PBI.EX.VisualDrillableRoleActiveItemsFixed",r.EXVisualDrillableRoleActiveItemsFixed=window.updatedTelemetryFunction?t.generateTelemetryEvent(r.EXVisualDrillableRoleActiveItemsFixedEventName):r.EventFactories[r.EXVisualDrillableRoleActiveItemsFixedEventName]=function(e){return t.telemetryEventFactory({name:r.EXVisualDrillableRoleActiveItemsFixedEventName,info:e})},r.PersistentStateSerializationErrorEventName="PBI.PersistentState.SerializationError",r.PersistentStateSerializationError=window.updatedTelemetryFunction?t.generateTelemetryEvent(r.PersistentStateSerializationErrorEventName):r.EventFactories[r.PersistentStateSerializationErrorEventName]=function(e){return t.telemetryEventFactory({name:r.PersistentStateSerializationErrorEventName,info:e})},r.PodSerializationErrorFixedEventName="PBI.Pod.SerializationErrorFixed",r.PodSerializationErrorFixed=window.updatedTelemetryFunction?t.generateTelemetryEvent(r.PodSerializationErrorFixedEventName):r.EventFactories[r.PodSerializationErrorFixedEventName]=function(e){return t.telemetryEventFactory({name:r.PodSerializationErrorFixedEventName,info:e})},r.SerializationErrorEventName="PBI.SerializationError",r.SerializationError=window.updatedTelemetryFunction?t.generateTelemetryEvent(r.SerializationErrorEventName):r.EventFactories[r.SerializationErrorEventName]=function(e){return t.telemetryEventFactory({name:r.SerializationErrorEventName,info:e})},r.EXEmptyVisualContainerConfigEventName="PBI.EX.EmptyVisualContainerConfig",r.EXEmptyVisualContainerConfig=window.updatedTelemetryFunction?t.generateTelemetryEvent(r.EXEmptyVisualContainerConfigEventName):r.EventFactories[r.EXEmptyVisualContainerConfigEventName]=function(e){return t.telemetryEventFactory({name:r.EXEmptyVisualContainerConfigEventName,info:e})},r.ClipboardServicePasteEventName="PBI.ClipboardService.Paste",r.ClipboardServicePaste=window.updatedTelemetryFunction?t.generateTelemetryEvent(r.ClipboardServicePasteEventName):r.EventFactories[r.ClipboardServicePasteEventName]=function(e){return t.telemetryEventFactory({name:r.ClipboardServicePasteEventName,info:e})},r.ClipboardServiceUnsupportedVersionEventName="PBI.ClipboardService.UnsupportedVersion",r.ClipboardServiceUnsupportedVersion=window.updatedTelemetryFunction?t.generateTelemetryEvent(r.ClipboardServiceUnsupportedVersionEventName):r.EventFactories[r.ClipboardServiceUnsupportedVersionEventName]=function(e){return t.telemetryEventFactory({name:r.ClipboardServiceUnsupportedVersionEventName,info:e})},r.DataPointLassoSelectPreviewSerializedEventName="PBI.DataPointLassoSelect.PreviewSerialized",r.DataPointLassoSelectPreviewSerialized=window.updatedTelemetryFunction?t.generateTelemetryEvent(r.DataPointLassoSelectPreviewSerializedEventName):r.EventFactories[r.DataPointLassoSelectPreviewSerializedEventName]=function(e){return t.telemetryEventFactory({name:r.DataPointLassoSelectPreviewSerializedEventName,info:e})},r.EXLoopingSQExprEventName="PBI.EX.LoopingSQExpr",r.EXLoopingSQExpr=window.updatedTelemetryFunction?t.generateTelemetryEvent(r.EXLoopingSQExprEventName):r.EventFactories[r.EXLoopingSQExprEventName]=function(e){return t.telemetryEventFactory({name:r.EXLoopingSQExprEventName,info:e})},r.EXGetLinguisticSchemaEventName="PBI.EX.GetLinguisticSchema",r.EXGetLinguisticSchema=window.updatedTelemetryFunction?t.generateTelemetryEvent(r.EXGetLinguisticSchemaEventName):r.EventFactories[r.EXGetLinguisticSchemaEventName]=function(e){return t.telemetryEventFactory({name:r.EXGetLinguisticSchemaEventName,info:e})},r.EXGetAutoRefreshAdminConfigEventName="PBI.EX.GetAutoRefreshAdminConfig",r.EXGetAutoRefreshAdminConfig=window.updatedTelemetryFunction?t.generateTelemetryEvent(r.EXGetAutoRefreshAdminConfigEventName):r.EventFactories[r.EXGetAutoRefreshAdminConfigEventName]=function(e){return t.telemetryEventFactory({name:r.EXGetAutoRefreshAdminConfigEventName,info:e})},r.EXGetChangeDetectionAdminConfigEventName="PBI.EX.GetChangeDetectionAdminConfig",r.EXGetChangeDetectionAdminConfig=window.updatedTelemetryFunction?t.generateTelemetryEvent(r.EXGetChangeDetectionAdminConfigEventName):r.EventFactories[r.EXGetChangeDetectionAdminConfigEventName]=function(e){return t.telemetryEventFactory({name:r.EXGetChangeDetectionAdminConfigEventName,info:e})},r.EXAnchorTimeUndefinedEventName="PBI.EX.AnchorTimeUndefined",r.EXAnchorTimeUndefined=window.updatedTelemetryFunction?t.generateTelemetryEvent(r.EXAnchorTimeUndefinedEventName):r.EventFactories[r.EXAnchorTimeUndefinedEventName]=function(e){return t.telemetryEventFactory({name:r.EXAnchorTimeUndefinedEventName,info:e})},r.EXGetAPRConfigFailureEventName="PBI.EX.GetAPRConfigFailure",r.EXGetAPRConfigFailure=window.updatedTelemetryFunction?t.generateTelemetryEvent(r.EXGetAPRConfigFailureEventName):r.EventFactories[r.EXGetAPRConfigFailureEventName]=function(e){return t.telemetryEventFactory({name:r.EXGetAPRConfigFailureEventName,info:e})},r.EXDefnsDuplicateSelectorEventName="PBI.EX.DefnsDuplicateSelector",r.EXDefnsDuplicateSelector=window.updatedTelemetryFunction?t.generateTelemetryEvent(r.EXDefnsDuplicateSelectorEventName):r.EventFactories[r.EXDefnsDuplicateSelectorEventName]=function(e){return t.telemetryEventFactory({name:r.EXDefnsDuplicateSelectorEventName,info:e})},r.EXCertifiedTelemetryChildrenCountMismatchEventName="PBI.EX.CertifiedTelemetryChildrenCountMismatch",r.EXCertifiedTelemetryChildrenCountMismatch=window.updatedTelemetryFunction?t.generateTelemetryEvent(r.EXCertifiedTelemetryChildrenCountMismatchEventName):r.EventFactories[r.EXCertifiedTelemetryChildrenCountMismatchEventName]=function(e){return t.telemetryEventFactory({name:r.EXCertifiedTelemetryChildrenCountMismatchEventName,info:e})},r.EXUndoEventTimeEventName="PBI.EX.UndoEventTime",r.EXUndoEventTime=window.updatedTelemetryFunction?t.generateTelemetryEvent(r.EXUndoEventTimeEventName):r.EventFactories[r.EXUndoEventTimeEventName]=function(e){return t.telemetryEventFactory({name:r.EXUndoEventTimeEventName,info:e})},r.EXConsecutiveUndoCountEventName="PBI.EX.ConsecutiveUndoCount",r.EXConsecutiveUndoCount=window.updatedTelemetryFunction?t.generateTelemetryEvent(r.EXConsecutiveUndoCountEventName):r.EventFactories[r.EXConsecutiveUndoCountEventName]=function(e){return t.telemetryEventFactory({name:r.EXConsecutiveUndoCountEventName,info:e})}})(powerbi=powerbi||{}),(function(e){function t(){}e=(e=e.explore||(e.explore={})).contracts||(e.contracts={}),t.isValidBookmark=function(e){return e&&(t.isBookmarkGroup(e)||t.isStateBookmark(e))},t.isBookmarkGroup=function(e){return void 0!==e.children},t.isStateBookmark=function(e){return!t.isBookmarkGroup(e)},t.isWebBookmark=function(e){return void 0!==e.type},e.BookmarkExtensions=t,(e=e.BookmarkActions||(e.BookmarkActions={})).Add="AddBookmark",e.Apply="ApplyBookmark",e.Remove="RemoveBookmark",e.Move="MoveBookmark",e.Update="UpdateBookmark",e.Rename="RenameBookmark",e.Group="GroupBookmarks",e.Ungroup="UngroupBookmarks"})(powerbi=powerbi||{}),(function(a){var n,e,t,i;function o(e){return _.includes(Object.keys(e),"extends")}function s(e){return _.map(e,(function(e){return e[i.readerType(e)]}))}n=a.explore||(a.explore={}),e=n.contracts||(n.contracts={}),t=jsCommon.ArrayExtensions,i=a.data.DataReaderUtils,e.createDataSourceArray=function(e){return t.extendWithName(t.extendWithId(e=void 0===e?[]:e))},e.dataSourceForModel=function(e){var t=n.constants.DefaultSchemaName,r=e.capacityObjectId&&void 0===e.queryCachingState?void 0:2===e.queryCachingState,i=e.datasetHost;return{type:a.common.constants.dsrDataReaderType,id:e.id,name:t,dsr:{schemaName:t,vsName:e.vsName,dbName:e.dbName,modelId:e.id,isQueryCachingEnabled:r,lastRefreshTime:e.lastRefreshTime,isLimitedParallelQueryModel:i===a.common.contracts.DatasetHost.ASOnPrem}}},(e=e.DataSource||(e.DataSource={})).isExtension=o,e.referenced=function(e,t){var r;if(!_.isEmpty(e))return r=i.findSchemas(t),s(_.isEmpty(r)?e:_.filter(e,(function(e){return _.includes(r,e.name)})))},e.queried=function(e,t){var r;if(!_.isEmpty(e))return r=i.findSchemas(t),_.isEmpty(r)?_.filter(e,(function(e){return!o(e)})):_.chain(e).filter((function(e){return _.includes(r,e.name)})).map((function(t){return o(t)?_.find(e,(function(e){return e.name===t.extends})):t})).uniq().value()},e.dataReaderDataSources=s})(powerbi=powerbi||{}),(function(e){var t;(t=(t=(t=e.explore||(e.explore={})).contracts||(t.contracts={})).AutoPageRefreshOption||(t.AutoPageRefreshOption={})).CDM="CDM",t.APR="APR",t.Type=e.createEnumType([{value:t.APR,displayName:function(e){return e.get("PageRefresh_APR")}},{value:t.CDM,displayName:function(e){return e.get("ChangeDetection")}}])})(powerbi=powerbi||{}),(function(e){var t,r;t=(t=e.explore||(e.explore={})).contracts||(t.contracts={}),(r=t.SectionAlignmentOption||(t.SectionAlignmentOption={}))[r.Top=0]="Top",r[r.Middle=1]="Middle",(r=t.SectionAlignmentPosition||(t.SectionAlignmentPosition={})).top="Top",r.middle="Middle",r.Type=e.createEnumType([{value:r.top,displayName:function(e){return e.get("Top")}},{value:r.middle,displayName:function(e){return e.get("Middle")}}])})(powerbi=powerbi||{}),(function(e){var t;(t=(t=(t=e.explore||(e.explore={})).contracts||(t.contracts={})).SectionPageSizeTypes||(t.SectionPageSizeTypes={})).PageSizeTypes={Dynamic:"Dynamic",Standard:"Standard",Widescreen:"Widescreen",Cortana:"Cortana",Letter:"Letter",Tooltip:"Tooltip",Custom:"Custom"},t.Type=e.createEnumType([{value:t.PageSizeTypes.Widescreen,displayName:function(e){return e.get("PagePropertyPane_PageSizeType_Widescreen")}},{value:t.PageSizeTypes.Standard,displayName:function(e){return e.get("PagePropertyPane_PageSizeType_Standard")}},{value:t.PageSizeTypes.Letter,displayName:function(e){return e.get("PagePropertyPane_PageSizeType_Letter")}},{value:t.PageSizeTypes.Tooltip,displayName:function(e){return e.get("Tooltip")}},{value:t.PageSizeTypes.Custom,displayName:function(e){return e.get("Custom")}}])})(powerbi=powerbi||{}),(function(e){var l,p,u,t,c,d;function r(e){"string"==typeof e?this.originalExplorationJSON=e:this.originalExploration=e}l=e.explore||(e.explore={}),p=l.contracts||(l.contracts={}),u=jsCommon.ArrayExtensions,t=e.data.createDisplayNameGetter,c=e.data.DataViewObjectDefinitions,d=e.data.SQExprBuilder,(e=p.LinguisticSchemaSyncVersion||(p.LinguisticSchemaSyncVersion={}))[e.Unspecified=0]="Unspecified",e[e.QnaSuggestQuestions=1]="QnaSuggestQuestions",e[e.VisualColumnRenameTerms=2]="VisualColumnRenameTerms",p.createDefaultExploration=function(e,t,r,i,a){var n=l.constants,o={},s={useNewFilterPaneExperience:!0,allowChangeFilterTypes:!0,useStylableVisualContainerHeader:!0,queryLimitOption:6};return r.featureSwitches.enhancedTooltips&&(s.useEnhancedTooltips=!0),r.featureSwitches.exportDataMode&&(s.exportDataMode=1),r.featureSwitches.automatedInsights&&r.featureSwitches.automatedInsightsBackgroundRefresh&&r.featureSwitches.automatedInsightsEntryPointsEnabled&&r.featureSwitches.automatedInsightsTenantEnabled&&(s.allowAutomatedInsightsNotification=!0),r.featureSwitches.defaultAggrDisplayName&&(s.useDefaultAggregateDisplayName=!0),null!=i?c.setValue(o,{objectName:"section",propertyName:"verticalAlignment"},null,d.text(i)):c.setValue(o,{objectName:"section",propertyName:"verticalAlignment"},null,d.text(p.SectionAlignmentPosition.top)),{themeCollection:{baseTheme:l.util.ThemeUtils.getCurrentBaseThemeMetadata(r)},id:0,width:n.ExploreCanvasConstants.DefaultCanvasWidth,height:n.ExploreCanvasConstants.DefaultCanvasHeight,dataSources:p.createDataSourceArray(),sections:u.extendWithId([{id:0,name:"ReportSection",displayName:e,visualContainers:t,visualContainerGroups:__spreadArray([],t||[],!0),filters:[],size:{displayOption:1,width:n.ExploreCanvasConstants.DefaultWidescreenWidth,height:n.ExploreCanvasConstants.DefaultWidescreenHeight}}]),settings:_.isEmpty(s)?void 0:s,objects:o,creationSource:a}},p.ExplorationObjectDescriptors={outspacePane:{displayName:t("Exploration_FilterPane"),properties:{expanded:{type:{bool:!0}},visible:{type:{bool:!0}}}},section:{displayName:t("PagePropertyPane_PageAlignment"),properties:{verticalAlignment:{type:{enumeration:p.SectionAlignmentPosition.Type}}}}},r.prototype.value=function(){return!this.originalExploration&&this.originalExplorationJSON&&(this.originalExploration=jsCommon.JsonExtensions.tryParseJSON(this.originalExplorationJSON),this.originalExplorationJSON=void 0),this.originalExploration},r.Empty=new r,p.OriginalExploration=r})(powerbi=powerbi||{}),(function(e){var t;e=(e=e.explore||(e.explore={})).contracts||(e.contracts={}),(t=e.FilterContainer||(e.FilterContainer={})).ObjectType="filter",t.CommonObjectDescriptors={general:{properties:{requireSingleSelect:{type:{bool:!0}},isInvertedSelectionMode:{type:{bool:!0}}}}},(t=e.FilterType||(e.FilterType={}))[t.Categorical=0]="Categorical",t[t.Range=1]="Range",t[t.Advanced=2]="Advanced",t[t.Passthrough=3]="Passthrough",t[t.Visual=4]="Visual",t[t.TopN=5]="TopN",t[t.Include=6]="Include",t[t.Exclude=7]="Exclude",t[t.RelativeDate=8]="RelativeDate",t[t.Tuple=9]="Tuple",t[t.RelativeTime=10]="RelativeTime"})(powerbi=powerbi||{}),(function(e){(e=(e=(e=e.explore||(e.explore={})).contracts||(e.contracts={})).CollectedFilterSource||(e.CollectedFilterSource={}))[e.Self=1]="Self",e[e.Slicer=2]="Slicer"})(powerbi=powerbi||{}),(function(e){var t,r;t=(t=e.explore||(e.explore={})).contracts||(t.contracts={}),e=e.data.createDisplayNameGetter,(r=t.Section||(t.Section={})).objectDescriptors={pageInformation:{displayName:e("PagePropertyPane_PageInformation"),properties:{pageInformationName:{displayName:e("Name"),type:{text:!0}},pageInformationQnaPodEnabled:{displayName:e("Generic_Qna"),type:{bool:!0}},pageInformationAltName:{displayName:e("PagePropertyPane_PageInformation_AltName_Placeholder"),type:{formatting:{altText:!0}}},pageInformationType:{displayName:e("Allow_As_Tooltip"),type:{bool:!0}}}},pageSize:{displayName:e("Canvas_Settings"),properties:{pageSizeTypes:{displayName:e("Type"),type:{enumeration:t.SectionPageSizeTypes.Type}},pageSizeWidth:{displayName:e("PagePropertyPane_PageSizeWidth"),type:{numeric:!0}},pageSizeHeight:{displayName:e("PagePropertyPane_PageSizeHeight"),type:{numeric:!0}}}},background:{displayName:e("PagePropertyPane_PageBackground"),properties:{color:{displayName:e("PagePropertyPane_PageBackgroundColor"),type:{fill:{solid:{color:!0}}}},image:{type:{image:{}}},transparency:{displayName:e("Transparency"),type:{numeric:!0}}}},displayArea:{displayName:e("PagePropertyPane_PageAlignment"),properties:{verticalAlignment:{displayName:e("Visual_Alignment_Vertical"),type:{enumeration:t.SectionAlignmentPosition.Type}}}},outspace:{displayName:e("PagePropertyPane_Outspace"),properties:{color:{displayName:e("PagePropertyPane_PageBackgroundColor"),type:{fill:{solid:{color:!0}}}},image:{type:{image:{}}},transparency:{displayName:e("Transparency"),type:{numeric:!0}}}},outspacePane:{displayName:e("Exploration_FilterPane"),properties:{backgroundColor:{displayName:e("PagePropertyPane_OutspacePane_BackgroundColor"),type:{fill:{solid:{color:!0}}},description:e("PagePropertyPane_OutspacePane_BackgroundColorTooltip")},transparency:{displayName:e("Transparency"),type:{numeric:!0},description:e("PagePropertyPane_OutspacePane_BackgroundTransparencyTooltip")},foregroundColor:{displayName:e("PagePropertyPane_OutspacePane_ForegroundColor"),type:{fill:{solid:{color:!0}}},description:e("PagePropertyPane_OutspacePane_ForegroundColorTooltip")},titleSize:{displayName:e("Visual_AxisTitleTextSize"),type:{integer:!0},description:e("PagePropertyPane_OutspacePane_TitleSizeTooltip")},searchTextSize:{displayName:e("PagePropertyPane_OutspacePane_SearchTextSize"),type:{integer:!0},description:e("PagePropertyPane_OutspacePane_SearchTextSizeTooltip")},headerSize:{displayName:e("PagePropertyPane_OutspacePane_HeaderSize"),type:{integer:!0},description:e("PagePropertyPane_OutspacePane_HeaderSizeTooltip")},fontFamily:{displayName:e("Visual_FontFamily"),type:{formatting:{fontFamily:!0}},description:e("PagePropertyPane_OutspacePane_FontFamilyTooltip")},border:{displayName:e("Visual_Border"),type:{bool:!0},description:e("PagePropertyPane_OutspacePane_LeftBorderTooltip")},borderColor:{displayName:e("PagePropertyPane_FilterCards_BorderColor"),type:{fill:{solid:{color:!0}}},description:e("PagePropertyPane_OutspacePane_BorderColorTooltip")},checkboxAndApplyColor:{displayName:e("Checkbox_Apply_Color_Title"),type:{fill:{solid:{color:!0}}},description:e("Checkbox_Apply_Color_Description")},inputBoxColor:{displayName:e("PagePropertyPane_FilterCards_InputBoxColor"),type:{fill:{solid:{color:!0}}},description:e("PagePropertyPane_OutspacePane_InputBoxColorTooltip")},width:{displayName:e("PagePropertyPane_PageSizeWidth"),type:{integer:!0}}}},filterCard:{displayName:e("PagePropertyPane_FilterCards"),properties:{backgroundColor:{displayName:e("PagePropertyPane_OutspacePane_BackgroundColor"),type:{fill:{solid:{color:!0}}},description:e("PagePropertyPane_FilterCards_BackgroundColorTooltip")},transparency:{displayName:e("Transparency"),type:{integer:!0},description:e("PagePropertyPane_FilterCards_BackgroundTransparencyTooltip")},border:{displayName:e("Visual_Border"),type:{bool:!0},description:e("PagePropertyPane_FilterCards_BorderTooltip")},borderColor:{displayName:e("PagePropertyPane_FilterCards_BorderColor"),type:{fill:{solid:{color:!0}}},description:e("PagePropertyPane_FilterCards_BorderColorTooltip")},foregroundColor:{displayName:e("PagePropertyPane_OutspacePane_ForegroundColor"),type:{fill:{solid:{color:!0}}},description:e("PagePropertyPane_FilterCards_ForegroundColorTooltip")},textSize:{displayName:e("Visual_TextSize"),type:{integer:!0},description:e("PagePropertyPane_FilterCards_TextSizeTooltip")},fontFamily:{displayName:e("Visual_FontFamily"),type:{formatting:{fontFamily:!0}},description:e("PagePropertyPane_FilterCards_FontFamilyTooltip")},inputBoxColor:{displayName:e("PagePropertyPane_FilterCards_InputBoxColor"),type:{fill:{solid:{color:!0}}},description:e("PagePropertyPane_FilterCards_InputBoxColorTooltip")}}},pageRefresh:{displayName:e("PageRefresh"),properties:{show:{displayName:e("Show"),type:{bool:!0}},refreshType:{displayName:e("AutoPageRefreshType"),type:{enumeration:t.AutoPageRefreshOption.Type}},duration:{displayName:e("AutoPageRefreshInterval"),type:{duration:!0}},dialogLauncher:{displayName:e("AutoPageRefreshInterval"),type:{}},measure:{displayName:e("NewMeasureName"),type:{readOnlyText:!0}},checkEvery:{displayName:e("CheckEvery"),type:{readOnlyText:!0}}}},personalizeVisual:{displayName:e("VisualHeader_ShowPersonalizeVisualButton"),properties:{show:{displayName:e("Show"),type:{bool:!0}},perspectiveRef:{displayName:e("PersonalizeVisual_PerspectivePropertyName"),type:{reference:{perspective:!0}}},applyToAllPages:{displayName:e("PagePropertyPane_ApplyToAllPages"),type:{applyToAllPages:!0}}}}},r.filterTransient=function(e){return _.filter(e,(function(e){return!e.transient}))},t.SectionProps={pageInformation:{pageInformationName:{objectName:"pageInformation",propertyName:"pageInformationName"},pageInformationQnaPodEnabled:{objectName:"pageInformation",propertyName:"pageInformationQnaPodEnabled"},pageInformationAltName:{objectName:"pageInformation",propertyName:"pageInformationAltName"},pageInformationType:{objectName:"pageInformation",propertyName:"pageInformationType"},pageInformationDrillthroughKeepAllFilters:{objectName:"pageInformation",propertyName:"pageInformationDrillthroughKeepAllFilters"},pageInformationDrillthroughCrossReportEnabled:{objectName:"pageInformation",propertyName:"pageInformationDrillthroughCrossReportEnabled"},pageInformationDrillthroughFields:{objectName:"pageInformation",propertyName:"pageInformationDrillthroughFields"},pageInformationDrillthroughLinkFieldsLinkTypes:{objectName:"pageInformation",propertyName:"pageInformationDrillthroughLinkFieldsLinkTypes"}},pageSize:{pageSizeTypes:{objectName:"pageSize",propertyName:"pageSizeTypes"},pageSizeWidth:{objectName:"pageSize",propertyName:"pageSizeWidth"},pageSizeHeight:{objectName:"pageSize",propertyName:"pageSizeHeight"}},background:{color:{objectName:"background",propertyName:"color"},image:{objectName:"background",propertyName:"image"},transparency:{objectName:"background",propertyName:"transparency"}},displayArea:{verticalAlignment:{objectName:"displayArea",propertyName:"verticalAlignment"}},outspace:{color:{objectName:"outspace",propertyName:"color"},image:{objectName:"outspace",propertyName:"image"},transparency:{objectName:"outspace",propertyName:"transparency"}},outspacePane:{backgroundColor:{objectName:"outspacePane",propertyName:"backgroundColor"},transparency:{objectName:"outspacePane",propertyName:"transparency"},foregroundColor:{objectName:"outspacePane",propertyName:"foregroundColor"},titleSize:{objectName:"outspacePane",propertyName:"titleSize"},searchTextSize:{objectName:"outspacePane",propertyName:"searchTextSize"},headerSize:{objectName:"outspacePane",propertyName:"headerSize"},fontFamily:{objectName:"outspacePane",propertyName:"fontFamily"},border:{objectName:"outspacePane",propertyName:"border"},borderColor:{objectName:"outspacePane",propertyName:"borderColor"},checkboxAndApplyColor:{objectName:"outspacePane",propertyName:"checkboxAndApplyColor"},inputBoxColor:{objectName:"outspacePane",propertyName:"inputBoxColor"},width:{objectName:"outspacePane",propertyName:"width"}},filterCard:{backgroundColor:{objectName:"filterCard",propertyName:"backgroundColor"},transparency:{objectName:"filterCard",propertyName:"transparency"},border:{objectName:"filterCard",propertyName:"border"},borderColor:{objectName:"filterCard",propertyName:"borderColor"},foregroundColor:{objectName:"filterCard",propertyName:"foregroundColor"},textSize:{objectName:"filterCard",propertyName:"textSize"},fontFamily:{objectName:"filterCard",propertyName:"fontFamily"},inputBoxColor:{objectName:"filterCard",propertyName:"inputBoxColor"}},pageRefresh:{show:{objectName:"pageRefresh",propertyName:"show"},refreshType:{objectName:"pageRefresh",propertyName:"refreshType"},duration:{objectName:"pageRefresh",propertyName:"duration"},dialogLauncher:{objectName:"pageRefresh",propertyName:"dialogLauncher"},measure:{objectName:"pageRefresh",propertyName:"measure"},checkEvery:{objectName:"pageRefresh",propertyName:"checkEvery"}},personalizeVisual:{show:{objectName:"personalizeVisual",propertyName:"show"},perspectiveRef:{objectName:"personalizeVisual",propertyName:"perspectiveRef"},applyToAllPages:{objectName:"personalizeVisual",propertyName:"applyToAllPages"}}}})(powerbi=powerbi||{}),(function(e){(e=(e=e.explore||(e.explore={})).contracts||(e.contracts={})).SnapshotReportType="Report",(e=e.EmbedType||(e.EmbedType={}))[e.Static=0]="Static",e[e.Interactive=1]="Interactive"})(powerbi=powerbi||{}),(function(e){var t,r;t=(t=e.explore||(e.explore={})).contracts||(t.contracts={}),r=e.visuals.builder,e=e.data.createDisplayNameGetter,(t=t.VisualContainerGroup||(t.VisualContainerGroup={})).objectType="visualContainerGroup",t.objectDescriptors={background:{displayName:e("Visual_Background"),properties:{show:{displayName:e("Visual_Show"),type:{bool:!0}},color:{displayName:e("Visual_Background_Color"),description:e("VisualGroup_Background_ColorDescription"),type:{fill:{solid:{color:!0}}}},transparency:{displayName:e("Transparency"),description:e("Visual_Background_TransparencyDescription"),type:{numeric:!0}}}},lockAspect:{displayName:e("Visual_BasicShape_LockAspect"),properties:{show:{displayName:e("Visual_Show"),type:{bool:!0}}}},general:{displayName:e("Visual_General_Properties"),properties:{x:{displayName:e("Visual_General_Properties_X_Coordinate"),type:{numeric:!0}},y:{displayName:e("Visual_General_Properties_Y_Coordinate"),type:{numeric:!0}},width:{displayName:e("Visual_General_Properties_Width"),type:{numeric:!0}},height:{displayName:e("Visual_General_Properties_Height"),type:{numeric:!0}},altText:{displayName:e("Visual_General_Properties_Description"),placeHolderText:e("Visual_General_Properties_Description_Placeholder"),type:{formatting:{altText:!0}}}}}},t.ObjectProps=r.getPropertyIdentifiers(t.objectDescriptors),t.isHidden=function(e){return e.isHidden},t.setHidden=function(e,t){e.isHidden=t},t.setDisplayName=function(e,t){e.displayName=t}})(powerbi=powerbi||{}),(function(e){var t;function p(e){return!!e.children}function u(e){return p(e)?t.VisualContainerGroup.isHidden(e):t.VisualContainer.isHidden(e.config.singleVisual)}e=e.explore||(e.explore={}),(t=e.contracts||(e.contracts={})).traverseVisualContainerGroups=function(e,t,r){return (function e(t,r,i,a){for(var n=0,o=i;n<o.length;n++){var s=o[n],l=t||u(s);r&&l||(a(s,l),p(s)&&e(l,r,s.children,a))}})(!1,r&&r.visibleOnly,e,t)},t.isVisualContainerGroup=p,t.isVisualContainer=function(e){return!e.children}})(powerbi=powerbi||{}),(function(e){var t,r,a;t=(t=e.explore||(e.explore={})).contracts||(t.contracts={}),a=e.data.DataViewObjectDefinitions,(r=t.VisualTooltip||(t.VisualTooltip={})).Default="Default",r.Canvas="Canvas",r.Type=e.createEnumType([{value:r.Default,displayName:function(e){return e.get("Default")}},{value:r.Canvas,displayName:function(e){return e.get("ReportPage")}}]),r.getType=function(e){return e.type},r.SectionAuto="___AUTO___",(t.VisualTitle||(t.VisualTitle={})).isHidden=function(e,t){return void 0===t&&(t=!1),!!e&&(!1===e.show||void 0===e.show&&t)},(t.VisualSubTitle||(t.VisualSubTitle={})).isVisualSubTitleHidden=function(e){return!!e&&!1===e.show},(t.VisualDivider||(t.VisualDivider={})).isVisualDividerHidden=function(e){return!!e&&!1===e.show},(r=t.SingleVisualConfig||(t.SingleVisualConfig={})).clone=function(e){var t,r,i;if(e)return t={visualType:e.visualType},e.syncGroup&&(t.syncGroup=_.cloneDeep(e.syncGroup)),e.columnProperties&&(t.columnProperties=_.cloneDeep(e.columnProperties)),e.query&&(t.query=e.query.clone()),e.queryOptions&&(t.queryOptions=_.cloneDeep(e.queryOptions)),e.objects&&(t.objects=a.clone(e.objects)),e.vcObjects&&(t.vcObjects=a.clone(e.vcObjects)),i=t,(r=e).mobileObjects&&(i.mobileObjects=a.clone(r.mobileObjects)),r.mobileVcObjects&&(i.mobileVcObjects=a.clone(r.mobileVcObjects)),e.hasDefaultSort&&(t.hasDefaultSort=e.hasDefaultSort),(i=e.conversionSourceContext)&&(t.conversionSourceContext={visualType:i.visualType,query:i.query&&i.query.clone(),syncGroup:i.syncGroup}),e.display&&(t.display=_.cloneDeep(e.display)),e.autoSelectVisualType&&(t.autoSelectVisualType=e.autoSelectVisualType),t.hasUsedSmallMultiples=e.hasUsedSmallMultiples,t},r.enumerateObjectRepetition=function(e,t){return(e=e&&e.getAdapter())?e.enumerateObjectRepetitionAsync?e.enumerateObjectRepetitionAsync():e.enumerateObjectRepetition?t.resolve(e.enumerateObjectRepetition()):t.resolve():t.resolve()}})(powerbi=powerbi||{}),(function(e){var t,r;t=(t=e.explore||(e.explore={})).contracts||(t.contracts={}),(r=t.VisualHeaderTooltip||(t.VisualHeaderTooltip={})).Text=t.VisualTooltip.Default,r.Canvas=t.VisualTooltip.Canvas,r.Type=e.createEnumType([{value:t.VisualTooltip.Default,displayName:function(e){return e.get("Text")}},{value:r.Canvas,displayName:function(e){return e.get("ReportPage")}}])})(powerbi=powerbi||{}),(function(e){var t,r,i,a,n,o,s,l,p;t=(t=e.explore||(e.explore={})).contracts||(t.contracts={}),s=e.visuals.builder,l=e.data.createDisplayNameGetter,p=e.visuals.lineStyle,(i=r=t.VisualLink||(t.VisualLink={})).Back="Back",i.Bookmark="Bookmark",i.Drillthrough="Drillthrough",i.PageNavigation="PageNavigation",i.Qna="Qna",i.WebUrl="WebUrl",i.ApplyAllSlicers="ApplyAllSlicers",i.ClearAllSlicers="ClearAllSlicers",i.Type=e.createEnumType([{value:i.Back,displayName:function(e){return e.get("Generic_Back")}},{value:i.Bookmark,displayName:function(e){return e.get("Generic_Bookmark")}},{value:i.Drillthrough,displayName:function(e){return e.get("Drillthrough")}},{value:i.PageNavigation,displayName:function(e){return e.get("PageNavigation")}},{value:i.Qna,displayName:function(e){return e.get("Generic_Qna")}},{value:i.WebUrl,displayName:function(e){return e.get("Web_Url")}},{value:i.ApplyAllSlicers,displayName:function(e){return e.get("ReportAppBar_ApplyAllSlicers")}},{value:i.ClearAllSlicers,displayName:function(e){return e.get("ReportAppBar_ClearAllSlicers")}}]),i.getType=function(e){return e.type||i.Back},i.BookmarkNone="",i.SectionNone="",(n=a=t.VisualDropShadow||(t.VisualDropShadow={})).CustomPreset="Custom",n.TopPreset="Top",n.TopLeftPreset="TopLeft",n.TopRightPreset="TopRight",n.CenterPreset="Center",n.CenterLeftPreset="CenterLeft",n.CenterRightPreset="CenterRight",n.BottomPreset="Bottom",n.BottomLeftPreset="BottomLeft",n.BottomRightPreset="BottomRight",n.OuterPosition="Outer",n.InnerPosition="Inner",n.Preset=e.createEnumType([{value:n.BottomRightPreset,displayName:function(e){return e.get("Visual_LabelPosition_BottomRight")}},{value:n.BottomPreset,displayName:function(e){return e.get("Bottom")}},{value:n.BottomLeftPreset,displayName:function(e){return e.get("Visual_LabelPosition_BottomLeft")}},{value:n.CenterRightPreset,displayName:function(e){return e.get("Visual_TextAlignment_Right")}},{value:n.CenterPreset,displayName:function(e){return e.get("Visual_TextAlignment_Center")}},{value:n.CenterLeftPreset,displayName:function(e){return e.get("Visual_TextAlignment_Left")}},{value:n.TopRightPreset,displayName:function(e){return e.get("Visual_LabelPosition_TopRight")}},{value:n.TopPreset,displayName:function(e){return e.get("Top")}},{value:n.TopLeftPreset,displayName:function(e){return e.get("Visual_LabelPosition_TopLeft")}},{value:n.CustomPreset,displayName:function(e){return e.get("Custom")}}]),n.Position=e.createEnumType([{value:n.OuterPosition,displayName:function(e){return e.get("Visual_DonutLabelPosition_Outside")}},{value:n.InnerPosition,displayName:function(e){return e.get("Visual_DonutLabelPosition_Inside")}}]),(o=n=t.VisualTitleHeading||(t.VisualTitleHeading={})).Normal="Normal",o.Heading2="Heading2",o.Heading3="Heading3",o.Heading4="Heading4",o.Heading5="Heading5",o.Heading6="Heading6",o.HeadingTypeAttribute=e.createEnumType([{value:o.Normal,displayName:function(e){return e.get("Normal")}},{value:o.Heading2,displayName:function(e){return e.get("Heading_2")}},{value:o.Heading3,displayName:function(e){return e.get("Heading_3")}},{value:o.Heading4,displayName:function(e){return e.get("Heading_4")}},{value:o.Heading5,displayName:function(e){return e.get("Heading_5")}},{value:o.Heading6,displayName:function(e){return e.get("Heading_6")}}]),o.DefaultHeadingAttribute=o.Heading3,(o=t.VisualHeaderTooltip||(t.VisualHeaderTooltip={})).NoSection="none",(e=t.VisualContainer||(t.VisualContainer={})).EmptyConfig={singleVisual:{visualType:"uninitializedVisual"}},jsCommon.FreezeUtility.deepFreeze(e.EmptyConfig),e.CommonObjectDescriptors={title:{displayName:l("Visual_Title"),description:l("Visual_TitleDescription"),properties:{show:{displayName:l("Visual_Show"),type:{bool:!0}},text:{displayName:l("Visual_Title_Text"),description:l("Visual_Title_TextDescription"),type:{text:!0},suppressFormatPainterCopy:!0},heading:{displayName:l("Visual_Title_Heading_Attribute"),description:l("Visual_Title_Heading_AttributeDescription"),type:{enumeration:n.HeadingTypeAttribute}},titleWrap:{displayName:l("Visual_Word_Wrap"),type:{bool:!0}},fontColor:{displayName:l("Visual_FontColor"),description:l("Visual_Title_FontColorDescription"),type:{fill:{solid:{color:!0}}}},background:{displayName:l("Background_Color"),description:l("Visual_Title_BackgroundColorDescription"),type:{fill:{solid:{color:{nullable:!0}}}}},alignment:{displayName:l("Visual_Title_Alignment"),description:l("Visual_Title_AlignmentDescription"),type:{formatting:{alignment:!0}}},fontSize:{displayName:l("Visual_TextSize"),description:l("Visual_Title_TextSizeDescription"),type:{formatting:{fontSize:!0}}},bold:{displayName:l("Bold"),type:{bool:!0}},italic:{displayName:l("Italic"),type:{bool:!0}},underline:{displayName:l("Underline"),type:{bool:!0}},fontFamily:{displayName:l("Visual_FontFamily"),type:{formatting:{fontFamily:!0}}}}},subTitle:{displayName:l("Visual_SubTitle"),description:l("Visual_SubTitle_Description"),properties:{show:{displayName:l("Visual_Show"),type:{bool:!0}},text:{displayName:l("Visual_Title_Text"),description:l("Visual_Title_TextDescription"),type:{text:!0},suppressFormatPainterCopy:!0},heading:{displayName:l("Visual_Title_Heading_Attribute"),description:l("Visual_Title_Heading_AttributeDescription"),type:{enumeration:n.HeadingTypeAttribute}},titleWrap:{displayName:l("Visual_Word_Wrap"),type:{bool:!0}},fontColor:{displayName:l("Visual_FontColor"),description:l("Visual_Title_FontColorDescription"),type:{fill:{solid:{color:!0}}}},alignment:{displayName:l("Visual_Title_Alignment"),description:l("Visual_Title_AlignmentDescription"),type:{formatting:{alignment:!0}}},fontSize:{displayName:l("Visual_TextSize"),description:l("Visual_Title_TextSizeDescription"),type:{formatting:{fontSize:!0}}},bold:{displayName:l("Bold"),type:{bool:!0}},italic:{displayName:l("Italic"),type:{bool:!0}},underline:{displayName:l("Underline"),type:{bool:!0}},fontFamily:{displayName:l("Visual_FontFamily"),type:{formatting:{fontFamily:!0}}}}},divider:{displayName:l("Visual_Divider"),properties:{show:{displayName:l("Visual_Show"),type:{bool:!0}},ignorePadding:{displayName:l("Visual_Divider_IgnorePadding"),type:{bool:!0}},color:{displayName:l("Generic_Color"),type:{fill:{solid:{color:!0}}}},style:{displayName:l("Style"),type:{enumeration:p.type}},width:{displayName:l("Visual_General_Properties_Width"),type:{numeric:!0}}}},spacing:{properties:{customizeSpacing:{displayName:l("Visual_Spacing_Customize"),type:{bool:!0}},verticalSpacing:{displayName:l("Visual_Spacing_Vertical"),type:{numeric:!0}},spaceBelowTitle:{displayName:l("Visual_Spacing_Below_Title"),type:{numeric:!0}},spaceBelowSubTitle:{displayName:l("Visual_Spacing_Below_SubTitle"),type:{numeric:!0}},spaceBelowTitleArea:{displayName:l("Visual_Spacing_Below_TitleArea"),type:{numeric:!0}}}},background:{displayName:l("Visual_Background"),properties:{show:{displayName:l("Visual_Show"),type:{bool:!0}},color:{displayName:l("Visual_Background_Color"),description:l("Visual_Background_ColorDescription"),type:{fill:{solid:{color:!0}}}},transparency:{displayName:l("Transparency"),description:l("Visual_Background_TransparencyDescription"),type:{numeric:!0}}}},padding:{displayName:l("Visual_Padding"),properties:{top:{displayName:l("Visual_PaddingTop"),type:{numeric:!0}},bottom:{displayName:l("Visual_PaddingBottom"),type:{numeric:!0}},left:{displayName:l("Visual_PaddingLeft"),type:{numeric:!0}},right:{displayName:l("Visual_PaddingRight"),type:{numeric:!0}}}},lockAspect:{displayName:l("Visual_BasicShape_LockAspect"),properties:{show:{displayName:l("Visual_Show"),type:{bool:!0}}}},general:{displayName:l("Visual_General_Properties"),properties:{x:{displayName:l("Visual_General_Properties_X_Coordinate"),type:{numeric:!0}},y:{displayName:l("Visual_General_Properties_Y_Coordinate"),type:{numeric:!0}},width:{displayName:l("Visual_General_Properties_Width"),type:{numeric:!0}},height:{displayName:l("Visual_General_Properties_Height"),type:{numeric:!0}},altText:{displayName:l("Visual_General_Properties_Description"),placeHolderText:l("Visual_General_Properties_Description_Placeholder"),type:{formatting:{altText:!0}}},allowBinnedLineSample:{displayName:l("Visual_General_HighDensitySampling"),type:{bool:!0}},allowOverlappingPointsSample:{displayName:l("Visual_General_HighDensitySampling"),type:{bool:!0}},keepLayerOrder:{displayName:l("Visual_General_KeepLayerOrder"),description:l("Visual_General_KeepLayerOrderDescription"),type:{bool:!0}}}},border:{displayName:l("Visual_Border"),properties:{show:{displayName:l("Visual_Show"),type:{bool:!0}},color:{displayName:l("Visual_Border_Color"),type:{fill:{solid:{color:!0}}}},radius:{displayName:l("Visual_Radius"),type:{numeric:!0}}}},dropShadow:{displayName:l("Visual_DropShadow"),properties:{show:{displayName:l("Visual_Show"),type:{bool:!0}},preset:{displayName:l("Visual_DropShadow_Preset"),type:{enumeration:a.Preset}},position:{displayName:l("Visual_DropShadow_Position"),type:{enumeration:a.Position}},color:{displayName:l("Generic_Color"),type:{fill:{solid:{color:!0}}}},transparency:{displayName:l("Transparency"),type:{numeric:!0}},shadowSpread:{displayName:l("Visual_BubbleSize"),type:{numeric:!0}},shadowBlur:{displayName:l("Visual_DropShadow_Blur"),type:{numeric:!0}},angle:{displayName:l("Visual_Angle"),type:{numeric:!0}},shadowDistance:{displayName:l("Distance"),type:{numeric:!0}}}},visualLink:{displayName:l("Visual_VisualLink"),suppressFormatPainterCopy:!0,properties:{show:{displayName:l("Visual_Show"),type:{bool:!0}},type:{displayName:l("Type"),description:l("Visual_VisualLink_Type_Description"),type:{enumeration:r.Type}},bookmark:{displayName:l("Generic_Bookmark"),description:l("Visual_VisualLink_Bookmark_Description"),type:{reference:{bookmark:!0}}},disabledTooltip:{displayName:l("Disabled_Tooltip"),type:{text:!0}},drillthroughSection:{displayName:l("Destination"),description:l("Visual_VisualLink_Destination_Description"),type:{reference:{section:!0}}},enabledTooltip:{displayName:l("Enabled_Tooltip"),type:{text:!0}},suppressDefaultTooltip:{displayName:l("Visual_SuppressDefaultTooltips"),type:{bool:!0}},showDefaultTooltip:{displayName:l("Visual_ShowTooltips"),type:{bool:!0}},navigationSection:{displayName:l("Destination"),description:l("Visual_VisualLink_Destination_Description"),type:{reference:{section:!0}}},tooltip:{displayName:l("Tooltip"),description:l("Visual_VisualLink_Tooltip_Description"),type:{text:!0}},tooltipPlaceholderText:{displayName:l("Tooltip_PlaceHolderText"),type:{text:!0}},webUrl:{displayName:l("Web_Url"),type:{misc:{webUrl:!0}}}}},visualTooltip:{displayName:l("Tooltip"),properties:{show:{displayName:l("Visual_Show"),type:{bool:!0}},type:{displayName:l("Type"),description:l("Visual_Tooltip_Type_Description"),type:{enumeration:t.VisualTooltip.Type}},section:{displayName:l("Page"),description:l("Visual_Tooltip_Section_Description"),type:{reference:{section:!0}}},titleFontColor:{displayName:l("Visual_Label_FontColor"),description:l("Visual_Tooltip_Title_FontColorDescription"),type:{fill:{solid:{color:!0}}}},valueFontColor:{displayName:l("Visual_Value_FontColor"),description:l("Visual_Tooltip_Value_FontColorDescription"),type:{fill:{solid:{color:!0}}}},fontSize:{displayName:l("Visual_TextSize"),description:l("Visual_Tooltip_TextSizeDescription"),type:{formatting:{fontSize:!0}}},bold:{displayName:l("Bold"),type:{bool:!0}},italic:{displayName:l("Italic"),type:{bool:!0}},underline:{displayName:l("Underline"),type:{bool:!0}},fontFamily:{displayName:l("Visual_FontFamily"),description:l("Visual_Tooltip_FontFamilyDescription"),type:{formatting:{fontFamily:!0}}},background:{displayName:l("Background_Color"),description:l("Visual_Tooltip_BackgroundColorDescription"),type:{fill:{solid:{color:{nullable:!0}}}}},transparency:{displayName:l("Transparency"),description:l("Visual_Tooltip_BackgroundTransparencyDescription"),type:{numeric:!0}},actionFontColor:{displayName:l("Visual_Action_FontColor"),description:l("Visual_Action_FontColor_FontColorDescription"),type:{fill:{solid:{color:!0}}}},themedTitleFontColor:{displayName:l("Visual_Label_FontColor"),description:l("Visual_Tooltip_Title_FontColorDescription"),type:{fill:{solid:{color:!0}}}},themedBackground:{displayName:l("Background_Color"),description:l("Visual_Tooltip_BackgroundColorDescription"),type:{fill:{solid:{color:{nullable:!0}}}}},themedValueFontColor:{displayName:l("Visual_Value_FontColor"),description:l("Visual_Tooltip_Value_FontColorDescription"),type:{fill:{solid:{color:!0}}}}}},stylePreset:{displayName:l("Visual_Table_StylePreset_SliceTitle"),properties:{name:{displayName:l("Visual_Table_StylePreset_SliceTitle"),type:{formatting:{stylePreset:!0}}}}},visualHeader:{displayName:l("Visual_Header"),description:l("VisualHeader_Toggle_Description"),properties:{show:{displayName:l("Visual_Show"),type:{bool:!0}},background:{displayName:l("Background_Color"),description:l("VisualHeader_Background_ColorDescription"),type:{fill:{solid:{color:!0}}}},border:{displayName:l("Visual_Border"),description:l("Visual_Border"),type:{fill:{solid:{color:!0}}}},transparency:{displayName:l("Transparency"),description:l("VisualHeader_Background_TransparencyDescription"),type:{numeric:!0}},foreground:{displayName:l("VisualHeader_Foreground_Color"),description:l("VisualHeader_Foreground_ColorDescription"),type:{fill:{solid:{color:!0}}}},showVisualInformationButton:{displayName:l("VisualHeader_ShowVisualInformationButton"),description:l("VisualHeader_ShowVisualInformationButton_Description"),type:{bool:!0}},showVisualWarningButton:{displayName:l("VisualHeader_ShowVisualWarningButton"),description:l("VisualHeader_ShowVisualWarningButton_Description"),type:{bool:!0}},showVisualErrorButton:{displayName:l("VisualHeader_ShowVisualErrorButton"),description:l("VisualHeader_ShowVisualErrorButton_Description"),type:{bool:!0}},showDrillRoleSelector:{displayName:l("VisualHeader_ShowDrillRoleSelector"),description:l("VisualHeader_ShowDrillRoleSelector_Description"),type:{bool:!0}},showDrillUpButton:{displayName:l("VisualHeader_ShowDrillUpButton"),description:l("VisualHeader_ShowDrillUpButton_Description"),type:{bool:!0}},showDrillToggleButton:{displayName:l("VisualHeader_ShowDrillToggleButton"),description:l("VisualHeader_ShowDrillToggleButton_Description"),type:{bool:!0}},showDrillDownLevelButton:{displayName:l("VisualHeader_ShowDrillDownLevelButton"),description:l("VisualHeader_ShowDrillDownLevelButton_Description"),type:{bool:!0}},showDrillDownExpandButton:{displayName:l("VisualHeader_ShowDrillDownExpandButton"),description:l("VisualHeader_ShowDrillDownExpandButton_Description"),type:{bool:!0}},showPinButton:{displayName:l("VisualHeader_ShowPinButton"),description:l("VisualHeader_ShowPinButton_Description"),type:{bool:!0}},showFilterRestatementButton:{displayName:l("VisualHeader_ShowFilterRestatementButton"),description:l("VisualHeader_ShowFilterRestatementButton_Description"),type:{bool:!0}},showFocusModeButton:{displayName:l("VisualHeader_ShowFocusModeButton"),description:l("VisualHeader_ShowFocusModeButton_Description"),type:{bool:!0}},showCopyVisualImageButton:{displayName:l("VisualHeader_ShowCopyVisualImageButton"),description:l("VisualHeader_ShowCopyVisualImageButton_Description"),type:{bool:!0}},showSeeDataLayoutToggleButton:{displayName:l("VisualHeader_ShowSeeDataLayoutToggleButton"),description:l("VisualHeader_ShowSeeDataLayoutToggleButton_Description"),type:{bool:!0}},showOptionsMenu:{displayName:l("VisualHeader_ShowOptionsMenu"),description:l("VisualHeader_ShowOptionsMenu_Description"),type:{bool:!0}},showCommentButton:{displayName:l("VisualHeader_ShowCommentButton"),description:l("VisualHeader_ShowCommentButton_Description"),type:{bool:!0}},showTooltipButton:{displayName:l("VisualHeader_ShowVisualHeaderTooltip"),description:l("VisualHeader_ShowVisualHeaderTooltip_Description"),type:{bool:!0}},showPersonalizeVisualButton:{displayName:l("VisualHeader_ShowPersonalizeVisualButton"),description:l("VisualHeader_ShowPersonalizeVisualButton_Description"),type:{bool:!0}},showSmartNarrativeButton:{displayName:l("SmartNarratives_ToolTip"),description:l("VisualHeader_ShowSmartNarrativeButton_Description"),type:{bool:!0}}}},visualHeaderTooltip:{displayName:l("VisualHeaderTooltip"),properties:{type:{displayName:l("Type"),type:{enumeration:o.Type}},section:{displayName:l("Page"),description:l("Visual_Tooltip_Section_Description"),type:{reference:{section:!0}}},text:{displayName:l("VisualHeaderTooltip_Text"),description:l("VisualHeaderTooltip_Text_Description"),type:{text:!0}},titleFontColor:{displayName:l("Generic_Color"),description:l("VisualHeaderTooltip_FontColorDescription"),type:{fill:{solid:{color:!0}}}},fontSize:{displayName:l("Visual_TextSize"),description:l("Visual_Tooltip_TextSizeDescription"),type:{formatting:{fontSize:!0}}},fontFamily:{displayName:l("Visual_FontFamily"),description:l("Visual_Tooltip_FontFamilyDescription"),type:{formatting:{fontFamily:!0}}},bold:{displayName:l("Bold"),type:{bool:!0}},italic:{displayName:l("Italic"),type:{bool:!0}},underline:{displayName:l("Underline"),type:{bool:!0}},background:{displayName:l("Background_Color"),description:l("Visual_Tooltip_BackgroundColorDescription"),type:{fill:{solid:{color:{nullable:!0}}}}},transparency:{displayName:l("Transparency"),description:l("Visual_Tooltip_BackgroundTransparencyDescription"),type:{numeric:!0}},themedTitleFontColor:{displayName:l("Generic_Color"),description:l("VisualHeaderTooltip_FontColorDescription"),type:{fill:{solid:{color:!0}}}},themedBackground:{displayName:l("Background_Color"),description:l("Visual_Tooltip_BackgroundColorDescription"),type:{fill:{solid:{color:{nullable:!0}}}}}}}},e.ObjectProps=s.getPropertyIdentifiers(e.CommonObjectDescriptors),e.clone=function(e,t){if(e)return e=t.serializeVisualContainer(e),t.deserializeCanvasItem(e,!0)},e.isHidden=function(e){return!!e.display&&"hidden"===e.display.mode},e.setHidden=function(e,t){e.display=t?{mode:"hidden"}:void 0},(t.PinData||(t.PinData={})).getVisualType=function(e){if(e.visualContainer)return e.visualContainer.config.singleVisual.visualType}})(powerbi=powerbi||{}),(function(e){((e=(e=e.explore||(e.explore={})).contracts||(e.contracts={})).VisualRelationshipFilterActionUtil||(e.VisualRelationshipFilterActionUtil={})).toString=function(e){switch(e){case 0:return"Default";case 1:return"DataFilter";case 2:return"HighlightFilter";case 3:return"NoFilter"}}})(powerbi=powerbi||{}),(function(e){var t,p,C,m,r,c,a,i,x,v;function l(e,t,r){for(var i in this.defn=e,this.projections=t,this.expansionStates=r||[],t)_.isEmpty(t[i].activeProjectionRefs)||this.ensureActiveItems(i)}t=(t=e.explore||(e.explore={})).contracts||(t.contracts={}),p=jsCommon.ArrayExtensions,C=e.data.ExpansionState,m=e.data.transforms.plugins,r=e.data.ProjectionUtils,c=e.data.QueryProjectionCollection,a=e.data.QueryProjectionsByRole,i=e.data.SemanticQuery,x=e.data.SQExpr,v=e.data.SQExprBuilder,l.prototype.ensureExpansionState=function(e,t){var r,i=C.findExpansionState(this.expansionStates,e);return i||(i=new C(e,t),r=this.getRolesUniqueProjectionRefs(e),e=this.getRolesUniqueActiveProjectionsRefs(e,t.canCollapseRoot),i.updateLevels(r,e.length),this.expansionStates.push(i)),i},l.prototype.add=function(e,t,r){var i=(r=r||{}).exprName,a=r.fieldIndex,n=r.parameter,o=r.indexInParameter,s=r.nativeReferenceName,r=r.isHidden,l=!!(p=this.defn.selectNameOf(e)),p=p||this.addSelect(e,i,s),e=(this.getRoleProjections(t)||(this.projections[t]=new c([])),{queryRef:p}),u=(r&&(e.hidden=r),0),i=this.projections[t];return n?(r=null!=o?o:null!=(s=n.length)?s:0,i.addProjection(e,{parameter:n,indexInParameter:r}),u=i.getParameterProjectionIndex(n,r),this.addNewQueryRefToActiveProjectionRefsIfNeeded(t,p,u)):(o=i.all(),null==a||a>o.length?(i.addProjection(e),u=o.length-1):(i.addProjection(e,{fieldIndex:a}),u=i.getColumnProjectionIndex(a),this.addNewQueryRefToActiveProjectionRefsIfNeeded(t,p,u))),this.updateExpansionStates(t,(function(e,t){return e.addLevel(p,t+u)})),l&&this.resetHiddenState(p),u},l.prototype.toggleHidden=function(e){for(var t in this.projections)this.projections[t].toggleHidden(e)},l.prototype.addParameter=function(e,t,r){this.getRoleProjections(t)||(this.projections[t]=new c([]));t=this.projections[t],e={expr:e,index:r=null==r?t.getFieldCount():r,length:void 0};return t.addFieldParameter(e),r},l.prototype.removeParameterBySQExpr=function(e){var t,r=this.projections;for(t in r){var i=r[t],a=i.findParameterBySQExpr(e);_.isEmpty(a)||i.removeFieldParameters(a)}},l.prototype.removeParameter=function(e){var t,r=!1;for(t in this.projections)r=this.removeParameterByRoleName(e,t)||r;return r},l.prototype.removeParameterByRoleName=function(e,t){t=this.projections[t];return null==t?void 0:t.removeFieldParameters([e])},l.prototype.getParameterByFieldIndex=function(e,t){t=this.projections[t];return null==t?void 0:t.getParameterByFieldIndex(e)},l.prototype.getResolveParameterResultsByRole=function(){var t=this,e={},r=this.projections;if(r)for(var i in r){var a=this.getQueryFieldParametersByRole(i);if(!_.isEmpty(a))for(var n=e[i]=[],o=0,s=a;o<s.length;o++){var l=s[o],p=r[i].getParameterProjections(l).map((function(e){return{expr:t.defn.select().withName(e.queryRef).expr,alias:void 0}}));n.push({parameter:l,result:p})}}return e},l.prototype.removeExpr=function(e,t,r,i){if(t){for(var a=this.defn.select(),n=!1,o=a.length-1;0<=o;--o){var s=a[o].expr;if(l.areEqualIgnoringAggregate(s,e,r)){if(!this.removeAllProjectionsForExpr(s,i))return!1;n=!0}}return n}return this.removeAllProjectionsForExpr(e,i)},l.prototype.getQueryRefByProjectionIndex=function(e,t){e=this.projections[e];if(e){e=e.getQueryRefs();if(t<e.length)return e[t]}},l.prototype.getQueryRef=function(e,t){var r=t.fieldIndex,i=t.parameter,t=t.indexInParameter,e=a.getRole(this.projections,e);if(e)return i?e.getParameterProjections(i)[t].queryRef:r>=e.getFieldCount()?void 0:e.getColumnProjection(r).queryRef},l.prototype.removeProjection=function(e,t){this.projections[e];var r,i,a,n,o,s=t.fieldIndex,l=t.parameter,p=t.indexInParameter,t=this.getQueryRef(e,t);return!!t&&!!(r=this.defn.select().withName(t))&&(r=r.expr,a=(i=this.projections[e]).all(),o=l?(n={parameter:l,indexInParameter:p},i.getParameterProjectionIndex(l,p)):(n={fieldIndex:s},i.getColumnProjectionIndex(s)),i.removeProjection(n),l=this.projections[e].activeProjectionRefs,_.pull(l,t),(p=_.isEmpty(a))&&_.isEmpty(i.getFieldParameters())?delete this.projections[e]:!p&&l&&0===l.length&&l.push(a[Math.max(0,o-1)].queryRef),this.updateExpansionStates(e,(function(e,t){return e.removeLevel(t+o)})),this.isUsed(t)||this.removeExpr(r,!1),!0)},l.prototype.moveProjection=function(e,t,r,i){if(t===r)return!1;if(t<0||r<0)return!1;var a,n=this.projections[e],o=(n&&(a=n.all()),n.convertFieldIndexToProjectionIndex(r)),s=n.convertFieldIndexToProjectionIndex(t),l=n.convertFieldIndexToProjectionIndex(r+i);if(!a||l>a.length)return!1;var p=this.projections[e].activeProjectionRefs,u=n.moveFields(t,r,i);if(p)if((t<r?l:o)<p.length){t=_.take(a,n.convertFieldIndexToProjectionIndex(r+1));this.projections[e].activeProjectionRefs=_.map(t,(function(e){return e.queryRef}))}else if(s<p.length){for(var c=0,d=u;c<d.length;c++){var m=d[c];_.pull(p,m.queryRef)}0===p.length&&p.push(a[0].queryRef)}return this.updateExpansionStates(e,(function(e,t){return e.moveLevels(t+s,t+o,i)})),!0},l.prototype.setAggregate=function(e,t,r,i){return this.updateExpression(e,t,(function(e){return v.setAggregate(e,r)}),i)},l.prototype.removeAggregate=function(e,t,r,i){return this.updateExpression(e,t,(function(e){return v.removeAggregate(e,r)}),i)},l.prototype.setPercentOfGrandTotal=function(e,t,r){return this.updateExpression(e,t,(function(e){return v.setPercentOfGrandTotal(e)}),r)},l.prototype.removePercentOfGrandTotal=function(e,t,r){return this.updateExpression(e,t,(function(e){return v.removePercentOfGrandTotal(e)}),r)},l.prototype.setPercentOfRoleTotal=function(t,e,r){return this.updateExpression(e,r,(function(e){return v.setPercentOfRoleTotal(e,t)}))},l.prototype.removePercentOfRoleTotal=function(e,t){return this.updateExpression(e,t,(function(e){return v.removePercentOfRoleTotal(e)}))},l.prototype.updateVisualCalculation=function(e,t,r,i){var a=this.getQueryRef(t,{fieldIndex:e}),a=this.defn.select().withName(a);return!(!a||!x.isNativeVisualCalc(a.expr)||!this.updateExpression(t,e,(function(e){return v.setVisualCalcExpression(e,i,r)}))||!(a=this.getRoleProjections(t))||!(a=null==(t=a[e])?void 0:t.queryRef)||(e=p.indexWithName(this.defn.select(),a))<0||(this.setNativeReferenceNameAt(e,r),0))},l.prototype.orderBy=function(e){this.defn,this.defn=this.defn.orderBy(e)},l.prototype.removeOrderBy=function(e){this.defn,this.defn=this.defn.removeOrderBy(e)},l.prototype.removeUnusedOrderBy=function(){this.defn;for(var e=this.defn,t=0,r=e.orderBy();t<r.length;t++){var i=r[t].expr;e.selectNameOf(i)||(this.defn=e.removeOrderBy(i))}},l.prototype.addTransform=function(e,t,r){this.defn;for(var i={},a=this.defn.transforms(),n=0,o=a;n<o.length;n++)i[o[n].name]=!0;for(var s=jsCommon.StringExtensions.findUniqueName(i,e.name),t={algorithm:e.name,name:s,input:{parameters:t},output:void 0},l=(this.defn=this.defn.transforms(a.concat([t])),e.name===m.KMeansClustering.name&&r.grouping&&r.grouping.cluster),p=0,u=e.outputRoles;p<u.length;p++){var c=u[p],d=c.name;l&&(d=r.grouping.cluster.clusteringRole),this.add(v.transformOutputRoleRef(c.algorithmRole),d,{exprName:c.columnName||c.algorithmRole})}return s},l.prototype.removeTransform=function(e,t){this.defn;var r=_.find(this.defn.transforms(),(function(e){return e.name===t}));if(r){for(var i=0,a=e.outputRoles;i<a.length;i++){var n=a[i];this.removeExpr(v.transformOutputRoleRef(n.algorithmRole),!1)}this.defn=this.defn.removeTransform(r)}},l.prototype.updateTransform=function(t,e){this.defn;var r=_.find(this.defn.transforms(),(function(e){return e.name===t}));r&&(r.input.parameters=e)},l.prototype.clone=function(){return new l(this.defn,a.clone(this.projections),C.clone(this.expansionStates))},l.prototype.equals=function(e){return!!i.equals(this.defn,e.defn)&&_.isEqual(this.projections,e.projections)&&_.isEqual(this.expansionStates,e.expansionStates)},l.prototype.ensureDrillableRoles=function(e){for(var t=[],r=0,i=e;r<i.length;r++){var a=i[r];this.ensureActiveItems(a)&&t.push(a)}return t},l.prototype.ensureActiveItems=function(e){var t,e=this.projections[e];if(e)return t=e.all(),!_.isEmpty(t)&&_.isEmpty(e.activeProjectionRefs)?(e.activeProjectionRefs=[t[0].queryRef],!0):void 0},l.prototype.toggleShowAll=function(e){e=this.projections[e];e&&(e.showAll=!e.showAll)},l.prototype.hasShowAll=function(){return!_.isEmpty(this.projections)&&_.some(this.projections,(function(e){return e.showAll}))},l.prototype.roleContainsExpr=function(e,t){var e=this.projections[e],r=e&&e.all();if(!_.isEmpty(r))for(var i=0,a=this.defn.select();i<a.length;i++)for(var n=a[i],o=0,s=r;o<s.length;o++)if(s[o].queryRef===n.name&&x.equals(t,n.expr))return!0;return!1},l.prototype.getRoleNameForExpr=function(e){var t,r=this.projections;for(t in r){var i=this.tryGetExprs(t);if(i&&0<i.length)for(var a=0,n=i;a<n.length;a++){var o=n[a];if(x.equals(e,o))return t}i=r[t].getFieldParameters();if(!_.isEmpty(i))for(var s=0,l=i;s<l.length;s++){var p=l[s];if(x.equals(p.expr,e))return t}}},l.prototype.tryGetExpr=function(e,t){var e=this.getRoleProjections(e);if(e)return e=e[t],null==(t=r.tryGetExprByProjection(this.defn,e))?void 0:t.expr},l.prototype.tryGetExprs=function(e){e=r.tryGetExprs(this.defn,this.projections,e);if(void 0!==e)return _.map(e,(function(e){return e.expr}))},l.prototype.tryGetFieldExprs=function(e){return r.tryGetFieldExprs(this.defn,this.projections,e)},l.prototype.getUniqueQueryRefs=function(){var e=_.values(this.projections);return _.chain(e).map((function(e){return e.getQueryRefs()})).flatten(!0).uniq().value()},l.prototype.getUniqueQueryFields=function(){var t=this,e=_.keys(this.projections);return _.chain(e).map((function(e){return t.tryGetFieldExprs(e)})).flatten(!0).uniqWith(l.isEqualQueryFields).value()},l.prototype.hasProjections=function(){return _.values(this.projections).some((function(e){return 0<e.all().length}))},l.prototype.currentDrillMode=function(e){var t=this.getRoleProjections(e);if(!_.isEmpty(t)){e=this.projections[e];if(e){e=e.activeProjectionRefs;if(!_.isEmpty(e))return 1<e.length?2:e[0]!==t[0].queryRef?3:void 0}}},l.prototype.addSelect=function(e,t,r){var i=this.defn,e=(this.defn=i=i.addSelect(e,t,r),i.select()),t=e.length-1;return e[t].name},l.isEqualQueryFields=function(e,t){return e.isFieldParameter||t.isFieldParameter||void 0===e.queryName||void 0===t.queryName?e.isFieldParameter===t.isFieldParameter&&x.equals(e.expr,t.expr):e.queryName===t.queryName},l.prototype.updateExpansionStates=function(t,e){var r,i;!_.isEmpty(this.expansionStates)&&(_.remove(this.expansionStates,(function(e){return!e.supportsMerge})),r=C.findExpansionStateForRole(this.expansionStates,t))&&(_.isEmpty(this.projections[t])||_.isEmpty(this.projections[t].all())?_.remove(this.expansionStates,(function(e){return e===r})):(i=_.takeWhile(r.roles,(function(e){return e!==t})),i=this.getRolesUniqueActiveProjectionsRefs(i,r.canCollapseRoot).length,e(r,i),e=r.getVisibleDescendentsDepth(r.root,-1),this.setActiveProjections(r.roles,e)))},l.prototype.resetHiddenState=function(e){for(var t in this.projections)this.projections[t].resetHiddenState(e)},l.prototype.removeAllProjectionsForExpr=function(e,v){var y,t=this.defn,h=t.selectNameOf(e);if(!h)return!1;_.remove(this.expansionStates,(function(e){return!e.supportsMerge}));var r,g=this.projections,f=this;for(r in g)!(function(t){var e=C.findExpansionStateForRole(f.expansionStates,t),r=g[t],i=r.all(),a=e&&_.takeWhile(e.roles,(function(e){return e!==t})),n=a&&f.getRolesUniqueActiveProjectionsRefs(a,e&&e.canCollapseRoot).length;if(v)for(var a=f.getQueryFieldParametersByRole(t),o=0,s=_.filter(a,(function(e){return x.equals(e.expr,v)}));o<s.length;o++)for(var l=s[o],p=l.length-1;0<=p;p--){var u={indexInParameter:p,parameter:l},c=r.getParameterProjectionIndex(l,p);(null==(y=i[c])?void 0:y.queryRef)===h&&(r.removeProjection(u),f.updateActiveProjectionRefAndExpansionState(t,h,n,c))}else for(c=i.length-1;0<=c;c--){var d=r.convertProjectionIndexToFieldIndex(c),m=r.getColumnProjection(d);(null==m?void 0:m.queryRef)===h&&(r.removeProjection(u={fieldIndex:d}),f.updateActiveProjectionRefAndExpansionState(t,h,n,c))}0!==i.length&&e&&(a=e.getVisibleDescendentsDepth(e.root,-1),f.setActiveProjections(e.roles,a))})(r);return this.isUsed(h)||(this.defn=t.removeSelect(e).removeOrderBy(e)),!0},l.prototype.updateActiveProjectionRefAndExpansionState=function(e,t,r,i){var a=this.projections[e],n=a.all(),e=C.findExpansionStateForRole(this.expansionStates,e),a=a.activeProjectionRefs;_.pull(a,t),a&&_.isEmpty(a)&&!_.isEmpty(n)&&a.push(n[Math.max(0,i-1)].queryRef),e&&e.removeLevel(r+i)},l.prototype.updateExpression=function(e,t,r,i){var a,n,o,s,l,e=this.projections[e];return!(!(n=e?e.all():n)||t>=n.length||(a=this.defn,n=n[t].queryRef,s=r(o=(r=a.select())[r=p.indexWithName(r,n)].expr),(l=a.selectNameOf(s))?(e.updateQueryRef(t,l),this.isUsed(n)||(this.defn=a.removeSelect(o))):1<this.getUsageCount(n)?e.updateQueryRef(t,this.addSelect(s,void 0,i)):this.defn=a.setSelectAt(r,s,i),0))},l.prototype.isUsed=function(e){return 0<this.getUsageCount(e)},l.prototype.getUsageCount=function(t){var e,r=0,i=this.projections;for(e in i){var a=i[e].all();r+=_.filter(a,(function(e){return e.queryRef===t})).length}return r},l.prototype.getRoleProjections=function(e){e=a.getRole(this.projections,e);if(e)return e.all()},l.prototype.addNewQueryRefToActiveProjectionRefsIfNeeded=function(e,t,r){var i=this.getRoleProjections(e),e=this.projections[e].activeProjectionRefs;e&&(1<e.length&&r<e.length?e.splice(r,0,t):1===e.length&&0===r&&1<i.length&&i[1].queryRef===e[0]&&e.splice(0,1,t))},l.prototype.getRolesProjectionRefs=function(e){for(var t=[],r=0,i=e;r<i.length;r++){var a=i[r],a=this.projections[a];a&&(a=_.map(a.all(),(function(e){return e.queryRef})),t.push.apply(t,a||[]))}return t},l.prototype.getRolesUniqueProjectionRefs=function(e){return _.uniq(this.getRolesProjectionRefs(e))},l.prototype.getQueryFieldParametersByRole=function(e){if(!_.isEmpty(this.projections))return(e=this.projections[e])?e.getFieldParameters():[]},l.prototype.getParameterProjectionExprs=function(e){var t,r=this,i=[],a=this.projections;for(t in a)for(var n=a[t],o=0,s=n.findParameterBySQExpr(e);o<s.length;o++){var l=s[o],p=n.getParameterProjections(l).map((function(e){return r.defn.select().withName(e.queryRef).expr}));i.push({exprs:p,parameter:l})}return i},l.prototype.getQueryFieldParameters=function(){if(_.isEmpty(this.projections))return[];var e,t=[];for(e in this.projections){var r=this.projections[e];r&&t.push.apply(t,r.getFieldParameters())}return t},l.prototype.hasQueryFieldParameters=function(){return!_.isEmpty(this.getQueryFieldParameters())},l.prototype.hasVisualCalcExpressions=function(){return this.defn.select().some((function(e){return x.isNativeVisualCalc(e.expr)}))},l.prototype.resetExpansionStates=function(){this.expansionStates=[]},l.prototype.getRolesActiveProjectionsRefs=function(e,t){for(var r=this,i=[],a=t||_.some(e,(function(e){return r.projections[e]&&!_.isEmpty(r.projections[e].activeProjectionRefs)})),n=0,o=e;n<o.length;n++){var s=o[n],s=this.projections[s],l=s&&s.all(),s=l&&(s.activeProjectionRefs||!a&&_.map(l,(function(e){return e.queryRef})));if(s&&(i.push.apply(i,s||[]),l.length!==s.length&&_.uniqBy(l,(function(e){return e.queryRef})).length!==_.uniq(s).length))break}return i},l.prototype.getRolesUniqueActiveProjectionsRefs=function(e,t){return _.uniq(this.getRolesActiveProjectionsRefs(e,t))},l.areEqualIgnoringAggregate=function(e,t,r){return x.equals(v.removeAggregate(e,r),v.removeAggregate(t,r))},l.prototype.setActiveProjections=function(e,t){var r=this.projections,i=C.findExpansionState(this.expansionStates,e);i&&i.pinLevels(t);for(var a=0,n=e;a<n.length;a++){var o,s,l=n[a];0<t?(o=r[l]&&r[l].all(),s=void 0,s=(o=_.uniqBy(o,(function(e){return e.queryRef}))).length<=t?o:_.take(o,t),r[l].activeProjectionRefs=_.map(s,(function(e){return e.queryRef})),t-=s.length):r[l]&&(r[l].activeProjectionRefs=[])}},l.prototype.setNativeReferenceNameAt=function(e,t){this.defn.setNativeReferencNameAt(e,t)},l.prototype.setNativeReferenceNameByRoleAndProjectionIndex=function(e,t,r){e=this.getQueryRefByProjectionIndex(e,t);null!=e&&(t=this.defn.select(),t=p.indexWithName(t,e),this.setNativeReferenceNameAt(t,r))},l.prototype.areAllProjectionsHidden=function(){for(var e in this.projections){e=this.getRoleProjections(e);if(_.some(e,(function(e){return!e.hidden})))return!1}return!0},t.VisualQuery=l})(powerbi=powerbi||{}),(function(e){((e=(e=e.explore||(e.explore={})).services||(e.services={})).upgrade||(e.upgrade={})).CurrentExplorationVersion="5.45"})(powerbi=powerbi||{}),(function(e){var t;e=(e=e.explore||(e.explore={})).services||(e.services={}),(t=e.upgrade||(e.upgrade={})).CurrentExplorationStateVersion="1.21",t.setCurrentExplorationStateVersion=function(e){t.CurrentExplorationStateVersion=e}})(powerbi=powerbi||{}),(function(e){var t,n,i;function r(e,t){return e.modelExtensions&&e.modelExtensions.withName(t)}function a(e,t){e=r(e,t);if(e)return e;throw new Error("Unable to find expected model extension: "+t)}function o(e,t,r){e.modelExtensions||(e.modelExtensions=n.createWithName());var i=e.modelExtensions.withName(t);return i||(i=s(t,r),e.modelExtensions.push(i)),i}function s(e,t){return{name:e,extends:t,entities:n.createWithName()}}function l(e,t){return e.entities.withName(t)}function p(e,t,r){e=l(a(e,t),r);if(e)return e;throw new Error("Unable to find expected entity: "+r)}function u(e,t){e.entities||(e.entities=n.createWithName());var r=e.entities.withName(t);return r||(r={name:t,extends:t,measures:n.createWithName()},e.entities.push(r)),r}function c(e,t){return e.measures.withName(t)}function d(e,t){e=c(e,t);if(e)return e;throw new Error("Unable to find expected measure:"+t)}function m(t){var e=Object.keys(t),e=_.chain(e).filter((function(e){return"name"!==e&&"extends"!==e})).filter((function(e){return!(_.isArray(t[e])&&_.isEmpty(t[e]))})).value();return _.some(e)}t=(t=e.explore||(e.explore={})).util||(t.util={}),n=jsCommon.ArrayExtensions,i=e.data.dsr,(t=t.ModelExtensionUtils||(t.ModelExtensionUtils={})).getOptionalModelExtension=r,t.getExpectedModelExtension=a,t.getOrCreateModelExtension=o,t.createModelExtension=s,t.ensureEntityExists=function(e,t,r){return u(o(e,t,i.DefaultSchemaName),r)},t.findEntity=l,t.getExpectedEntity=p,t.getOrCreateExtendingEntity=u,t.addMeasure=function(e,t){if(e.measures||(e.measures=n.createWithName()),e.measures.withName(t.name))throw new Error("Measure ".concat(t.name," already exists and cannot be added"));e.measures.push(t)},t.getExpectedMeasure=function(e,t,r,i){return d(p(e,t,r),i)},t.findMeasureFromEntity=c,t.removeMeasure=function(e,t,r,i){var i=d(r=p(e,t,r),i),i=r.measures.indexOf(i);r.measures.splice(i,1),0===r.measures.length&&(delete r.measures,i=e,e=t,m(t=r)||(e=a(i,e),t=e.entities.indexOf(t),e.entities.splice(t,1),0!==e.entities.length)||(delete e.entities,r=i,m(t=e))||(t=r.modelExtensions.indexOf(t),r.modelExtensions.splice(t,1),0===r.modelExtensions.length&&delete r.modelExtensions))},t.setAnnotation=function(e,t,r){var i,a;null==r?(i=t,(i=(a=e).annotations&&a.annotations.withName(i))&&(i=a.annotations.indexOf(i),a.annotations.splice(i,1),a.annotations)&&0===a.annotations.length&&delete a.annotations):(i=t,a=r,(t=e).annotations||(t.annotations=n.createWithName()),(r=t.annotations.withName(i))?r.value=a:(r={name:i,value:a},t.annotations.push(r)))},t.getAnnotationValue=function(e,t){if(e=e.annotations&&e.annotations.withName(t))return e.value},t.toQueryExtensionSchema=function(e){var t;if(e)return t={Version:0,Name:e.name,Extends:e.extends},e.entities&&(t.Entities=_.map(e.entities,(function(e){var t={Extends:e.extends,Name:e.name};return e.measures&&(t.Measures=_.map(e.measures,(function(e){var t=e.dataType;return 6!==t&&9!==t||(t=7),{Name:e.name,Expression:e.expression,DataType:t}}))),t}))),t}})(powerbi=powerbi||{}),(function(e){var o;function t(e){this.modelExtension=e,this.visited={}}e=e.explore||(e.explore={}),o=e.util||(e.util={}),t.prototype.visitReference=function(e){if(e.schema===this.modelExtension.name){var t=o.ModelExtensionUtils.findEntity(this.modelExtension,e.entity);if(t){var r=o.ModelExtensionUtils.findMeasureFromEntity(t,e.name);if(r){e=this.toVisitedKey(e);if(!this.visited[e]){this.visitMeasure(this.modelExtension,t,r),this.visited[e]=!0;for(var i=0,a=r.references.measures;i<a.length;i++){var n=a[i];this.visitReference(n)}}}}}},t.prototype.visitMeasure=function(e,t,r){},t.prototype.toVisitedKey=function(e){return JSON.stringify(e)},o.ModelExtensionDependencyVisitor=t})(powerbi=powerbi||{}),(function(e){var t,s;function i(e){var t=e.resourcePackages;return t||(e.resourcePackages=t=[]),t}t=(t=e.explore||(e.explore={})).util||(t.util={}),s=e.visualHost.utils.ResourcePackageUtils,(t=t.ResourcePackageUtils||(t.ResourcePackageUtils={})).newSharedResourceItem=function(e,t,r){return s.newSharedResourceItem(e,t,r)},t.ensureResourcePackageType=function(e,t,r){return e=i(e),s.ensureResourcePackage(e,t,r)},t.ensurePublicCustomVisuals=function(e){var t=e.publicCustomVisuals;return t||(e.publicCustomVisuals=t=[]),t},t.ensureResourcePackages=i,t.synchronizePackageIds=function(o,e){if(!_.isEmpty(e)&&!_.isEmpty(o))for(var t=function(e){var t,r=s.findResourcePackage(o,e.type,e.name);if(r){r.id,e.id=r.id;for(var i=0,a=e.items;i<a.length;i++){var n=a[i];n=n,t=void 0,(t=s.findItemInPackage(r,n.name))&&(t.id,n.id=t.id)}}},r=0,i=e;r<i.length;r++)t(i[r])}})(powerbi=powerbi||{}),(function(e){var i;e=e.explore||(e.explore={}),(i=e.dataReaderPlugins||(e.dataReaderPlugins={})).ExplorationDataReaderType="exploration",i.registerExplorationDataReaderExtension=function(e,t,r){e[i.ExplorationDataReaderType]={name:"exploration",extends:"dsr",queryExtensionProvider:i.createExplorationQueryExtensionProvider(),schemaReader:function(){return i.createConceptualSchemaReader(t,r)}}},i.getExplorationDataReaderDataSource=function(e){if(e=_.find(e,(function(e){return"exploration"===e.type})))return e.exploration}})(powerbi=powerbi||{}),(function(e){var t,s,r,i,a,n,o,l;function p(o){return function(e,t,r){var i,a,n={query:e,extensions:void 0,queryRewrites:t};return 1!==o.length||(a=(i=o[0]).getModelExtensions(),_.isEmpty(a))?r?r(e,t):n:(n=s.toQueryExtensionSchema(l.build(e,a.withName(i.schemaName))),r?r(e,t,n):{query:e,queryRewrites:t,extensions:n})}}function u(e){var t=a.call(this)||this;return t.dependencyVisitor=e,t}function c(e){return o.call(this,e)||this}t=(t=e.explore||(e.explore={})).dataReaderPlugins||(t.dataReaderPlugins={}),s=e.explore.util.ModelExtensionUtils,r=e.explore.util.ModelExtensionDependencyVisitor,i=e.data.SQExpr,e=e.data.SQExprRewriter,t.createExplorationQueryExtensionProvider=function(){return p},__extends(u,a=e),u.prototype.visitMeasureRef=function(e){return i.isEntity(e.source)&&this.dependencyVisitor.visitReference({schema:e.source.schema,entity:e.source.entity,name:e.ref}),e},n=u,__extends(c,o=r),c.build=function(e,t){t=new c(t);return e.rewrite(new n(t)),t.result},c.prototype.visitMeasure=function(e,t,r){this.result=this.result||s.createModelExtension(e.name,e.extends);e=s.getOrCreateExtendingEntity(this.result,t.name);s.findMeasureFromEntity(e,r.name)||s.addMeasure(e,r)},l=c})(powerbi=powerbi||{}),(function(g){var e,f,a;function C(e,t,r){var i=new a;return i.name=e,i.extends=t,i.capabilities={canEdit:r,discourageQueryAggregateUsage:!1,isExtendable:!1,isQnaEnabled:!1,normalizedFiveStateKpiRange:!1,supportsMedian:!1,supportsPercentile:!1,supportsScopedEval:!1,supportsStringMinMax:!1,supportsMultiTableTupleFilters:!1,supportsTimeIntelligenceQuickMeasures:!1,supportsCalculatedColumns:!1,supportsGrouping:!1,limitMultiColumnFiltersToQueryGroupColumns:!1,supportsBinnedLineSample:!1,supportsOverlappingPointsSample:!1,supportsQna:!1,insights:{},supportsFastRefresh:!1,supportsSubqueryRegrouping:!1,supportsTopNPerLevel:!1,supportsExtensionColumns:!1,canEditChangeDetectionMeasure:!1,supportsGroupSynchronization:!1,supportsScopedDataReduction:!1,transformCapabilities:{supportedTransforms:[]},supportChangeDetectionMeasureRefresh:!1,supportsSparklineData:!1,supportsVisualCalculations:!1},i.entities=f.createWithName(),i}e=(e=g.explore||(g.explore={})).dataReaderPlugins||(e.dataReaderPlugins={}),f=jsCommon.ArrayExtensions,a=g.data.ConceptualSchema,(e=e.ExplorationConceptualSchemaFactory||(e.ExplorationConceptualSchemaFactory={})).createExtensionSchema=C,e.convertModelExtension=function(e,t){var r=C(e.name,e.extends,t);if(e.entities)for(var i=0,a=e.entities;i<a.length;i++){var n=a[i],o={name:n.name,extends:n.extends,displayName:n.name,properties:f.createWithName(),hierarchies:f.createWithName(),displayFolders:f.createWithName(),capabilities:{canRefresh:!1,canHaveMeasures:!1,canEditSource:!1,canRename:!1,canDelete:!1,canEditStorageMode:!1,supportsClustering:!1,supportsBinByCount:!1,limitOnNumberOfGroups:null,dataView:null},source:{}};if(r.entities.push(o),n.measures)for(var s=0,l=n.measures;s<l.length;s++){var p=l[s],u={name:p.name,displayName:p.name,type:g.ValueType.fromPrimitiveTypeAndCategory(p.dataType,p.dataCategory),kind:1,hidden:p.hidden,errorMessage:p.errorMessage,queryable:p.errorMessage?1:0,format:p.formatInformation&&p.formatInformation.formatString,measure:{},canDelete:r.capabilities.canEdit,description:p.description},c=(h=y=v=m=d=c=void 0,p),d=o,m=u;if(c.displayFolder)for(var c=c.displayFolder.split(";"),v=0,y=c;v<y.length;v++){var h=y[v].split("\\");!(function e(t,r,i,a){var n;i.withName(t)?n=i.withName(t):(n={displayName:t,name:t,properties:f.createWithName(),displayFolders:f.createWithName(),hierarchies:f.createWithName()},i.push(n));Array.isArray(r)&&r.length?e(r.shift(),r,n.displayFolders,a):n.properties.push(a)})(h.shift(),h,d.displayFolders,m)}p.measureTemplate&&(u.measure.template={name:p.measureTemplate.daxTemplateName}),o.properties.push(u)}}return r}})(powerbi=powerbi||{}),(function(e){var t,o,n,r;function i(e,t){this.promiseFactory=e,this.canEditSchemas=t}t=e.explore||(e.explore={}),o=t.dataReaderPlugins||(t.dataReaderPlugins={}),n=e.data.FederatedConceptualSchema,o.createConceptualSchemaReader=function(e,t){return new r(e,t=void 0===t?!1:t)},i.prototype.execute=function(e){e=e.dataSources;if(!e||1<e.length)return this.promiseFactory.reject(null);var e=e[0],t=e.exploration;if(!t)return this.promiseFactory.reject(null);var r=[],t=t.getModelExtensions();if(_.isEmpty(t))r.push(o.ExplorationConceptualSchemaFactory.createExtensionSchema(e.name,e.extends,this.canEditSchemas));else for(var i=0,a=t;i<a.length;i++){var n=a[i];r.push(o.ExplorationConceptualSchemaFactory.convertModelExtension(n,this.canEditSchemas))}return this.promiseFactory.resolve({data:{extensionSchemas:r}})},i.prototype.transform=function(e){for(var t={schemas:{}},r=0,i=e.data.extensionSchemas;r<i.length;r++){var a=i[r];t.schemas[a.name]=a}return{schema:new n(t)}},r=i})(powerbi=powerbi||{}),(function(e){function u(e,t){var r=(function(e,t){for(var r=[],i=[],a=e.visualContainers.slice(),n=0,o=t.visualContainers;n<o.length;n++){var s,l,p=o[n];void 0!==p.id&&(s=jsCommon.ArrayExtensions.findWithId(a,p.id))?(l=a.indexOf(s),a.splice(l,1),jsCommon.JsonComparer.equals(s,p)||i.push(p)):r.push(p)}return{added:r,updated:i,removed:a}})(e,t);return{added:r.added,updated:r.updated,removed:r.removed,page:t,originalPage:e}}((e=(e=e.explore||(e.explore={})).proxies||(e.proxies={})).ExplorationDiffer||(e.ExplorationDiffer={})).diff=function(e,t){return{pages:(function(e,t){for(var r=[],i=[],a=e.slice(),n=0,o=t.length;n<o;n++){var s,l,p=t[n];void 0!==p.id&&(s=jsCommon.ArrayExtensions.findWithId(a,p.id))?(l=a.indexOf(s),a.splice(l,1),l=u(s,p),i.push(l)):r.push(p)}return{added:r,updated:i,removed:a}})(e.sections,t.sections),pods:(function(e,t){for(var r=[],i=[],t=t||[],a=e?e.slice():[],n=0,o=t;n<o.length;n++){var s,l,p=o[n];void 0!==p.id&&(s=p.id,0<=(l=_.findIndex(a,(function(e){return e.id===s}))))?(i.push({updatedPod:p,originalPod:a[l]}),a.splice(l,1)):r.push(p)}return{added:r,removed:a,updated:i}})(e.pods,t.pods)}}})(powerbi=powerbi||{}),(function(y){var x,h,d,g,f,e,S,r,l;function C(e,t,r,i,a,n,o,s){this.promiseFactory=e,this.httpService=t,this.serializer=r,this.telemetryService=i,this.featureSwitchService=a,this.cache={},this.resourcePackageCopyService=n,this.uriPrefix=o||"explore/",this.preloadExplorationsService=s}x=y.explore||(y.explore={}),h=x.proxies||(x.proxies={}),d=y.telemetry.EXDeserializeExplorationEventName,g=y.telemetry.EXGetExplorationEventName,f=y.fillTelemetryEvent,e=y.MonitorWith,S=y.explore.util.ResourcePackageUtils,r=jsCommon.HttpUtils.attachPerformanceTimingByUrl,h.createExplorationProxy=function(e,t,r,i,a,n,o,s){return new l(e,t,r,i,a,n,o,s)},h.saveExplorationSerializationOptions={withData:!0,excludeHighContrastTheme:!0,forSave:!0},C.prototype.get=function(e){var r,i=this,t=this.featureSwitchService&&this.featureSwitchService.featureSwitches&&this.featureSwitchService.featureSwitches.telemetryV2,a=this.telemetryService,n=e.parentActivity?a.startChildEvent(e.parentActivity.event,y.telemetry.EXGetExploration,{fromCache:!1}):a.startEvent(y.telemetry.EXGetExploration,{fromCache:!1}),a=(e.parentContextActivity&&(r=e.parentContextActivity.createChildActivity({name:"Get Exploration"})),e.sectionId),o=e.id,s=e.model,l=e.bookmarkGuid;if(e.allowResultFromClientCache){e=this.getExplorationFromCache(o,a,s,l);if(e)return t&&f(g,{fromCache:!0}),n.event.info.fromCache=!0,n.resolve(),r&&r.resolve(),e}var p,u,c=t?new y.PbiDeferred:this.promiseFactory.defer(),d=this.uriPrefix+"reports/"+o+"/exploration",m=(_.isNumber(a)&&(d+="/sections/"+a),_.isEmpty(l)||(d+="?bookmarkGuid=".concat(l)),C.getCacheKey(o,a,l)),v=(this.cache[m.fullKey]={promise:c.promise},this.httpService.powerbiRequestOptions(n.event,"GetExploration"));return v.responseType="text",this.preloadExplorationsService&&(p=this.preloadExplorationsService.getPreloadedExplorations(),u=this.preloadExplorationsService.getPreloadExplorationsUrl()),u===d&&p?(p.then((function(e){i.attachPerfTimingToTelemetry(n.event.info,d);var t=jsCommon.JsonExtensions.tryParseJSON(e);i.onSuccess(t,c,e,r,s,m)}),(function(e){i.onError(__assign(__assign({},e),{data:void 0}),o,c,m,!0),i.httpGet(d,v,n,c,o,s,m,r)})),this.preloadExplorationsService.clear()):this.httpGet(d,v,n,c,o,s,m,r),c.promise},C.prototype.httpGet=function(r,e,i,a,t,n,o,s){var l=this;this.httpService.get(r,e).then((function(e){l.attachPerfTimingToTelemetry(i.event.info,r);var e=e.data,t=jsCommon.JsonExtensions.tryParseJSON(e);l.onSuccess(t,a,e,s,n,o),i.resolve()}),(function(e){l.attachPerfTimingToTelemetry(i.event.info,r),i.reject(y.errorDetailsHelper.getTelemetryErrorDetails(e.error,e.status)),l.onError(__assign(__assign({},e),{data:void 0}),t,a,o),s&&s.reject()}))},C.prototype.attachPerfTimingToTelemetry=function(e,t){r(t,e)},C.prototype.save=function(e,t,r,i){return this.saveInternal(e,t,r,!1,i)},C.prototype.saveWithoutGroupIdHeader=function(e,t,r){return this.saveInternal(e,t,r,!0)},C.prototype.saveInternal=function(n,o,s,l,p){var u=this,c=this.promiseFactory.defer();return this.copyResourcePackages(o).then((function(){var e,t=C.getCacheKey(s),r=u.serializer.serializeExploration(o,h.saveExplorationSerializationOptions),i=u.serializer.stringifyExplorationConfigs(r),a=u.cloneExplorationShallowForSave(i);null==o.id?(e=u.uriPrefix+"explorations/?reportid="+s,u.httpService.put(e,i,u.httpService.powerbiRequestOptions(null,"SaveExploration")).then((function(e){return u.onSuccess(e.data,c,JSON.stringify(e.data),void 0,null,t)}),(function(e){return u.onError(e,s,c,t)}))):(e=h.ExplorationDiffer.diff(n,i),o.id,u.explorationUpdateDiff(e,o.id,o,a,i,l,p).then((function(){c.resolve({wireContractJSON:JSON.stringify(i),exploration:o,isMobileOptimized:r.layoutOptimization}),u.updateExplorationCache(t,r)}),(function(e){c.reject(e)})))})),c.promise},C.prototype.copyResourcePackages=function(r){var i=[];if(r.resourcePackages)for(var a=r.report&&r.report.folderId,n=this,e=0,t=r.resourcePackages.length;e<t;e++)!(function(e){var t=e;i.push(n.resourcePackageCopyService.copyResourcePackageIfNeeded(r.resourcePackages[t].id,a,null).then((function(e){null!=e&&(r.resourcePackages[t]=e)})))})(e);return this.promiseFactory.all(i)},C.prototype.getModelsAndExploration=function(e,t,r){var i=this,a=this.promiseFactory.defer(),e="".concat(this.uriPrefix,"reports/").concat(e,"/modelsAndExploration?preferReadOnlySession=").concat(t);return r&&(e+="&bookmarkGuid="+r),this.httpService.get(e,this.httpService.powerbiRequestOptions(null,"GetModelsAndExploration")).then((function(t){var r=t.data.models;i.featureSwitchService.registerFeatureSwitches(t.data.featureSwitches),i.serializer.ensureInitialized().then((function(){var e=i.serializer.deserializeExploration(i.serializer.parseExplorationConfigs(t.data.exploration),[],!0,r);a.resolve({exploration:e,models:r,featureSwitches:t.data.featureSwitches})}))}),(function(e){a.reject(e?{error:e.error,requestId:e.requestId,httpStatusCode:e.status}:{})})),a.promise},C.prototype.cloneExplorationShallowForSave=function(e){return{id:e.id,reportId:e.reportId,config:e.config,filters:e.filters,layoutOptimization:e.layoutOptimization,sections:void 0,resourcePackages:_.cloneDeep(e.resourcePackages),publicCustomVisuals:e.publicCustomVisuals}},C.prototype.explorationUpdateDiff=function(e,t,m,r,v,i,a){var y=this,h=this.promiseFactory.defer(),n={},o=(n.exploration=r,-1),s=-1,l=-1,g={},f={},C={},r=(n.addedPods=e.pods.added.map((function(e){return e.id=s--,C[e.name]=e.id,e})),n.deletedPods=e.pods.removed.map((function(e){return e.id})),n.updatedPods=e.pods.updated.reduce((function(e,t){return jsCommon.JsonComparer.equals(t.originalPod,t.updatedPod)||e.push(t.updatedPod),e}),[]),n.addedPages=e.pages.added.map((function(e){if(e.id=o--,g[e.name]=e.id,e.visualContainers)for(var t=0,r=e.visualContainers;t<r.length;t++){var i=r[t],a=(i.id=l--,JSON.parse(i.config));f[y.concatenatePageAndVisualContainerNames(e.name,a.name)]=i.id}return e})),n.deletedPages=e.pages.removed.map((function(e){return e.id})),n.updatedPages=e.pages.updated.reduce((function(e,t){for(var r=0,i=t.added;r<i.length;r++){var a=i[r],n=(a.id=l--,JSON.parse(a.config));f[y.concatenatePageAndVisualContainerNames(t.page.name,n.name)]=a.id}var o=y.getUpdatedPageProperty(t);return _.isEmpty(o.addedVisualContainers)&&_.isEmpty(o.updatedVisualContainers)&&_.isEmpty(o.deletedVisualContainers)&&_.isEmpty(o.pageProperty)||e.push(o),e}),[]),this.uriPrefix+"explorations/savereport/"+t);return e=i?this.httpService.powerbiRequestOptions(null,"explorationUpdateDiff",{dismissGroupObjectId:!0}):this.getRequestOptionsWithGroupId(a),this.httpService.post(r,n,e).then((function(e){var e=e&&e.data,t=e&&e.addedPodIds,r=e&&e.addedSectionIds,i=e&&e.addedVisualContainerIds,e=e&&e.exploration&&e.exploration.resourcePackages;if(e&&S.synchronizePackageIds(y.serializer.deserializeResourcePackages(e),S.ensureResourcePackages(m)),m.pods&&t)for(var a=0,n=m.pods.length;a<n;a++){var o,s=m.pods[a];(u=_.find(t,{oldId:C[s.name]}))&&(o=v.pods[a],s.id=o.id=u.id)}var l=x.contracts.Section.filterTransient(m.sections),p=v.sections;if(l)for(a=0,n=l.length;a<n;a++){var u,c=l[a],d=p[a],d=((u=_.find(r,{oldId:g[c.name]}))&&(c.id=d.id=u.id),d.visualContainers);i&&y.updateDiffForContainerIds(c,d,i,f)}h.resolve(m)}),(function(e){return h.reject(e?{error:e.error,requestId:e.requestId,httpStatusCode:e.status}:{})})),h.promise},C.prototype.updateDiffForContainerIds=function(e,t,r,i){for(var a=0,n=t;a<n.length;a++){var o=n[a],s=JSON.parse(o.config),l=_.find(r,{oldId:i[this.concatenatePageAndVisualContainerNames(e.name,s.name)]});l&&(y.ItemGroupingManager.find(s.name,e.visualContainerGroups).id=o.id=l.id)}},C.prototype.concatenatePageAndVisualContainerNames=function(e,t){return e+"/"+t},C.prototype.getRequestOptionsWithGroupId=function(e,t,r){return e?this.httpService.powerbiRequestOptions(t,r,{groupObjectIdOverride:e}):this.httpService.powerbiRequestOptions(t,r)},C.prototype.saveAs=function(i,a,n,o,s,l,p,u,c,d){var m=this;if(s&&u)throw Error("Save As request should not be sent with both the folder id and the folder object id.");var v=this.promiseFactory.defer();return this.copyResourcePackages(i).then((function(){var e=m.serializer.stringifyExplorationConfigs(m.serializer.serializeExploration(i,h.saveExplorationSerializationOptions)),t=i.reportId,e=(e.reportId=void 0,e.report=void 0,{modelIds:[n],exploration:e,packageId:l?0:o,folderId:s,sourceReportId:t,folderObjectId:u,sensitivityLabelId:c}),t=(a=encodeURIComponent(a),m.uriPrefix+"explorations/"+(d||"")+"?name="+a),r=(l&&(t+="&personalizedreport=true"),m.getRequestOptionsWithGroupId(p,void 0,"saveExplorationAs"));m.httpService.put(t,e,r).then((function(e){return m.onSuccess(e.data,v,JSON.stringify(e.data),void 0,void 0)}),(function(e){return m.onError(e,n,v)}))})),v.promise},C.prototype.saveVisualContainerQueries=function(e,t){e=this.uriPrefix+"explorations/"+e+"/cache";return this.httpService.post(e,t,this.httpService.powerbiRequestOptions(null,"SaveVisualContainerQueries"))},C.prototype.getUpdatedPageProperty=function(e){var t={pageId:e.page.id},r=(t.addedVisualContainers=e.added,t.updatedVisualContainers=e.updated,t.deletedVisualContainers=e.removed.map((function(e){return e.id})),this.shallowCloneSection(e.originalPage)),e=this.shallowCloneSection(e.page);return jsCommon.JsonComparer.equals(r,e)||(t.pageProperty=e),t},C.prototype.shallowCloneSection=function(e){return{config:e.config,displayName:e.displayName,displayOption:e.displayOption,filters:e.filters,height:e.height,id:e.id,name:e.name,objectId:e.objectId,ordinal:e.ordinal,transient:e.transient,visualContainers:void 0,width:e.width}},C.prototype.getExplorationFromCache=function(e,t,r,i){e=this.findMatch(e,t,i);if(e){i=e.result;if(i.promise)return i.promise;if(i.data)if(null==t||_.some(i.data.sections,(function(e){return e.id===t})))return(e=this.promiseFactory.defer()).resolve({wireContractJSON:JSON.stringify(this.serializer.stringifyExplorationConfigs(i.data)),exploration:this.serializer.deserializeExploration(i.data,[],!0,r)}),e.promise}},C.prototype.findMatch=function(e,t,r){var t=C.getCacheKey(e,t,r),i=this.cache[t.fullKey];if(i||null!=r||(t=C.getCacheKey(e),i=this.cache[t.fullKey]),i)return{key:t,result:i}},C.prototype.updateExplorationCache=function(r,e){var t,i=this;r&&(e?((t=this.cache[r.fullKey])?(t.promise&&delete t.promise,t.data=e):this.cache[r.fullKey]={data:e,promise:null},r.part&&!this.cache[r.part.reportKey]&&((t=_.clone(e)).activeWebBookmark&&delete t.activeWebBookmark,this.cache[r.part.reportKey]={data:t,promise:null}),r.allSectionKey&&_.forOwn(this.cache,(function(e,t){t!==r.fullKey&&null!=t.match(new RegExp("^"+r.fullKey))&&delete i.cache[t]})),this.cacheExpirationTimerId&&clearTimeout(this.cacheExpirationTimerId),this.cacheExpirationTimerId=setTimeout((function(){i.clearCache()}),18e5)):delete this.cache[r.fullKey])},C.prototype.clearCache=function(){this.cache={}},C.prototype.logDeserializationErrorsTelemetryEvents=function(e,t){_.find(t,(function(e){return 0===e.errorType}))&&((t=e.config).version,this.telemetryService.logEvent(y.telemetry.NewerExplorationVersion,{explorationVersion:t.version.toString(),supportedVersion:x.services.upgrade.CurrentExplorationVersion.toString()}))},C.prototype.onSuccess=function(e,t,r,i,a,n){try{var o=[],s=this.deserializeExploration(e,r,o,i,a),l=s&&s.explorationWireContract,p=s&&s.explorationContract,u=(i&&i.setProperty("deserializationDuration",null==s?void 0:s.duration),{wireContractJSON:r,exploration:p,isMobileOptimized:l.layoutOptimization});e.report&&(u.modelId=e.report.modelId,u.reportGuid=e.report.objectId),t.resolve(u),this.logDeserializationErrorsTelemetryEvents(l,o),this.updateExplorationCache(n,l),i&&i.resolve()}catch(e){i&&i.reject(e),t.reject(e)}},C.prototype.deserializeExploration=function(e,t,r,i,a){var n,o=this,s=this.featureSwitchService&&this.featureSwitchService.featureSwitches&&this.featureSwitchService.featureSwitches.telemetryV2,l=(e&&e.sections&&(c=e.sections.length),this.telemetryService.startEvent(y.telemetry.EXDeserializeExploration,{length:t.length,upgraderCount:0,sectionCount:c,reportGuid:null==(c=null==e?void 0:e.report)?void 0:c.objectId})),p=this.serializer.parseExplorationConfigs(e),u=(i&&(i.setProperty("explorationJSONStringLength",t.length),i.setProperty("explorationVersion",p.config.version)),{upgraderCount:0}),c=jsCommon.PerfTimer.logTime((function(){l.event.info.explorationVersion=p.config.version,s&&f(d,{explorationVersion:p.config.version,length:t.length}),n=o.serializer.deserializeExploration(p,r,!0,a,u,i),l.event.info.upgraderCount=u.upgraderCount}));return l.resolve(),s&&f(d,{upgraderCount:u.upgraderCount}),{explorationContract:n,explorationWireContract:p,duration:c}},C.prototype.onError=function(e,t,r,i,a){a||r.reject(e?{error:e.error,requestId:e.requestId,httpStatusCode:e.status}:{}),this.updateExplorationCache(i,null)},C.getCacheKey=function(e,t,r){var i,e=null!=t?"".concat(e).concat("_").concat(t):"".concat(e).concat("_").concat("[0-9]+");return r?(i=_.cloneDeep(e),{fullKey:e+="".concat("_").concat(r),allSectionKey:null==t,part:{reportKey:i}}):{fullKey:e,allSectionKey:null==t}},__decorate([e(g)],C.prototype,"get",null),__decorate([e(d)],C.prototype,"deserializeExploration",null),l=C})(powerbi=powerbi||{}),(function(e){(e=(e=(e=(e=e.explore||(e.explore={})).proxies||(e.proxies={})).wireContracts||(e.wireContracts={})).VisualLink||(e.VisualLink={})).Bookmark="Bookmark",e.Back="Back",e.Qna="Qna"})(powerbi=powerbi||{}),(function(e){(e=(e=(e=(e=e.explore||(e.explore={})).proxies||(e.proxies={})).wireContracts||(e.wireContracts={})).VisualTooltip||(e.VisualTooltip={})).Canvas="Canvas",e.Default="Default"})(powerbi=powerbi||{}),(function(e){((e=(e=e.explore||(e.explore={})).util||(e.util={})).DisplayNameServiceUtils||(e.DisplayNameServiceUtils={})).concatStrings=function(e,t,r){var i;return _.isEmpty(e)?null:1===e.length?e[0]:(i=e.pop(),StringExtensions.format(r.stringResourceProvider.get(t),1<e.length?e.join(r.stringResourceProvider.get("ListJoin_Separator")):e[0],i))}})(powerbi=powerbi||{}),(function(e){function x(e,t,r){e=e.defn.select().withName(t);return e?{expr:e.expr,roleName:r}:void 0}(e=(e=(e=e.explore||(e.explore={})).util||(e.util={})).DrillUtils||(e.DrillUtils={})).getDrillableRoles=function(e){return null!=(e=e.drilldown)&&e.roles?e.roles:[]},e.getDrillFilterRemovalInfoList=function(e,t,r){if(t){var i,a;switch(r){case 1:n=(function(e,t){var r=[],i=e.projections,a=t.sourceCount,n=t.sourceIndex,o=t.sourceRole,s=t.targetRole;if(i[s]){var l=(y=i[s]).all(),t=t.targetIndex;n<=t&&o===s&&(t+=a);for(var p=y.convertFieldIndexToProjectionIndex(t),u=l.length;p<u;p++){for(var c=y.getProjectionsByProjectionIndex(p),d=0,m=c;d<m.length;d++){var v=m[d];r.push(x(e,v.queryRef,s))}p+=c.length-1}}if(i[o])for(var y=i[o],h=a-1;0<=h;h--)for(var g=y.getProjectionsByFieldIndex(n+h),f=0,C=g;f<C.length;f++){v=C[f];r.push(x(e,v.queryRef,o))}return r})(e,t);break;case 0:if(t.expr)for(var n=[],o=0,s=jsCommon.ArrayExtensions.ensureArray(t.expr);o<s.length;o++){var l=s[o];n.push((l=l,a=void 0,a=(i=e).defn.selectNameOf(l),i=(function(e,t){for(var r in e){var i=e[r].all();if(0<=_.findIndex(i,(function(e){return e.queryRef===t})))return r}})(i.projections,a),{expr:l,roleName:i}))}else n=(function(e,t){var r=[],i=null!=(i=t.count)?i:1,a=t.role,n=e.projections[a];if(n)for(var o=t.projOptions.fieldIndex+i-1,s=i-1;0<=s;s--,o--)for(var l=n.getProjectionsByFieldIndex(o),p=0,u=l;p<u.length;p++){var c=u[p];r.push(x(e,c.queryRef,a))}return r})(e,t);break;case 2:break;default:return}return _.compact(n)}}})(powerbi=powerbi||{}),(function(e){var s,g,E;function N(e,a,n,o){e&&(f(e.filters,o),_.forOwn(e.sections,(function(e,t){var v,r,y,h,i=_.find(a,(function(e){return e.name===t}));i=i,v=n,r=o,(e=e)&&i&&(r.visitSectionState(e),f(e.filters,r),y=r.visualContainerStateVisitor)&&(h=i.visualContainers,_.forOwn(e.visualContainers,(function(e,t){var r=_.find(h,(function(e){return e.name===t})),i=v,a=y;if(e&&r){a.visitVisualContainerState(e),f(e.filters,a);var n=e.highlight,o=a;if(n){if(!_.isEmpty(n.selection))for(var s=0,l=n.selection;s<l.length;s++){var p=l[s];o.visitSelectorsByColumn(p)}n.filterExpressionMetadata&&o.visitFilterExpressionMetadata(n.filterExpressionMetadata)}var n=e&&e.singleVisual,e=r,r=i,u=a;if(n){u.visitSingleVisualState(n);i=n.orderBy,i=(i&&u.visitOrderByStates(i),n.objects);if(i){e=g.VisualContainerUtils.getVisualCapabilities(e,r),e=(e&&(r=e.objects)&&u.visitDataViewObjectDefinitionUpdates(i,r),i.merge),r=(e&&C(e,u),i.remove);if(!_.isEmpty(r))for(var c=0,d=r;c<d.length;c++){var m=d[c].selector;m&&u.visitSelector(m)}}e=n.activeProjections;e&&u.visitActiveProjectionStates(e)}}})))})))}function V(e,r,t){var i,a,n,o;r.visitVisualContainer(e),e.config&&(i=e.config.singleVisual)&&(r.visitSingleVisualConfig(i),(a=i.query)&&r.visitQuery(a),a=function(e,t){t&&r.visitDataViewObjects(e,t),C(e,r)},(o=i.objects)&&(n=void 0,a(o,n=(o=g.VisualContainerUtils.getVisualCapabilities(e,t))?o.objects:n)),t=i.vcObjects)&&(a(t,n=s.contracts.VisualContainer.CommonObjectDescriptors),o=i.vcObjects.visualLink)&&r.visitVisualLinks(o),w(e.filters,r)}function w(e,t){if(!_.isEmpty(e))for(var r=0,i=e;r<i.length;r++){var a=i[r];null!=a&&t.visitFilterContainer(a)}}function f(e,t){if(e){var r=e.nameIdentifiedMerges,r=(_.forOwn(r,(function(e){t.visitFilterContainer(e)})),e.exprIdentifiedMerges);if(!_.isEmpty(r))for(var i=0,a=r;i<a.length;i++){var n=a[i];t.visitFilterContainer(n)}}}function C(e,a){_.forOwn(e,(function(e){if(!_.isEmpty(e))for(var t=0,r=e;t<r.length;t++){var i=r[t].selector;i&&a.visitSelector(i)}}))}s=e.explore||(e.explore={}),g=s.util||(s.util={}),E=e.explore.contracts.BookmarkExtensions,g.traverseExploration=function(e,t,r){t.visitExploration(e),w(e.filters,t);var i=e.bookmarks;if(!_.isEmpty(i))for(var a=0,n=i;a<n.length;a++)!(function e(t,r,i,a){a.visitBookmark(t);if(E.isBookmarkGroup(t))for(var n=0,o=t.children;n<o.length;n++){var s=o[n];e(s,r,i,a)}else N(t.explorationState,r,i,a.explorationStateVisitor)})(n[a],e.sections,r,t);if(i=e.sections,!_.isEmpty(i))for(var o=0,s=i;o<s.length;o++){var l=s[o],p=(f=g=h=c=u=p=void 0,l),u=t,c=r,l=(u.visitSection(p),w(p.filters,u),y=v=m=d=l=void 0,p.linkFields),d=u;if(!_.isEmpty(l))for(var m=0,v=l;m<v.length;m++){var y=v[m];d.visitLinkField(y)}var h=p.visualContainers;if(!_.isEmpty(h))for(var g=0,f=h.length;g<f;g++)V(h[g],u.visualContainerVisitor,c)}var i=e.pods,C=t;if(!_.isEmpty(i))for(var x=0,S=i;x<S.length;x++){var b=S[x];C.visitPod(b)}},g.traverseExplorationState=N,g.traverseVisualContainer=V})(powerbi=powerbi||{}),(function(e){var a,r;function t(){}function i(e){var t=r.call(this)||this;return t.rewriters=e,t}e=e.explore||(e.explore={}),a=e.util||(e.util={}),t.prototype.visitVisualContainer=function(e){},t.prototype.visitSingleVisualConfig=function(e){},t.prototype.visitQuery=function(e){},t.prototype.visitDataViewObjects=function(e,t){},t.prototype.visitSelector=function(e){},t.prototype.visitFilterContainer=function(e){},t.prototype.visitVisualLinks=function(e){},e=t,a.DefaultVisualContainerVisitor=e,__extends(i,r=e),i.prototype.visitSingleVisualConfig=function(e){e.cachedFilterDisplayItems&&a.rewriteDisplayNameIdentityPairs(e.cachedFilterDisplayItems,this.rewriters)},i.prototype.visitQuery=function(e){if(e.defn)for(var t=0,r=this.rewriters;t<r.length;t++)e=r[t].rewriteQuery(e)},i.prototype.visitDataViewObjects=function(e,t){a.rewriteFilterOutput(e,t,this.rewriters),a.rewriteDataBoundPropertyDefinitions(e,t,this.rewriters)},i.prototype.visitFilterContainer=function(e){a.rewriteFilterContainer(e,this.rewriters)},i.prototype.visitVisualLinks=function(e){for(var t=0,r=e;t<r.length;t++){var i=r[t];a.rewriteVisualLink(i,this.rewriters)}},i.prototype.visitSelector=function(e){var t=a.rewriteDataRepetitionSelectors(e.data,this.rewriters);t!==e.data&&(e.data=t)},e=i,a.VisualContainerRewriter=i})(powerbi=powerbi||{}),(function(e){var a,i,r;function t(){}function n(e){var t=r.call(this)||this;return t.rewriters=e,t}e=e.explore||(e.explore={}),a=e.util||(e.util={}),i=jsCommon.DictionaryExtensions,t.prototype.visitActiveProjectionStates=function(e){},t.prototype.visitDataViewObjectDefinitionUpdates=function(e,t){},t.prototype.visitFilterContainer=function(e){},t.prototype.visitOrderByStates=function(e){},t.prototype.visitSelector=function(e){},t.prototype.visitSelectorsByColumn=function(e){},t.prototype.visitSingleVisualState=function(e){},t.prototype.visitVisualContainerState=function(e){},t.prototype.visitFilterExpressionMetadata=function(e){},e=t,a.DefaultVisualContainerStateVisitor=e,__extends(n,r=e),n.prototype.visitActiveProjectionStates=function(r){var i=this;_.forOwn(r,(function(e,t){e=e.map((function(e){return a.rewriteExpr(e,i.rewriters)}));r[t]=e}))},n.prototype.visitFilterContainer=function(e){a.rewriteFilterContainerState(e,this.rewriters)},n.prototype.visitDataViewObjectDefinitionUpdates=function(e,t){e=e.merge;e&&(a.rewriteFilterOutput(e,t,this.rewriters),a.rewriteDataBoundPropertyDefinitions(e,t,this.rewriters))},n.prototype.visitOrderByStates=function(e){for(var t=0,r=e;t<r.length;t++){var i=r[t];i.expr=a.rewriteExpr(i.expr,this.rewriters)}},n.prototype.visitSelector=function(e){var t=a.rewriteDataRepetitionSelectors(e.data,this.rewriters);t!==e.data&&(e.data=t)},n.prototype.visitSelectorsByColumn=function(e){var r=this,t=i.rewriteDictionary(e.dataMap,(function(e,t){return a.rewriteDataRepetitionSelectors(t,r.rewriters)}));t!==e.dataMap&&(e.dataMap=t)},n.prototype.visitFilterExpressionMetadata=function(e){a.rewriteFilterExpressionMetadata(e,this.rewriters)},e=n,a.VisualContainerStateRewriter=n})(powerbi=powerbi||{}),(function(e){((e=(e=e.explore||(e.explore={})).util||(e.util={})).VisualPerformanceActivityUtil||(e.VisualPerformanceActivityUtil={})).updateParentWithNewLinkingActivity=function(e,t,r){if(e&&e.getProperty("telemetryActivityId")){var i=r.getOpenActivityById(e&&e.getProperty("telemetryActivityId"));if(i&&i.isActive())return r=r.startChildActivity(i.event,t),e.setProperty("telemetryActivityId",r.event.id),r}}})(powerbi=powerbi||{}),(function(e){function p(e,t){var r={},i=e.defn.select();if(i)for(var a in e.projections){var n=e.projections[a];if(n){r[a]=[];for(var o=n.all(),s=0;s<o.length;s++){var l=n.convertProjectionIndexToFieldIndex(s);n.doesParameterExist(l)||t?r[a].push(i.withName(o[s].queryRef).expr):r[a].push(null)}}}return r}(e=(e=(e=e.explore||(e.explore={})).util||(e.util={})).PresentationUtils||(e.PresentationUtils={})).explorationToPresentationState=function(e){for(var t={},r=0,i=e.sections;r<i.length;r++){var a=i[r];t[a.name]={};for(var n=0,o=a.visualContainers;n<o.length;n++){var s,l=o[n];l.config.singleVisual&&(s=l.config.singleVisual,t[a.name][l.name]={visualType:s.visualType,autoSelectVisualType:s.autoSelectVisualType,projections:s.query?p(s.query,!0):void 0})}}return t},e.captureProjections=p,e.captureParameters=function(e){var t;if(e.defn.select())for(var r in e.projections){var i=e.projections[r];if(i){i=_.sortBy(i.getFieldParameters(),(function(e){return e.index}));if(!_.isEmpty(i)){(t=t||{})[r]=[];for(var a=0,n=i;a<n.length;a++){var o=n[a],s=o.expr,l=o.index,o=o.length;t[r].push({expr:s,index:l,length:o})}}}}return t}})(powerbi=powerbi||{}),(function(e){function t(e){this.container=e,this.context={pendingGeocodingCount:0}}e=(e=e.explore||(e.explore={})).util||(e.util={}),t.prototype.newQuery=function(e){var t=0!==this.context.pendingGeocodingCount,r=this.context.geocodingActivity;this.context={pendingGeocodingCount:0,rootActivity:e},t&&(r&&r.reject(),this.container.onStopGeocoding())},t.prototype.hasPendingGeocoding=function(){return 0<this.context.pendingGeocodingCount},t.prototype.wrapGeocoder=function(r){return{geocode:this.wrapAsyncGeocoderMethod(r,r.geocode),geocodeBoundary:this.wrapAsyncGeocoderMethod(r,r.geocodeBoundary),geocodePoint:this.wrapAsyncGeocoderMethod(r,r.geocodePoint),tryGeocodeImmediate:function(e,t){return r.tryGeocodeImmediate(e,t)},tryGeocodeBoundaryImmediate:function(e,t){return r.tryGeocodeBoundaryImmediate(e,t)}}},t.prototype.wrapAsyncGeocoderMethod=function(n,o){var s=this;return function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];function r(){i===s.context&&--i.pendingGeocodingCount<=0&&(s.context.geocodingActivity&&s.context.geocodingActivity.resolve(),s.container.onStopGeocoding())}var i=s.context,a=o.apply(n,e);1==++i.pendingGeocodingCount&&(s.context.rootActivity&&(s.context.geocodingActivity=s.context.rootActivity.createChildActivity({name:"Geocoding"})),s.container.onStartGeocoding());return a.then(r,r),a}},e.QueryGeocodingTracker=t})(powerbi=powerbi||{}),(function(e){function t(e,t){this.explorationStateVisitor=e,this.visualContainerVisitor=t}e=(e=e.explore||(e.explore={})).util||(e.util={}),t.prototype.visitBookmark=function(e){},t.prototype.visitFilterContainer=function(e){},t.prototype.visitExploration=function(e){},t.prototype.visitSection=function(e){},t.prototype.visitLinkField=function(e){},t.prototype.visitPod=function(e){},e.DefaultExplorationVisitor=t})(powerbi=powerbi||{}),(function(e){var t,r;function i(e){this.visualContainerStateVisitor=e}function a(e,t){t=r.call(this,t)||this;return t.rewriters=e,t}e=e.explore||(e.explore={}),t=e.util||(e.util={}),i.prototype.visitFilterContainer=function(e){},i.prototype.visitSectionState=function(e){},e=i,t.DefaultExplorationStateVisitor=e,__extends(a,r=e),a.prototype.visitFilterContainer=function(e){t.rewriteFilterContainerState(e,this.rewriters)},e=a,t.ExplorationStateRewriter=a})(powerbi=powerbi||{}),(function(u){var l=u.explore||(u.explore={}),n=u.common.utils.ColorUtility,i=u.visualHost.CustomVisualsFilterPropertyIdentifier,o=u.data.DataViewObjectDefinitions,a=u.data.DataViewObjectDescriptors,p=u.data.FieldExprPattern,c=u.data.FilterKindDetector,s=l.contracts.FilterType,d=u.common.utils.IdUtility,m=u.data.ScopeIdentityExtractor.ScopeIdKeysAndValuesExtractorImpl,v=u.data.SemanticFilter,y=u.data.services.SemanticQuerySerializer,h=u.data.SQExpr,g=u.data.SQExprConverter,f=u.data.SQExprUtils,r=u.visuals.valueFormatter;function e(){}e.getFormatter=function(e,t){e=e.getMetadata(t);if(e)return t=e.format,r.create({format:t,allowFormatBeautification:!0})},e.getDefaultFilterType=function(e,t,r,i){var t=e.getMetadata(t);if(t)return 5!==r&&(r=(r=t.type)&&(r.text||r.bool||r.dateTime),t=t.idOnEntityKey&&i&&h.equals(e,i),!r||f.isMeasure(e)||t)?l.contracts.FilterType.Advanced:l.contracts.FilterType.Categorical},e.getFilterType=function(e,t){return f.isMeasure(e)||!t?l.contracts.FilterType.Advanced:l.contracts.FilterType.Categorical},e.canAdd=function(e,t,r,i,a,n){if(!t||!r)return!1;if(!this.supportsMeasureFilters(e,n)&&f.isMeasure(t))return!1;e=g.asFieldPattern(t,r),t=p.toFieldExprEntityItemPattern(e),r=r.schema(t.schema);if(!r)return!1;var o,s=r.findProperty(t.entity,p.getPropertyName(e));if(s||(e.hierarchyLevel?(l=r.findHierarchy(t.entity,e.hierarchyLevel.name))&&(o=l.levels.withName(e.hierarchyLevel.level)):e.columnHierarchyLevelVariation&&(l=r.findHierarchy(e.columnHierarchyLevelVariation.level.entity,e.columnHierarchyLevelVariation.level.name))&&(o=l.levels.withName(e.columnHierarchyLevelVariation.level.level))),!s&&!o||!i||!i.container)return!1;if(s&&1===s.kind&&(0!==i.scopeType||r.capabilities.limitMultiColumnFiltersToQueryGroupColumns)&&!a)return!1;if(a){t=s&&s.kind;if(!(!!o||0===t||1===t))return!1;var l=!1;if(!(l=1===i.scopeType&&(e=i.container)&&!e.transient?!0:l))return!1}if(0===i.scopeType){r=i.container;if(!r||!this.supportsVisualFilters(r,n))return!1}return!0},e.supportsVisualFilters=function(e,t){e=l.util.VisualContainerUtils.getVisualType(e);return t.isQueryVisual(e)},e.supportsFilterOutput=function(e){return null!=this.tryGetFilterPropertyIdentifier(e,null,null)},e.tryGetFilterPropertyIdentifier=function(e,t,r){return t&&r&&r.isCustomVisual(t)?i:e?a.findFilterOutput(e.objects):void 0},e.tryGetFilterProperty=function(e,t,r,i){e=this.tryGetFilterPropertyIdentifier(e,t,r);if(e)return o.getValue(i,e,void 0)},e.add=function(e,t){e.filters||(e.filters=[]),e.filters.push(t)},e.getFiltersContainer=function(e,t,r){switch(e){case 0:return l.services.selectionUtils.getSelectedVisual(t);case 1:return r.getCurrentSection();case 2:return r.getCurrentExploration()}},e.convertFilterData=function(e,t,r){if(e){t={filter:e.filter,name:this.getNextFilterName(t),type:e.type,restatement:e.restatement,howCreated:r};if(e.type===l.contracts.FilterType.Categorical||e.filterExpressionMetadata&&1===e.filterExpressionMetadata.expressions.length){t.expression=e.filterExpressionMetadata.expressions[0];var i=[];if(!_.isEmpty(e.filterExpressionMetadata.cachedValueItems)){for(var a=0,n=e.filterExpressionMetadata.cachedValueItems;a<n.length;a++){var o=n[a];1===o.identities.length&&i.push({identity:o.identities[0],displayName:o.valueMap[0]})}t.cachedValueItems=i}}else e.filterExpressionMetadata&&(t.filterExpressionMetadata=e.filterExpressionMetadata);return t}},e.shouldDisableFilter=function(e,t,r,i,a){if(r){var n=e.expression;if(n){var o=u.data.SQExprUtils.isMeasure(n),e=!_.isEmpty(this.validate(e,t,i)),i=l.util.VisualContainerUtils.hasGrouping(r,t);if(o){if(!i&&!e)return!0;o=n.getTargetEntity();if(!o)return!0;i=o.schema;if(t.schema(i).capabilities.limitMultiColumnFiltersToQueryGroupColumns)return!0;if(l.util.VisualContainerUtils.hasFilterMappingWithNonAggregatableColumns(r,t,a))return!0;if(l.util.VisualContainerUtils.hasGroupByItemsInQuery(r))return!0}}}return!1},e.getValueType=function(e,t){e=e.getMetadata(t);if(e)return e.type},e.getDefaultRetainedValue=function(e,t){t=u.data.SQExprUtils.getDefaultValues(e,t);if(!_.isEmpty(t))return{isNot:!1,scopeIds:[[u.data.createDataViewScopeIdentity(u.data.SQExprUtils.getDataViewScopeIdentityComparisonExpr(e,t))]]}},e.validate=function(e,t,r){var i=e.expression,e=e.filter,i=f.validate(i,t,r);if(e&&(i=e.validate(t,r,i)),!_.isEmpty(i))return i},e.getNextFilterName=function(e){for(var t={},r=0,i=e=null==e?[]:e;r<i.length;r++){var a=i[r];null!=a&&(t[a.name]=!0)}return d.generateUniqueId(t,"Filter")},e.isCategoricalFilter=function(e){return e===l.contracts.FilterType.Categorical||e===l.contracts.FilterType.Visual},e.getQueryRefsForSingleItemDrillFilters=function(e,t,r){var i=e.filters,a=[];if(i)for(var n=0,o=i;n<o.length;n++){var s=o[n],l=s&&s.filter;l&&_.isEmpty(l.validate(t,r))&&2===s.howCreated&&this.areDrillFiltersSingleValue(l.where())&&(l=this.getQueryRefFromFilter(e,s.expression))&&a.push(l)}return a},e.areDrillFiltersSingleValue=function(e){return!_.isEmpty(e)&&_.every(e,(function(e){return null!=e&&(e=e.condition,h.isIn(e)?e.values&&1===e.values.length:!!h.isCompareRef(e)&&0===e.comparison)}))},e.getQueryRefFromFilter=function(e,t){e=l.util.VisualContainerUtils.getVisualQuery(e);if(e)return e.defn.selectNameOf(t)},e.getFilterValuesForColumn=function(e,t){if(t)return t=t.condition,e=new b(e),t.accept(e),e.values},e.deriveFromSQFilters=function(e,t,r){var i=[],a=r&&r.Filters&&0!==r.Filters.length?r.Filters:null;a&&a.length!==t.length&&(a=null);for(var n=0,o=t.length;n<o;n++){var s=t[n],l=a&&a[n],p=l&&l.expression&&y.deserializeExpr(l.expression);i.push({name:this.getNextFilterName(i),filter:new u.data.SemanticFilter(e,[s]),restatement:l&&l.Restatement,expression:p,howCreated:0,type:l&&l.type})}return i},e.extractParameterFilters=function(e,t){var r=_.filter(e.From,(function(e){return 1!==e.Type})),r={Version:e.Version,From:r,Where:e.Where},i={RemovedIndexes:[]},e=y.deserializeFilter(r,i);if(t&&!_.isEmpty(i.RemovedIndexes)&&(t.Filters=_.filter(t.Filters,(function(e,t){return!_.includes(i.RemovedIndexes,t)}))),e)return this.deriveFromSQFilters(e.from(),e.where(),t)},e.mergeExplorationSectionFilters=function(e,t){_.isEmpty(e.filters)||(t.filters=this.mergeFilters(t.filters,e.filters,"explore"),e.filters=[])},e.isFilterModified=function(e){var t=!0===e.isHiddenInViewMode,r=!0===e.isLockedInViewMode,i=!!e.displayName,a=void 0!==e.ordinal,t=t||r||i||a;return!!e.filter||!o.isEmpty(e.objects)||t},e.ensureFilterHasName=function(e,t){null==e.name&&this.isFilterModified(e)&&(e.name=this.getNextFilterName(t.container&&t.container.filters))},e.applySectionParameterFilters=function(e,t,r,i,a){if(e.filters=this.getSectionParameterFiltersToApply(t,e.filters,r,i),a=_.isEmpty(i)&&_.isEmpty(r)?a:!0)for(var n=0,o=e.visualContainers;n<o.length;n++)o[n].cachedData=null},e.getFiltersToApplyFromVisualQueryFilterContext=function(e){if(e){for(var t=e.dataFilters?e.dataFilters.slice():[],r=[],i=[],a=0,n=t=e.highlightFiltersUnmerged?t.concat(e.highlightFiltersUnmerged):t;a<n.length;a++){var o=n[a],s=o.filter.where();if(!_.isEmpty(s)){var l=_.filter(s,(function(e){return 1===c.runDetector(e.condition)}));if(i.push.apply(i,l||[]),!_.isEmpty(l)){l=_.filter(s,(function(e){return 1!==c.runDetector(e.condition)}));if(_.isEmpty(l))continue;o={filter:v.fromSQFromAndSQFilters(o.filter.from(),l)}}r.push(o)}}return _.isEmpty(i)||(t=v.fromMeasureFilters(e.query,i))&&r.push({filter:t}),r}},e.findValuesInFilterCache=function(e,t,r){if(r&&!_.isEmpty(r.cachedValueItems)){var i=this.findIdentityMapInFilterCache(e,t,r);if(i){var a,n=[],o=[];for(a in i.valueMap)n.push(i.valueMap[a]),o.push(r.expressions[a]);return{values:n,columns:o}}}},e.removeEntryFromFilterCache=function(e,t,r){var i;r&&!_.isEmpty(r.cachedValueItems)&&(i=this.findIdentityMapInFilterCache(e,t,r))&&_.remove(r.cachedValueItems,(function(e){return e===i}))},e.findIdentityMapInFilterCache=function(r,i,e){if(e&&!_.isEmpty(e.cachedValueItems))for(var t=0,a=e.cachedValueItems;t<a.length;t++){for(var n=a[t],o=new m,s=0,l=n.identities;s<l.length;s++)l[s].expr.accept(o);if(o.keys.length===r.length){for(var p=!0,u=0;u<o.keys.length;u++)if("break"===(function(e){var t=o.keys[e];if(_.findIndex(r,(function(e){return h.equals(e,t)}))<0||i[e].value!==o.values[e].value)return p=!1,"break"})(u))break;if(p)return n}}},e.getSectionParameterFiltersToApply=function(e,t,r,i){t=__spreadArray([],t||[],!0);return _.isEmpty(i)||e&&!_.isEmpty(e.parameters)&&_.remove(t,(function(t){return _.some(e.parameters,(function(e){return e.boundFilter===t.name}))})),_.isEmpty(i)&&_.isEmpty(r)?t:(i=this.getUnOverriddenAndMergedFilters(i,r),this.getUnOverriddenAndMergedFilters(i,t))},e.getUnOverriddenAndMergedFilters=function(e,t){return _.isEmpty(e)?t:_.isEmpty(t)?e:(t=this.getNonoverriddenFilters(e,t),this.mergeFilters(t||[],e||[],"param"))},e.getNonoverriddenFilters=function(e,t){var r,i=this;return _.isEmpty(e)||_.isEmpty(t)?t:(r=this.extractAllReferencedFields(e),_.filter(t,(function(e){e=i.extractReferencedFields(e);return!_.some(e,(function(t){return _.some(r,(function(e){return h.equals(e,t,!1,!0)}))}))})))},e.extractParameterFiltersFromSection=function(e,t){e=e||[];for(var r={},i=[],a=0,n=t=t||[];a<n.length;a++)r[(l=n[a]).name]=l;for(var o=0,s=e;o<s.length;o++){var l,p=r[(l=s[o]).name];p&&_.isEqual(p,l)||i.push(l)}return i},e.mergeFilters=function(e,t,r){for(var i={},a=0,n=e=e||[];a<n.length;a++)i[(o=n[a]).name]=!0;for(var o,s=0,l=t;s<l.length;s++)(o=l[s]).name=r+"_"+o.name,i[o.name]?o.name:i[o.name]=!0;return e.concat(t)},e.canExpandManually=function(e,t,r,i,a){return 6!==e&&(a=a===s.Exclude||a===s.Include,!(5===e&&!t&&!a&&r&&h.isMeasure(r)||!i))},e.hasMeasureOrAsAggregationLinkField=function(e){return _.some(e.filters,(function(e){return 5===e.howCreated&&!e.isTransient&&(e.isLinkedAsAggregation||e.expression&&h.isMeasure(e.expression))}))},e.notifyFilterContainerChangedByUser=function(e,t){e.publishToChannel(l.services.events.userActionTriggered,{source:"UserAction_ChangeFilter"}),e.publishToChannel(l.services.events.filterContainerChanged,t)},e.createChangeFilterActivity=function(e,t){return e.createActivity({name:"Change Filter",operationType:t})},e.notifyBufferedFilterChanges=function(e,t,r,i,a,n){e.publishToChannel(l.services.events.applyAllBufferedFilterCardChanged,{filterScopeType:t,filterType:r,id:i,canApply:a,wasDeleted:n})},e.isApplyAllEnabled=function(e,t){t=t.getCurrentExploration();return!!(e&&t&&t.slowDataSourceSettings)&&t.slowDataSourceSettings.isApplyAllButtonEnabled},e.getFilterCardStyle=function(e,t,r,i){var a,n,o=e&&e.filterCard,o=t?(a=o&&o.$instances&&o.$instances[l.constants.ExploreCanvasConstants.Applied],n=r.colorPalette.backgroundLight.value,l.constants.ExploreCanvasConstants.DefaultAppliedFilterCardTransparency):(a=o&&o.$instances&&o.$instances[l.constants.ExploreCanvasConstants.Available],n=r.colorPalette.background.value,l.constants.ExploreCanvasConstants.DefaultAvailableFilterCardTransparency),s=null!=(s=null==i?void 0:i.defaultStyleOverride)?s:{checkboxAndApplyColor:l.constants.ExploreCanvasConstants.DefaultOutspacePaneCheckboxAndApplyColor,borderColor:l.constants.ExploreCanvasConstants.DefaultFilterCardBorderColor,backgroundColor:n,foregroundColor:r.colorPalette.foreground.value,inputBoxBorderColor:l.constants.ExploreCanvasConstants.DefaultFilterCardBorderColor,inputBoxBackgroundColor:l.constants.ExploreCanvasConstants.DefaultControlBackgroundColor,inputBoxForegroundColor:l.constants.ExploreCanvasConstants.DefaultControlForegroundColor,fontSize:this.getFontSize(a),fontFamily:this.getFontFamily(a)};return{checkboxAndApplyColor:this.getCheckboxAndApplyColor(e&&e.outspacePane,s.checkboxAndApplyColor),borderColor:this.getBorderColor(a,s.borderColor,null==i?void 0:i.alwaysEnableBorder),backgroundColor:this.getBackgroundColor(a,s.backgroundColor,o,t,s.backgroundColorApplied),foregroundColor:this.getColor(a,"foregroundColor",s.foregroundColor),inputBoxBorderColor:this.getBorderColor(a,s.inputBoxBorderColor,!0),inputBoxBackgroundColor:this.getColor(a,"inputBoxColor",s.inputBoxBackgroundColor),inputBoxForegroundColor:this.getColor(a,"foregroundColor",s.inputBoxForegroundColor),fontSize:null!=i&&i.ignoreFontSizeAndFamily?null:s.fontSize,fontFamily:null!=i&&i.ignoreFontSizeAndFamily?null:s.fontFamily}},e.determineIsLinkedAsAggregation=function(e,t,r){if(5===e.howCreated)return null!=r.defaultAggregate(e.expression,t)},e.getDisplayNameForIncludeExcludeFilters=function(e,t,r){return(t===s.Include?e.get("Include_Label"):e.get("FilterPane_Exclude"))+" ("+r+")"},e.getCheckboxAndApplyColor=function(e,t){void 0===t&&(t=l.constants.ExploreCanvasConstants.DefaultOutspacePaneCheckboxAndApplyColor);e=u.DataViewObject.getFillColorByPropertyName(e,"checkboxAndApplyColor",t);return n.hexToRGBString(e)},e.getBorderColor=function(e,t,r){t=u.DataViewObject.getFillColorByPropertyName(e,"borderColor",t),e=!0===u.DataViewObject.getValue(e,"border",l.constants.ExploreCanvasConstants.DefaultFilterCardBorder)||r?1:0;return n.hexToRGBString(t,e)},e.getBackgroundColor=function(e,t,r,i,a){i=u.DataViewObject.getFillColorByPropertyName(e,"backgroundColor",i&&a?a:t),a=n.convertTransparencyToOpacity(u.DataViewObject.getValue(e,"transparency",r));return n.hexToRGBString(i,a)},e.getColor=function(e,t,r){e=u.DataViewObject.getFillColorByPropertyName(e,t,r);return n.hexToRGBString(e)},e.getFontSize=function(e){e=u.DataViewObject.getValue(e,"textSize",l.constants.ExploreCanvasConstants.DefaultFilterCardTextSizePt);return"".concat(e,"pt")},e.getFontFamily=function(e){return u.DataViewObject.getValue(e,"fontFamily",l.constants.ExploreCanvasConstants.DefaultOutspacePaneFontFamily)},e.extractAllReferencedFields=function(e){var t=this;return _.flatten(_.map(e,(function(e){return t.extractReferencedFields(e)})))},e.extractReferencedFields=function(e){var t=[];if(e.expression&&t.push(e.expression),e.filter)for(var r=0,i=e.filter.conditions();r<i.length;r++){var a=i[r],n=new C;a.accept(n),t=t.concat(n.fields)}return t},e.supportsMeasureFilters=function(e,t){e=l.util.VisualContainerUtils.getVisualType(e);return!t.isAnalysisVisual(e)},e.getFilterCapabilities=function(e){return{canClear:this.canClearManually(e),canDelete:this.canDeleteManually(e),canEdit:this.canEditManually(e),canHide:this.canHideManually(e),canLock:this.canLockManually(e),canRename:this.canRenameManually(e),canSort:this.canSortManually(e)}},e.canClearManually=function(e){var t=5===e.howCreated&&(e.type===s.Exclude||e.type===s.Include);return(0===e.howCreated||1===e.howCreated||2===e.howCreated||5===e.howCreated||7===e.howCreated)&&e.type!==s.Passthrough&&!t},e.canDeleteManually=function(e){return 1===e.howCreated||5===e.howCreated||7===e.howCreated||e.type===s.Passthrough||3===e.howCreated||4===e.howCreated},e.canEditManually=function(e){return(0===e.howCreated||1===e.howCreated||2===e.howCreated||5===e.howCreated||7===e.howCreated||3===e.howCreated||4===e.howCreated)&&e.type!==s.Passthrough},e.canHideManually=function(e){return 0===e.howCreated||1===e.howCreated||5===e.howCreated&&!e.isTransient||e.type===s.Passthrough||3===e.howCreated||4===e.howCreated},e.canLockManually=function(e){return(0===e.howCreated||1===e.howCreated||5===e.howCreated&&!e.isTransient||3===e.howCreated||4===e.howCreated)&&e.type!==s.Passthrough},e.canRenameManually=function(e){return(0===e.howCreated||1===e.howCreated)&&e.type!==s.Passthrough},e.canSortManually=function(e){return 0===e.howCreated||1===e.howCreated||e.type===s.Passthrough||3===e.howCreated||4===e.howCreated},l.FilterUtils=e,t=u.data.DefaultSQExprVisitorWithTraversal,__extends(x,t),x.prototype.visitColumnRef=function(e){this.fields.push(e)},x.prototype.visitHierarchyLevel=function(e){this.fields.push(e)},x.prototype.visitMeasureRef=function(e){this.fields.push(e)},x.prototype.visitEntity=function(e){this.fields.push(e)},x.prototype.visitAggr=function(){};var t,C=x;function x(){var e=null!==t&&t.apply(this,arguments)||this;return e.fields=[],e}S=u.data.DefaultSQExprVisitor,__extends(E,S),E.prototype.visitCompare=function(e){0===e.comparison&&h.isConstant(e.right)&&h.equals(e.left,this.comparisonColumn)&&this.values.push(e.right)},E.prototype.visitIn=function(e){var t=this;if(!_.isEmpty(e.values)){var r=e.args,i=_.findIndex(r,(function(e){return h.equals(e,t.comparisonColumn,void 0,!0)}));if(!(i<0))for(var a=0,n=e.values;a<n.length;a++){var o=n[a];this.values.push(o[i])}}};var S,b=E;function E(e){var t=S.call(this)||this;return t.comparisonColumn=e,t.values=[],t}})(powerbi=powerbi||{}),(function(o){var e,m,s,i,v,y;function t(e,t){return e.displayName.localeCompare(t.displayName,void 0,{sensitivity:"base"})}e=(e=o.explore||(o.explore={})).util||(e.util={}),m=o.data.SQExpr,s=o.data.SQExprBuilder,i=o.data.SQExprConverter,v=o.data.SQExprGroupUtils,y=o.data.SQHierarchyExprUtils,(e=e.HierarchyUtils||(e.HierarchyUtils={})).getOptionsToAddHierarchyLevelToExistingHierarchies=function(s,e,l,t){if(l&&e&&m.isHierarchyLevel(t)){for(var p=t,u=p.arg,c=y.expandExpr(s,u),d=[],r=0,i=e.dataRoles;r<i.length;r++)!(function(e){var t=l.tryGetExprs(e.name);if(!t)return;for(var r,i=0,a=(m.isHierarchy(u)&&m.isPropertyVariationSource(u.arg)?(r=u.arg,_(v.groupExprs(s,t,{})).filter((function(e){return e.isHierarchyLevelsGroup&&m.isColumn(e.expr)&&m.equals(e.expr.source,r.arg)&&e.expr.ref===r.property}))):_(v.groupExprs(s,t,{})).filter((function(e){return m.equals(e.expr,u)}))).reverse().value();i<a.length;i++){var n=a[i],o=y.getInsertionIndex(c,n.children,p);d.push({expr:p,schema:s,targetRole:e.name,projOptions:{fieldIndex:n.selectQueryIndex+o}})}})(i[r]);return d}},e.getHierarchyReplacementExpressions=function(e,t,r,i,a,n){if(e=(e.singleVisual.query.tryGetExprs(t)||[]).slice(r,r+i),!_.isEmpty(e)){t=(_.isEmpty(n)?e:n)[0];if(m.isHierarchyLevel(t)){r=(function(e,t){if(e&&e.kind===o.VisualDataRoleKind.Measure){e=y.getHierarchySourceAsVariationSource(t);if(e)return s.columnRef(e.arg,e.property)}})(a,t);if(r)return[r]}return _.isEmpty(n)?e:n}},e.hierarchyLevelComparer=function(e,t){return m.isHierarchyLevel(e)&&m.isHierarchyLevel(t)&&m.equals(e.arg,t.arg)},e.findHierarchyLevelIndex=function(e,t){var r=i.asFieldPattern(t).hierarchyLevel;return r&&(t=e.findHierarchy(r.entity,r.name))?_.findIndex(t.levels,(function(e){return e.name===r.level})):void 0},e.sortHierarchies=function(e){_.isEmpty(e)||e.sort(t)}})(powerbi=powerbi||{}),(function(e){var t,g,p,f,n;function c(){}t=(t=e.explore||(e.explore={})).util||(t.util={}),g=e.data.DataViewMatrixUtils,p=e.data.DataViewSelectTransform,f=e.visuals.matrixRoleNames,n=e.data.SQExprUtils,c.generate=function(e,t,r,i,a,n){if(e.matrix){for(var o=[],s=[],l=[],p=[],u=e.matrix,c=0,d=t;c<d.length;c++){var m=d[c],m=__assign({},m);m.roles={},o.push(m)}var v=function(e){return!((!n||!n.featureSwitches.showGeneratedColumnsInDetailView)&&(e=t[e.index])&&_.isEmpty(e.roles)&&_.isEmpty(e.relatedSelects))},y=null==n?void 0:n.featureSwitches.comboMultiples,r=this.getSelectsGroupedByRowHierarchy(r,t,e.matrix,v),h=this.tryProcessDataViewHierarchy(u.rows,o,s,f.rows,r)&&this.tryProcessDataViewHierarchy(u.columns,o,l,f.columns,r,(function(e){return!e.isMeasure}))&&this.tryUpdateReferencedSelects(u.valueSources,o,p,f.values,r,v);if(h=y&&(u=_.last(u.rows.levels))?h&&this.tryUpdateReferencedSelects(g.getScopedValueSources(u),o,p,f.values,r,v):h)return u=e,this.sortMatrixRoleProjectionOrders(i,a,s,l,p,o),_.isEmpty(r)||(u=this.fixMeasuresGroupedByRowHierarchy(e,y,r)),v={},0<s.length&&(v[f.rows]=s),0<l.length&&(v[f.columns]=l),0<p.length&&(v[f.values]=p),{transformActions:{selects:o,roles:{ordering:v}},dataView:u}}},c.getSelectsGroupedByRowHierarchyFromMatrix=function(e,t){var r={},e=null==(e=null==e?void 0:e.rows)?void 0:e.levels;if(!_.isEmpty(e)){e=_.last(e),e=g.getScopedValueSources(e);if(!_.isEmpty(e))for(var i=0,a=e;i<a.length;i++){var n=a[i];_.isNumber(n.index)&&t(n)&&(r[n.index]=!0)}}return r},c.tryProcessDataViewHierarchy=function(e,t,r,i,a,n){if(e&&!_.isEmpty(e.levels))for(var o=0,s=e.levels;o<s.length;o++){var l=s[o];if(!this.tryUpdateReferencedSelects(l.sources,t,r,i,a,n))return!1}return!0},c.tryUpdateReferencedSelects=function(i,a,n,o,s,l){if(!_.isEmpty(i))for(var e=function(r){if(!l||l(r)){if(null==r.index&&_.some(i,(function(e){return e.formatSource&&e.formatSource.formatString===r})))return"continue";if(s[r.index]){if(!_.isEmpty(a[r.index].relatedSelects))for(var e=0,t=a[r.index].relatedSelects;e<t.length;e++)!(function(t){var e=_.findIndex(a,(function(e){return e.queryName===t.queryName}));s[e]||n.push(r.index)})(t[e])}else n.push(r.index);if(!a[r.index])return{value:!1};a[r.index].roles[o]=!0}},t=0,r=i;t<r.length;t++){var p=e(r[t]);if("object"==typeof p)return p.value}return!0},c.sortMatrixRoleProjectionOrders=function(e,t,r,i,a,n){var o,s,l;!_.isEmpty(e)&&t&&(o=2<=r.length,s=2<=i.length,l=2<=a.length,o||s||l)&&(e=this.createSelectIndexToSortOrderMappings(e,t))&&(o&&this.applySortOrder(r,e),s&&this.applySortOrder(i,e),l)&&(this.applySortOrder(a,e),(t={})[f.values]=a,p.reorderDependentSelects(n,t))},c.createSelectIndexToSortOrderMappings=function(e,t){e=_.chain(e).map((function(e){return t[e]})).flatten().filter((function(e){return _.isNumber(e)})).value(),e=_.reduce(e,(function(e,t,r){return void 0===e[t]&&(e[t]=r),e}),{});return 2<=Object.keys(e).length?e:void 0},c.applySortOrder=function(e,r){var i=this;e.sort((function(e,t){return i.getSortOrderOrDefault(e,r)-i.getSortOrderOrDefault(t,r)}))},c.getSortOrderOrDefault=function(e,t,r){return void 0===r&&(r=Number.MAX_VALUE),_.isNumber(t[e])?t[e]:r},c.fixMeasuresGroupedByRowHierarchy=function(e,t,r){e.matrix,e.matrix.columns;var i=e.matrix;return this.nothingToFix(r,i)?e:(i=_.cloneDeep(e),t?this.addMeasureValuesGroupedByRowHierarchy(i,r):(e.categorical,this.removeMeasuresGroupedByRowHierarchy(i.matrix,r),this.addMeasureValuesGroupedByRowHierarchyLegacy(i,r)),i)},c.nothingToFix=function(e,t){return _.isEmpty(Object.keys(e))||_.isEmpty(t.columns.root.children)||_.isEmpty(t.rows.root.children)},c.getSelectsGroupedByRowHierarchy=function(e,t,r,i){if(e&&1<e.length){(null==(a=e[0])?void 0:a.selects)&&null!=(a=e[1])&&a.selects;var a=this.categorizeSplitSelects(e[0],t);if(_.isEmpty(a.measureSelectIndices))return{};var n=this.categorizeSplitSelects(e[1],t);if(_.isEqual(a.groupingSelectIndices,n.groupingSelectIndices))return{};if(!_.isEmpty(n.measureSelectIndices))for(var o=_.map(_.keys(n.measureSelectIndices),(function(e){return t[parseInt(e,10)].queryName})),s=0;s<t.length;s++){var l=t[s];if(!_.isEmpty(l.relatedSelects))for(var p=0,u=l.relatedSelects;p<u.length;p++)!(function(t){null!=_.find(o,(function(e){return t.queryName===e}))&&(n.measureSelectIndices[s]=!0)})(u[p])}return n.measureSelectIndices}return c.getSelectsGroupedByRowHierarchyFromMatrix(r,i)},c.categorizeSplitSelects=function(e,t){var r,i={groupingSelectIndices:{},measureSelectIndices:{}};for(r in e.selects){var a=t[r];a.expr&&(n.isMeasure(a.expr)?i.measureSelectIndices[r]=!0:i.groupingSelectIndices[r]=!0)}return i},c.addMeasureValuesGroupedByRowHierarchy=function(e,t){e.matrix.columns.root.children;var r=e.matrix,i=r.columns.levels[0],a=[],n=_.last(r.rows.levels),o=r.valueSources.length,s=(n.valueSources,g.getScopedValueSources(n));if(s){for(var l=r.columns.root,p=this.getColumnLeavesCount(l),u=0;u<s.length;u++){var c=s[u];t[c.index]&&(c.formatSource&&delete c.formatSource,r.valueSources.push(c),this.addStaticMeasureColumnHeader(i,c,l),a.push(u))}g.forEachLeafNode(e.matrix.rows.root,(function(e){var t=p,r=g.getNodeScopedValues(e);if(!_.isEmpty(r))for(var i=0;i<a.length;i++)e.values[t++]={value:r[a[i]].value,valueSourceIndex:o+i}}))}},c.addMeasureValuesGroupedByRowHierarchyLegacy=function(e,t){e.matrix.columns.root.children;for(var r=e.matrix,i=r.columns.root,a=this.getColumnLeavesCount(i),n=r.columns.levels[0],o=0,s=r.valueSources;o<s.length;o++){var l=s[o];t[l.index]&&this.addStaticMeasureColumnHeader(n,l,i)}var p=this.getValuesForMeasuresGroupedByRowHierarchy(e,t),u=0;g.forEachLeafNode(e.matrix.rows.root,(function(e){var t,r=a;for(t in p){var i=p[t];e.values[r]={value:i[u],valueSourceIndex:parseInt(t,10)},r++}u++}))},c.getColumnLeavesCount=function(e){var t=0;return g.forEachLeafNode(e,(function(){return t++})),t},c.addStaticMeasureColumnHeader=function(e,t,r){e.sources.push(t);t={level:0,levelSourceIndex:e.sources.length-1};r.children.push(t)},c.getValuesForMeasuresGroupedByRowHierarchy=function(r,i){for(var a={},e=0,t=r.categorical.values;e<t.length;e++)!(function(t){var e;t.source&&i[t.source.index]&&(e=_.findIndex(r.matrix.valueSources,(function(e){return e.index===t.source.index})),a[e]=t.values)})(t[e]);return a},c.removeMeasuresGroupedByRowHierarchy=function(e,t){for(var r={},i=[],a=0;a<e.valueSources.length;a++){var n,o=e.valueSources[a];t[o.index]&&(r[a]=!0,i.push(o),o)&&o.formatSource&&o.formatSource.formatString&&(n=o.formatSource.formatString,r[e.valueSources.indexOf(n)]=!0,i.push(n),delete o.formatSource)}this.removeColumnHeaders(e.columns,r),e.valueSources=this.adjustIntersections(e.rows,r,e.valueSources);var s=_.last(e.columns.levels);s.sources=s.sources.filter((function(t){return!_.find(i,(function(e){return e===t}))}))},c.removeColumnHeaders=function(e,t){for(var r=0,i=g.getLeafNodesPath(e.root);r<i.length;r++){var a=i[r],a=a[a.length-2];a.children=_.filter(a.children,(function(e){return!t[e.levelSourceIndex||0]})),a.children&&null!=a.level&&1===a.children.length&&delete a.children}},c.adjustIntersections=function(e,o,t){var r,s;if(!_.isEmpty(e.root.children))return r=t.filter((function(e,t){return e&&!o[t]})),s=r.length,r.push.apply(r,t.filter((function(e,t){return e&&null!=e.index&&o[t]}))),g.forEachLeafNode(e.root,(function(e){var t,r={},i=0;for(t in e.values){var a,n=e.values[t];o[n.valueSourceIndex||0]||(0==(a=i%s)?delete n.valueSourceIndex:n.valueSourceIndex=a,r[i]=n,i++)}e.values=r})),r},t.MatrixVisualDataViewConverter=c})(powerbi=powerbi||{}),(function(e){var c,t,r;function d(e,t){this.federatedConceptualSchema=e,this.localizationService=t}e=(e=e.explore||(e.explore={})).util||(e.util={}),(t=c=e.NameValidationError||(e.NameValidationError={}))[t.None=0]="None",t[t.DuplicatedName=1]="DuplicatedName",e.createNameValidator=function(e,t){return new r(e,t)},d.prototype.validateExistingMeasureName=function(e){for(var t=d.normalizeModelItemName(e.name),r=0,i=this.federatedConceptualSchema.schemas;r<i.length;r++)for(var a=0,n=i[r].entities;a<n.length;a++)for(var o=n[a],s=0,l=o.properties;s<l.length;s++){var p,u=l[s];if(u!==e)if(d.normalizeModelItemName(u.name)===t)return p=u.measure?"NameValidationFailedCollisionMeasure":"NameValidationFailedCollisionColumn",{error:c.DuplicatedName,reason:this.localizationService.format(p,[u.name,o.name])}}return{error:c.None}},d.normalizeModelItemName=function(e){return jsCommon.StringExtensions.normalizeCase(e)},r=d})(powerbi=powerbi||{}),(function(e){var t,i,a,n,o,s;function r(e,t,r){e.capabilities,this.plugin=e,this.initialize(t,r)}function l(e,t,r,i){e=o.call(this,e,r,i)||this;return e.dataRoles=t,e}t=(t=e.explore||(e.explore={})).QueryProjectionBuilderCoreUtils||(t.QueryProjectionBuilderCoreUtils={}),i=e.data.QueryProjectionCollection,a=e.data.QueryProjectionsByRole,Object.defineProperty(r,"ValuesRoleName",{get:function(){return r.ValuesRole},enumerable:!1,configurable:!0}),r.getProjectionCollection=function(e,t){var r=a.getRole(e,t);return r||(e[t]=r=new i([])),r},r.addCategoryRole=function(e,t){r.getProjectionCollection(e,r.CategoryRole).addProjection(t.projection)},r.addValuesRole=function(e,t){r.getProjectionCollection(e,r.ValuesRole).addProjection(t.projection)},r.addSeriesRole=function(e,t){r.getProjectionCollection(e,r.SeriesRole).addProjection(t.projection)},r.addBreakdownRole=function(e,t){r.getProjectionCollection(e,r.BreakdownRole).addProjection(t.projection)},r.addGroupRole=function(e,t){r.getProjectionCollection(e,r.GroupRole).addProjection(t.projection)},r.addDetailsRole=function(e,t){r.getProjectionCollection(e,r.DetailsRole).addProjection(t.projection)},r.addYRole=function(e,t){r.getProjectionCollection(e,r.YRole).addProjection(t.projection)},r.addTargetValueRole=function(e,t){r.getProjectionCollection(e,r.TargetValueRole).addProjection(t.projection)},r.addMinValueRole=function(e,t){r.getProjectionCollection(e,r.MinValueRole).addProjection(t.projection)},r.addMaxValueRole=function(e,t){r.getProjectionCollection(e,r.MaxValueRole).addProjection(t.projection)},r.addXRole=function(e,t){r.getProjectionCollection(e,r.XRole).addProjection(t.projection)},r.addSizeRole=function(e,t){r.getProjectionCollection(e,r.SizeRole).addProjection(t.projection)},r.addGradientRole=function(e,t){r.getProjectionCollection(e,r.GradientRole).addProjection(t.projection)},r.addTooltipRole=function(e,t){r.getProjectionCollection(e,r.TooltipRole).addProjection(t.projection)},r.addRowsRole=function(e,t){r.getProjectionCollection(e,r.RowsRole).addProjection(t.projection)},r.addColumnsRole=function(e,t){r.getProjectionCollection(e,r.ColumnsRole).addProjection(t.projection)},r.prototype.initialize=function(e,t){var r=e.select();this.projectionsInfo=[];for(var i=0,a=r.length;i<a;i++){var n=r[i];this.projectionsInfo.push({projection:{queryRef:n.name},metadata:n.expr.getMetadata(t)})}},r.ValuesRole="Values",r.SeriesRole="Series",r.BreakdownRole="Breakdown",r.CategoryRole="Category",r.GroupRole="Group",r.DetailsRole="Details",r.YRole="Y",r.Y2Role="Y2",r.XRole="X",r.SizeRole="Size",r.GradientRole="Gradient",r.PlayRole="Play",r.RowsRole="Rows",r.ColumnsRole="Columns",r.MinValueRole="MinValue",r.MaxValueRole="MaxValue",r.TargetValueRole="TargetValue",r.TooltipRole="Tooltips",n=r,t.QueryProjectionBuilder=n,__extends(l,o=n),l.prototype.validatePlugin=function(){return!0},l.prototype.build=function(){for(var e={},t=0,r=this.dataRoles.length;t<r;t++){var i=this.dataRoles[t],a=this.projectionsInfo[i.Projection];a&&(n.getProjectionCollection(e,i.Name).addProjection(a.projection),i.isActive)&&e[i.Name].addActiveQueryReference(a.projection.queryRef)}return e},s=l,t.DataRolesQueryProjectionBuilder=s,t.createProjectionBuilderFromDataRoles=function(e,t,r,i){return new s(e,t,r,i)}})(powerbi=powerbi||{}),(function(e){var t,r,i,a,n;t=(t=e.explore||(e.explore={})).utils||(t.utils={}),a=jsCommon.Lazy,n=e.visuals.plugins,t=t.visualUtil||(t.visualUtil={}),r=new a(function(){var e={};return e[3]=n.card,e[13]=n.lineClusteredColumnComboChart,e[29]=n.multiRowCard,e[7]=n.clusteredBarChart,e[10]=n.clusteredColumnChart,e[20]=n.donutChart,e[16]=n.funnel,e[30]=n.gauge,e[22]=n.heatMap,e[9]=n.hundredPercentStackedBarChart,e[12]=n.hundredPercentStackedColumnChart,e[4]=n.lineChart,e[1]=n.map,e[19]=n.filledMap,e[2]=n.pivotTable,e[5]=n.pieChart,e[6]=n.scatterChart,e[8]=n.barChart,e[11]=n.columnChart,e[0]=n.tableEx,e[17]=n.treemap,e[23]=n.waterfallChart,e[26]=n.stackedAreaChart,e[32]=n.areaChart,e[33]=n.ribbonChart,e[34]=n.kpi,e[35]=n.decompositionTreeVisual,e}),i=new a(function(){var e={};return e[n.card.name]=3,e[n.lineClusteredColumnComboChart.name]=13,e[n.multiRowCard.name]=29,e[n.clusteredBarChart.name]=7,e[n.clusteredColumnChart.name]=10,e[n.donutChart.name]=20,e[n.funnel.name]=16,e[n.gauge.name]=30,e[n.heatMap.name]=22,e[n.hundredPercentStackedBarChart.name]=9,e[n.hundredPercentStackedColumnChart.name]=12,e[n.lineChart.name]=4,e[n.map.name]=1,e[n.filledMap.name]=19,e[n.matrix.name]=2,e[n.pivotTable.name]=2,e[n.pieChart.name]=5,e[n.scatterChart.name]=6,e[n.barChart.name]=8,e[n.columnChart.name]=11,e[n.table.name]=0,e[n.tableEx.name]=0,e[n.treemap.name]=17,e[n.waterfallChart.name]=23,e[n.stackedAreaChart.name]=26,e[n.areaChart.name]=32,e[n.ribbonChart.name]=33,e[n.kpi.name]=34,e[n.decompositionTreeVisual.name]=35,e}),t.getPlugin=function(e){return r.getValue()[e]},t.getType=function(e){return i.getValue()[e]}})(powerbi=powerbi||{}),(function(n){var e,i,t,l,o,a,s,p,u,c,d,m,v,y,h,g,f,C,x,S,b,E,N;function r(e,t,r){return i.call(this,e,t,r)||this}function V(e,t,r){return a.call(this,e,t,r)||this}function _(e,t,r){return p.call(this,e,t,r)||this}function w(e,t,r){return c.call(this,e,t,r)||this}function P(e,t,r){return m.call(this,e,t,r)||this}function T(e,t,r){return y.call(this,e,t,r)||this}function F(e,t,r){return g.call(this,e,t,r)||this}function j(e,t,r){return C.call(this,e,t,r)||this}function D(e,t,r){return S.call(this,e,t,r)||this}function R(e,t,r){return E.call(this,e,t,r)||this}e=(e=n.explore||(n.explore={})).utils||(e.utils={}),t=n.visuals.plugins,l=n.explore.QueryProjectionBuilderCoreUtils.QueryProjectionBuilder,(e.QueryProjectionBuilderUtils||(e.QueryProjectionBuilderUtils={})).createProjectionBuilder=function(e,t,r){var i,a=n.explore.utils.visualUtil.getPlugin(e);if(null!=a){switch(e){case 3:case 29:case 0:i=new o(a,t,r);break;case 2:i=new N(a,t,r);break;case 20:case 16:case 4:case 26:case 32:case 5:i=new s(a,t,r);break;case 23:i=new u(a,t,r);break;case 7:case 10:case 9:case 12:case 8:case 11:case 33:case 13:i=new d(a,t,r);break;case 1:case 22:i=new f(a,t,r);break;case 19:i=new x(a,t,r);break;case 17:i=new b(a,t,r);break;case 6:i=new h(a,t,r);break;case 30:i=new v(a,t,r);break;default:return}return i}},__extends(r,i=l),r.prototype.validatePlugin=function(){var e=this.plugin.capabilities.dataRoles;return 1===e.length&&e[0].name===l.ValuesRole},r.prototype.build=function(e){var t={};if(1===this.projectionsInfo.length)l.addValuesRole(t,this.projectionsInfo[0]);else for(var e=e.Primary.Groupings,r=e[0].Projections,i=0,a=r.length;i<a;i++)l.addValuesRole(t,this.projectionsInfo[r[i]]);return t},o=r,__extends(V,a=l),V.prototype.validatePlugin=function(){var e=this.plugin.capabilities.dataRoles;return this.plugin.name===t.funnel.name?4===e.length&&e[0].name===l.CategoryRole&&e[1].name===l.YRole&&e[2].name===l.GradientRole&&e[3].name===l.TooltipRole:this.plugin.name===t.lineChart.name?5===e.length&&e[0].name===l.CategoryRole&&e[1].name===l.SeriesRole&&e[2].name===l.YRole&&e[3].name===l.Y2Role&&e[4].name===l.TooltipRole:4===e.length&&e[0].name===l.CategoryRole&&e[1].name===l.SeriesRole&&e[2].name===l.YRole&&e[3].name===l.TooltipRole},V.prototype.build=function(e){var t=e.Primary.Groupings,r={};return this.processPrimaryGroup(t[0],r),e.Secondary&&1===(t=e.Secondary.Groupings).length&&this.processSecondaryGroup(t[0],r),r},V.prototype.processPrimaryGroup=function(e,t){for(var r=e.Projections,i=0,a=r.length;i<a;i++){var n=r[i],n=this.projectionsInfo[n];0===n.metadata.kind?(l.addCategoryRole(t,n),t[l.CategoryRole].addActiveQueryReference(n.projection.queryRef)):1===n.metadata.kind&&l.addYRole(t,n)}},V.prototype.processSecondaryGroup=function(e,t){for(var r=e.Projections,i=0,a=r.length;i<a;i++){var n=r[i];l.addSeriesRole(t,this.projectionsInfo[n])}},__extends(_,p=s=V),_.prototype.processSecondaryGroup=function(e,t){for(var r=e.Projections,i=0,a=r.length;i<a;i++){var n=r[i];l.addBreakdownRole(t,this.projectionsInfo[n])}},u=_,__extends(w,c=s),w.prototype.validatePlugin=function(){var e=this.plugin.capabilities.dataRoles;return this.plugin.name===t.ribbonChart.name?4===e.length&&e[0].name===l.CategoryRole&&e[1].name===l.SeriesRole&&e[2].name===l.YRole&&e[3].name===l.TooltipRole:5===e.length&&e[0].name===l.CategoryRole&&e[1].name===l.SeriesRole&&e[2].name===l.YRole&&e[3].name===l.GradientRole&&e[4].name===l.TooltipRole},d=w,__extends(P,m=s),P.prototype.validatePlugin=function(){var e=this.plugin.capabilities.dataRoles;return 5===e.length&&e[0].name===l.YRole&&e[1].name===l.MinValueRole&&e[2].name===l.MaxValueRole&&e[3].name===l.TargetValueRole&&e[4].name===l.TooltipRole},P.prototype.processPrimaryGroup=function(e,t){for(var e=e.Projections,r=0,i=this,a=0,n=e;a<n.length;a++){var o=n[a],s=(s=void 0,i.projectionsInfo[o]);if(1===s.metadata.kind){switch(r){case 0:l.addYRole(t,s);break;case 1:l.addTargetValueRole(t,s);break;case 2:l.addMaxValueRole(t,s);break;case 3:l.addMinValueRole(t,s);break;case 4:l.addTooltipRole(t,s)}r++}}},v=P,__extends(T,y=s),T.prototype.validatePlugin=function(){var e=this.plugin.capabilities.dataRoles;return 8===e.length&&e[0].name===l.CategoryRole&&e[1].name===l.SeriesRole&&e[2].name===l.XRole&&e[3].name===l.YRole&&e[4].name===l.SizeRole&&e[5].name===l.GradientRole&&e[6].name===l.PlayRole&&e[7].name===l.TooltipRole},T.prototype.processPrimaryGroup=function(e,t){for(var r=e.Projections,i=0,a=0,n=r.length;a<n;a++){var o=r[a],s=this.projectionsInfo[o];if(0===s.metadata.kind)l.addCategoryRole(t,s);else if(1===s.metadata.kind){switch(i){case 0:l.addXRole(t,s);break;case 1:l.addYRole(t,s);break;case 2:l.addSizeRole(t,s);break;case 3:l.addGradientRole(t,s);break;case 4:l.addTooltipRole(t,s)}i++}}},h=T,__extends(F,g=s),F.prototype.validatePlugin=function(){var e=this.plugin.capabilities.dataRoles;return 7===e.length&&e[0].name===l.CategoryRole&&e[1].name===l.SeriesRole&&e[2].name===l.YRole&&e[3].name===l.XRole&&e[4].name===l.SizeRole&&e[5].name===l.GradientRole&&e[6].name===l.TooltipRole},F.prototype.processPrimaryGroup=function(e,t){for(var e=e.Projections,r=0,i=this,a=0,n=e;a<n.length;a++){var o=n[a],s=(s=void 0,i.projectionsInfo[o]);if(0===s.metadata.kind)l.addCategoryRole(t,s);else if(1===s.metadata.kind){switch(r){case 0:l.addSizeRole(t,s);break;case 1:l.addXRole(t,s);break;case 2:l.addYRole(t,s);break;case 3:l.addGradientRole(t,s);break;case 4:l.addTooltipRole(t,s)}r++}}},f=F,__extends(j,C=s),j.prototype.validatePlugin=function(){var e=this.plugin.capabilities.dataRoles;return 6===e.length&&e[0].name===l.CategoryRole&&e[1].name===l.SeriesRole&&e[2].name===l.YRole&&e[3].name===l.XRole&&e[4].name===l.SizeRole&&e[5].name===l.TooltipRole},j.prototype.processPrimaryGroup=function(e,t){for(var e=e.Projections,r=0,i=this,a=0,n=e;a<n.length;a++){var o=n[a],s=(s=void 0,i.projectionsInfo[o]);if(0===s.metadata.kind)l.addCategoryRole(t,s);else if(1===s.metadata.kind){switch(r){case 0:l.addSizeRole(t,s);break;case 1:l.addXRole(t,s);break;case 2:l.addYRole(t,s);break;case 3:l.addTooltipRole(t,s)}r++}}},x=j,__extends(D,S=s),D.prototype.validatePlugin=function(){var e=this.plugin.capabilities.dataRoles;return 5===e.length&&e[0].name===l.GroupRole&&e[1].name===l.DetailsRole&&e[2].name===l.ValuesRole&&e[3].name===l.GradientRole&&e[4].name===l.TooltipRole},D.prototype.processPrimaryGroup=function(e,t){for(var r=e.Projections,i=0,a=r.length;i<a;i++){var n=r[i],n=this.projectionsInfo[n];0===n.metadata.kind?(l.addGroupRole(t,n),t[l.GroupRole].addActiveQueryReference(n.projection.queryRef)):1===n.metadata.kind&&l.addValuesRole(t,n)}},D.prototype.processSecondaryGroup=function(e,t){for(var r=e.Projections,i=0,a=r.length;i<a;i++){var n=r[i];l.addDetailsRole(t,this.projectionsInfo[n])}},b=D,__extends(R,E=l),R.prototype.validatePlugin=function(){var e=this.plugin.capabilities.dataRoles;return 3===e.length&&e[0].name===l.RowsRole&&e[1].name===l.ColumnsRole&&e[2].name===l.ValuesRole},R.prototype.build=function(e){var t=e.Primary.Groupings,r={};return this.processPrimaryGroups(t,r),e.Secondary&&(t=e.Secondary.Groupings,this.processSecondaryGroups(t,r)),r},R.prototype.processPrimaryGroups=function(e,t){if(e)for(var r=0,i=e.length;r<i;r++)this.processPrimaryGroup(e[r],t)},R.prototype.processSecondaryGroups=function(e,t){if(e)for(var r=0,i=e.length;r<i;r++)this.processSecondaryGroup(e[r],t)},R.prototype.processPrimaryGroup=function(e,t){for(var r=e.Projections,i=0,a=r.length;i<a;i++){r[i];var n=this.projectionsInfo[r[i]];0===n.metadata.kind?(l.addRowsRole(t,n),t[l.RowsRole].addActiveQueryReference(n.projection.queryRef)):1===n.metadata.kind&&l.addValuesRole(t,n)}},R.prototype.processSecondaryGroup=function(e,t){for(var r=e.Projections,i=0,a=r.length;i<a;i++){var n=this.projectionsInfo[r[i]];l.addColumnsRole(t,n),t[l.ColumnsRole].addActiveQueryReference(n.projection.queryRef)}},N=R})(powerbi=powerbi||{}),(function(e){var r,t,n,o;function a(i,a,n,o,s){return __awaiter(this,void 0,e.Promise,(function(){var t,r;return __generator(this,(function(e){switch(e.label){case 0:return(t=s?u(i,a,0,0):l(i,a),s||t)?[4,o.get(i.reportId,t.name)]:[2];case 1:return r=e.sent(),r=r&&r.words,_.isEmpty(r)?r=[n]:r[0]=n,[4,o.set(i.reportId,t.name,r)];case 2:return e.sent(),[2]}}))}))}function p(e,t){return e&&e.pods?_.findIndex(e.pods,(function(e){return e.boundSection===t})):-1}function l(e,t){t=p(e,t);if(-1!==t)return e.pods[t]}function s(e,t){return e&&e.parameters?_.findIndex(e.parameters,(function(e){return e.boundFilter===t})):-1}function u(e,t,r,i){var a=l(e,t);return a||c(e,t,r,i)}function c(e,t,r,i){e.pods||(e.pods=[]);t={name:(function(e){for(var t={},r=0,i=e;r<i.length;r++){var a=i[r];t[a.name]=!0}return n.findUniqueName(t,o)})(e.pods),boundSection:t,parameters:[],type:0,referenceScope:r,config:{acceptsFilterContext:i}};return e.pods.push(t),t}function d(t,r,e,i){var a=t.pods[r];_.isEmpty(a.parameters)&&(a.type=0),!a.cortanaEnabled&&_.isEmpty(a.parameters)&&0===a.config.acceptsFilterContext&&0===a.referenceScope&&(i?e.get(t.reportId,a.name).then((function(e){e&&!_.isEmpty(e.words)||m(t,r)})):m(t,r))}function m(e,t){e.pods.splice(t,1),0===e.pods.length&&(e.pods=void 0)}r=e.explore||(e.explore={}),t=r.PodUtils||(r.PodUtils={}),n=jsCommon.StringExtensions,o="Pod",t.getLinguisticMetadata=function(e,t,r,i){var a=i.defer();return-1===(i=p(e,t))?a.resolve(void 0):r.get(e.reportId,e.pods[i].name).then((function(e){e=e&&e.words.slice();_.isEmpty(e)?a.resolve(void 0):(e.shift(),a.resolve({altNames:e}))})),a.promise},t.deleteLinguisticEntity=function(r,i,a){return __awaiter(this,void 0,e.Promise,(function(){var t;return __generator(this,(function(e){switch(e.label){case 0:return-1<(t=p(r,i))?[4,a.set(r.reportId,r.pods[t].name,[])]:[3,2];case 1:e.sent(),d(r,t,a,!1),e.label=2;case 2:return[2]}}))}))},t.deletePod=function(r,i,a){return __awaiter(this,void 0,e.Promise,(function(){var t;return __generator(this,(function(e){switch(e.label){case 0:return-1<(t=p(r,i))?[4,a.set(r.reportId,r.pods[t].name,[])]:[3,2];case 1:e.sent(),m(r,t),e.label=2;case 2:return[2]}}))}))},t.ensurePod=function(t,r,i){return __awaiter(this,void 0,e.Promise,(function(){return __generator(this,(function(e){switch(e.label){case 0:return[4,a(t,r.name,r.displayName,i,!0)];case 1:return e.sent(),[2]}}))}))},t.updateLinguisticPrimaryName=a,t.updateLinguisticAltNames=function(r,i,a,n){return __awaiter(this,void 0,e.Promise,(function(){var t;return __generator(this,(function(e){switch(e.label){case 0:return t=u(r,i.name,0,0),a.unshift(i.displayName),[4,n.set(r.reportId,t.name,a)];case 1:return e.sent(),[2]}}))}))},t.addParameter=function(e,t,r,i,a,n,o){(e=u(e,t,0,0)).parameters||(e.parameters=[]),t={name:"Param_"+r,boundFilter:r,fieldExpr:i,asAggregation:a,isLegacySingleSelection:n},e.parameters.push(t),null!=e.type&&0!==e.type||0===o||(e.type=o)},t.deleteParameter=function(e,t,r,i){var a;-1<(t=p(e,t))&&-1<(r=s(a=e.pods[t],r))&&(a.parameters.splice(r,1),d(e,t,i,!0))},t.updateParameter=function(e,t,r,i){-1<(t=p(e,t))&&-1<(t=s(e=e.pods[t],r))&&(e.parameters[t].asAggregation=i)},t.hasParameter=function(e,t,r){return-1!==(t=p(e,t))&&-1!==s(e.pods[t],r)},t.setCortanaEnabled=function(e,t,r,i){var a,n=p(e,t);-1===n&&!r||(-1===n?(a=c(e,t,0,0),n=e.pods.length-1):a=e.pods[n],a.cortanaEnabled=r,d(e,n,i,!0))},t.findPodIndexForPodName=function(e,t){if(e&&e.pods)return e=e.pods,-1!==(e=_.findIndex(e,(function(e){return e.name===t})))?e:void 0},t.duplicatePod=function(e,t,r,i,a){var n,o,s,l;return-1===(r=p(e,e.sections[r].name))?a.resolve():(r=void 0!==(a=e.pods[r]).config?a.config.acceptsFilterContext:0,(r=c(e,t.name,a.referenceScope,r)).cortanaEnabled=a.cortanaEnabled,r.parameters=_.cloneDeep(a.parameters),r.type=a.type,n=e.reportId,o=t,s=r,(l=i).get(n,a.name).then((function(e){e=e&&e.words.slice();_.isEmpty(e)||(e.shift(),e.unshift(o.displayName),l.set(n,s.name,e))})))},t.findPodIndexForSectionName=p,t.findPodForSectionName=l,t.updateConfig=function(e,t,r){var i=l(e,t);(i=i||0===r?i:c(e,t,0,r))&&(null==i.config?i.config={acceptsFilterContext:r}:i.config.acceptsFilterContext!==r&&(i.config.acceptsFilterContext=r))},t.updateReferenceScope=function(e,t,r){var i=l(e,t);(i=i||0===r?i:c(e,t,r,0))&&null!=r&&i.referenceScope!==r&&(i.referenceScope=r)},t.acceptsAllFiltersWhenLinked=function(e,t){return!(e&&t&&(e=l(e,t.name))&&e.config&&0!==e.config.acceptsFilterContext)},t.hasMeasureOrAsAggregation=function(e,t){return!!(e&&t&&(e=l(e,t.name))&&e.config)&&r.DrillthroughUtils.hasMeasureOrAsAggregationPodParameter(e.type,e.parameters)},t.acceptsCrossReportDrillthrough=function(e,t){return!(!e||!t||!(e=l(e,t.name))||1!==e.referenceScope)},t.determineReferenceScope=function(e){return e?1:0},t.determineAcceptsFilterContextKind=function(e){return e?0:1},t.determineType=function(e,t){return!(t||0!==e.type&&null!=e.type)||t&&2===e.type?1:1===e.type?2:0},t.isLinkedAsAggregation=function(e,t,r){return!(!e||!t||!(e=l(e,t.name))||_.isEmpty(e.parameters)||-1===(t=s(e,r.name)))&&e.parameters[t].asAggregation},t.isPodEnabled=function(e,t){return t&&1===t.scopeType&&r.FilterUtils.isCategoricalFilter(e.type)&&!e.isTransient},t.updateType=function(e,t,r){-1!==(t=p(e,t))&&(e=e.pods[t],_.isEmpty(e.parameters)&&(e.type=0),e.type=r)}})(powerbi=powerbi||{}),(function(a){var e,t,r,n,i,o,s,l,p,u;function c(e,t){e=i.asFieldPattern(e);return e.columnHierarchyLevelVariation&&e.columnHierarchyLevelVariation.source.entity===t.entity&&e.columnHierarchyLevelVariation.source.schema===t.schema&&e.columnHierarchyLevelVariation.source.name===t.property&&e.columnHierarchyLevelVariation.variationName===t.name}function d(e){var t=this;return(t=s.call(this)||this).change=e,t}function m(e){this.exprRewriter=e}function v(e,t){this.exprRewriter=e,this.change=t}e=(e=a.explore||(a.explore={})).schemaRewriterUtils||(e.schemaRewriterUtils={}),t=a.data.SQColumnRefExpr,r=a.data.SQEntityExpr,n=a.data.SQExpr,i=a.data.SQExprConverter,o=a.data.SQExprRewriter,e.createSchemaChangeRewriters=function(e){for(var r=[],t=0,i=e;t<i.length;t++)!(function(t){t.measureMove&&r.push(new p(a.data.createMoveMeasureRewriter(t.measureMove))),t.entityRename&&r.push(new p(a.data.createEntityRenameRewriter(t.entityRename))),t.propertyRename&&r.push(new p(a.data.createPropertyRenameRewriter(t.propertyRename))),t.hierarchyLevelRename&&r.push(new p(a.data.createHierarchyLevelRenameRewriter(t.hierarchyLevelRename))),t.removeVariation&&r.push(new u(new l(t.removeVariation),t.removeVariation)),t.newMeasureCreated&&_.find(e,(function(e){return e.itemDelete&&e.itemDelete.property===t.newMeasureCreated.name&&e.itemDelete.entity===t.newMeasureCreated.entity&&e.itemDelete.schema!==t.newMeasureCreated.schema}))&&r.push(new p(a.data.createSetSchemaMeasureRewriter(t.newMeasureCreated)))})(i[t]);return r},__extends(d,s=o),d.prototype.visitHierarchyLevel=function(e){return c(e,this.change)?new t(new r(this.change.schema,this.change.entity),this.change.property):e},l=d,m.prototype.rewriteQuery=function(e){var t=this,r=(r=e.defn).rewrite(this.exprRewriter),r=(e.defn=r,e.expansionStates=_.map(e.expansionStates,(function(e){return e.rewrite(t.exprRewriter)})),e.getQueryFieldParameters());if(!_.isEmpty(r))for(var i=0,a=r;i<a.length;i++){var n=a[i];n.expr=n.expr.accept(this.exprRewriter)}return e},m.prototype.rewriteFilter=function(e){return e.rewrite(this.exprRewriter)},m.prototype.rewriteExpr=function(e){return e.accept(this.exprRewriter)},p=m,e.VisualQueryExprRewriter=p,v.prototype.rewriteQuery=function(e){var t=this;this.removeDuplicateSQHierarchyLevelExpr(e);var r=(r=e.defn).rewrite(this.exprRewriter);return e.defn=r,e.expansionStates=_.map(e.expansionStates,(function(e){return e.rewrite(t.exprRewriter)})),e},v.prototype.rewriteFilter=function(e){return e.rewrite(this.exprRewriter)},v.prototype.rewriteExpr=function(e){return e.accept(this.exprRewriter)},v.prototype.removeDuplicateSQHierarchyLevelExpr=function(e){for(var t=e.defn.select(),r=0;r<t.length;){var i=t[r];if(r++,n.isHierarchyLevel(i.expr)&&c(i.expr,this.change))for(;r<t.length&&n.isHierarchyLevel(t[r].expr)&&n.equals(i.expr.arg,t[r].expr.arg);)e.removeExpr(t[r].expr,!1),r++}},u=v})(powerbi=powerbi||{}),(function(e){function p(e,t){var r=[];if(e&&e.visualContainers)for(var i=0,a=e.visualContainers;i<a.length;i++){var n=a[i];t.addScriptVisualInfo(n,r)}return r}(e=(e=(e=e.explore||(e.explore={})).util||(e.util={})).ScriptVisualsUtil||(e.ScriptVisualsUtil={})).defaultScript="##############################",e.getScriptVisualIdsInSection=p,e.getVisualStatsInExploration=function(e,t){var r={totalVisualsCount:0,info:[]};if(e&&e.sections)for(var i=0,a=e.sections;i<a.length;i++){var n,o=a[i];o.visualContainers&&(n=p(o,t),r.info=r.info.concat(n),r.totalVisualsCount+=o.visualContainers.length)}return r},e.getScriptVisualIds=function(e,t,r,i,a){var n=[];switch(e){case 0:if(!i)return n;a.addScriptVisualInfo(i,n);break;case 1:n=p(r,a);break;case 2:if(!t)return n;for(var o=0,s=t.sections;o<s.length;o++)var l=p(s[o],a),n=n.concat(l);break;default:return n}return n},e.visualContainerHasScriptVisuals=function(e,t){for(var r=0,i=e;r<i.length;r++){var a=i[r];if(a&&a.config&&a.config.singleVisual){a=a.config.singleVisual.visualType;if(a&&t.isScriptVisual(a))return!0}}return!1},e.confirmRefreshForRDataSource=function(e,t,r,i,a,n){var o=e.control(),e=t.get("SettingsDataset_RDataSource_RefreshConfirmationDialog_OkButton"),s=t.get("SettingsDataset_RDataSource_RefreshConfirmationDialog_CancelButton"),e=[new InJs.ModalDialogAction(e,function(){o.hideDialog(),a()}),new InJs.ModalDialogAction(s,function(){o.hideDialog(),n()})],s=t.get("SettingsDataset_RDataSource_RefreshConfirmationDialog_Title"),l=t.get("SettingsDataset_RDataSource_RefreshConfirmationDialog_WarningMessage"),t="<div><span>"+t.get("SettingsDataset_RDataSource_RefreshConfirmationDialog_ActionMessagePart1")+' </span><a href= "https://go.microsoft.com/fwlink/?LinkId=821887" target= "_blank">'+t.get("SettingsDataset_RDataSource_RefreshConfirmationDialog_ActionMessageLink1")+"</a><span> "+t.get("SettingsDataset_RDataSource_RefreshConfirmationDialog_ActionMessagePart2")+"</span><br/><span>"+t.get("SettingsDataset_RDataSource_RefreshConfirmationDialog_ActionMessagePart3")+' </span><a href= "https://go.microsoft.com/fwlink/?LinkId=821886" target= "_blank">'+t.get("SettingsDataset_RDataSource_RefreshConfirmationDialog_ActionMessageLink2")+"</a></div>",s=(i.message=l,{dialogName:s,isDismissable:!1,scope:i,template:"<custom-modal-dialog></custom-modal-dialog>",dialogCssClass:"customModalDialog",dialogActions:e,notificationType:jsCommon.ModalDialogNotificationType.SecurityWarning,notificationText:l,htmlMessageText:t,focusOnFirstButton:!1,noActiveButtons:!0,flipContentAndNotificationOrder:!0});r.showLegacyWebModalDialog(s)},e.getScriptVisualType=function(e){switch(e){case"scriptVisual":return 0;case"pythonVisual":return 1;default:return null}},e.getScriptVisualTypeName=function(e){switch(e){case 0:return"scriptVisual";case 1:return"pythonVisual";default:return null}}})(powerbi=powerbi||{}),(function(e){var a,t,e=(e=e.explore||(e.explore={})).utils||(e.utils={}),r=(Object.defineProperty(i.prototype,"position",{get:function(){},set:function(e){},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"max",{get:function(){},enumerable:!1,configurable:!0}),i.prototype.scrollItemIntoView=function(e,t,r){var i,a=this.getContainer(),a=this.getRange(a),n=this.getItems(),o=n[e];o&&(i=0===e,e=e===n.length-1,n=this.getRange($(o),!0),i?t=0:e?t=r||0:null==t&&(t=this.getDefaultOverscroll()),a)&&n&&(o=this.calculatePositionDelta(a,n,t),this.position=this.position+o)},i.prototype.getPageDownItemIndex=function(e){var t=this.getRange(this.getContainer());if(t){var r=this.getItems();if(0===r.length)return-1;for(var i=0,a=e;a<r.length-1;a++)if((i+=this.getRange(r.eq(a)).size)>t.size)return a;return r.length-1}return-1},i.prototype.getPageUpItemIndex=function(e){var t=this.getRange(this.getContainer());if(t){var r=this.getItems();if(0===r.length)return-1;for(var i=0,a=e;0<a;a--)if((i+=this.getRange(r.eq(a)).size)>t.size)return a;return 0}return-1},i.prototype.retainPosition=function(e){var t=this.position;try{e()}finally{this.position=t}},i.prototype.handleKeyDown=function(e,t,r){var i=!0,a=e,n=this.getItems().length-1;switch(t.keyCode){case $.ui.keyCode.PAGE_UP:var o=this.getPageUpItemIndex(e),a=Math.max(o,0);break;case $.ui.keyCode.PAGE_DOWN:o=this.getPageDownItemIndex(e);a=Math.min(o,n);break;case $.ui.keyCode.END:a=n;break;case $.ui.keyCode.HOME:a=0;break;default:i=void 0!==(a=this.getNewIndexOnKeyDown(e,n,t))}return void 0!==a&&a!==e&&(r(a),this.scrollItemIntoView(a)),i},i.prototype.onScroll=function(t){var r=this;this.getContainer().scroll((function(){var e=r.position/r.max;t(e)}))},i.prototype.getNewIndexOnKeyDown=function(e,t,r){},i.prototype.getRange=function(e,t){void 0===t&&(t=!1)},i.prototype.getDefaultOverscroll=function(){},i.prototype.getContainer=function(){return $(this.containerSelector)},i.prototype.getItems=function(){return this.retrieveItems()},i.prototype.retrieveItems=function(){return this.includeDescendants?this.getContainer().find(this.itemsSelector):this.getContainer().children(this.itemsSelector)},i.prototype.calculatePositionDelta=function(e,t,r){return t.min<e.min?-(e.min-t.min+r):t.max>e.max?t.max-e.max+r:0},i);function i(e,t,r){void 0===r&&(r=!0),this.containerSelector=e,this.itemsSelector=t,this.includeDescendants=r}function n(){return null!==t&&t.apply(this,arguments)||this}function o(e,t,r,i){void 0===r&&(r=!1);e=a.call(this,e,t,i=void 0===i?!0:i)||this;return e.isRtl=r,e}function s(e,t,r){var i=this;this.lastScrollLeft=0,this.lastScrollTop=0,this.scrollPanel=e,this.syncedPanel=t,this.syncOptions=r,this.onScroll=this.onScroll.bind(this),jsCommon.Zone.runOutsideAngular((function(){i.scrollPanel.addEventListener("scroll",i.onScroll)}))}e.BaseScrollHelper=r,__extends(n,t=r),Object.defineProperty(n.prototype,"position",{get:function(){return this.getContainer().scrollTop()},set:function(e){var t=this.getContainer();t.scrollTop()!==e&&t.scrollTop(e)},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"max",{get:function(){var e=this.getContainer()[0];return e?e.scrollHeight:void 0},enumerable:!1,configurable:!0}),n.prototype.getNewIndexOnKeyDown=function(e,t,r){switch(r.keyCode){case $.ui.keyCode.UP:return r.scrollHandled=!0,Math.min(Math.max(e-1,0),t);case $.ui.keyCode.DOWN:return Math.min(e+1,t)}},n.prototype.getRange=function(e,t){void 0===t&&(t=!1);var r=e.offset();return r?(t=t?e.outerHeight():e.innerHeight(),{min:r.top,max:r.top+t,size:t}):null},n.prototype.getDefaultOverscroll=function(){return 0},e.VerticalScrollHelper=n,__extends(o,a=r),Object.defineProperty(o.prototype,"position",{get:function(){return this.getContainer().scrollLeft()},set:function(e){var t=this.getContainer();t.scrollLeft()!==e&&t.scrollLeft(e)},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"max",{get:function(){var e=this.getContainer()[0];return e?e.scrollWidth:void 0},enumerable:!1,configurable:!0}),o.prototype.getNewIndexOnKeyDown=function(e,t,r){var i=0;switch(r.keyCode){case $.ui.keyCode.LEFT:i=-1;break;case $.ui.keyCode.RIGHT:i=1}if(0!==(i=this.isRtl?-i:i))return e=t<(e=(e+=i)<0?0:e)?t:e},o.prototype.getRange=function(e,t){void 0===t&&(t=!1);var r=e.offset();return r?(t=t?e.outerWidth():e.innerWidth(),{min:r.left,max:r.left+t,size:t}):null},o.prototype.getDefaultOverscroll=function(){return 16},o.prototype.calculatePositionDelta=function(e,t,r){e=a.prototype.calculatePositionDelta.call(this,e,t,r);return this.isRtl?-e:e},e.HorizontalScrollHelper=o,s.prototype.dispose=function(){this.scrollPanel.removeEventListener("scroll",this.onScroll)},s.prototype.onScroll=function(){var e=this;this.syncOptions.syncDelay?(clearTimeout(this.timeoutId),this.timeoutId=setTimeout((function(){e.syncScrollPositions()}),this.syncOptions.syncDelay)):this.syncScrollPositions()},s.prototype.syncScrollPositions=function(){var e;this.syncOptions.syncX&&(e=this.scrollPanel.scrollLeft)!==this.lastScrollLeft&&(this.syncedPanel.scrollLeft=e,this.lastScrollLeft=e),this.syncOptions.syncY&&(e=this.scrollPanel.scrollTop)!==this.lastScrollTop&&(this.syncedPanel.scrollTop=e,this.lastScrollTop=e)},e.ScrollSyncHelper=s})(powerbi=powerbi||{}),(function(e){var s,l;function t(e,t,r,i,a,n,o){void 0===i&&(i=!0),this._hasFocus=!1,this.selection=s.createTreeSelectionManager(e,a),this.scrollHelper=null!=o?o:new s.VerticalScrollHelper(t,r,!0),this.getVisibleNodes=e,this.allowMultiSelect=i,this.onFocusedItemChanged=null!=n?n:_.noop}e=e.explore||(e.explore={}),s=e.utils||(e.utils={}),l=jsCommon.BrowserUtils,t.prototype.hasFocus=function(){return this._hasFocus},t.prototype.onNodeClick=function(e,t){var r=t.shiftKey,i=l.isCtrlOrMeta(t);r&&i?this.shiftSelect(e):r?(this.selection.clear(),this.shiftSelect(e)):i?this.selection.toggle(e):_.isEqual(this.selection.getSelectedItems(),[e])||(this.selection.clear(),this.selection.select(e)),r||(this.shiftSelectionStartNode=e),this.focus(e),t.preventDefault(),t.stopPropagation()},t.prototype.onBackgroundClick=function(e){this.selection.clear(),e.stopPropagation()},t.prototype.onFocus=function(){this.focus(this.getFocusedNode()||this.getVisibleNodes()[0]),this._hasFocus=!0},t.prototype.onBlur=function(){this.getVisibleNodes().map((function(e){return e.isFocused=!1})),this._hasFocus=!1,this.onFocusedItemChanged(void 0)},t.prototype.onKeyDown=function(e){var t,r,i=this,a=e.shiftKey,n=l.isCtrlOrMeta(e),o=!1,s=this.lastFocusedNode;n&&"KeyA"===e.code&&this.allowMultiSelect?(this.selection.selectAll(),o=!0):"Escape"===e.code?(this.selection.clear(),o=!0):"Space"===e.code&&s?(n&&a?this.shiftSelectionStartNode&&(r=this.getVisibleNodes(),r=this.getNodesInRange(r,this.shiftSelectionStartNode,s),this.selection.selectRange(r)):n?this.selection.toggle(s):this.selection.select(s),o=!0):"ArrowLeft"===e.code&&s?(s.isExpanded?this.setExpandValue(s,!1):s.parent&&(r=s.parent,this.selectAndScrollTo([r]),this.focus(r)),o=!0):"ArrowRight"===e.code&&s?(_.isEmpty(s.children)||(s.isExpanded?(r=s.children[0],this.selectAndScrollTo([r]),this.focus(r)):this.setExpandValue(s,!0)),o=!0):s&&(t=this.getVisibleNodes(),o=!0,0<=(r=t.indexOf(s)))&&(o=this.scrollHelper.handleKeyDown(r,e,(function(e){e=t[e];i.allowMultiSelect?a&&n?i.shiftSelect(e):a?(i.selection.clear(),i.shiftSelect(e)):n||(i.selection.clear(),i.selection.select(e)):(i.selection.clear(),i.selection.select(e)),a||(i.shiftSelectionStartNode=e),i.focus(e)}))),o&&(e.stopPropagation(),e.preventDefault())},t.prototype.toggleExpandCollapse=function(e,t){this.setExpandValue(e,!e.isExpanded),t&&t.stopPropagation()},t.prototype.selectAndScrollTo=function(t){var r=this;this.selection.clear(),this.selection.selectRange(t),requestAnimationFrame((function(){var e=r.getVisibleNodes().indexOf(t[0]);r.scrollHelper.scrollItemIntoView(e,30)}))},t.prototype.syncManagedNodes=function(e){var t=this,r=(this.hasNode(e,this.shiftSelectionStartNode)||(this.shiftSelectionStartNode=void 0),this.hasNode(e,this.lastFocusedNode)||(this.lastFocusedNode=void 0),this.selection.clear(),[]);_.forEach(e,(function(e){t.collectSelectedNodes(e,r)})),_.forEach(r,(function(e){e.isSelected=!1})),this.selection.selectRange(r)},t.prototype.shiftSelect=function(e){var t=this.getVisibleNodes(),r=null!=(r=this.shiftSelectionStartNode)?r:_.first(t);this.selection.selectRange(this.getNodesInRange(t,r,e))},t.prototype.collectSelectedNodes=function(e,t){var r=this;e&&(e.isSelected&&t.push(e),_.forEach(e.children,(function(e){r.collectSelectedNodes(e,t)})))},t.prototype.hasNode=function(e,t){for(var r=0,i=null!=e?e:[];r<i.length;r++){var a=i[r];if(a===t)return!0;if(this.hasNode(a.children,t))return!0}return!1},t.prototype.getNodesInRange=function(e,t,r){var t=e.indexOf(t),r=e.indexOf(r),i=Math.min(t,r),a=Math.max(t,r);if(-1<i)for(var n=[],o=i;o<=a;o++)n.push(e[o]);return n},t.prototype.focus=function(e){e&&(this.getVisibleNodes().map((function(e){return e.isFocused=!1})),e.isFocused=!0,this.lastFocusedNode=e,this.onFocusedItemChanged(e))},t.prototype.getFocusedNode=function(){var e=this.getVisibleNodes(),t=_.find(e,(function(e){return e.isSelected}));return null!=t?t:_.find(e,(function(e){return e.isFocused}))},t.prototype.setExpandValue=function(e,t){e.isExpanded!==t&&(e.isExpanded=t,e.isExpanded||(null==(t=this.shiftSelectionStartNode)?void 0:t.parent)!==e||(this.shiftSelectionStartNode=e))},s.TreeHelper=t})(powerbi=powerbi||{}),(function(e){var r;function t(e,t){this.selectedItems=[],this.getItems=e,this.onSelectionChanged=null!=t?t:_.noop}((e=e.explore||(e.explore={})).utils||(e.utils={})).createTreeSelectionManager=function(e,t){return new r(e,t)},Object.defineProperty(t.prototype,"lastSelected",{get:function(){return _.last(this.selectedItems)},enumerable:!1,configurable:!0}),t.prototype.getSelectedItems=function(){return __spreadArray([],this.selectedItems||[],!0)},t.prototype.select=function(e){this.selectInternal(e)&&this.onSelectionChanged(this.selectedItems)},t.prototype.selectRange=function(e){for(var t=!1,r=0,i=e;r<i.length;r++)var a=i[r],t=this.selectInternal(a)||t;t&&this.onSelectionChanged(this.selectedItems)},t.prototype.selectAll=function(){this.selectRange(this.getItems())},t.prototype.toggle=function(e){e.isSelected?(e.isSelected=!1,this.selectedItems.splice(this.selectedItems.indexOf(e),1)):(e.isSelected=!0,this.selectedItems.push(e)),this.onSelectionChanged(this.selectedItems)},t.prototype.clear=function(){for(var e=!_.isEmpty(this.selectedItems),t=0,r=this.selectedItems;t<r.length;t++)r[t].isSelected=!1;this.selectedItems.splice(0),e&&this.onSelectionChanged([])},t.prototype.selectInternal=function(e){return!e.isSelected&&(e.isSelected=!0,this.selectedItems.push(e),!0)},r=t})(powerbi=powerbi||{}),(function(E){var e,o,r,N,s,l,p,u,V;function c(e,t){t=m(e.expr,t);return t!==e.expr?r(t):e}function w(e,t){if(e instanceof V)for(var r=e,i=0,a=t;i<a.length;i++)if((r=a[i].rewriteExpr(r))!==e)return 1}function P(e,t){for(var r=0,i=e.textRuns;r<i.length;r++)if(w(i[r].value,t))return 1}function i(e,t){var r=e.expression,i=e.filter,a=e.cachedValueItems;r&&(e.expression=m(r,t)),i&&(e.filter=d(i,t)),a&&n(a,t)}function n(e,t){for(var r=0,i=e;r<i.length;r++){var a=i[r],n=c(a.identity,t);n!==a.identity&&(a.identity=n)}}function d(e,t){return _.reduce(t,(function(e,t){return t.rewriteFilter(e)}),e)}function m(e,t){return _.reduce(t,(function(e,t){return t.rewriteExpr(e)}),e)}e=(e=E.explore||(E.explore={})).util||(e.util={}),o=jsCommon.ArrayExtensions,r=E.data.createDataViewScopeIdentity,N=E.data.DataViewObjectDefinitions,s=E.data.DataViewObjectDescriptors,l=E.data.DataViewScopeTotal,p=E.data.DataViewScopeWildcard,u=E.data.Selector,V=E.data.SQExpr,e.rewriteDataRepetitionSelectors=function(e,n){return _.isEmpty(e)?e:o.rewriteArray(e,(function(e){return u.isScopeIdentity(e)?c(e,n):u.isScopeWildcard(e)?(r=e,i=n,(a=o.rewriteArray(r.exprs,(function(e){return m(e,i)})))!==r.exprs?p.fromExprs(a):r):!u.isRoleWildcard(e)&&!u.isWildcard(e)&&u.isScopeTotal(e)?(a=e,t=n,(r=o.rewriteArray(a.exprs,(function(e){return m(e,t)})))!==a.exprs?l.fromExprs(r):a):e;var t,r,i,a}))},e.rewriteVisualLink=function(e,t){},e.rewriteFilterContainer=function(e,t){i(e,t)},e.rewriteFilterContainerState=function(e,t){i(e,t)},e.rewriteFilterOutput=function(e,t,r){if(t=s.findFilterOutput(t)){e=E.data.DataViewObjectDefinitions.getPropertyContainer(e,t,null);if(e){t=t.propertyName;if(n=e[t]){for(var i=0,a=r;i<a.length;i++)var n=a[i].rewriteFilter(n);e[t]=n}}}},e.rewriteDataBoundPropertyDefinitions=function(e,t,f){function C(e){var t=x(e.value);return{textStyle:e.textStyle,url:e.url,value:t,mentionEmail:e.mentionEmail}}function x(e){return e=e instanceof V?b(e,f):e}function S(e){return{textRuns:_.map(e.textRuns,C)}}function b(e,t){for(var r=0,i=t;r<i.length;r++)e=i[r].rewriteExpr(e);return e}e&&t&&(_.isEmpty(f)||N.visitPropertyDefinitions(e,t,(function(e,t,r,i,a){var n,a=a&&a.properties[t];if((l=e[t])instanceof V)for(var o=0,s=f;o<s.length;o++)var l=(c=s[o]).rewriteExpr(l);else if(N.isObjectPropertySQExprWithContext(l))for(var p=0,u=f;p<u.length;p++){var c=u[p];if(!_.isEmpty(null==(n=l.context)?void 0:n.filterContext))for(var d=0,m=l.context.filterContext;d<m.length;d++){var v=m[d];v.filter=c.rewriteFilter(v.filter)}l.value=c.rewriteExpr(l.value)}else{a=a.type;if(a.fill&&a.fill.solid&&a.fill.solid.color){if(!E.StructuralObjectDefinition.isFillDefinition(l))return;var y=l.solid.color;if(!y)return;var h=y;(y=b(y,f))!==h&&(l={solid:{color:y}})}else if(a.paragraphs){if(!E.StructuralObjectDefinition.isParagraphsDefinition(l))return;if(!(function(e,t){for(var r=0,i=e;r<i.length;r++)for(var a=i[r].textRuns,n=0,o=a;n<o.length;n++){var s=o[n];if(E.ParagraphsDefinition.isTextRunDefinition(s)){if(w(s.value,t))return 1}else if(E.ParagraphsDefinition.isTextRunConditionalDefinition(s)){for(var l=0,p=s.cases;l<p.length;l++)if(function(e,t){if(P(e,t))return 1;if(w(e.pattern,t))return 1}(p[l],t))return 1;if(P(s.defaultCase,t))return 1;if(w(s.expression,t))return 1}}return})(l,f))return;l=_.map(l,(function(e){return{horizontalTextAlignment:e.horizontalTextAlignment,textRuns:_.map(e.textRuns,(function(e){return E.ParagraphsDefinition.isTextRunDefinition(e)?C(e):E.ParagraphsDefinition.isTextRunConditionalDefinition(e)?{cases:_.map(e.cases,(function(e){var t=e.pattern;return t instanceof V&&(t=b(t,f)),__assign({pattern:t},S(e))})),defaultCase:S(e.defaultCase),expression:x(e.expression)}:void 0}))}}))}else if(a.icon){if(!E.StructuralObjectDefinition.isIconDefinition(l))return;h={kind:"Icon",value:l.value&&b(l.value,f),layout:l.layout&&b(l.layout,f),verticalAlignment:l.verticalAlignment&&b(l.verticalAlignment,f)};l.value===h.value&&l.layout===h.layout&&l.layout===h.layout||(l=h)}else if(a.errorRange){if(!E.StructuralObjectDefinition.isErrorRangeDefinition(l))return;var g,y={kind:"ErrorRange"};l.explicit?(g=l.explicit,h=y.explicit={isRelative:b(g.isRelative,f)},g.lowerBound&&(h.lowerBound=b(g.lowerBound,f)),g.upperBound&&(h.upperBound=b(g.upperBound,f))):l.symmetricalExplicit?y.symmetricalExplicit={delta:b(l.symmetricalExplicit.delta,f)}:l.standardDeviation?(g=l.standardDeviation,y.standardDeviation={value:b(g.value,f),multiplier:b(g.multiplier,f)}):l.percentage?(g=l.percentage,y.percentage={lowerBoundDelta:b(g.lowerBoundDelta,f),upperBoundDelta:b(g.upperBoundDelta,f)}):l.percentile&&(g=l.percentile,y.percentile={lowerBound:b(g.lowerBound,f),upperBound:b(g.upperBound,f)}),l=y}}e[t]=l})))},e.rewriteDisplayNameIdentityPairs=n,e.rewriteSemanticFilter=d,e.rewriteExpr=m,e.rewriteLinkField=function(e,t){var r=e.fieldExpr;e.fieldExpr=m(r,t)},e.rewritePod=function(e,t){if(!_.isEmpty(e.parameters))for(var r=0,i=e.parameters;r<i.length;r++){var a=i[r];a.fieldExpr&&(a.fieldExpr=m(a.fieldExpr,t))}},e.rewriteFilterExpressionMetadata=function(e,t){if(e.expressions=o.rewriteArray(e.expressions,(function(e){return m(e,t)})),e.cachedValueItems)for(var e=e.cachedValueItems,r=t,i=0,a=e;i<a.length;i++){var n=a[i];n.identities=o.rewriteArray(n.identities,(function(e){return c(e,r)}))}}})(powerbi=powerbi||{}),(function(e){var t,n,o;function r(e){var e=e===o.InnerPosition,t=e?15:10,r=e?0:3,i=n.DefaultTransparency,a={};return a[o.BottomRightPreset]={angle:e?225:45,shadowDistance:10,shadowBlur:t,shadowSpread:r,transparency:i},a[o.BottomPreset]={angle:e?270:90,shadowDistance:10,shadowBlur:t,shadowSpread:r,transparency:i},a[o.BottomLeftPreset]={angle:e?315:135,shadowDistance:10,shadowBlur:t,shadowSpread:r,transparency:i},a[o.CenterRightPreset]={angle:e?180:0,shadowDistance:10,shadowBlur:t,shadowSpread:r,transparency:i},a[o.CenterPreset]={angle:0,shadowDistance:0,shadowBlur:e?20:15,shadowSpread:r,transparency:i},a[o.CenterLeftPreset]={angle:e?0:180,shadowDistance:10,shadowBlur:t,shadowSpread:r,transparency:i},a[o.TopRightPreset]={angle:e?135:315,shadowDistance:10,shadowBlur:t,shadowSpread:r,transparency:i},a[o.TopPreset]={angle:e?90:270,shadowDistance:10,shadowBlur:t,shadowSpread:r,transparency:i},a[o.TopLeftPreset]={angle:e?45:225,shadowDistance:10,shadowBlur:t,shadowSpread:r,transparency:i},a}function a(e,t){t=r(t||n.DefaultPosition);return t.hasOwnProperty(e)?t[e]:null}e=e.explore||(e.explore={}),t=e.util||(e.util={}),o=e.contracts.VisualDropShadow,(n=t.VisualDropShadowUtil||(t.VisualDropShadowUtil={})).DefaultShow=!1,n.DefaultPreset=o.BottomRightPreset,n.DefaultPosition=o.OuterPosition,n.DefaultTransparency=70,n.DefaultShadowSpread=3,n.DefaultShadowBlur=10,n.DefaultAngle=45,n.DefaultShadowDistance=10,n.DefaultColor="#000",n.getDefaultValues=function(e,t){var r=e&&e.preset?e.preset:n.DefaultPreset,e=e&&e.position?e.position:n.DefaultPosition,i=a(r,e),t=t?t.colorPalette.foreground.value:n.DefaultColor;return{show:n.DefaultShow,preset:r,position:e,color:{solid:{color:t}},shadowSpread:i?i.shadowSpread:n.DefaultShadowSpread,shadowBlur:i?i.shadowBlur:n.DefaultShadowBlur,angle:i?i.angle:n.DefaultAngle,shadowDistance:i?i.shadowDistance:n.DefaultShadowDistance,transparency:i?i.transparency:n.DefaultTransparency}},n.presetSettings=r,n.getPresetSettings=a})(powerbi=powerbi||{}),(function(P){var p,e,u,i,T,l,c,d,m,t,r,a,n,F,j,o,s;function v(e){return e&&e.config&&e.config.singleVisual?e.config.singleVisual.query:null}function y(e){return e&&e.config&&e.config.singleVisual}function h(e){e=e.config;if(e){e=e.singleVisual;if(e&&e.query)return e.query.defn.select()}}function g(e,t){if(e&&t){t=t.getPlugin(e);if(t)return t.capabilities}}function f(e,t){return g(u.getVisualType(e),t)}function C(e,t){if(e.role)t.push(e.role);else{var r=e;if(r.bind)r.bind.to&&t.push(r.bind.to);else if(e.for)e.for.in&&t.push(e.for.in);else{r=e;if(r.group){if(r.group.by&&t.push(r.group.by),r.group.select)for(var i=0,a=r.group.select;i<a.length;i++)C(a[i],t)}else{r=e;if(r.composite)for(var n=0,o=r.composite;n<o.length;n++)C(o[n],t);else if(e.select)for(var s=0,l=e.select;s<l.length;s++)C(l[s],t)}}}}function D(e){var t=[];return e&&(e.categorical&&(e.categorical.categories&&C(e.categorical.categories,t),e.categorical.values)&&C(e.categorical.values,t),e.table&&e.table.rows&&C(e.table.rows,t),e.single&&C(e.single,t),e.tree&&(e.tree.nodes&&C(e.tree.nodes,t),e.tree.values)&&C(e.tree.values,t),e.matrix)&&(e.matrix.columns&&C(e.matrix.columns,t),e.matrix.rows&&C(e.matrix.rows,t),e.matrix.values)&&C(e.matrix.values,t),_.uniq(t)}function R(e){switch(e.extendedType){case 66048:return 67;case 131584:return 35}switch(e.primitiveType){case 1:return 2048;case 2:case 3:return 1;case 4:return 3;case 5:return 4096;case 6:return 20;case 7:return 4;case 9:return 8}}function A(e){return P.data.conceptualDataCategoryFromString(e.categoryString)}function x(e){return r.generateUniqueId(e)}function S(e){return e&&null!=e.size?n.fromPoint(e.size.pt):n.toString(u.DefaultTitleFontSizeInPixel)}function b(e){return!(!e||!e.defn||(e=e.defn.groupBy(),_.isEmpty(e)))}function I(e){for(var t={},r=0,i=e.defn.select();r<i.length;r++){var a=i[r],n=void 0,n=j.isMeasure(a.expr)?P.VisualDataRoleKind.Measure:P.VisualDataRoleKind.Grouping;t[a.name]=n}return t}function E(e){for(var t=0,r=e.visualContainers;t<r.length;t++){var i=r[t];delete i.cachedData,i.disableCacheOnServerForInitialLoad=!0}}function N(e){e=y(e);return e&&e.columnProperties}p=P.explore||(P.explore={}),e=p.util||(p.util={}),l=jsCommon.CssConstants,c=P.data.DataViewObjectDefinitions,d=P.data.services.DataViewObjectSerializer,m=P.data.DataViewTransform,t=P.visuals.Units.FontSize,r=P.common.utils.IdUtility,a=P.data.InteractiveQueryCachingSettings,n=jsCommon.PixelConverter,F=P.data.SQExpr,j=P.data.SQExprUtils,o=p.contracts.VisualContainer,s=p.contracts.VisualTitleHeading,u=e.VisualContainerUtils||(e.VisualContainerUtils={}),T=jsCommon.ArrayExtensions,u.DefaultTitleFontSizeInPixel=12,u.DefaultTitleFontFamily="'Segoe UI', wf_segoe-ui_normal, helvetica, arial, sans-serif",u.DefaultTitleFontColor="#C8C8C8",u.DefaultTitleTextClass="largeTitle",u.DefaultTitleThemeColor="foreground",u.DefaultSubTitleFontFamily="'Segoe UI', wf_segoe-ui_normal, helvetica, arial, sans-serif",u.DefaultSubTitleTextClass="lightLabel",u.DefaultSubTitleThemeColor="foreground",u.DefaultTitleFontSizeInPoints=jsCommon.PixelConverter.toPoint(u.DefaultTitleFontSizeInPixel),u.DefaultTitleFontProperties={size:t.createFromPt(u.DefaultTitleFontSizeInPoints),family:u.DefaultTitleFontFamily,color:u.DefaultTitleFontColor},u.DefaultTitleHeading=s.DefaultHeadingAttribute,u.DefaultSubTitleHeading=s.Heading4,(e=i=u.VisualElementSpacing||(u.VisualElementSpacing={}))[e.Title=0]="Title",e[e.SubTitle=1]="SubTitle",e[e.Divider=2]="Divider",u.getVisualType=function(e){if(e)return p.contracts.isVisualContainerGroup(e)?p.constants.GroupComponentType:e.config&&e.config.singleVisual?e.config.singleVisual.visualType:void 0},u.getVisualQuery=v,u.getSingleVisualConfig=y,u.isVisualTypeAutoSelect=function(e){return null==(e=null==(e=null==e?void 0:e.config)?void 0:e.singleVisual)?void 0:e.autoSelectVisualType},u.getSelectExprs=h,u.getFilterCapabilities=function(e,t){return g(e&&e.config&&e.config.singleVisual?e.config.singleVisual.visualType:null,t)},u.getVisualCapabilities=f,u.getDataRolesForVisual=function(e,t){if((e=f(e,t))&&!_.isEmpty(e.dataRoles))return e.dataRoles},u.getVisualQueryCachingSettings=function(e,t,r){if(e)return r||"UserAction_ChangeModel"===t||"UserAction_Refresh"===t?a.BypassCache:a.Default},u.setQueryKeepProjectionOrder=function(e){e.config&&e.config.singleVisual&&(e=e.config.singleVisual)&&e.query&&e.query.hasShowAll()&&(e.queryOptions=e.queryOptions||{},e.queryOptions.keepProjectionOrder=!0)},u.getDataRolesForVisualPlugin=function(e){if(e){e=e.capabilities;if(e&&!_.isEmpty(e.dataRoles))return e.dataRoles}},u.getNumberRangesForRoles=function(e,t,r){if(t=f(e,t)){e=v(e);if(e)return P.visualCapabilitiesHelperModuleFactory().create(t,r).getNumberRangesForRoles(e)}},u.isScriptVisual=function(e,t){return e=u.getVisualType(e),t&&t.isScriptVisual(e)},u.isSmallMultiplesVisual=function(e){if(0<=[P.visuals.plugins.lineChart.name,P.visuals.plugins.areaChart.name,P.visuals.plugins.stackedAreaChart.name,P.visuals.plugins.barChart.name,P.visuals.plugins.clusteredBarChart.name,P.visuals.plugins.hundredPercentStackedBarChart.name,P.visuals.plugins.columnChart.name,P.visuals.plugins.clusteredColumnChart.name,P.visuals.plugins.hundredPercentStackedColumnChart.name,P.visuals.plugins.lineClusteredColumnComboChart.name,P.visuals.plugins.lineStackedColumnComboChart.name].indexOf(e.visualType)){e=null==(e=e.query)?void 0:e.projections;if(e&&e[P.visuals.cartesianRoleNames.rows]&&0<e[P.visuals.cartesianRoleNames.rows].all().length)return!0}return!1},u.getObjectDefinitions=function(e){return null==(e=null==(e=e.config)?void 0:e.singleVisual)?void 0:e.objects},u.getContainerObjectDefinitions=function(e){return e.config&&e.config.singleVisual&&e.config.singleVisual.vcObjects},u.getQueryName=function(e,t,r){return(e=e.config.singleVisual.query.projections[t].all()[r]).queryRef},u.describeForPinning=function(e,t,r,i,a,n,o){if(r){var s=r.defn.select(),l=r.projections,p=[],u=[],c=I(r),d=P.DataViewAnalysis.chooseDataViewMappings(r.projections,a.dataViewMappings,c,n).supportedMappings;if(d){for(var m=0,v=d;m<v.length;m++){var y,h=v[m],g=1<d.length?D(h):null,f=[];for(y in l)if(null==g||_.includes(g,y))for(var C=l[y],x=0,S=C.all();x<S.length;x++){var b,E,N,V=S[x],w=T.indexWithName(s,V.queryRef);-1===w||(N=s[w],F.isTransformOutputRoleRef(N.expr))||(b=N.expr.getMetadata(t,j.buildExprEvaluationContext(r.defn.from())),E={Restatement:e.getDisplayName(N.expr,t,a,N.name,i),Name:V.queryRef,Type:R(b.type)},(N=j.getKpiMetadata(N.expr,t))&&(E.kpi=N),(N=V.format||b.format)&&(E.Format=N),(N=A(b.type))&&(E.DataCategory=N),p[w]=E,f.push({Name:y,Projection:w,isActive:_.includes(C.activeProjectionRefs,V.queryRef)}))}u.push({DataRoles:f})}return{queryMetadata:{Select:p,Filters:o},visualElements:u}}}},u.getRolesForDataViewMapping=D,u.toSemanticType=R,u.toConceptualDataCategory=A,u.hasGrouping=function(e,t){if(e&&e.config&&e.config.singleVisual&&e.config.singleVisual.query&&e.config.singleVisual.query.defn){var r=e.config.singleVisual.query.projections,i=e.config.singleVisual.query.defn.select();if(r&&0<i.length)for(var a in r)for(var n=0,o=r[a].all();n<o.length;n++){var s=o[n],s=jsCommon.ArrayExtensions.findItemWithName(i,s.queryRef);if(s){s=s.expr.getMetadata(t);if(s&&0===s.kind&&null==s.aggregate)return!0}}return!1}},u.contractEqualityComparator=function(t){return function(e){return t===e}},u.contractUnEqualityComparator=function(t){return function(e){return t!==e}},u.filterAffects=function(t,r,i,a){return function(e){return t===e||3!==(i&&i.relationshipFilterAction(r,t,e,a))}},u.clearDataSelection=function(e,t){e.publishToChannel(P.explore.services.events.dataSelectionChanged,{affectContainer:function(e){return e===t}})},u.createCacheEntry=function(e,t,r,i,a,n,o,s,l){var p;if(n)return(e=e.capabilities(n.visualType))&&(t=u.describeForPinning(t,a,n.query,n.columnProperties,e,o,s))&&(a=d.serializeObjects(n.objects,e.objects,o.serializeSpaceOptimization),(p=i.transforms&&e&&e.objects?P.data.services.DataViewTransformActionsSerializer.serializeDataViewTransformActions(i.transforms,e.objects):{objects:a}).objects=p.objects||a,p.visualElements=t.visualElements,p.queryMetadata=t.queryMetadata),{queryObject:i.options.query.command,dataObject:r,transformsObject:p,dataUpdatedTime:l}},u.uniqueName=function(e){var t={};return p.contracts.traverseVisualContainerGroups(e,(function(e){e.name,t[e.name]=!0})),x(t)},u.nextUniqueName=x,u.getVisualContainerGroups=function(e){var t=[];return p.contracts.traverseVisualContainerGroups(e,(function(e){p.contracts.isVisualContainerGroup(e)&&t.push(e)})),t},u.isInHiddenGroup=function(e){for(var t=e.parentGroup;t;){if(p.contracts.VisualContainerGroup.isHidden(t))return!0;t=t.parentGroup}return!1},u.isVisualHiddenOrInHiddenGroup=function(e){return o.isHidden(e.config.singleVisual)||u.isInHiddenGroup(e)},u.getAbsoluteVisualContainerPosition=function(e,t,r){void 0===t&&(t=0);var i=_.cloneDeep(e),a=r;if(1!==t)for(;a;){if(!a.layouts.withId(t))return"must provide a layout for groups for layout".concat(t),i;var n=a.layouts.withId(t).position;i.x+=n.x,i.y+=n.y,a=a.parentGroup}return i},u.getGroupRelativeVisualContainerPosition=function(e,t,r){void 0===r&&(r=0);for(var i=_.cloneDeep(e),a=t.parentGroup;a;){var n=a.layouts.withId(r).position;i.x-=n.x,i.y-=n.y,a=a.parentGroup}return i},u.notifyVisualContainersExceptSource=function(e,t,r,i,a){e.publishToChannel(P.explore.services.events.visualContainerChanged,{affectContainer:function(e){return e!==t},sourceLabelKey:r,parentActivity:i,parentContextActivity:a})},u.notifyVisualContainers=function(e,t,r,i,a){_.isEmpty(t)||e.publishToChannel(P.explore.services.events.visualContainerChanged,{affectContainer:function(e){return _.includes(t,e)},sourceLabelKey:r,parentActivity:i,parentContextActivity:a})},u.createCrossHighlightActivity=function(e,t){return e.createActivity({name:"Cross Highlight",operationType:t})},u.createChangeSlicerActivity=function(e){return e.createActivity({name:"Change Slicer"})},u.hasOnPremDataSource=function(e){return _.some(e,(function(e){return e.dsr&&e.dsr.vsName===P.common.constants.onPremiseVSName}))},u.getTitleFontSize=S,u.getTitleHeight=function(e){var t=S(e),e={fontFamily:e&&e.family||u.DefaultTitleFontFamily,fontSize:t};return P.TextMeasurementService.estimateSvgTextHeight(e)},u.evaluateObjectDefinitions=function(e,t,r,i,a,n,o){var s=r.config.singleVisual.visualType,r=r.config.singleVisual.vcObjects,l=c.getValue(r,{objectName:"stylePreset",propertyName:"name"},void 0),l=((s=t.getVisualObjects(e,s,l&&F.isConstant(l)&&l.value,p.contracts.VisualContainer.CommonObjectDescriptors))&&(r=c.clone(r||{}),c.extend(r,s,!0)),t.getVisualStyle(e)),s=m.evaluateMetadataOnceDataViewObjectDefinitions(r,p.contracts.VisualContainer.CommonObjectDescriptors,l,i,a,n,o);return(t=c.getObjectDefinition(r,"visualLink",void 0))&&t.properties&&t.properties.qna&&(((e=s.dataViewObjects=s.dataViewObjects||{}).visualLink=e.visualLink||{}).qna=t.properties.qna),s},u.setHoverClass=function(e,t){t.toggleClass("showHover",e)},u.notifyContainerHoverEvent=function(e,t,r){e=e?P.common.events.canvasItemContainerShowHover:P.common.events.canvasItemContainerHideHover,r.publishToChannel(e,{containerName:t})},u.getVisualStyleAttributes=function(e,t,r,i,a,n,o){var s={};return s[l.transformProperty]=null!=t?"scale("+t+")":"scale(1)",s[l.widthProperty]=e.width,s[l.heightProperty]=e.height,s[l.borderProperty]=i||"",s[l.paddingProperty]=n||"",s[l.borderRadiusProperty]=a||"",s[l.backgroundColorProperty]=r||"",s[l.boxShadowProperty]=o||"",s},u.getVisualBackgroundColor=function(e){var t;if(e&&e.show)return t=P.visuals.visualBackgroundHelper.getDefaultValues(),!e.transparency&&0!==e.transparency||(t.transparency=e.transparency),e.color&&e.color.solid.color&&(t.color=e.color),P.common.utils.ColorUtility.applyTransparency(t.color.solid.color,(100-t.transparency)/100)},u.getVisualBorder=function(e,t){return{show:(e||t).show,color:(e&&e.color&&e.color.solid&&e.color.solid.color?e:t).color,radius:e&&e.radius||t.radius}},u.getVisualDropShadow=function(e,t){return{show:(e||t).show,preset:(e&&e.preset?e:t).preset,position:(e&&e.position?e:t).position,color:(e&&e.color&&e.color.solid&&e.color.solid.color?e:t).color,transparency:(e&&void 0!==e.transparency?e:t).transparency,shadowBlur:(e&&void 0!==e.shadowBlur?e:t).shadowBlur,shadowSpread:(e&&void 0!==e.shadowSpread?e:t).shadowSpread,angle:(e&&void 0!==e.angle?e:t).angle,shadowDistance:(e&&void 0!==e.shadowDistance?e:t).shadowDistance}},u.getVisualPadding=function(e,t,r){void 0===r&&(r=!1);var i,t=null!=t&&t.suppressDefaultPadding?0:5;return{top:null!=(i=(e=e||{}).top)?i:r?0:t,bottom:null!=(i=e.bottom)?i:t,left:null!=(r=e.left)?r:t,right:null!=(i=e.right)?i:t}},u.getVisualBodyPadding=function(e,t,r){return _.isEmpty(t)&&r&&0!==(r=isNaN(r)||r<0?0:r)?{left:e.left+r,right:e.right+r,top:e.top+r,bottom:e.bottom+r}:e},u.getVisualSpacing=function(e,t){var r;if(null==t||!t.customizeSpacing)return null!=(r=null==t?void 0:t.verticalSpacing)?r:5;switch(e){case i.Title:return void 0!==(null==t?void 0:t.verticalSpacing)&&void 0===(null==t?void 0:t.spaceBelowTitle)?null==t?void 0:t.verticalSpacing:void 0!==(null==t?void 0:t.spaceBelowTitle)?null==t?void 0:t.spaceBelowTitle:5;case i.SubTitle:return void 0!==(null==t?void 0:t.verticalSpacing)&&void 0===(null==t?void 0:t.spaceBelowSubTitle)?t.verticalSpacing:void 0!==(null==t?void 0:t.spaceBelowSubTitle)?t.spaceBelowSubTitle:5;case i.Divider:return void 0!==(null==t?void 0:t.verticalSpacing)&&void 0===(null==t?void 0:t.spaceBelowTitleArea)?null==t?void 0:t.verticalSpacing:void 0!==(null==t?void 0:t.spaceBelowTitleArea)?null==t?void 0:t.spaceBelowTitleArea:5;default:return 5}},u.isSegment=function(e){return null!=e&&null!=e.metadata&&null!=e.metadata.segment},u.hasGroupByItems=b,u.hasGroupByItemsInQuery=function(e){return b(u.getVisualQuery(e))},u.containSearchableField=function(e,t,r){var t=u.getDataRolesForVisual(e,t),e=v(e);if(e&&!_.isEmpty(t))return t=t[0].name,e=e.tryGetExprs(t),!_.isEmpty(e)&&!_.some(e,(function(e){e=e.getMetadata(r);if(e)return!e.type.text}))},u.hasFilterMappingWithNonAggregatableColumns=function(e,t,r){if(e=(function(e,t){var r=v(e);if(r){t=f(e,t);if(t&&t.filterMappings&&t.filterMappings.measureFilter&&t.filterMappings.measureFilter.targetRoles){for(var i=t.filterMappings.measureFilter.targetRoles,t=_.chain(t.dataRoles).filter((function(e){return e.kind===P.VisualDataRoleKind.Grouping})).map((function(e){return e.name})).difference(i).value(),a=[],n=0,o=t;n<o.length;n++){var s=o[n];r.projections[s]&&a.push.apply(a,r.projections[s].all())}i=h(e);if(!_.isEmpty(a))return _.chain(i).filter((function(t){return _.some(a,(function(e){return e.queryRef===t.name}))})).map((function(e){return e.expr})).value()}}})(e,r),!_.isEmpty(e))for(var i=0,a=e;i<a.length;i++){var n=a[i];if(1===j.getAggregateBehavior(n,t))return!0}return!1},u.createRoleKindByQueryRef=I,u.clearExplorationQueryCaches=function(e){for(var t=0,r=e.sections;t<r.length;t++)E(r[t])},u.clearSectionQueryCaches=E,u.markInitialLoadQueriesDirty=function(e){for(var t=0,r=e.sections;t<r.length;t++)for(var i=0,a=r[t].visualContainers;i<a.length;i++)a[i].disableCacheOnServerForInitialLoad=!0},u.getVisualTypesAndCountsFromSection=function(a){function n(e,t){t=t.config.singleVisual.visualType;e[t]||(e[t]=0),e[t]++}function t(){for(var e=a&&a.visualContainers||[],t={},r=0,i=_.reject(e,(function(e){return o.isHidden(e.config.singleVisual)}));r<i.length;r++)n(t,i[r]);return t}try{return e=a&&a.visualContainerGroups,_.isEmpty(e)?t():(i={__hidden:r={}},p.contracts.traverseVisualContainerGroups(a.visualContainerGroups,(function(e,t){p.contracts.isVisualContainer(e)&&n(t?r:i,e)})),i)}catch(e){return jsCommon.Trace.error("Error getting visuals from groups ".concat(e&&e.message,": ").concat(e&&e.stack)),t()}var r,i,e},u.getAutoVisualFilterContainers=function(e,t,r,i,a){if(void 0===a&&(a=!1),p.FilterUtils.supportsVisualFilters(e,t))return t=p.FilterUtils.supportsMeasureFilters(e,t),e=u.getSelectExprs(e),t||(e=_.filter(e,(function(e){return!j.isMeasure(e.expr)}))),(e=_.filter(e,(function(e){return!F.isNativeVisualCalc(e.expr)})))?_.chain(e).map((function(e){return e.expr})).filter((function(e){return j.isExprValidForFiltering(e)&&_.isEmpty(e.validate(r,i))})).map((function(e){return{name:void 0,expression:e,expanded:!1,howCreated:0,type:p.FilterUtils.getDefaultFilterType(e,r,0),isHiddenInViewMode:a}})).value():void 0},u.getAutoCrossDrillVisualFilterContainers=function(e,t,r,i){return r=r.getDrillCrossFiltersToApply(e,t,i),_.map(r,(function(e){return{name:void 0,type:e.type,filter:e.filter,expression:e.expression,expanded:!1,howCreated:6,precedence:e.precedence}}))},u.getVisualContainerCount=function(e,t){for(var r=0,i=0,a=e.sections;i<a.length;i++)for(var n=0,o=a[i].visualContainers;n<o.length;n++)o[n].config.singleVisual.visualType===t.name&&++r;return r},u.containsCustomVisuals=function(e){var t,r=e.resourcePackages,i=null!=(t=e.publicCustomVisuals)?t:[];if(r||0!==i.length)for(var a=0,n=e.sections;a<n.length;a++){var o=n[a];if(o.visualContainers)for(var s=0,l=o.visualContainers;s<l.length;s++){var p=(function(e){var t;if(e.config&&e.config.singleVisual&&e.config.singleVisual.visualType)return t=e.config.singleVisual.visualType,_(r).find((function(e){return e.name===t}))||_(i).includes(t)?{value:!0}:void 0})(l[s]);if("object"==typeof p)return p.value}}return!1},u.getImprovedFilterExperienceTelemetry=function(e,t){var t={usingImprovedFilterExperience:!0,viewMode:0===t},r=(function(e){if((e=e.objects)&&e.outspacePane)return(e=c.getValue(e,{objectName:"outspacePane",propertyName:"expanded"},null))&&e.value})(e),r=(_.isUndefined(r)||(t.isOutspacePaneExpanded=r),(function(e){if((e=e.objects)&&e.outspacePane)return(e=c.getValue(e,{objectName:"outspacePane",propertyName:"visible"},null))&&e.value})(e));return _.isUndefined(r)||(t.isOutspacePaneVisible=r),t},u.shouldUseQueryCache=function(e,t){return e.id&&!t},u.getExecutionMetricsKind=function(e){return e?3:1},u.wrapContextActivity=function(e,t,r){t&&(i=t.createChildActivity(e));var i,t=r();return i&&i.resolve(),t},u.wrapContextActivityAsync=function(i,a,n){return __awaiter(this,void 0,P.Promise,(function(){var t,r;return __generator(this,(function(e){switch(e.label){case 0:return a&&(t=a.createChildActivity(i)),[4,n()];case 1:return r=e.sent(),t&&t.resolve(),[2,r]}}))}))},u.getColumnProperties=N,u.hasVisualColumnRename=function(e){if(!_.isEmpty(e))for(var t=0,r=e;t<r.length;t++){var i=r[t];if(p.contracts.isVisualContainer(i)){var a=N(i);if(a)for(var n in a)if(a[n].displayName)return!0}}return!1},u.doesVisualSupportPersonalizeVisuals=function(e,t){return t=u.getVisualType(t),e.isQnaVisual(t)||e.isQueryVisual(t)},u.getVisualContainerDisplayName=function(a,n){var o;return __awaiter(this,void 0,void 0,(function(){var t,r,i;return __generator(this,(function(e){switch(e.label){case 0:return t=u.getSingleVisualConfig(a),r=n.dataSources.get(),[4,n.conceptualSchemaProxy.get(r)];case 1:return r=e.sent(),i=f(a,n.visualPlugin),[2,null==(o=n.displayNameService.getVisualTitle(t,r,i,void 0,void 0,!0))?void 0:o.text]}}))}))}})(powerbi=powerbi||{}),(function(u){var r,e,p,a,i,c;function n(e,t,r){if(!t||!t.column||!t.column.groupingMetadata)return 0;if(r){r=r.getGroupingDesignState(e,t.name);if(!r)return 1;if(r.partitionTable)return 3;if(r.binItem)return 2}return 1}function o(e,t,r){return!!(t&&t.column&&t.column.groupingMetadata)&&!(!(r=r.getGroupingDesignState(e,t.name))||!r.groupItems&&!r.partitionTable)}function s(e,t){return m(e,t).capabilities.canEdit}function l(e){return e&&!!(e.type.dateTime||e.type.integer||e.type.numeric||e.type.text)}function d(e,t){return _.map(e.groupedColumns,(function(e){if(0===e.kind)return u.data.SQExprBuilder.columnRef(t,e.name)}))}function m(e,t){t=u.data.FieldExprPattern.getSchema(a.asFieldPattern(t));return e.schema(t)}function v(e,t){return p.isGroupRef(e)&&p.isColumn(t)&&y(e,t)?e:p.isGroupRef(t)&&p.isColumn(e)&&y(t,e)?t:p.isGroupRef(e)&&p.isGroupRef(t)?y(e,t)?e:y(t,e)?t:void 0:void 0}function y(e,t){return u.data.SQExprUtils.sequenceEqual(e.groupedExprs,[t])}r=u.explore||(u.explore={}),e=r.utils||(r.utils={}),p=u.data.SQExpr,a=u.data.SQExprConverter,i=jsCommon.StringExtensions,c=u.explore.util.VisualContainerUtils,(e=e.GroupUtils||(e.GroupUtils={})).getGroupMode=n,e.isGroupOrBinColumn=function(e,t,r){return 1===(e=n(e,t,r))||2===e},e.isClusteringColumn=function(e,t,r){return 3===n(e,t,r)},e.isGroupOrClusteringColumn=o,e.canExprBeGrouped=function(e,t){return!(!t||!s(e,t)||!p.isColumn(t)&&!p.isGroupRef(t))&&l(t.getConceptualProperty(e))},e.canEditSchema=s,e.canPropertyBeGrouped=l,e.generateGroupDisplayName=function(e,t){return i.constructNameFromList(e,t.get("GroupDefinition_And"),50)},e.hasGroupOnKeys=function(e){var t;return!!(e&&e.column&&e.column.keys)&&(1===(t=e.column.keys).length&&t[0].name!==e.name||1<t.length)},e.findGroupingColumn=function(e,t){var r=t&&t.defn.select();if(r&&0<r.length&&e)for(var i=0,a=e;i<a.length;i++){var n=a[i];if(!n||!n.dataMap)return;n=Object.keys(n.dataMap);if(2===_.size(n)){var o=r.withName(n[0]),n=r.withName(n[1]);if(o&&n)return v(o.expr,n.expr)}}},e.ensureBlankDefaultPlaceholder=function(e,t){_.some(e,(function(e){return e.blankDefaultPlaceholder}))||e.splice(0,0,{name:t.get("NullValue"),blankDefaultPlaceholder:!0})},e.filterOutBlankDefaultPlaceholder=function(e){return _.filter(e,(function(e){return!e.blankDefaultPlaceholder}))},e.getValidGroupingRules=function(e,t,r){var i=[];if((t=c.getVisualCapabilities(e,t))&&t.grouping){e=c.getVisualQuery(e);if(!e)return i;for(var a=e.projections,n=c.createRoleKindByQueryRef(e),o=0,s=_.filter(t.grouping.groupingRules,(function(e){return e.kind===r}));o<s.length;o++){var l=s[o],p=u.DataViewAnalysis.checkForConditionErrors(a,l.condition,n,!1);_.isEmpty(p)&&i.push(l)}}return i},e.getGroupedColumns=function(e,t,r){var i=a.asFieldPattern(e);if(i.groupingColumn)return _.map(i.groupingColumn.groupedColumns,(function(e){return u.data.SQExprBuilder.fieldExpr(e)}));if(i.column){t=t.schema(i.column.schema).findProperty(i.column.entity,i.column.name);if(o(i.column.entity,t,r))return i=e.getTargetEntity(),d(t.column.groupingMetadata,i)}},e.getGroupedColumnsFromMetadata=d,e.getConceptualSchema=m,e.canGroup=function(e,t){var r=t&&t.defn.select();if(_.isEmpty(r)||_.isEmpty(e))return!1;for(var i=0,a=e;i<a.length;i++){var n=a[i];if(!n||!n.dataMap)return!1;var o=Object.keys(n.dataMap),n=_.size(n.dataMap);if(2<n)return!1;if(2===n){var s=r.withName(o[0]),l=r.withName(o[1]);if(s&&l&&(s=s.expr,l=l.expr,!v(s,l)))return!1}else if(1===n){s=r.withName(o[0]);if(s&&!p.isColumn(s.expr)&&!p.isGroupRef(s.expr))return!1}}return!0},e.getGroupDataType=function(e){return e.dateTime?2:e.numeric?1:0},e.convertToTimeUnit=function(e){switch(e){case 4:return 3;case 6:return 2;case 8:return 0;case 9:return 7;case 10:return 6;case 11:return 5}},e.convertToBinUnit=function(e){switch(e){case 3:return 4;case 2:return 6;case 0:return 8;case 7:return 9;case 6:return 10;case 5:return 11}},e.ensureDataSources=function(e){var t;e.get()||(t=r.contracts.createDataSourceArray([{type:"dsr",id:1,name:void 0,dsr:{schemaName:void 0,vsName:"vsName",dbName:"dbName"}}]),e.set(t))},e.showQueryError=function(e,t){null!=t&&t.getDetails&&(t=t.getDetails(u.common.getLocalize()),e.error(t.message,"GroupDialog",{debugErrorInfo:t.debugErrorInfo,displayableErrorInfo:t.displayableErrorInfo,helpLink:t.helpLink}))}})(powerbi=powerbi||{}),(function(e){var t,r;function i(e){this.key=[],this.value=[],this.comparer=e}t=(t=e.explore||(e.explore={})).utils||(t.utils={}),r=e.data.SQExpr,i.prototype.add=function(e,t){this.key.push(e),this.value.push(t)},i.prototype.get=function(e){if(r.isHierarchyLevel(e))for(var t=0;t<this.key.length;t++)if(this.comparer(this.key[t],e))return this.value[t]},t.SQExprToRoleDictionary=i})(powerbi=powerbi||{}),(function(e){var l,t,r;function i(){}e=(e=e.explore||(e.explore={})).services||(e.services={}),(t=l=e.CanvasListOrderingConstants||(e.CanvasListOrderingConstants={})).negMinOrder=-1,t.posMinOrder=0,t.negMaxOrder=-1e7,t.posMaxOrder=1e7,t.defaultGap=1e3,t.minGap=5,e.createCanvasListOrderNormalizeService=function(){return new r},i.prototype.getContainerListOrders=function(e,t){for(var r={},i=0,a=e;i<a.length;i++){var n=a[i];r[n.name]=t(n)}return r},i.prototype.getSortedContainerNames=function(t,e){e=e?"asc":"desc";return _.chain(t).keys().orderBy((function(e){return t[e]}),e).value()},i.prototype.settingListOrder=function(e,t,r,i){for(var a=0,n=t;a<n.length;a++)e[n[a]]=r,r+=i;return r},i.prototype.checkIfExtremitiesSurpassed=function(e,t,r){var i,a,n,r=r?(i=l.posMinOrder,a=l.posMaxOrder,n=t[_.head(e)]<i,t[_.last(e)]>a):(i=l.negMinOrder,a=l.negMaxOrder,n=t[_.head(e)]>i,t[_.last(e)]<a);return!(!n&&!r)},i.prototype.shouldNormalizeListOrder=function(e,t){var r,i=this.getSortedContainerNames(e,t);if(this.checkIfExtremitiesSurpassed(i,e,t))return!0;if(_.some(e,(function(e){return void 0===e})))return!0;for(var a=0,n=i;a<n.length;a++){var o=e[n[a]];if(null!=r){var s=0<=o==0<=r;if(Math.abs(o-r)<l.minGap&&s)return!0}r=o}return!1},i.prototype.normalizeListOrder=function(e,t){var e=this.getSortedContainerNames(e,t),r=t?l.posMaxOrder-l.posMinOrder:l.negMaxOrder-l.negMinOrder,r=t?Math.min(r/e.length,l.defaultGap):Math.max(r/e.length,-l.defaultGap),t=t?l.posMinOrder:l.negMinOrder,i={};this.settingListOrder(i,e,t,r);return i},r=i,e.CanvasListOrderNormalizeService=r})(powerbi=powerbi||{}),(function(v){var l,p,u,d,c,m,y,h,g,f,s,a,n,r;function C(e,t,r,i,a,n,o){this.aggrOps=e,this.visualPluginService=t,this.visualTimeSynchronizationService=r,this.localizationService=i,this.networkAvailabilityService=a,this.filterOverlayRestatementVisitorFactoryService=n,this.locOptions=null!=o?o:{aggregateDisplayNames:{Sum:this.localizationService.get("DisplayName_Sum"),Avg:this.localizationService.get("DisplayName_Avg"),Count:this.localizationService.get("DisplayName_Count"),Min:this.localizationService.get("DisplayName_Min"),Max:this.localizationService.get("DisplayName_Max"),CountNonNull:this.localizationService.get("DisplayName_CountNonNull"),Median:this.localizationService.get("DisplayName_Median"),StandardDeviation:this.localizationService.get("DisplayName_StandardDeviation"),Variance:this.localizationService.get("DisplayName_Variance"),DateMin:this.localizationService.get("DisplayName_DateMin"),DateMax:this.localizationService.get("DisplayName_DateMax"),StringMin:this.localizationService.get("DisplayName_StringMin"),StringMax:this.localizationService.get("DisplayName_StringMax")},showValueAsDisplayNames:{PercentOfGrandTotal:this.localizationService.get("DisplayName_QuickCalc_PercentOfGrandTotal"),PercentOfGrandTotalTooltip:this.localizationService.get("DisplayName_QuickCalc_PercentOfGrandTotalTooltip"),PercentileExclusive:this.localizationService.get("DisplayName_QuickCalc_PercentileExclusive"),PercentileInclusive:this.localizationService.get("DisplayName_QuickCalc_PercentileInclusive")},qualifiedDisplayNameTemplate:this.localizationService.get("Field_Tooltip"),stringResourceProvider:this.localizationService}}function x(e,t,r,i,a,n,o){this.schema=e,this.locOptions=t,this.aggrOps=r,this.visualCapabilities=i,this.visualTimeSynchronizationService=a,this.networkAvailabilityService=n,this.displayOptions=o}function S(e,t,r,i,a,n,o){this.schema=e,this.locOptions=t,this.aggrOps=r,this.visualCapabilities=i,this.visualTimeSynchronizationService=a,this.networkAvailabilityService=n,this.displayOptions=o}function i(e){this.schema=e}function b(e,t,r,i){return!(r&&r.includeDefaultAggregate||i.defaultAggregate(e,t,!1)!==e.func)}function E(e,t,r,i){t=o(t,r),r=i.aggregateDisplayNames[t];return y.format(r,[e])}function o(e,t){var r=v.data.aggregateFunctionName(e);return(3===e||4===e)&&t&&t.type&&(t.type.dateTime?r="Date"+r:t.type.text&&(r="String"+r)),r}function t(e,t,r,i){e=r.left.arithmetic?i.stringResourceProvider.format("BracketedValue",e):e,t=r.right.arithmetic?i.stringResourceProvider.format("BracketedValue",t):t,r=(function(e){switch(e){case 0:return"+";case 1:return"-";case 2:return"*";case 3:return"/"}})(r.operator);return i.stringResourceProvider.format("DisplayName_Arithmetic_Format",e,r,t)}l=v.explore||(v.explore={}),p=l.services||(l.services={}),u=v.data.DataViewObjectDefinitions,d=v.explore.util.DisplayNameServiceUtils,c=v.data.FieldExprPattern,m=v.data.FilterPattern,y=v.formattingService,h=v.data.SQExpr,g=v.data.SQExprBuilder,f=jsCommon.StringExtensions,p.createDisplayNameService=function(e,t,r,i,a,n,o){return new s(e,t,r,i,a,n,o)},C.prototype.getOriginalDisplayName=function(e,t,r,i){if(v.data.SQExprConverter.asFieldPattern(e,t))return c.visit(e,new a(t,this.locOptions,this.aggrOps,r,this.visualTimeSynchronizationService,this.networkAvailabilityService,i),t)},C.prototype.getDisplayName=function(e,t,r,i,a,n){if(a&&i){a=a[i];if(a&&a.displayName)return a.displayName}return this.getOriginalDisplayName(e,t,r,n)},C.prototype.createUniqueNativeReference=function(e,t,r,i,a){e=this.getDisplayName(e,t,i,a,void 0,{includeVariationSource:!0,hierarchyNameDelimiter:" ",includeHierarchyName:!0});return null==r?e:(t=new Set(r.defn.select().map((function(e){return e.nativeReferenceName})).filter((function(e){return null!=e}))),f.findUniqueName(t,e))},C.prototype.getQualifiedDisplayName=function(e,t,r,i){if(v.data.SQExprConverter.asFieldPattern(e,t))return n.run(e,t,this.locOptions,this.aggrOps,r,this.visualTimeSynchronizationService,this.networkAvailabilityService,i)},C.prototype.getFilterRestatement=function(e,t,r,i){e=v.data.SQFilterConverter.asFilterPattern(e,t);if(e&&e[0])return m.visit(e[0],new p.FilterRestatementVisitor(t,this.locOptions,this.visualTimeSynchronizationService,this.networkAvailabilityService,new a(t,this.locOptions,this.aggrOps,r,this.visualTimeSynchronizationService,this.networkAvailabilityService,i),i))},C.prototype.getFilterRestatementForOverlay=function(r,i,a,n,o){var s=this,e=v.data.SQFilterConverter.asFilterPattern(r.filter,i);return e&&e[0]?_.without(_.flatten(e.map((function(e){var t;return e.condition&&e.condition.complex&&r.restatement?{fieldName:"",restatements:[r.restatement],fieldNameToolTip:""}:(t=s.filterOverlayRestatementVisitorFactoryService.create(i,s.locOptions,a,s,r,n,o),m.visit(e,t))}))),void 0):[]},C.prototype.getQualifiedFilterRestatement=function(e,t,r,i){e=v.data.SQFilterConverter.asFilterPattern(e,t);if(e&&e[0])return m.visit(e[0],new p.FilterRestatementVisitor(t,this.locOptions,this.visualTimeSynchronizationService,this.networkAvailabilityService,new n(t,this.locOptions,this.aggrOps,r,this.visualTimeSynchronizationService,this.networkAvailabilityService,i),i))},C.prototype.getVisualSubTitle=function(e,t,r,i,a){var n=v.Prototype.inherit(null!=i?i:{show:null==i?void 0:i.show});return l.contracts.VisualSubTitle.isVisualSubTitleHidden(n)?i:(null==n.show?n.show=!1:void 0===n.text&&(i=u.getValue(e.vcObjects,{objectName:"subTitle",propertyName:"text"},void 0),n=this.autoGenerateText(e,t,r,i,n,a,!1)),n)},C.prototype.getVisualTitle=function(e,t,r,i,a,n){var o=!!n||!(!r||r.suppressDefaultTitle),s=v.Prototype.inherit(null!=i?i:{show:o});return l.contracts.VisualTitle.isHidden(s)?i:(null==s.show&&(s.show=o),void 0===s.text&&(i=u.getValue(e.vcObjects,{objectName:"title",propertyName:"text"},void 0),s=this.autoGenerateText(e,t,r,i,s,a,n)),s)},C.prototype.autoGenerateText=function(e,t,r,i,a,n,o){return r?(t=a.titleComponents=this.getRawTitleComponents(e,t,r,i,n),!(r=this.getTitleText(t))&&o&&(r=this.generateNonQueryTitle(e.visualType)),a.text=r,a.text&&(a.isGeneratedText=!0),this.formatTitleComponents(t)):(a.text=this.generateNonQueryTitle(e.visualType),a.isGeneratedText=!0),a},C.prototype.getTitleText=function(e){return e.subtitle?f.format(this.locOptions.stringResourceProvider.get("VisualTitle_By_Template"),e.title,e.subtitle):e.title},C.prototype.generateNonQueryTitle=function(e){var t=this.visualPluginService.getPlugin(e);return t&&t.titleKey?v.data.getDisplayName(t.titleKey,this.locOptions.stringResourceProvider):t&&t.custom?t.displayName||t.name.match(/([A-z\s]+)/g)[0]:t&&t.displayName?t.displayName:e},C.prototype.formatTitleComponents=function(e){e.subtitle&&(e.subtitle=f.format(this.locOptions.stringResourceProvider.get("VisualTitle_By_Template"),"",e.subtitle).trim())},C.prototype.getRawTitleComponents=function(e,t,r,i,a){if(i){if(h.isConstantText(i))return{title:i.value};if(e.evaluatedObjects){i=e.evaluatedObjects.title;if(i&&i.text)return{title:i.text.toString()}}return{title:null}}var n=[],o=[];if(e&&e.query){var s=e.query;if(s.projections&&r&&!r.suppressDefaultTitle&&r.dataRoles)for(var l=0,p=r.dataRoles;l<p.length;l++){var u=p[l];this.populateDisplayNamesByDataRole(u,s,t,r,e.columnProperties,n,o,a)}}var i={},c="AndConjunction";return 0<n.length?(i.title=d.concatStrings(n,c,this.locOptions),0<o.length&&(i.subtitle=d.concatStrings(o,c,this.locOptions))):0<o.length&&(i.title=d.concatStrings(o,c,this.locOptions)),i},C.prototype.getDescription=function(e,t){return r.run(e,t)},C.prototype.populateDisplayNamesByDataRole=function(e,t,r,i,a,n,o,s){var l=t.defn.select(),p=t.projections[e.name];if(p)for(var u=0,c=_.isEmpty(p.activeProjectionRefs)?_.map(p.projected(),(function(e){return e.queryRef})):p.activeProjectionRefs;u<c.length;u++){var d=c[u],m=l.withName(d);m&&m.expr&&(m=this.getDisplayName(m.expr,r,i,d,a,s),(e.kind===v.VisualDataRoleKind.Grouping||e.kind!==v.VisualDataRoleKind.Measure&&C.isRoleUsedAsGroup(e,t,r)?o:n).push(m))}},C.isRoleUsedAsGroup=function(e,t,r){e=t.projections[e.name];if(e){e=_.head(e.all()),t=t.defn.select().withName(e.queryRef).expr.getMetadata(r);if(t)return 0===t.kind}return!1},s=C,x.prototype.visitColumn=function(e){return x.getDisplayNameForProperty(e,this.schema)},x.prototype.visitColumnAggr=function(e){return x.getDisplayNameForSQAggregate(e,g.fromColumnAggr(e),this.schema,this.locOptions,this.visualCapabilities,this.visualTimeSynchronizationService,this.aggrOps,this.displayOptions,this.networkAvailabilityService)},x.prototype.visitGroupingColumn=function(e){return x.getDisplayNameForProperty(e,this.schema)},x.prototype.visitGroupingColumnAggr=function(e){return x.getDisplayNameForSQAggregate(e,g.fromGroupingColumnAggr(e),this.schema,this.locOptions,this.visualCapabilities,this.visualTimeSynchronizationService,this.aggrOps,this.displayOptions,this.networkAvailabilityService)},x.prototype.visitColumnHierarchyVariation=function(e){return x.getVariationHierarchyName(e,this.schema,this.displayOptions,this.locOptions.stringResourceProvider)},x.prototype.visitColumnHierarchyLevelVariation=function(e){return x.getVariationLevelName(e,this.schema,this.displayOptions,this.locOptions.stringResourceProvider)},x.prototype.visitColumnSubquery=function(e){},x.prototype.visitColumnAggrSubquery=function(e){},x.prototype.visitColumnTransformRef=function(e){},x.prototype.visitEntity=function(e){return x.getDisplayNameForEntity(e,this.schema)},x.prototype.visitEntityAggr=function(e){return x.getDisplayNameForSQAggregate(e,g.fromEntityAggr(e),this.schema,this.locOptions,this.visualCapabilities,this.visualTimeSynchronizationService,this.aggrOps,this.displayOptions,this.networkAvailabilityService)},x.prototype.visitHierarchy=function(e){return x.getDisplayNameForHierarchy(e,this.schema)},x.prototype.visitHierarchyLevel=function(e){return x.getDisplayNameForHierarchyLevel(e,this.schema,this.displayOptions,this.locOptions.stringResourceProvider)},x.prototype.visitHierarchyLevelAggr=function(e){return x.getDisplayNameForSQAggregate(e,g.fromHierarchyLevelAggr(e),this.schema,this.locOptions,this.visualCapabilities,this.visualTimeSynchronizationService,this.aggrOps,this.displayOptions,this.networkAvailabilityService)},x.prototype.visitMeasure=function(e){return x.getDisplayNameForProperty(e,this.schema)},x.prototype.visitSelectRef=function(e){},x.prototype.visitPercentile=function(e){var t=this.locOptions.showValueAsDisplayNames;return y.format(e.exclusive?t.PercentileExclusive:t.PercentileInclusive,[c.visit(e.arg,this),e.k])},x.prototype.visitPercentOfGrandTotal=function(e){return y.format(this.locOptions.showValueAsDisplayNames.PercentOfGrandTotal,[c.visit(e.baseExpr,this)])},x.prototype.visitPercentOfRoleTotal=function(t){if(this.visualCapabilities,this.visualCapabilities.dataRoleTotals,this.visualCapabilities&&this.visualCapabilities.dataRoleTotals){var e=this.visualCapabilities.dataRoleTotals,e=_.find(e,(function(e){return _.isEqual(t.roles,e.roles)}));if(e)return e=v.data.getDisplayName(e.shortDisplayName,this.locOptions.stringResourceProvider),y.format(e,[c.visit(t.baseExpr,this)])}},x.prototype.visitTransformOutputRoleRef=function(e){return e.expressionName},x.prototype.visitFilteredEval=function(e){for(var t=this.locOptions.stringResourceProvider.get("VisualTitle_For_Template"),r=c.visit(e.baseExpr,this),i=new p.FilterRestatementVisitor(this.schema,this.locOptions,this.visualTimeSynchronizationService,this.networkAvailabilityService,new x(this.schema,this.locOptions,this.aggrOps,this.visualCapabilities,this.visualTimeSynchronizationService,this.networkAvailabilityService,this.displayOptions),this.displayOptions),a=[],n=0,o=e.filters;n<o.length;n++){var s=o[n],s=m.visit(s,i);null!=s&&a.push(s)}if(!_.isEmpty(a))return e=d.concatStrings(a,"FilterRestatement_CompoundAnd",this.locOptions),y.format(t,[r,e])},x.prototype.visitArithmetic=function(e){return t(c.visit(e.left,this),c.visit(e.right,this),e,this.locOptions)},x.prototype.visitConstant=function(e){return v.visuals.valueFormatter.format(e.value,void 0)},x.prototype.visitSparklineData=function(e){return this.locOptions.stringResourceProvider.format("VisualTitle_By_Template",c.visit(e.measure,this),c.visit(e.grouping[0],this))},x.prototype.visitNativeVisualCalc=function(e){return e.name},x.getDisplayNameForEntity=function(e,t){t=t.schema(e.schema).entities.withName(e.entity);if(t)return t.displayName},x.getDisplayNameForProperty=function(e,t){var r=e.entity,i=e.name,e=e.schema,t=t.schema(e).findProperty(r,i);return null!=(e=null==t?void 0:t.displayName)?e:i},x.getDisplayNameForHierarchyLevel=function(e,t,r,i){t=t.schema(e.schema).findHierarchy(e.entity,e.name);if(t){var e=t.levels.withName(e.level);if(e)return e=e.displayName||e.column.displayName,r&&r.includeHierarchyName&&i&&(t=t.displayName,e=null!=r.hierarchyNameDelimiter?[t,e].join(r.hierarchyNameDelimiter):f.format(i.get("IncludeVariationSourceDisplayName"),t,e)),e}},x.getDisplayNameForHierarchy=function(e,t){t=t.schema(e.schema).findHierarchy(e.entity,e.name);if(t)return t.displayName},x.getVariationHierarchyName=function(e,t,r,i){var a=t.schema(e.source.schema).findProperty(e.source.entity,e.source.name);if(a)for(var n=0,o=a.column.variations;n<o.length;n++){var s=o[n],l=s.defaultHierarchy;if(s.name===e.variationName&&l&&l.name===e.hierarchy.name)return s=l.displayName,r&&r.includeVariationSource&&i?null!=r.hierarchyNameDelimiter?[a.displayName,s].join(r.hierarchyNameDelimiter):f.format(i.get("IncludeVariationSourceDisplayName"),a.displayName,s):s}},x.getVariationLevelName=function(e,t,r,i){var a=t.schema(e.source.schema).findProperty(e.source.entity,e.source.name);if(a)for(var n=0,o=a.column.variations;n<o.length;n++){var s=o[n];if(s.name===e.variationName)for(var l=0,p=s.defaultHierarchy.levels;l<p.length;l++){var u=p[l];if(u.name===e.level.level)return u=u.column.displayName,r&&r.includeVariationSource&&i?null!=r.hierarchyNameDelimiter?[a.displayName,u].join(r.hierarchyNameDelimiter):f.format(i.get("IncludeVariationSourceDisplayName"),a.displayName,u):u}}},x.getDisplayNameForSQAggregate=function(e,t,r,i,a,n,o,s,l){e=r.schema(e.schema).entities.withName(e.entity);if(e)return(a=c.visit(t.arg,new x(r,i,o,a,n,l,s)))?b(t,r,s,o)?a:E(a,t.func,t.arg.getMetadata(r),i):E(e.displayName,t.func,t.arg.getMetadata(r),i)},a=x,p.DisplayNameServiceVisitor=a,S.run=function(e,t,r,i,a,n,o,s){return new S(t,r,i,a,n,o,s).accept(e,t)},S.prototype.accept=function(e,t){var r,i=e;return h.isAggregation(i)?(r=c.visit(i.arg,this),b(i,this.schema,this.displayOptions,this.aggrOps)?r:E(r,i.func,i.arg.getMetadata(this.schema),this.locOptions)):c.visit(e,this,t)},S.prototype.visitEntity=function(e){var t=a.getDisplayNameForEntity(e,this.schema);return this.formatWithEntity(t,e)},S.prototype.visitColumn=function(e){var t=a.getDisplayNameForProperty(e,this.schema);return this.formatWithEntity(t,e)},S.prototype.visitColumnAggr=function(e){},S.prototype.visitGroupingColumn=function(e){var t=a.getDisplayNameForProperty(e,this.schema);return this.formatWithEntity(t,e)},S.prototype.visitGroupingColumnAggr=function(e){},S.prototype.visitColumnHierarchyVariation=function(e){var t=a.getVariationHierarchyName(e,this.schema,this.displayOptions,this.locOptions.stringResourceProvider);return this.formatWithEntity(t,e.source)},S.prototype.visitColumnHierarchyLevelVariation=function(e){var t=a.getVariationLevelName(e,this.schema,this.displayOptions,this.locOptions.stringResourceProvider);return this.formatWithEntity(t,e.source)},S.prototype.visitColumnSubquery=function(e){},S.prototype.visitColumnAggrSubquery=function(e){},S.prototype.visitColumnTransformRef=function(e){},S.prototype.visitEntityAggr=function(e){var t=a.getDisplayNameForSQAggregate(e,g.fromEntityAggr(e),this.schema,this.locOptions,this.visualCapabilities,this.visualTimeSynchronizationService,this.aggrOps,this.displayOptions,this.networkAvailabilityService);return this.formatWithEntity(t,e)},S.prototype.visitHierarchy=function(e){var t=a.getDisplayNameForHierarchy(e,this.schema);return this.formatWithEntity(t,e)},S.prototype.visitHierarchyLevel=function(e){var t=a.getDisplayNameForHierarchyLevel(e,this.schema,this.displayOptions,this.locOptions.stringResourceProvider);return this.formatWithEntity(t,e)},S.prototype.visitHierarchyLevelAggr=function(e){},S.prototype.visitMeasure=function(e){var t=this.locOptions.qualifiedDisplayNameTemplate,r=a.getDisplayNameForProperty(e,this.schema),e=a.getDisplayNameForEntity(e,this.schema);return e?f.format(t,e,r):r},S.prototype.visitSelectRef=function(e){},S.prototype.visitPercentile=function(e){var t=this.locOptions.showValueAsDisplayNames;return y.format(e.exclusive?t.PercentileExclusive:t.PercentileInclusive,[this.accept(g.fieldExpr(e.arg)),e.k])},S.prototype.visitPercentOfGrandTotal=function(e){return y.format(this.locOptions.showValueAsDisplayNames.PercentOfGrandTotalTooltip,[this.accept(g.fieldExpr(e.baseExpr))])},S.prototype.visitPercentOfRoleTotal=function(t){if(this.visualCapabilities,this.visualCapabilities.dataRoleTotals,this.visualCapabilities&&this.visualCapabilities.dataRoleTotals){var e=this.visualCapabilities.dataRoleTotals,e=_.find(e,(function(e){return _.isEqual(t.roles,e.roles)}));if(e)return e=v.data.getDisplayName(e.tooltip,this.locOptions.stringResourceProvider),y.format(e,[this.accept(g.fieldExpr(t.baseExpr))])}},S.prototype.visitTransformOutputRoleRef=function(e){return e.expressionName},S.prototype.visitFilteredEval=function(e){for(var t=this.locOptions.stringResourceProvider.get("VisualTitle_For_Template"),r=this.accept(g.fieldExpr(e.baseExpr)),i=[],a=new p.FilterRestatementVisitor(this.schema,this.locOptions,this.visualTimeSynchronizationService,this.networkAvailabilityService,new S(this.schema,this.locOptions,this.aggrOps,this.visualCapabilities,this.visualTimeSynchronizationService,this.networkAvailabilityService,this.displayOptions),this.displayOptions),n=0,o=e.filters;n<o.length;n++){var s=o[n],s=m.visit(s,a);null!=s&&i.push(s)}if(!_.isEmpty(i))return e=d.concatStrings(i,"FilterRestatement_CompoundAnd",this.locOptions),y.format(t,[r,e])},S.prototype.visitArithmetic=function(e){return t(this.accept(g.fieldExpr(e.left)),this.accept(g.fieldExpr(e.right)),e,this.locOptions)},S.prototype.visitConstant=function(e){return v.visuals.valueFormatter.format(e.value,void 0)},S.prototype.visitSparklineData=function(e){return this.locOptions.stringResourceProvider.format("VisualTitle_By_Template",this.accept(g.fieldExpr(e.measure)),this.accept(g.fieldExpr(e.grouping[0])))},S.prototype.visitNativeVisualCalc=function(e){return e.name},S.prototype.formatWithEntity=function(e,t){var r=this.locOptions.qualifiedDisplayNameTemplate,t=a.getDisplayNameForEntity(t,this.schema);return t?f.format(r,t,e):e},n=S,p.QualifiedDisplayNameVisitor=n,i.run=function(e,t){t=new i(t);return c.visit(e,t)},i.prototype.visitColumn=function(e){return this.getPropertyDescription(e)},i.prototype.visitColumnAggr=function(e){return this.getPropertyDescription(e)},i.prototype.visitGroupingColumn=function(e){return this.getPropertyDescription(e)},i.prototype.visitGroupingColumnAggr=function(e){return this.getPropertyDescription(e)},i.prototype.visitColumnHierarchyVariation=function(e){e=e.hierarchy,e=this.findHierarchy(e);if(e)return e.description},i.prototype.visitColumnHierarchyLevelVariation=function(e){return this.getHierarchyLevelDescription(e.level)},i.prototype.visitColumnSubquery=function(e){},i.prototype.visitColumnAggrSubquery=function(e){},i.prototype.visitColumnTransformRef=function(e){},i.prototype.visitEntity=function(e){return this.getEntityDescription(e)},i.prototype.visitEntityAggr=function(e){return this.getEntityDescription(e)},i.prototype.visitHierarchy=function(e){e=this.findHierarchy(e);if(e)return e.description},i.prototype.visitHierarchyLevel=function(e){return this.getHierarchyLevelDescription(e)},i.prototype.visitHierarchyLevelAggr=function(e){return this.getHierarchyLevelDescription(e)},i.prototype.visitMeasure=function(e){return this.getPropertyDescription(e)},i.prototype.visitPercentile=function(e){return c.visit(e.arg,this)},i.prototype.visitPercentOfGrandTotal=function(e){return c.visit(e.baseExpr,this)},i.prototype.visitPercentOfRoleTotal=function(e){return c.visit(e.baseExpr,this)},i.prototype.visitSelectRef=function(e){},i.prototype.visitTransformOutputRoleRef=function(e){},i.prototype.visitFilteredEval=function(e){},i.prototype.visitArithmetic=function(e){},i.prototype.visitConstant=function(e){},i.prototype.visitSparklineData=function(e){},i.prototype.visitNativeVisualCalc=function(e){},i.prototype.getPropertyDescription=function(e){var t=this.schema.schema(e.schema);if(t)return(t=t.findProperty(e.entity,e.name))&&t.description},i.prototype.getEntityDescription=function(e){var t=this.schema.schema(e.schema);if(t)return(t=t.entities.withName(e.entity))&&t.description},i.prototype.getHierarchyLevelDescription=function(e){var t=this.findHierarchy(e);if(t)return(t=t.levels.withName(e.level))&&t.description},i.prototype.findHierarchy=function(e){var t=this.schema.schema(e.schema);if(t)return t.findHierarchy(e.entity,e.name)},r=i,p.getAggregateKey=o})(powerbi=powerbi||{}),(function(e){function i(){}e=(e=e.explore||(e.explore={})).util||(e.util={}),i.DetailVisualBorder=10,i.supportsVisualDetails=function(e,t,r){t=t.capabilities(e);return!(!t||!r.isQueryVisual(e)||r.isAnalysisVisual(e)||t.disableVisualDetails)&&_.some(t.dataViewMappings,(function(e){return e.categorical||e.matrix||e.table||e.tree}))},i.getDetailVisualViewport=function(e,t){var r,t=1===(t||1)?(r=e.width-2*i.DetailVisualBorder,e.height-i.DetailVisualBorder):(r=e.width-i.DetailVisualBorder,e.height-2*i.DetailVisualBorder);return{width:Math.max(r,0),height:Math.max(t,0),scale:e.scale}},i.adjustViewport=function(e,t,r){e=e||1,t=i.getDetailVisualViewport(t,e);return t=r&&1===e?{width:t.width,height:Math.max(t.height-33,0),scale:t.scale}:t},e.DetailVisualUtils=i})(powerbi=powerbi||{}),(function(c){var e,r,i,d,a,p,m,n;function t(e,t,r,i){this.eventBridge=e,this.visualPlugin=t,this.visualPluginOps=r,this.runningVisualService=i}e=c.explore||(c.explore={}),r=e.services||(e.services={}),i=c.explore.util.DetailVisualUtils,d=c.explore.util.DrillUtils,a=jsCommon.EnumExtensions,p=c.visuals.plugins,m=e.util.VisualContainerUtils,r.createDrillService=function(e,t,r,i){return new n(e,t,r,i)},t.prototype.getSupportedDrillDirections=function(e,t){var r=this.getProjections(e);if(!r)return 0;t=t?[t]:[];if(_.isEmpty(t)){var i=e.config.singleVisual,i=this.visualPlugin.capabilities(i.visualType);if(!i||i.drilldown&&i.drilldown.suppresDrillOperations)return 0;t=d.getDrillableRoles(i)}for(var a=0,n=0,o=t;n<o.length;n++){var s,l,p,u=o[n],c=r[u];c&&c.activeProjectionRefs&&1!==(s=c.all()).length&&(l=c.activeProjectionRefs,p=this.findActiveProjectionIndexInQueryCollection(s,l),_.isEmpty(l)||p+l.length===s.length||(this.canDrillDownLevel(e,2,u)&&(a|=2),this.canDrillDownLevel(e,3,u)&&(a|=4)),!_.isEmpty(c.activeProjectionRefs))&&(0!==p||1<l.length)&&(a|=1)}return a},t.prototype.setDrillMode=function(e,t){e&&e.drillMode!==t&&(e.drillMode=t,this.raiseDrillModeChanged(e,t))},t.prototype.canSeeData=function(e){var t;return!(!(e&&e.config&&e.config.singleVisual&&e.config.singleVisual.query)||(t=m.getVisualType(e),(e=this.runningVisualService.getVisual(e))&&!!e.getErrorInfo()))&&i.supportsVisualDetails(t,this.visualPlugin,this.visualPluginOps)},t.prototype.canDrillToDetails=function(e,t){if(!e)return!1;var r=m.getVisualQuery(e);if(!r)return!1;var i=m.getVisualType(e);if(i===p.lineChart.name||i===p.areaChart.name||i===p.stackedAreaChart.name)return!1;i=m.getVisualCapabilities(e,this.visualPlugin);if(!i||!1===i.supportsSelection)return!1;var a=_(m.getSelectExprs(e)).filter((function(e){return c.data.SQExpr.isAggregation(e.expr)})).map((function(e){return e.name})).value();if(_.isEmpty(a))return!1;if(!_.isEmpty(t)&&!_.includes(a,_.head(_.head(t).metadata)))return!1;e=i.dataRoles;if(_.isEmpty(e))return!1;for(var n=0,o=0,s=_(e).filter((function(e){return e.kind===c.VisualDataRoleKind.Measure&&0!==e.joinPredicate})).map((function(e){return e.name})).value();o<s.length;o++){var l=s[o],l=r.projections[l];if(!_.isEmpty(l)){if(1<++n)return!1;l=l.all();if(_.some(l,(function(e){return!_.includes(a,e.queryRef)})))return!1}}return 0!==n},t.prototype.canDrillByDirection=function(e,t,r){var i;return!(!e||(i=this.runningVisualService.getVisual(e))&&!!i.getErrorInfo()||!(i=this.getSupportedDrillDirections(e,r)))&&a.hasFlag(i,t)},t.prototype.canDrillthrough=function(e){return!!e},t.prototype.isDrillModeEnabled=function(e,t){return!!e&&e.drillMode===t},t.prototype.drillToLastLevel=function(e){if(null!=e&&null!=e.config.singleVisual.query){var t=e.config.singleVisual,e=this.visualPlugin.capabilities(t.visualType),e=d.getDrillableRoles(e);if(!_.isEmpty(e))for(var r=0,i=e;r<i.length;r++){var a=i[r];if(s=o=n=void 0,a=a){var n=t.query.projections[a];if(null!=n){a=n.getLastActiveQueryReference();if(null!=a)for(var o=n.getQueryRefs(),a=o.indexOf(a),s=a+1;s<o.length;s++)n.addActiveQueryReference(o[s])}}}}},t.prototype.canDrillDownLevel=function(r,i,a){var n,o=m.getVisualQuery(r);if(!o)return!1;var e=m.getVisualCapabilities(r,this.visualPlugin);if(!e)return!1;if(e.drilldown&&e.drilldown.suppresDrillOperations)return!1;if(!a)return!1;var s=o.projections[a],t=s.getLastActiveQueryReference();if(!t)return!1;for(var l=_.findIndex(s.all(),(function(e){return e.queryRef===t})),p=0;p<l;p++){var u=(function(e){var e=s.all()[e],t=null==(n=o.defn.select().withName(e.queryRef))?void 0:n.expr;if(t&&0===_.filter(r.filters,(function(e){return"canDrillDownLevel: visualContainer with name ".concat(r.name," contains blank value in .filters"),null!=e&&2===e.howCreated&&c.data.SQExpr.equals(t,e.expression)})).length)return{value:o.currentDrillMode(a)===i}})(p);if("object"==typeof u)return u.value}return 3!==i||!_.find(o.expansionStates,(function(e){return _.find(e.roles,(function(e){return e===a}))&&e.isStateModified()}))},t.prototype.getProjections=function(e){return e&&e.config&&e.config.singleVisual&&e.config.singleVisual.query&&e.config.singleVisual.query.projections},t.prototype.findActiveProjectionIndexInQueryCollection=function(e,t){if(!_.isEmpty(t))for(var r=0;r<e.length;r++){for(var i=r,a=0;a<t.length&&i<e.length&&t[a]===e[i].queryRef;)a++,i++;if(a===t.length)return r}return-1},t.prototype.raiseDrillModeChanged=function(e,t){this.eventBridge.publishToChannel(r.events.drillModeChanged,{visualContainer:e})},n=t})(powerbi=powerbi||{}),(function(e){var t;e=(e=e.explore||(e.explore={})).services||(e.services={}),(t=e.SectionNavigationAction||(e.SectionNavigationAction={}))[t.Unknown=0]="Unknown",t[t.Swipe=1]="Swipe",(t=e.events||(e.events={})).modelChangeApplyingUpdate={type:4,name:"modelChangeApplyingUpdate"},t.explorationLoaded={type:1,name:"explorationLoaded"},t.explorationUnloaded={type:1,name:"explorationUnloaded"},t.explorationContainerReady={type:3,name:"explorationContainerReady"},t.explorationSlowDataSourceSettingsLoaded={type:1,name:"explorationSlowDataSourceSettingsLoaded"},t.explorationSettingsLoaded={type:1,name:"explorationSettingsLoaded"},t.updateNavButtonEvent={type:1,name:"updateNavButtonEvent"},t.userActionTriggered={type:2,name:"userActionTriggered"},t.filterContainerChanged={type:2,name:"filterContainerChanged"},t.applyAllBufferedFilterCardChanged={type:1,name:"applyAllBufferedFilterCardChange"},t.applyAllClicked={type:1,name:"applyAllClicked"},t.applyAllSlicersClicked={type:1,name:"applyAllSlicersClicked"},t.explorationFiltersContainerChanged={type:1,name:"explorationFiltersContainerChanged"},t.sectionFiltersContainerChanged={type:1,name:"sectionFiltersContainerChanged"},t.sectionDrillthroughLinkChanged={type:1,name:"sectionDrillthroughLinkChanged"},t.formFactorChanged={type:1,name:"formFactorChanged"},t.canvasLayoutChanged={type:1,name:"canvasLayoutChanged"},t.setPaneFocus={type:1,name:"setPaneFocus"},t.modelChanging={type:0,name:"modelChanging"},t.modelChanged={type:0,name:"modelChanged"},t.visualRelationshipsModeChanged={type:2,name:"visualRelationshipsModeChanged"},t.schemaItemActivationChanged={type:0,name:"schemaItemActivationChanged"},t.selectionChanged={type:2,name:"selectionChanged"},t.visualTypeChanged={type:2,name:"visualTypeChanged"},t.visualLinkButtonClicked={type:2,name:"visualLinkButtonClicked"},t.dataPointsSelected={type:2,name:"dataPointsSelected"},t.dataHyperlinkClicked={type:2,name:"dataHyperlinkClicked"},t.visualClicked={type:2,name:"visualClicked"},t.undoRedoStackUpdated={type:1,name:"undoRedoStackUpdated"},t.undoRedoStackCleared={type:1,name:"undoRedoStackCleared"},t.onReportChanged={type:1,name:"onReportChanged"},t.onReportChangedGlobal={type:4,name:"onReportChanged"},t.clipboardDataUpdated={type:1,name:"clipboardDataUpdated"},t.dataSelectionChanged={type:2,name:"dataSelectionChanged"},t.drillModeChanged={type:2,name:"drillModeChanged"},t.refreshExploration={type:2,name:"refreshExploration"},t.clearAnnotations={type:2,name:"clearAnnotations"},t.saveReportCompleted={type:0,name:"saveReportCompleted"},t.customSaveAsTriggered={type:0,name:"customSaveAsTriggered"},t.sectionLayoutRemoved={type:1,name:"sectionLayoutRemoved"},t.canvasChanged={type:1,name:"canvasChanged"},t.visualContainerParentActivityLinkingDone={type:2,name:"visualContainerParentActivityLinkingDone"},t.fieldWellFieldRemovedEvent={type:2,name:"fieldWellFieldRemoved"},t.visualContainerChanged={type:2,name:"visualContainerChanged"},t.visualContainerAdded={type:2,name:"visualContainerAdded"},t.cancelVisualQuery={type:2,name:"cancelVisualQuery"},t.dataRefreshTriggered={type:2,name:"triggerDataRefresh"},t.visualContainerGroupChanged={type:2,name:"visualContainerGroupChanged"},t.visualContainerGroupRendered={type:2,name:"visualContainerGroupRendered"},t.visualContainerDataRenderingStarted={type:2,name:"visualContainerDataRenderingStarted"},t.visualContainerDataRendered={type:2,name:"visualContainerDataRendered"},t.canvasItemContainerPositionChanged={type:2,name:"canvasItemContainerPositionChanged"},t.visualContainerLoadingStarted={type:2,name:"visualContainerLoadingStarted"},t.visualContainerLoadingStopped={type:2,name:"visualContainerLoadingStopped"},t.visualConversion={type:2,name:"visualConversion"},t.focusExplorationEvent={type:3,name:"focusExplorationEvent"},t.focusVisualContainerEvent={type:2,name:"focusVisualContainerEvent"},t.canvasSizeChangedEvent={type:2,name:"canvasSizeChanged"},t.visualPluginsChanged={type:2,name:"visualPluginsChanged"},t.addCustomVisual={type:2,name:"addCustomVisual"},t.deleteCustomVisual={type:2,name:"deleteCustomVisual"},t.modelingContextChanged={type:0,name:"modelingContextChanged"},t.changeViewMode={type:2,name:"changeViewMode"},t.requestViewModeChange={type:2,name:"requestViewModeChange"},t.editModeChanged={type:2,name:"editModeChanged"},t.getClusters={type:2,name:"getClusters"},t.toggleSortVisualContainer={type:2,name:"toggleSortVisualContainer"},t.toggleSortDirectionVisualContainer={type:2,name:"toggleSortDirectionVisualContainer"},t.saveKeyPressedEvent={type:1,name:"saveEventViaCtrlS"},t.highContrastModeChanged={type:1,name:"highContrastModeChanged"},t.canvasDisplayChanged={type:1,name:"canvasDisplayChanged"},t.canvasZoomChanged={type:1,name:"canvasZoomChanged"},t.canvasZoomScaleUpdated={type:1,name:"canvasZoomScaleUpdated"},t.canvasDimensionChanged={type:1,name:"canvasDimensionChanged"},t.explorationObjectsLoaded={type:3,name:"explorationObjectsLoaded"},t.explorationObjectsChanged={type:3,name:"explorationObjectsChanged"},t.sectionObjectsEvaluated={type:1,name:"sectionObjectsEvaluated"},t.sectionObjectsChanged={type:1,name:"sectionObjectsChanged"},t.datasourceVariablesEditClicked={type:3,name:"showDataSourceVariablesDialog"},t.themeDialogButtonClicked={type:3,name:"showThemeDialog"},t.visibilityChanged={type:2,name:"visibilityChanged"},t.canvasItemHiddenChanged={type:2,name:"canvasItemHiddenChanged"},t.align={type:1,name:"align"},t.deleteSectionInitiated={type:1,name:"deleteSectionInitiated"},t.sectionNameChanged={type:1,name:"sectionNameChanged"},t.sectionDeleted={type:1,name:"sectionDeleted"},t.renameSection={type:1,name:"renameSection"},t.sectionChanged={type:1,name:"sectionChanged"},t.podParameterChanged={type:1,name:"podParameterChanged"},t.missingTableRelationship={type:2,name:"missingTableRelationship"},t.addVisualContainer={type:1,name:"addVisualContainer"},t.addCustomVisualToCanvas={type:3,name:"addCustomVisualToCanvas"},t.deleteVisualContainer={type:2,name:"deleteVisualContainer"},t.addInsightContainer={type:1,name:"addInsightContainer"},t.addQnaContainer={type:1,name:"addQnaContainer"},t.showQnaPopout={type:1,name:"showQnaPopoutEventArgs"},t.canvasPinched={name:"canvasPinched",type:1},t.changeFormFactor={name:"changeFormFactor",type:1},t.arrangeVisualsOrder={type:1,name:"arrangeVisualsOrder"},t.createImage={type:1,name:"createImage"},t.createBasicShape={type:1,name:"createBasicShape"},t.createShape={type:1,name:"createShape"},t.createActionButton={type:1,name:"createActionButton"},t.createNavigator={type:1,name:"createPageNavigator"},t.createTextbox={type:1,name:"createTextbox"},t.importVisual={type:1,name:"importVisual"},t.addManagedCustomVisual={type:4,name:"addManagedCustomVisual"},t.installVisual={type:1,name:"installVisual"},t.downloadVisual={type:1,name:"downloadVisual"},t.newQueryCacheResultAvailable={type:2,name:"newQueryCacheResultAvailable"},t.exportVisualData={type:2,name:"exportVisualData"},t.exportVisualDataFromPane={type:1,name:"exportVisualDataFromPane"},t.addCommentVisual={type:2,name:"addCommentVisual"},t.shareToTeamsVisual={type:2,name:"shareToTeamsVisual"},t.reportSlidesChanged={type:1,name:"reportSlidesChanged"},t.createSection={type:1,name:"createSection"},t.deleteSection={type:1,name:"deleteSection"},t.duplicateSection={type:1,name:"duplicateSection"},t.insertSection={type:1,name:"insertSection"},t.reorderSection={type:1,name:"reorderSection"},t.switchSection={type:1,name:"switchSection"},t.explorationNextPage={type:3,name:"explorationNextPage"},t.explorationPreviousPage={type:3,name:"explorationPreviousPage"},t.startExplorationContainerLoading={type:3,name:"startExplorationContainerLoading"},t.stopExplorationContainerLoading={type:3,name:"stopExplorationContainerLoading"},t.copyTable={type:1,name:"copyDataTable"},t.showEnableScriptVisualsDialog={type:2,name:"showEnableScriptVisualsDialog"},t.CanvasResized={type:1,name:"canvasResized"},t.openReportFinished={type:4,name:"openReportFinished"},t.openReportLoadingScreenHidden={type:4,name:"openReportLoadingScreenHidden"},t.visualQueryThrottled={type:4,name:"visualQueryThrottled"},t.datasetNotFound={type:4,name:"datasetNotFound"},t.ShowVisuals={type:4,name:"ShowVisuals"},t.bookmarkApplied={type:1,name:"bookmarkApplied"},t.exploreCanvasVisualRendered={type:1,name:"exploreCanvasVisualRendered"},t.reportVisualError={type:2,name:"ReportVisualError"},t.reportVisualErrorGlobal={type:4,name:"ReportVisualError"},t.visualThumbnailDoubleClicked={type:3,name:"visualThumbnailDoubleClicked"},t.removeVisualContainerFromLayout={type:2,name:"removeVisualContainerFromLayout"},t.pauseQueriesChanged={type:1,name:"pauseQueriesChanged"},t.deleteVisual={type:2,name:"deleteVisual"},t.deleteCustomVisuals={type:2,name:"deleteCustomVisuals"},t.resetPersistentUserState={type:4,name:"resetPersistentUserState"},t.resetUserStateKeyPressedEvent={type:1,name:"resetUserStateKeyPressedEvent"},t.resetUserStateEvent={type:4,name:"resetUserStateEvent"},t.reloadPersistenState={type:3,name:"reloadPersistenState"},t.togglePaneVisibility={type:1,name:"togglePaneVisibility"},t.visualDrillFilterOtherVisualsSettingChanged={type:2,name:"visualDrillFilterOtherVisualsSettingChanged"},t.emulationChanged={type:0,name:"emulationChanged"},t.showOtherBookmarks={type:3,name:"showOtherBookmarks"},t.parentExpandCollapseAction={type:2,name:"parentExpandCollapseAction"},t.bookmarkViewStateChanged={type:3,name:"bookmarkViewStateChanged"},t.exportDataStarted={type:0,name:"exportDataStarted"},t.exportDataEnded={type:0,name:"exportDataEnded"},t.visualContainerControllerLinked={type:2,name:"visualContainerControllerLinked"},t.insightsInFocusPaneClose={type:4,name:"insightsInFocusPaneClose"},t.pinInsightContainer={type:4,name:"pinInsightContainer"},t.insightSelected={type:4,name:"insightSelected"},t.getRelatedInsights={type:4,name:"getRelatedInsights"},t.viewInsightInFocus={type:4,name:"viewInsightInFocus"},t.autoPageRefreshTriggered={type:0,name:"autoPageRefreshTriggered"},t.drillthroughActionTriggered={type:2,name:"drillthroughActionTriggered"},t.anchorTimeUpdated={type:4,name:"anchorTimeUpdated"},t.visualCancelLoadEvent={type:4,name:"visualCancelLoadEvent"},t.shareVisual={type:2,name:"shareVisual"},t.shareVisualToPPT={type:2,name:"shareVisualToPPT"},t.saveAsExploration={name:"saveAsExploration"},t.generateReportQR={name:"generateReportQR"},t.saveExploration={name:"saveExploration"},t.saveReportFromPinDialogEvent={type:4,name:"saveReportFromPinDialog"},t.findAnomalies={type:2,name:"findAnomalies"},t.forecast={type:2,name:"forecast"},t.toggleDataTable={type:2,name:"toggleDataTable"},t.affectsVisualContainer=function(e,t){return e.visualContainer===t}})(powerbi=powerbi||{}),(function(i){var e,t,l,p,u,r;function a(e){this.visualPlugin=e}e=i.explore||(i.explore={}),t=e.services||(e.services={}),l=i.data.ExpansionState,p=i.data.Selector,u=e.util.VisualContainerUtils,t.createExpandCollapseService=function(e,t){return new r(e)},a.prototype.getExpandCollapseRoles=function(e){i.contract.checkValue(e,"visual should have a value");e=this.visualPlugin.capabilities(u.getVisualType(e));if(e&&e.expandCollapse&&!_.isEmpty(e.expandCollapse.roles))return e.expandCollapse.roles},a.prototype.isSupported=function(e,t,r){var i;return!!(t&&e&&e.supportsInstanceFilters)&&!(!(i=u.getVisualQuery(t))||!_.isEmpty(r)&&_.some(r,(function(e){return 3===i.currentDrillMode(e)})))},a.prototype.isEnabled=function(e,t){var r;return i.contract.checkValue(e,"visual should have a value"),!_.isEmpty(t)&&(r=this.getExpandCollapseRoles(e),!_.isEmpty(r))&&!_.some(t,(function(e){return-1===_.indexOf(r,e)}))},a.prototype.getMaximumExpansionDepth=function(e,t){if(this.isEnabled(e,t)){e=u.getVisualQuery(e);if(e)return e.getRolesProjectionRefs(t).length}},a.prototype.getAllowedActions=function(e,t,r){var i=u.getVisualQuery(e);if(i&&this.isEnabled(e,t)&&!_.isEmpty(r)&&1===r.length){r=r[0];if(r&&r.dataMap&&!_.isEmpty(r.dataMap)){var a,n,o,s=p.toScopeIdentities(p.convertSelectorsByColumnToSelector(r));if(!_.isEmpty(s))return o=i.getRolesUniqueProjectionRefs(t),e=(a=i.getRolesUniqueActiveProjectionsRefs(t,this.canCollapseRoot(e))).length===o.length,n=_.some(t,(function(e){return 3===i.currentDrillMode(e)})),1===o.length||n?{}:(n=this.getSelectorRefs(r),_.some(n,(function(e){return!_.includes(a,e)}))?void 0:(n=(r=s.length)===o.length,o=r===a.length,(r=l.findExpansionState(i.expansionStates,t))?(t=r.getNodeLevelState(s,r.root,0),{expandNode:!n&&!!t.isNodeCollapsed,collapseNode:!o&&!t.isNodeCollapsed,expandLevel:!n&&(t.levelHasToggledNodes||!!t.isNodeCollapsed),collapseLevel:!o&&(t.levelHasToggledNodes||!t.isNodeCollapsed),expandHierarchy:!e||!r.isHierarchyExpanded(),collapseHierarchy:!r.isWholeLevelCollapsed(0)}):{expandNode:!n&&o,collapseNode:!o,expandLevel:!n&&o,collapseLevel:!o,expandHierarchy:!e,collapseHierarchy:1<a.length}))}}},a.prototype.getSelectorRefs=function(e){if(!e||!e.dataMap||_.isEmpty(e.dataMap))return[];var t,r=[];for(t in e.dataMap)r.push(t);return r},a.prototype.expandNode=function(e,t,r){var i,a=this.setNodeState(e,t,r,!1);a&&(i=this.ensureExpansionState(e,t),r=this.getSelectorRefs(r).length-1,i=i.getVisibleDescendentsDepth(a,r),a=u.getVisualQuery(e))&&a.getRolesUniqueActiveProjectionsRefs(t,this.canCollapseRoot(e)).length<i&&this.setActiveProjections(e,t,i)},a.prototype.collapseNode=function(e,t,r){this.setNodeState(e,t,r,!0);r=this.ensureExpansionState(e,t),r=r.getVisibleDescendentsDepth(r.root,-1);this.setActiveProjections(e,t,r)},a.prototype.expandLevel=function(e,t,r,i){void 0===i&&(i=!1);var a=this.ensureExpansionState(e,t),r=(this.setLevelState(e,t,r,!1,i),a.getVisibleDescendentsDepth(a.root,-1));this.setActiveProjections(e,t,r)},a.prototype.collapseLevel=function(e,t,r,i){this.setLevelState(e,t,r,!0,i=void 0===i?!1:i),this.setActiveProjections(e,t,r+1)},a.prototype.expandAll=function(e,t){this.setAllLevelsState(e,t,!1);var r=this.ensureExpansionState(e,t).levels.length;this.setActiveProjections(e,t,r)},a.prototype.collapseAll=function(e,t){this.setAllLevelsState(e,t,!0),this.setActiveProjections(e,t,this.canCollapseRoot(e)?0:1)},a.prototype.pinLevels=function(e,t,r){this.ensureExpansionState(e,t).pinLevels(r)},a.prototype.unpinLevels=function(e,t,r){this.ensureExpansionState(e,t).unpinLevels(r)},a.prototype.lockLevels=function(e,t,r){this.ensureExpansionState(e,t).lockLevels(r)},a.prototype.unlockLevels=function(e,t,r){this.ensureExpansionState(e,t).unlockLevels(r)},a.prototype.setAILevelInformation=function(e,t,r,i,a){e=this.ensureExpansionState(e,t);"Level at index ".concat(r," does not match expected query refs"),e.setAILevelInformation(r,a)},a.prototype.getAILevelInformation=function(e,t,r){e=u.getVisualQuery(e);return l.getAILevelInformation(e.expansionStates,t,r)},a.prototype.clearAILevelsInformation=function(e,t){for(var r=this.ensureExpansionState(e,t),i=0;i<_.size(r.levels);i++)r.setAILevelInformation(i,void 0)},a.prototype.setNodeState=function(e,t,r,i){var t=this.ensureExpansionState(e,t),a=this.getSelectorRefs(r);if(!_.isEmpty(a)||this.canCollapseRoot(e))return t.setNodeState(p.convertSelectorsByColumnToSelector(r),i)},a.prototype.setLevelState=function(e,t,r,i,a){var n=this.ensureExpansionState(e,t);if(n.levels,a)for(var o=0;o<r;o++)n.levels[o],"expandCollapseService.setLevelState - level for index ".concat(o," doesn't exist"),n.setLevelState(o,!1);n.setLevelState(r,i)},a.prototype.setAllLevelsState=function(e,t,r){for(var i=this.ensureExpansionState(e,t),a=(i.levels,this.canCollapseRoot(e)&&i.setLevelState(-1,r),i.levels),n=0;n<a.length-1;n++)i.setLevelState(n,r)},a.prototype.ensureExpansionState=function(e,t){var r=u.getVisualQuery(e),i=this.visualPlugin.capabilities(u.getVisualType(e)),a=i&&i.expandCollapse&&i.expandCollapse.supportsMerge,i=i&&i.expandCollapse&&i.expandCollapse.collapseParentAfterRemovingChildLevel,e=this.canCollapseRoot(e),r=r.ensureExpansionState(t,{supportsMerge:a,canCollapseRoot:e,collapseParentAfterRemovingChildLevel:i});return r.levels,r},a.prototype.canCollapseRoot=function(e){e=this.visualPlugin.capabilities(u.getVisualType(e));return!(!e||!e.noDefaultProjections)},a.prototype.setActiveProjections=function(e,t,r){this.canCollapseRoot(e);e=u.getVisualQuery(e);e.setActiveProjections(t,r)},r=a})(powerbi=powerbi||{}),(function(p){var u,e;function c(e,t,r){t&&(e.usageReportSection=r&&r.isNewUsageMetrics?t.displayName:void 0),r&&(e.isNewUsageMetrics=r.isNewUsageMetrics,e.isUsageMetrics=r.isUsageMetrics)}u=p.explore||(p.explore={}),(e=(e=u.util||(u.util={})).ExplorationTelemetryUtil||(e.ExplorationTelemetryUtil={})).addExplorationInfoToEvent=function(e,t){var r,i,a,n={},o=t.getCurrentSection(),s=t.getCurrentExploration(),l=t.getExplorationTelemetryData();switch(o&&(n={activeSectionId:o.id,sectionGuid:o.objectId,sectionIndex:s&&s.activeSectionIndex},e.name!==p.telemetry.EXOpenExplorationEventName&&e.name!==p.telemetry.EXSwitchSectionEventName&&e.name!==p.telemetry.EXSwitchToAdjacentSectionEventName&&e.name!==p.telemetry.EXNavigateBackEventName&&e.name!==p.telemetry.EXNavigationButtonClickedEventName||(n.visualTypesAndCounts=JSON.stringify(u.util.VisualContainerUtils.getVisualTypesAndCountsFromSection(o)))),l&&(n.modelId=l.modelId,n.reportGuid=l.reportGuid,n.dataCacheMode=l.dataCacheMode,n.datasetHost=l.datasetHost,n.dbName=l.dbName,n.enterpriseCapacitySkuTier=l.enterpriseCapacitySkuTier,n.isDirectQuery=l.isDirectQuery,n.isOnPrem=l.isOnPrem,n.exid=l.exid,n.exsid=l.exsid),e.name){case p.telemetry.EXOpenExplorationEventName:r=n,(i=s)&&!_.isEmpty(i.sections)&&(r.areAnySectionQuickExplore=u.SectionUtils.areAnySectionQuickExplore(i.sections),r.creationSource=i.creationSource),c(n,o,l);break;case p.telemetry.EXSwitchSectionEventName:c(n,o,l)}_.isEmpty(n)||(a=e.formatted||function(){return{}},e.formatted=function(){return p.extendFormatted(a.apply(e),n)})},e.addExplorationSettingsInfoToEvent=function(e,t){var r,i,a;_.isEmpty(t)||(r={},null!=t.queryLimitOption&&(r.queryLimitOption=t.queryLimitOption),null!=t.customMemoryLimit&&(r.customMemoryLimit=t.customMemoryLimit),null!=t.customTimeoutLimit&&(r.customTimeoutLimit=t.customTimeoutLimit),_.isEmpty(r))||((i={}).explorationSettings=JSON.stringify(r),a=e.formatted||function(){return{}},e.formatted=function(){return p.extendFormatted(a.apply(e),i)})}})(powerbi=powerbi||{}),(function(e){var v,t;function r(e){this.localization=e}((v=e.explore||(e.explore={})).services||(v.services={})).createFederatedSchemaValidator=function(e){return new t(e)},r.prototype.validate=function(e){if(e)for(var t=v.util.createNameValidator(e,this.localization),r=0,i=e.schemas;r<i.length;r++){var a=i[r];if(a.isExtensionSchema)for(var n=e.schema(a.extends),o=0,s=a.entities;o<s.length;o++){var l=s[o],p=!1;n.entities.withName(l.name)||(p=!0,l.errorMessage=this.localization.get("ReportMeasuresMissingTableErrorMessage"),l.queryable=1,l.isAbandoned=!0);for(var u=0,c=l.properties;u<c.length;u++){var d,m=c[u];1===m.kind&&((d=t.validateExistingMeasureName(m)).error===v.util.NameValidationError.DuplicatedName?(m.errorMessage=d.reason,m.queryable=1):p&&(m.errorMessage=this.localization.get("ReportMeasuresMissingTableMeasureErrorMessage"),m.queryable=1))}}}},t=r})(powerbi=powerbi||{}),(function(g){var s,m,l,t,p,v,a,f,o,n,u,C,c;function e(e,t,r,i,a,n,o,s){this.eventBridge=e,this.visualPlugins=t,this.aggrOps=r,this.relationshipService=i,this.hostFilters=a,this.telemetryService=n,this.scriptVisuals=o,this.featureSwitchService=s,this.eventBridge,this.visualPlugins,this.aggrOps,this.relationshipService,this.hostFilters,this.telemetryService,this.scriptVisuals}s=g.explore||(g.explore={}),m=s.services||(s.services={}),l=g.explore.contracts.CollectedFilterSource,t=g.data.DataViewObjectDescriptors,p=g.data.FilterKindDetector,v=g.visuals.plugins,a=g.explore.util.ScriptVisualsUtil,f=g.data.Selector,o=g.data.SemanticFilter,n=g.data.SemanticQuery,u=g.data.SQExprUtils,C=g.explore.util.VisualContainerUtils,m.createFilterGenerator=function(e,t,r,i,a,n,o,s,l){return new c(e,t,r,i,a,n,o,s)},e.prototype.collectVisualContainerFilters=function(e,t,r){var i=new m.FilterCollector(this.visualPlugins),t=(i.collectFilters(r.filters,0,r),t&&(i.collectFilters(t.filters,1),this.collectCrossFilter(i,t,r)),this.collectSelfFilter(i,r,null),e&&i.collectFilters(e.filters,2),this.hostFilters.getSelectedHostFilters());return t&&i.collectFilters(t.filters,1),i.getCollectedFilters()},e.prototype.collectVisualContainerDrillFilters=function(t){var e=new m.FilterCollector(this.visualPlugins),r=_.filter(t.filters,(function(e){return"collectVisualContainerDrillFilters: visualContainer with name ".concat(t.name," contains blank value in .filters"),null!=e&&2===e.howCreated}));return e.collectFilters(r,0,t),e.getCollectedFilters()},e.prototype.addVisualContainerFilters=function(e,t,r,i,a,n){void 0===n&&(n=!1),e.addCollectedFilters(this.collectVisualContainerFilters(t,r,i),!0,this.getShouldApplyFilter(i,a,r,n)),r&&(this.addHighlightFilter(e,r,i,a),this.addCrossDrillFilters(e,r,i,a))},e.prototype.calculateVisualContainerFilter=function(e,t,r,i,a,n){void 0===a&&(a=!1),void 0===n&&(n=!1);var o=new m.FilterBuilder(r),e=(this.addVisualContainerFilters(o,e,t,r,i,a),o.getFilters(n));return e.queryRefsForSingleItemDrillFilters=s.FilterUtils.getQueryRefsForSingleItemDrillFilters(r,i,this.aggrOps),e},e.prototype.calculateDetailVisualFilter=function(e,t,r,i,a){var n=new m.FilterBuilder(r),e=(this.addVisualContainerFilters(n,e,t,r,i),0===a&&(a=1),n.getHighlightFilters()),t=(e&&(n.clearHighlightFilters(),n.mergeHighlightFiltersBasedOnRelationship(e,a)),n.getFilters());return t.queryRefsForSingleItemDrillFilters=s.FilterUtils.getQueryRefsForSingleItemDrillFilters(r,i,this.aggrOps),t},e.prototype.clearCrossHighlight=function(e,t,r){e=this.clearCrossHighlightOperation(e);C.notifyVisualContainers(this.eventBridge,e,"UserAction_CrossHighlight",t,r)},e.prototype.clearCrossHighlightForVisualContainers=function(e,t,r,i){e=this.clearCrossHighlightForVisualContainersOperation(e,t);C.notifyVisualContainers(this.eventBridge,e,"UserAction_CrossHighlight",r,i)},e.prototype.clearCrossHighlightForVisualContainersOperation=function(e,t){var r=e.crossFilterSource&&e.crossFilterSource.highlight;if(!_.isEmpty(r)){for(var i=[],a=0,n=_.chain(r).map((function(e){return e.sourceVisualContainer})).filter((function(e){return _.includes(t,e)})).valueOf();a<n.length;a++){var o=n[a],o=this.setCrossHighlightOperation(null,null,e,3,o);i.push.apply(i,o||[])}return _.uniq(i)}},e.prototype.clearFiltersFromVisualContainers=function(e,t,r){var i,a=this,n=e&&e.crossFilterSource,o=n&&n.drill,s=n&&n.highlight,n=[];!_.isEmpty(s)&&_.some(t,(function(t){return _.some(s,(function(e){return t===e.sourceVisualContainer}))}))&&(n=this.clearCrossHighlightOperation(e)),_.isEmpty(o)||(o=this.clearCrossDrillFromVisualContainersOperation(e,t),n=_.union(n,o)),this.featureSwitchService.featureSwitches.applyAllSlicersButton&&(i=[],_.forEach(t,(function(e){var t=C.getContainerObjectDefinitions(e),t=g.data.DataViewObjectDefinitions.getValue(t,{objectName:"visualLink",propertyName:"type"},void 0);(null==t?void 0:t.value)===g.explore.contracts.VisualLink.ApplyAllSlicers&&i.push(e)})),n=_.union(n,i)),_.some(t,(function(e){return a.supportsFilterOutput(e)}))?C.notifyVisualContainers(this.eventBridge,e.visualContainers,r):_.isEmpty(n)||C.notifyVisualContainers(this.eventBridge,n,r)},e.prototype.updateCrossHighlightCollectedFilters=function(e,t,r){var i=e&&e.crossFilterSource&&e.crossFilterSource.highlight;i&&(i=_.find(i,(function(e){return e.sourceVisualContainer===r})))&&!_.isEmpty(i.selection)&&(i.collectedFilters=this.collectVisualContainerFilters(t,e,r),C.notifyVisualContainersExceptSource(this.eventBridge,r))},e.prototype.calculateFilterContainerInputFilter=function(e,t,r,i,a){var n,o;if(r&&t&&a)return 0===a.scopeType&&(n=a.container),o=new m.FilterCollector(this.visualPlugins),e&&o.collectFiltersForFilterContainer(e.filters,2,r),1===a.scopeType?(e=5===r.howCreated?_.filter(t.filters,(function(e){return null!=e&&5===e.howCreated})):t.filters,o.collectFiltersForFilterContainer(e,1,r)):2!==a.scopeType&&o.collectFiltersForFilterContainer(t.filters,1,r),this.collectSelfFilter(o,null,r),n&&(o.collectFiltersForFilterContainer(n.filters,0,r,n),this.collectCrossFilter(o,t,n)),(e=new m.FilterBuilder(n,r)).addCollectedFilters(o.getCollectedFilters(),!1,this.getShouldApplyFilterContainerInputFilter(r,n,i,t)),e.getFilters()},e.prototype.getVisualContainerCrossFilters=function(e,t,r){var i=new m.FilterCollector(this.visualPlugins),a=(this.collectCrossFilter(i,e,t),new m.FilterBuilder(t));return a.addCollectedFilters(i.getCollectedFilters(),!1,this.getShouldApplyFilter(t,r,e)),this.addHighlightFilter(a,e,t,r),this.addCrossDrillFilters(a,e,t,r),{dataFilters:a.getCrossFilters()||[],highlightFilters:a.getHighlightFilters()}},e.prototype.checkSelectionLimit=function(e,t,r,i){e=this.countSelectedDataPoints(e,t,i),t=r.length;return{existingSelectionLength:e,newSelectionLength:t,allowed:!(this.featureSwitchService.featureSwitches.dataPointLassoSelect&&e+t>g.visuals.PlotAreaLassoSelectionLimit)}},e.prototype.logRFilterTelemetry=function(e,t,r,i){t=a.getScriptVisualIdsInSection(t,this.scriptVisuals);_.isEmpty(t)||this.telemetryService.logChildEvent(i&&i.event,e,{filterType:r,visualIds:JSON.stringify(t)})},e.prototype.setCrossHighlightOperation=function(e,t,r,i,a,n,o){var s,l,p=r.crossFilterSource&&r.crossFilterSource.highlight,u=!1;if(a?(u=!0,r.crossFilterSource||(r.crossFilterSource={highlight:[]}),r.crossFilterSource.highlight||(r.crossFilterSource.highlight=[]),s=r.crossFilterSource.highlight,l=void 0,3!==i&&1!==i||!this.newAndPreviousSelectionsSupportMultiVisualSelection(a,s)?(r.crossFilterSource.highlight=s=[],l=0):-1===(l=_.findIndex(s,(function(e){return e.sourceVisualContainer===a})))&&(l=s.length),null==t?(_.isEmpty(s)||((s=__spreadArray([],s||[],!0)).splice(l,1),r.crossFilterSource.highlight=s),a=null):s[l]={sourceVisualContainer:a,selection:t,selectorFilter:f.filterFromSelectorsByColumn(t),collectedFilters:_.isEmpty(t)?[]:this.collectVisualContainerFilters(e,r,a),filterExpressionMetadata:n},this.logRFilterTelemetry(g.telemetry.EXCrossFilterScriptVisual,r,"Highlight",o)):p&&(u=!0,r.crossFilterSource.highlight=void 0),u){var c=r.crossFilterSource&&r.crossFilterSource.highlight;if(!_.isEmpty(p)){for(var d=this,m=0,v=p;m<v.length;m++)!(function(t){-1===_.findIndex(c,(function(e){return e.sourceVisualContainer===t.sourceVisualContainer}))&&C.clearDataSelection(d.eventBridge,t.sourceVisualContainer)})(v[m]);for(var y=0,h=p;y<h.length;y++)if("break"===(function(t){if(t.sourceVisualContainer!==a&&!(-1!==_.findIndex(c,(function(e){return e.sourceVisualContainer===t.sourceVisualContainer}))))return a=null,"break"})(h[y]))break}return _.filter(r.visualContainers,(function(e){return e!==a}))}},e.prototype.newAndPreviousSelectionsSupportMultiVisualSelection=function(e,t){return!(!this.supportsMultiVisualSelection(e)||1===t.length&&!this.supportsMultiVisualSelection(t[0].sourceVisualContainer))},e.prototype.supportsMultiVisualSelection=function(e){e=C.getVisualCapabilities(e,this.visualPlugins);return e&&e.supportsMultiVisualSelection},e.prototype.clearCrossHighlightOperation=function(e){if(e.crossFilterSource&&e.crossFilterSource.highlight)return this.setCrossHighlightOperation(null,null,e)},e.prototype.clearCrossDrillFromVisualContainersOperation=function(e,t){if(!_.isEmpty(t)){for(var r=[],i=0,a=t;i<a.length;i++)var n=a[i],n=this.updateCrossDrillFromVisualContainerOperation(e,n,!0),r=_.union(r,n);return r}},e.prototype.updateCrossDrillFromVisualContainerOperation=function(e,t,r){var i,a=e.crossFilterSource&&e.crossFilterSource.drill,n=!1,r=(r||(r=this.collectVisualContainerDrillFilters(t),_.isEmpty(r))||(i={sourceVisualContainer:t,collectedFilters:r}),_.findIndex(a,(function(e){return e.sourceVisualContainer===t})));if(0<=r?(n=!0,i?a[r]=i:a.splice(r,1)):i&&(n=!0,e.crossFilterSource||(e.crossFilterSource={}),(e.crossFilterSource.drill||(e.crossFilterSource.drill=[])).push(i)),n)return _.filter(e.visualContainers,(function(e){return e!==t}))},e.prototype.collectSelfFilter=function(e,t,r){var i,a,n=this;!!t?(i=this.getFilterFromFilterPropertyInVisualContainer(t,(function(e){return n.tryGetSelfFilterProperty(e)})))&&((a=o.clone(i)).setIgnoreMParameter(),e.collectFilter(a,null,t,0,l.Self)):(i=this.getFilterFromFilterPropertyInFilterContainer(r,(function(e){return n.tryGetSelfFilterProperty(e)})))&&((a=o.clone(i)).setIgnoreMParameter(),e.collectFilter(a,r,null,0,l.Self))},e.prototype.collectCrossFilter=function(e,t,r){for(var i=this,a=0,n=t.visualContainers;a<n.length;a++){var o,s=n[a];s!==r&&(o=this.getFilterFromFilterPropertyInVisualContainer(s,(function(e,t){return i.tryGetFilterPropertyIdentifier(e,t)})))&&e.collectFilter(o,null,s,0,l.Slicer)}},e.prototype.getFilterFromFilterPropertyUtil=function(e,t,r){r=r(e,t&&t.visualType);if(r){e=t.objects;if(e)return g.data.DataViewObjectDefinitions.getValue(e,r,null)}},e.prototype.getFilterFromFilterPropertyInVisualContainer=function(e,t){var r=C.getVisualCapabilities(e,this.visualPlugins),e=e.config&&e.config.singleVisual;return this.getFilterFromFilterPropertyUtil(r,e,t)},e.prototype.getFilterFromFilterPropertyInFilterContainer=function(e,t){var r=C.getFilterCapabilities(e,this.visualPlugins),e=e.config&&e.config.singleVisual;return this.getFilterFromFilterPropertyUtil(r,e,t)},e.prototype.addHighlightFilter=function(e,t,r,i){var a=t.crossFilterSource&&t.crossFilterSource.highlight;if(!_.isEmpty(a)&&C.getVisualType(r)!==v.slicer.name)for(var n=0,o=a;n<o.length;n++){var s=o[n];if(s.sourceVisualContainer!==r){var l=this.buildHighlightFiltersForRelatedTargets(s,i,t);if(!_.isEmpty(l)){var p=this.relationshipService.relationshipFilterAction(t,s.sourceVisualContainer,r,i);if(this.featureSwitchService.featureSwitches.visualCalculations&&this.hasVisualCalcExpression(r)){if(3!==p)for(var u=0,c=l;u<c.length;u++){var d=c[u];e.addSectionFilter(d)}}else{var m=C.getVisualCapabilities(r,this.visualPlugins);0===p&&(p=this.relationshipService.defaultFilterAction(s.sourceVisualContainer,r)),e.mergeHighlightFiltersBasedOnRelationship(l,p,!m.supportsHighlight)}}}}},e.prototype.hasVisualCalcExpression=function(e){e=e.config.singleVisual.query;return!!e&&e.hasVisualCalcExpressions()},e.prototype.addCrossDrillFilters=function(r,e,t,i){var a=e.crossFilterSource&&e.crossFilterSource.drill;if(!_.isEmpty(a)){for(var n=[],o=0,s=a;o<s.length;o++){var l=s[o],p=l.sourceVisualContainer;if(this.relationshipService.shouldApplyCrossDrill(e,p,t,i)){var u=new m.FilterBuilder(p),p=(u.addCollectedFilters(l.collectedFilters,!1,this.getShouldApplyDrillCrossFilter(p,i,e)),u.getUnmergedDrillCrossFilter());if(p)for(var c=0,d=p;c<d.length;c++)!(function(t){r.addCrossFilter(t);var e=_.find(l.collectedFilters,(function(e){return e.filter===t.filter}));e&&n.push(e.filterContainer)})(d[c])}}return n}},e.prototype.buildHighlightFiltersForRelatedTargets=function(e,t,r){var i=new m.FilterBuilder(e.sourceVisualContainer);return e.selectorFilter&&i.setSelectorFilter({filter:e.selectorFilter,filterExpressionMetadata:e.filterExpressionMetadata,type:s.contracts.FilterType.Include}),i.addCollectedFilters(e.collectedFilters,!1,this.getShouldApplyHighlightFilter(e.sourceVisualContainer,t,r)),i.getCrossHighlightFilters()},e.prototype.getShouldApplyFilterContainerInputFilter=function(i,a,n,o){var s=this;return function(e,t,r){return s.shouldApplyFilterContainerInputFilter(e,t,r,i,a,n,o)}},e.prototype.shouldApplyFilterContainerInputFilter=function(e,t,r,i,a,n,o){return t===i||!!this.shouldApplyFilter(e,t,r,a,n,o)&&!((i=t&&t.expression)&&u.isMeasure(i)||_.some(e.conditions(),(function(e){return 3===p.runDetector(e)})))},e.prototype.getShouldApplyHighlightFilter=function(i,a,n){var o=this;return function(e,t,r){return o.shouldApplyHighlightFilter(e,t,r,i,a,n)}},e.prototype.getShouldApplyDrillCrossFilter=function(i,a,n){var o=this;return function(e,t,r){return o.shouldApplyDrillCrossFilter(e,t,r,i,a,n)}},e.prototype.shouldApplyHighlightFilter=function(e,t,r,i,a,n){return!!this.shouldApplyFilter(e,t,r,i,a,n)&&!_.some(e.conditions(),(function(e){return 1===p.runDetector(e)}))},e.prototype.shouldApplyDrillCrossFilter=function(e,t,r,i,a,n){return!!this.shouldApplyFilterForCrossDrill(e,t,r,i,a,n)&&!_.some(e.conditions(),(function(e){return 1===p.runDetector(e)}))},e.prototype.getShouldApplyFilter=function(i,a,n,o){var s=this;return void 0===o&&(o=!1),function(e,t,r){return s.shouldApplyFilter(e,t,r,i,a,n,o)}},e.prototype.shouldApplyFilter=function(e,t,r,i,a,n,o){var s=this,o=(o=void 0===o?!1:o)?function(){return 1}:function(e,t,r,i){return s.relationshipService.relationshipFilterAction(e,t,r,i)};return this.shouldApplyFilterInternal(e,t,r,i,a,n,o)},e.prototype.shouldApplyFilterForCrossDrill=function(e,t,r,i,a,n){var o=this;return this.shouldApplyFilterInternal(e,t,r,i,a,n,(function(e,t,r,i){return o.relationshipService.drillRelationshipFilterAction(e,t,r,i)}))},e.prototype.shouldApplyFilterInternal=function(e,t,r,i,a,n,o){if(t&&s.FilterUtils.shouldDisableFilter(t,a,r,this.aggrOps,this.visualPlugins))return!1;if(!(_.isEmpty(e.validate(a,this.aggrOps))||r&&r===i))return!1;if(r&&i&&r!==i){if(3===o(n,r,i,a))return!1;t=r.config.singleVisual.syncGroup,e=i.config.singleVisual.syncGroup;if(t&&e&&t.groupName===e.groupName)return!1}return!0},e.prototype.countSelectedDataPoints=function(r,e,t){e=null==(e=e.crossFilterSource)?void 0:e.highlight;return t?_.chain(e).reduce((function(e,t){return e+(t.sourceVisualContainer!==r?t.selection.length:0)}),0).value():0},e.prototype.setMultipleFiltersOnSelectData=function(e,t,r,i,a){for(var n=this.clearCrossHighlightOperation(t),o=0,s=r;o<s.length;o++)var l=s[o],n=_.union(n,this.setCrossHighlightOperation(e,l.selection,t,3,l.sourceVisualContainer,l.filterExpressionMetadata));C.notifyVisualContainers(this.eventBridge,n,"UserAction_CrossHighlight",i,a)},e.prototype.setFilterOnSelectData=function(e,t,r,i,a,n,o,s){this.supportsFilterOutput(i)?this.logRFilterTelemetry(g.telemetry.EXCrossFilterScriptVisual,r,"Data",a):(e=this.setCrossHighlightOperation(e,t,r,o,i,s,a),C.notifyVisualContainers(this.eventBridge,e,"UserAction_CrossHighlight",a,n))},e.prototype.updateCrossFilterOnDrill=function(e,t){e=this.updateCrossDrillFromVisualContainerOperation(e,t,!1);C.notifyVisualContainers(this.eventBridge,e)},e.prototype.updateCrossDrillFromVisualContainers=function(e,t){e=this.updateCrossDrillFromVisualContainersOperation(e,t);C.notifyVisualContainers(this.eventBridge,e)},e.prototype.updateCrossDrillFromVisualContainersOperation=function(e,t){if(!_.isEmpty(t)){for(var r=[],i=0,a=t;i<a.length;i++)var n=a[i],n=this.updateCrossDrillFromVisualContainerOperation(e,n,!1),r=_.union(r,n);return r}},e.prototype.updateCrossDrillOfSection=function(e){e=this.updateCrossDrillOfSectionOperation(e);C.notifyVisualContainers(this.eventBridge,e)},e.prototype.updateCrossDrillOfSectionOperation=function(e){return this.updateCrossDrillFromVisualContainersOperation(e,e.visualContainers)},e.prototype.getDrillCrossFiltersToApply=function(e,t,r){var i=new m.FilterBuilder(t);return this.addCrossDrillFilters(i,e,t,r)},e.prototype.supportsFilterOutput=function(e){return s.FilterUtils.supportsFilterOutput(C.getVisualCapabilities(e,this.visualPlugins))},e.prototype.tryGetFilterPropertyIdentifier=function(e,t){return s.FilterUtils.tryGetFilterPropertyIdentifier(e,t,this.visualPlugins)},e.prototype.tryGetSelfFilterEnabledProperty=function(e){if(e)return t.findSelfFilterEnabled(e.objects)},e.prototype.tryGetSelfFilterProperty=function(e){if(e)return t.findSelfFilter(e.objects)},e.prototype.resolveFilterTargets=function(e,t,r,i,a){return n.willFiltersAffectQuery(t.defn)?(r={dataRoles:r,mappings:i,queryProjections:t.projections,select:t.defn.select(),schema:e},i=new m.VisualFilterMappingResolver(r),e=t.defn,a&&(e=e.addSemanticFilter(a)),i.resolveSemanticQuery(e)):t.defn},e.prototype.applyFilterOutput=function(e){this.supportsFilterOutput(e)&&C.notifyVisualContainersExceptSource(this.eventBridge,e)},c=e})(powerbi=powerbi||{}),(function(e){var s,l,t,a,n,g,f,p,r;function o(e){return"visualContainer"===e.canvasItemType}function u(e){return"group"===e.canvasItemType}function c(e,t,r){var r=r.config.singleVisual,i=e.capabilities(r.visualType),e=e.capabilities(t.visualType);i&&e&&(r.objects=d(i.objects,e.objects,t.objects,r.objects)),r.vcObjects=d(a,a,t.vcObjects,r.vcObjects)}function d(e,t,r,i){if(r===i)return i;for(var a in i=i||{},e){var n=e[a],o=t[a];if(o&&!n.suppressFormatPainterCopy&&!o.suppressFormatPainterCopy){var s,l=r&&r[a],p=i&&i[a];for(s in n.properties){var u=n.properties[s],c=o.properties[s];if(c&&!u.suppressFormatPainterCopy&&!c.suppressFormatPainterCopy&&_.isEqual(u.type,c.type)){if(p)for(var d=0,m=p;d<m.length;d++){var v=m[d];g.deleteSingleProperty(v,s)}if(l)for(var y=0,h=l;y<h.length;y++)(v=h[y]).properties[s]&&(f.ensure(i,a,v.selector).properties[s]=v.properties[s])}}}}return f.reduce(i)}s=e.explore||(e.explore={}),l=s.services||(s.services={}),g=e.data.DataViewObjectDefinition,f=e.data.DataViewObjectDefinitions,p=e.data.SQExpr,r=e.explore.contracts.VisualContainer,e=e.explore.contracts.VisualContainerGroup,(t=l.FormatPainter||(l.FormatPainter={})).isVisualContainerFormat=o,t.isGroupFormat=u,t.copyFormatCanvasItem=function(e,t,r,i){var a,n,o;if(e=l.selectionUtils.getSelectedCanvasItem(e))return s.contracts.isVisualContainer(e)?(a=(n=e).config.singleVisual.visualType,t.isCustomVisual(a)?void 0:(n=(t=n.config.singleVisual).vcObjects,o=f.getValue(n,{objectName:"stylePreset",propertyName:"name"},void 0),(i=i.getVisualObjects(r,a,o&&p.isConstant(o)&&o.value,s.contracts.VisualContainer.CommonObjectDescriptors))&&(n=f.clone(n||{}),f.extend(n,i,!0)),{canvasItemType:"visualContainer",visualType:t.visualType,objects:t.objects,vcObjects:n})):{canvasItemType:"group",objects:e.objects}},a=r.CommonObjectDescriptors,n=e.objectDescriptors,t.pasteFormatCanvasItem=function(e,t,r){var i;if((e=l.selectionUtils.getSelectedCanvasItem(e))&&r)return s.contracts.isVisualContainer(e)?o(r)?c(t,r,e):u(r)&&((i=e.config.singleVisual).vcObjects=d(a,n,r.objects,i.objects)):o(r)?s.contracts.traverseVisualContainerGroups([e],(function(e){s.contracts.isVisualContainer(e)&&c(t,r,e)})):u(r)&&(e.objects=d(n,n,r.objects,e.objects)),e},t.copyFormatObjects=d})(powerbi=powerbi||{}),(function(e){var t;function r(){this.runningVisuals={}}((e=e.explore||(e.explore={})).services||(e.services={})).createRunningVisualService=function(){return new t},r.prototype.getVisual=function(e){e&&e.name;var t=this.runningVisuals[e.name];if(null!=t&&t.contract===e)return t.visual},r.prototype.setVisual=function(e,t){e&&e.name,this.runningVisuals[e.name]={contract:e,visual:t}},r.prototype.removeVisual=function(e){e&&e.name,delete this.runningVisuals[e.name]},t=r})(powerbi=powerbi||{}),(function(e){var t;function r(){this.isPaused=!1}((e=e.explore||(e.explore={})).services||(e.services={})).createServicePauser=function(){return new t},r.prototype.register=function(e){e=jQuery.extend(!0,{},e);return this.updateService(e),e},r.prototype.pause=function(){this.isPaused=!0},r.prototype.resume=function(){this.isPaused=!1},r.prototype.updateService=function(i){var e,a=this;for(e in i)!(function(e){var t,r;_.isFunction(i[e])&&(t=i[e],r=a,i[e]=function(){if(!r.isPaused)return t.apply(i,arguments)})})(e)},t=r})(powerbi=powerbi||{}),(function(e){var t,u,a,p,l,n,i,o;function s(e,t,r){return e[t]||(e[t]={items:{},name:t,type:r}),e[t]}function c(e,t,r,i,a){e=s(e,t,r).items;return e[i]=e[i]||{name:i,type:a}}function r(e,t,r,i,a){this.promiseFactory=e,this.resourceLoader=t,this.explorationNavigation=r,this.explorationSerializer=i,this.resourceRegistration=a,this.restorableReferenceSources=[],this.preservedReferences={}}t=(t=e.explore||(e.explore={})).services||(t.services={}),a=e.data.DataViewObjectDefinitions,p=e.visualHost.ResourcePackageReferenceResolver,l=e.visualHost.utils.ResourcePackageUtils,n=e.data.SQExpr,i=jsCommon.UrlUtils,t.createStaticResourceReferenceService=function(e,t,r,i,a){return new o(e,t,r,i,a)},(t=u=t.StaticResourceReferences||(t.StaticResourceReferences={})).addObjectsReferences=function(e,t,r,i){e&&a.visitPropertyExprs({definitions:e,descriptors:t,visitor:function(e){var t;n.isResourcePackageItem(e)&&(t=l.findResourcePackage(r,e.packageType,e.packageName),e=l.findItemInPackage(t,e.itemName))&&c(i,t.name,t.type,e.name,e.type)}})},t.ensurePackageReference=s,t.addItemReference=c,t.findItem=function(e,t,r){return(e=e[t])&&e.items&&e.items[r]},t.eraseItem=function(e,t,r){var i=e[t];i&&(delete(i=i.items)[r],0===_.size(i))&&delete e[t]},t.visitItemReferences=function(e,t){for(var r in e){var i,a=e[r];for(i in a.items)t(a,a.items[i])}},r.prototype.addReferenceSource=function(e){this.restorableReferenceSources.push(e)},r.prototype.removeReferenceSource=function(e){_.pull(this.restorableReferenceSources,e)},r.prototype.garbageCollectUnreferencedStaticResources=function(){var e=this.explorationNavigation.getCurrentExploration(),t=e&&e.resourcePackages;if(t){for(var r=this.explorationSerializer.getReferencedStaticResources(e),i=this.getRestorableReferences(),a=[],n=t.length-1;0<=n;n--){var o=t[n];l.isStaticResource(o)&&(this.garbageCollectItems(o,r,this.preservedReferences,i,a),_.isEmpty(o.items))&&_.pull(t,o)}return _.isEmpty(t)&&delete e.resourcePackages,this.cleanPreservedReferences(r,i),a}},r.prototype.cleanPreservedReferences=function(r,i){var a=this;u.visitItemReferences(this.preservedReferences,(function(e,t){!u.findItem(r,e.name,t.name)&&u.findItem(i,e.name,t.name)||u.eraseItem(a.preservedReferences,e.name,t.name)}))},r.prototype.getRestorableReferences=function(){for(var r={},e=0,t=this.restorableReferenceSources;e<t.length;e++){var i=t[e];u.visitItemReferences(i.getReferences(),(function(e,t){u.addItemReference(r,e.name,e.type,t.name,t.type)}))}return r},r.prototype.garbageCollectItems=function(e,t,r,i,a){for(var n=e.items,o=e.name,s=_.size(n)-1;0<=s;s--){var l=n[s],p=l.name;u.findItem(t,o,p)||(u.findItem(i,o,p)&&this.preserveItem(e,p,l.type),a.push(o+"/"+l.path),_.pull(n,l))}},r.prototype.preserveItem=function(e,t,r){r=u.addItemReference(this.preservedReferences,e.name,e.type,t,r);r.uri||(r.uri=p.loadAndResolveContent(e,t,this.resourceLoader,this.promiseFactory).then((function(e){return e=i.isDataUri(e)?e:i.makeJsonDataUri(e)})))},r.prototype.loadItemsContent=function(e){var t,r=[],i=this.explorationNavigation.getCurrentExploration(),a=i&&i.resourcePackages;for(t in e){var n=e[t];if(1===n.type){var o,s=n.items,l=this;for(o in s)!(function(e){var t=s[e];r.push(p.loadRegisteredResourceAsDataUri(l.promiseFactory,l.resourceLoader,a,t.name).then((function(e){t.content=e})))})(o)}}return this.promiseFactory.all(r).then((function(){}))},r.prototype.addItemsContent=function(e){var t,r=this.explorationNavigation.getCurrentExploration();for(t in e){var i,a=e[t],n=a.items;for(i in n){var o=n[i];this.addResource(r.resourcePackages,t,a.type,o.name,o.type,o.content)}}},r.prototype.needingRestore=function(e){var n=this;if(!_.isEmpty(e)){var t=this.explorationNavigation.getCurrentExploration();if(t){var o,s=t&&t.resourcePackages;if(!_.isEmpty(s))return o={},u.visitItemReferences(e,(function(e,t){var r=e.name,i=t.name,a=u.findItem(n.preservedReferences,r,i);a&&!l.findItemInPackages(s,e.type,t.name,r)&&(u.ensurePackageReference(o,r,e.type).items[i]=a)})),o}}},r.prototype.addResource=function(e,t,r,i,a,n){l.findItemInPackages(e,r,i,t)||this.resourceRegistration.add(i,r,a,{content:n,skipUniqueName:!0})},r.prototype.restoreReferences=function(e){var i=this,e=this.needingRestore(e),a=[];return u.visitItemReferences(e,(function(t,r){a.push(r.uri.then((function(e){i.resourceRegistration.restore(r.name,t.type,r.type,e)})))})),this.promiseFactory.all(a).then((function(){}))},o=r})(powerbi=powerbi||{}),(function(p){var e,o,t,r,s,i;function u(e){return Math.round(100*jsCommon.PixelConverter.toPoint(e))/100}function l(e,t){var r,e=c(e,t.objectName);e&&(r=e[t.propertyName])&&(d(r)?e[t.propertyName]=v(r):(r=s.deserializeExpr(r.expr),e[t.propertyName]=m(v(r))))}function c(e,t){if(e){e=e[t];if(e)for(var r=0,i=e;r<i.length;r++){var a=i[r];if(null==a.selector)return a.properties}}}function d(e){return e instanceof p.data.SQExpr&&p.data.SQExpr.isConstant(e)}function m(e){return{expr:s.serializeExpr(e)}}function v(e){e=u(e.value);return i.decimal(e)}function a(e){return Math.round(100*jsCommon.PixelConverter.fromPointToPixel(e))/100}e=(e=(e=p.explore||(p.explore={})).services||(e.services={})).upgrade||(e.upgrade={}),o=e.UpgradeUtils||(e.UpgradeUtils={}),t=p.visuals.fillStyle,r=p.visuals.outline,s=p.data.services.SemanticQuerySerializer,i=p.data.SQExprBuilder,o.pxToPt=u,o.convertAxisScaleProperty=function(e){return void 0!==e&&"log"===e},o.convertAxisPositionProperty=function(e){return void 0!==e&&"Right"===e},o.convertScatterChartFillPoint=function(e){return e?t.fillOnly:t.borderOnly},o.convertSuppressDefaultTooltip=function(e){return!e},o.convertOutlineValue=function(e){switch(e){case r.none:return 0;case r.topOnly:return 1;case r.bottomOnly:return 4;case r.leftOnly:return 8;case r.rightOnly:return 2;case r.topBottom:return 5;case r.leftRight:return 10;case r.frame:return 15;default:return 0}},o.pxToPtUpgrader=function(e){switch(typeof e){case"string":e=+e;case"number":return u(e);default:return e}},o.updateSingleVisualConfigPxToPt=function(e){if(e){if(e.objects){var t=e.objects;if(t)for(var r=0,i=o.visualPropertiesToUpdate;r<i.length;r++){var a=i[r];l(t,a)}}e.vcObjects&&(e=e.vcObjects)&&(e=e.visualTooltip&&e.visualTooltip[0]&&e.visualTooltip[0].properties)&&(n=e.fontSize)&&(d(n)?e.fontSize=v(n):(n=s.deserializeExpr(n.expr),e.fontSize=m(v(n))))}var n},o.updateSingleVisualConfigTextboxPxToPt=function(e){if(e&&e.objects&&e.visualType===p.visuals.plugins.textbox.name&&(e=e.objects)){e=c(e,"general");if(e)for(var e=e.paragraphs,t=0,r=e;t<r.length;t++)for(var i=r[t],a=0,n=i.textRuns;a<n.length;a++){var o,s,l=n[a];p.ParagraphsDefinition.isTextRunDefinition(l)&&l.textStyle&&l.textStyle.fontSize&&(s=l.textStyle.fontSize,-1!==(o=s.indexOf("px")))&&(s=+s.substr(0,o),l.textStyle.fontSize=u(s)+"pt")}}},o.visualPropertiesToUpdate=[{objectName:"valueAxis",propertyName:"fontSize"},{objectName:"valueAxis",propertyName:"titleFontSize"},{objectName:"valueAxis",propertyName:"secFontSize"},{objectName:"valueAxis",propertyName:"secTitleFontSize"},{objectName:"categoryAxis",propertyName:"fontSize"},{objectName:"categoryAxis",propertyName:"titleFontSize"}],o.visualContainerPropertiesToUpdate=[{objectName:"visualTooltip",propertyName:"fontSize"}],o.upgradePropertyFromPxToPt=l,o.toExpr=m,o.pxToPtExpr=v,o.ptToPxWireExpr=function(e){return e=a(+s.deserializeExpr(e.expr).value),{expr:s.serializeExpr(i.decimal(e))}},o.ptToPx=a})(powerbi=powerbi||{}),(function(e){var t,r,i;e=(e=(e=e.explore||(e.explore={})).services||(e.services={})).upgrade||(e.upgrade={}),(r=t=e.ExplorationStateVersions||(e.ExplorationStateVersions={})).v1_0="1.0",r.v1_1="1.1",r.v1_2="1.2",r.v1_3="1.3",r.v1_4="1.4",r.v1_5="1.5",r.v1_6="1.6",r.v1_7="1.7",r.v1_8="1.8",r.v1_9="1.9",r.v1_10="1.10",r.v1_11="1.11",r.v1_12="1.12",r.v1_13="1.13",r.v1_14="1.14",r.v1_15="1.15",r.v1_16="1.16",r.v1_17="1.17",r.v1_18="1.18",r.v1_19="1.19",r.v1_20="1.20",r.v1_21="1.21",(i=e.ExplorationStateFeatureVersions||(e.ExplorationStateFeatureVersions={})).AllowMobileVisualFormatting=t.v1_8,i.FieldParameters=t.v1_11,i.OnObject=t.v1_15,i.setAllowMobileVisualFormatting=function(e){i.AllowMobileVisualFormatting=e}})(powerbi=powerbi||{}),(function(p){var e,t,u,r,c,i,d,a,n,s,o,l,m,v,y,h,g,f,C,x,S;function b(e){var t=r.call(this)||this;return t.highestVersion=e,t}function E(){}function N(e){if(e&&!_.isEmpty(e.data)&&1===e.data.length&&l.isWildcard(e.data[0]))return e.data[0].matchingOption}function V(t){if(t instanceof m)return!!_.find(S,(function(e){return e===t.value}));if(t instanceof Object&&!(t instanceof Function))for(var e=0,r=Object.keys(t);e<r.length;e++){var i=r[e];if(V(t[i]))return!0}return!1}function w(e,t,r){function i(e,t){return(e=e&&e[t.objectName])&&e[t.propertyName]}var a=r[e],e=(r[e]||(a=r[e]={}),t.currentId.objectName),n=(n=a[e])||(a[e]={}),e=t.previousId,a=i(a,e)||i(r[s],e);n[t.currentId.propertyName]=__assign(__assign({},t),{previous:a})}function P(e,t,r){var i=r[e],r=(r[e]||(i=r[e]={}),t.property.objectName),e=(e=i[r])||(i[r]={}),i=t.property.propertyName,r=e[i];(r=r||(e[i]=[])).push(t)}e=p.explore||(p.explore={}),t=e.services||(e.services={}),u=t.upgrade||(t.upgrade={}),t=p.visuals.AnomalyDetectionObjectConstants,i=p.visuals.AnomalyDetectionVisualPlugin,d=p.data.DataViewObjectDefinitions,a=p.visuals.GeocodingCulture,n=p.visuals.legendPosition,s=p.data.ObjectPropertyVersionWildcard,o=p.visuals.plugins,l=p.data.Selector,m=p.data.SQConstantExpr,v=p.data.SQExpr,y=p.visuals.standardGeoJson,h=jsCommon.Version,g=e.contracts.VisualLink,f=e.contracts.VisualTooltip,u.ExplorationVersions={v1_0:"1.0",v2_0:"2.0",v2_2:"2.2",v2_3:"2.3",v2_5:"2.5",v3_0:"3.0",v3_1:"3.1",v3_2:"3.2",v3_3:"3.3",v3_4:"3.4",v3_5:"3.5",v3_6:"3.6",v3_6_1:"3.6.1",v3_7:"3.7",v3_8:"3.8",v3_9:"3.9",v3_10:"3.10",v3_11:"3.11",v3_12:"3.12",v3_12_1:"3.12.1",v3_13:"3.13",v3_14:"3.14",v3_14_1:"3.14.1",v3_15:"3.15",v3_16:"3.16",v3_17:"3.17",v3_18:"3.18",v3_19:"3.19",v3_20:"3.20",v3_21:"3.21",v3_22:"3.22",v3_23:"3.23",v3_24:"3.24",v4_0:"4.0",v4_1:"4.1",v4_2:"4.2",v5_0:"5.0",v5_1:"5.1",v5_2:"5.2",v5_3:"5.3",v5_4:"5.4",v5_5:"5.5",v5_6:"5.6",v5_7:"5.7",v5_8:"5.8",v5_9:"5.9",v5_10:"5.10",v5_11:"5.11",v5_12:"5.12",v5_13:"5.13",v5_14:"5.14",v5_15:"5.15",v5_16:"5.16",v5_17:"5.17",v5_18:"5.18",v5_19:"5.19",v5_20:"5.20",v5_21:"5.21",v5_22:"5.22",v5_23:"5.23",v5_24:"5.24",v5_25:"5.25",v5_26:"5.26",v5_27:"5.27",v5_28:"5.28",v5_29:"5.29",v5_30:"5.30",v5_31:"5.31",v5_32:"5.32",v5_33:"5.33",v5_34:"5.34",v5_35:"5.35",v5_36:"5.36",v5_37:"5.37",v5_38:"5.38",v5_39:"5.39",v5_40:"5.40",v5_41:"5.41",v5_42:"5.42",v5_43:"5.43",v5_44:"5.44",v5_45:"5.45"},u.SQExprVersions={},u.SQExprVersions[41]=u.ExplorationVersions.v3_5,u.SQExprVersions[42]=u.ExplorationVersions.v3_7,u.SQExprVersions[33]=u.ExplorationVersions.v3_8,r=p.data.DefaultSQExprVisitorWithTraversal,__extends(b,r),b.prototype.visitAllRolesRef=function(e){this.highestVersion=h.max(this.highestVersion,u.ExplorationVersions.v5_1),r.prototype.visitAllRolesRef.call(this,e)},b.prototype.visitRangePercent=function(e){this.highestVersion=h.max(this.highestVersion,u.ExplorationVersions.v5_1),r.prototype.visitRangePercent.call(this,e)},b.prototype.visitArithmetic=function(e){v.isScopedEval(e.right)||(this.highestVersion=h.max(this.highestVersion,u.ExplorationVersions.v5_15)),r.prototype.visitArithmetic.call(this,e)},b.prototype.visitSparklineData=function(e){this.highestVersion=h.max(this.highestVersion,c.Sparklines),r.prototype.visitSparklineData.call(this,e)},C=b,E.getVersionForSQExpr=function(e){var t=u.SQExprVersions[e.kind]||h.ZeroStr,t=new C(t);return e.accept(t),t.highestVersion},E.getVersionForSQExprWithDescriptor=function(e,t){var r=this.getVersionForSQExpr(e);return r=t&&t.fill&&t.fill.solid&&t.fill.solid.color?h.max(r,this.getVersionForFillDefinition(e)):r},E.getVersionForFillDefinition=function(e){if(v.isFillRule(e)&&e.input&&!v.isSelectRef(e.input))return c.ConditionalFormattingSource;if(v.isConditional(e)){var t=function(e){return v.isCompare(e)&&!v.isSelectRef(e.left)};if(_.some(e.cases,(function(e){return e.condition.isOrdinalEvaluation()})))return c.ConditionalFormattingForStrings;if(_.some(e.cases,(function(e){return e=e.condition,!!t(e)||!(!v.isAnd(e)||!t(e.left)&&!t(e.right))})))return c.ConditionalFormattingSource}return v.isMeasure(e)||v.isAggregation(e)?c.ConditionalFormattingByValue:h.ZeroStr},E.getVersionForSortDefinitions=function(e){if(!_.isEmpty(e))for(var t=0,r=e;t<r.length;t++){var i=r[t];if(v.isScopedEval(i.expr))return u.ExplorationVersions.v5_23}return h.ZeroStr},E.getVersionForVisualContainerGroup=function(e){return e.objects&&void 0!==e.objects.lockAspect?c.VisualContainerGroupLockAspect:c.VisualContainerGrouping},u.ExplorationVersionHelper=E,(e=c=u.ExplorationFeatureVersions||(u.ExplorationFeatureVersions={})).bookmarks=u.ExplorationVersions.v3_6,e.visualHidden=u.ExplorationVersions.v3_6,e.slowDataSource=u.ExplorationVersions.v3_7,e.ExplorationState_v1_1=u.ExplorationVersions.v3_8,e.description=u.ExplorationVersions.v3_8,e.BookmarkOptions=u.ExplorationVersions.v3_8,e.SectionCrossDrill=u.ExplorationVersions.v3_8,e.SectionVisibility=u.ExplorationVersions.v3_9,e.ExplorationState_v1_2=u.ExplorationVersions.v3_10,e.VisualSyncGroup=u.ExplorationVersions.v3_11,e.ExplorationSettings=u.ExplorationVersions.v3_11,e.CanvasTooltips=u.ExplorationVersions.v3_12,e.ActionButton=u.ExplorationVersions.v3_13,e.QnaLink=u.ExplorationVersions.v3_13,e.ConditionalFormattingSource=u.ExplorationVersions.v3_14,e.MeasureDrillthrough=u.ExplorationVersions.v3_14,e.OutspaceFormatting=u.ExplorationVersions.v3_15,e.StylableVisualContainerHeader=u.ExplorationVersions.v3_15,e.BookmarkGroup=u.ExplorationVersions.v3_17,e.ConditionalFormattingByValue=u.ExplorationVersions.v3_17,e.BuiltInThemes=u.ExplorationVersions.v3_18,e.DotPlotVisual=u.ExplorationVersions.v3_18,e.ExportDataMode=u.ExplorationVersions.v3_19,e.ExpandCollapse=u.ExplorationVersions.v3_20,e.CartesianConditionalFormatting=u.ExplorationVersions.v3_20,e.FilterContainerVisibilityControl=u.ExplorationVersions.v3_20,e.OutspacePaneFormatting=u.ExplorationVersions.v3_20,e.ExplorationState_v1_3=u.ExplorationVersions.v3_20,e.NewFilterPaneExperience=u.ExplorationVersions.v3_20,e.VisualTabOrders=u.ExplorationVersions.v3_21,e.VisualLinkTooltip=u.ExplorationVersions.v3_21,e.FilterRequireSingleSelect=u.ExplorationVersions.v3_21,e.DefaultFilterAction=u.ExplorationVersions.v3_22,e.KeyDriversVisual=u.ExplorationVersions.v3_22,e.TitleWordWrap=u.ExplorationVersions.v3_22,e.VisualBorderRadius=u.ExplorationVersions.v3_22,e.WebUrlAction=u.ExplorationVersions.v3_23,e.StrictSingleSelect=u.ExplorationVersions.v3_23,e.DefaultTooltipFormatting=u.ExplorationVersions.v3_23,e.DisplayAreaVerticalAlignment=u.ExplorationVersions.v3_23,e.FilterContainerFilterMetadata=u.ExplorationVersions.v3_23,e.FiltersSort=u.ExplorationVersions.v3_23,e.CrossReportDrillthrough=u.ExplorationVersions.v3_24,e.AllowChangeFilterTypes=u.ExplorationVersions.v3_24,e.RenameFilters=u.ExplorationVersions.v3_24,e.ExpressionBoundVisualTitles=u.ExplorationVersions.v4_0,e.ColorConditionalFormatting=u.ExplorationVersions.v4_2,e.VisualLevelSlicerFilters=u.ExplorationVersions.v4_2,e.GaugeConditionalFormatting=u.ExplorationVersions.v4_2,e.VisualHeaderTooltip=u.ExplorationVersions.v4_2,e.ExplorationState_v1_4=u.ExplorationVersions.v4_2,e.ReportAnnotations=u.ExplorationVersions.v4_2,e.ExpressionBoundVisualBackground=u.ExplorationVersions.v5_0,e.KeyDriversCounting=u.ExplorationVersions.v5_1,e.KeyDriversDetails=u.ExplorationVersions.v5_2,e.MigrateFilterPaneExperience=u.ExplorationVersions.v5_2,e.VisualContainerGrouping=u.ExplorationVersions.v5_2,e.ExpressionBoundBorderColor=u.ExplorationVersions.v5_3,e.ExpressionBoundAltText=u.ExplorationVersions.v5_3,e.ExpressionBoundGaugeColors=u.ExplorationVersions.v5_3,e.AutomaticPageRefresh=u.ExplorationVersions.v5_4,e.ExpressionBoundActions=u.ExplorationVersions.v5_5,e.AdditionalKPISettings=u.ExplorationVersions.v5_6,e.FilterPaneSearchBoxFormatting=u.ExplorationVersions.v5_7,e.VisualFilterExpressionMetadata=u.ExplorationVersions.v5_8,e.DisableFilterPaneSearch=u.ExplorationVersions.v5_8,e.DecompTreeBarsPerLevel=u.ExplorationVersions.v5_8,e.HierarchicalSlicer=u.ExplorationVersions.v5_8,e.LineChartDualAxis=u.ExplorationVersions.v5_8,e.ChangeDetectionRefresh=u.ExplorationVersions.v5_9,e.FilterPaneHiddenInEditMode=u.ExplorationVersions.v5_9,e.AllowInlineExploration=u.ExplorationVersions.v5_9,e.RelativeTimeFilter=u.ExplorationVersions.v5_9,e.LinguisticSchemaSyncVersion=u.ExplorationVersions.v5_9,e.FilterSelectAll=u.ExplorationVersions.v5_9,e.ApplyAll=u.ExplorationVersions.v5_10,e.KpiScalingIndicatorIcon=u.ExplorationVersions.v5_10,e.LineChartExplicitDots=u.ExplorationVersions.v5_11,e.BingMapStyling=u.ExplorationVersions.v5_11,e.ConditionalParagraphs=u.ExplorationVersions.v5_12,e.DecompositionTreeVisual=u.ExplorationVersions.v5_12,e.GradientLegend=u.ExplorationVersions.v5_13,e.QnaWarningUnderlineColor=u.ExplorationVersions.v5_13,e.SlicerHeaderText=u.ExplorationVersions.v5_13,e.QnaActionButtonsColor=u.ExplorationVersions.v5_14,e.DropShadow=u.ExplorationVersions.v5_14,e.PersonalizeVisualPerspective=u.ExplorationVersions.v5_14,e.GeneralizedArithmetic=u.ExplorationVersions.v5_15,e.PersonalizeVisualPerspectiveToggle=u.ExplorationVersions.v5_15,e.KeepLayerOrder=u.ExplorationVersions.v5_15,e.PagesPosition=u.ExplorationVersions.v5_15,e.NarrativeVisual=u.ExplorationVersions.v5_15,e.StackedTotalDataLabels=u.ExplorationVersions.v5_15,e.SerializationOptimization=u.ExplorationVersions.v5_16,e.FilterPaneCheckboxAndApplyColor=u.ExplorationVersions.v5_16,e.AnomalyDetection=u.ExplorationVersions.v5_16,e.CartesianSmallMultiples=u.ExplorationVersions.v5_16,e.AxisZoom=u.ExplorationVersions.v5_16,e.DecompositionInsights=u.ExplorationVersions.v5_16,e.AzureMapConditionalColor=u.ExplorationVersions.v5_16,e.QuickExplore=u.ExplorationVersions.v5_17,e.IsEmptyFilterOperator=u.ExplorationVersions.v5_18,e.CartesianSmallMultiplesGridlines=u.ExplorationVersions.v5_18,e.MapGeocodingCulture=u.ExplorationVersions.v5_18,e.CartesianSmallMultiplesSubheaderFormatting=u.ExplorationVersions.v5_19,e.AzureMapSelectionControl=u.ExplorationVersions.v5_19,e.VisualContainerGroupLockAspect=u.ExplorationVersions.v5_19,e.lineChartVerticalReferenceLine=u.ExplorationVersions.v5_19,e.CartesianSmallMultiplesPadding=u.ExplorationVersions.v5_20,e.CartesianSmallMultiplesCombo=u.ExplorationVersions.v5_20,e.ShapeVisual=u.ExplorationVersions.v5_20,e.InvertAxis=u.ExplorationVersions.v5_20,e.EnhancedTooltips=u.ExplorationVersions.v5_21,e.ShowLassoButton=u.ExplorationVersions.v5_21,e.RdlVisual=u.ExplorationVersions.v5_22,e.ShapeMapFranceUpdatedRegions=u.ExplorationVersions.v5_22,e.LineChartExplicitDotsDefault=u.ExplorationVersions.v5_22,e.SmallMultiplesResponsive=u.ExplorationVersions.v5_22,e.EnhancedTooltipsForVisualHeaderTooltip=u.ExplorationVersions.v5_22,e.AreaChartTransparency=u.ExplorationVersions.v5_22,e.QuickExploreLayout=u.ExplorationVersions.v5_23,e.ConditionalFormattingUpdates=u.ExplorationVersions.v5_23,e.SuppressDefaultTooltip=u.ExplorationVersions.v5_23,e.ShapeFormattingFeatures=u.ExplorationVersions.v5_24,e.XAxisRefLineImprovements=u.ExplorationVersions.v5_24,e.AccessibilityTopLevelNav=u.ExplorationVersions.v5_24,e.GokSupportForCV=u.ExplorationVersions.v5_24,e.ButtonTileFormatting=u.ExplorationVersions.v5_25,e.LineChartSeriesLabels=u.ExplorationVersions.v5_25,e.WaterfallChartTotals=u.ExplorationVersions.v5_25,e.AzureMapHeatmapLayer=u.ExplorationVersions.v5_26,e.AllowAutomatedInsightsNotification=u.ExplorationVersions.v5_26,e.NavigatorVisuals=u.ExplorationVersions.v5_27,e.PieChartMarginBetweenSlices=u.ExplorationVersions.v5_27,e.TextboxSuperSubScriptBulletedList=u.ExplorationVersions.v5_27,e.BoldItalicUnderlineComponent=u.ExplorationVersions.v5_27,e.DonutChartStartAngle=u.ExplorationVersions.v5_27,e.ScorecardVisual=u.ExplorationVersions.v5_27,e.AzureMapHeatmapOpacityToTransparency=u.ExplorationVersions.v5_28,e.RdlVisualToolbarConfig=u.ExplorationVersions.v5_28,e.ScorecardCommandBarToggle=u.ExplorationVersions.v5_28,e.Sparklines=u.ExplorationVersions.v5_28,e.AllowMobileVisualFormatting=u.ExplorationVersions.v5_29,e.AzureMapsGeocoding=u.ExplorationVersions.v5_30,e.SlicerAccessibility=u.ExplorationVersions.v5_30,e.AxisScaleToLogAxisScale=u.ExplorationVersions.v5_31,e.PositionToSwitchAxisPosition=u.ExplorationVersions.v5_31,e.LegendPositionNewFormatPane=u.ExplorationVersions.v5_31,e.FillPointShowToStyle=u.ExplorationVersions.v5_31,e.ShowDefaultTooltip=u.ExplorationVersions.v5_31,e.RemoveDefaultToCircleToggle=u.ExplorationVersions.v5_31,e.OutlineDropdownToCheckboxes=u.ExplorationVersions.v5_31,e.SplitHelpTooltip=u.ExplorationVersions.v5_31,e.splitGrandTotals=u.ExplorationVersions.v5_31,e.splitSubTotals=u.ExplorationVersions.v5_31,e.UpgradeOutlineProperties=u.ExplorationVersions.v5_31,e.QueryFieldParameters=u.ExplorationVersions.v5_32,e.RemainingCategoryLogAxisScale=u.ExplorationVersions.v5_33,e.NewAlternatingRowsStyle=u.ExplorationVersions.v5_33,e.AltTextColumns=u.ExplorationVersions.v5_33,e.RowWithReferenceText=u.ExplorationVersions.v5_33,e.ErrorBars=u.ExplorationVersions.v5_34,e.GaugeChartCalloutTextFormatting=u.ExplorationVersions.v5_34,e.SlicerSliderColors=u.ExplorationVersions.v5_34,e.ShapeButtonTextFormatting=u.ExplorationVersions.v5_34,e.HelpTooltipBIU=u.ExplorationVersions.v5_34,e.AzureMapsFilledMap=u.ExplorationVersions.v5_34,e.CartesianBiuFontProperties=u.ExplorationVersions.v5_35,e.OnObject=u.ExplorationVersions.v5_36,e.DefaultAggregateDisplayName=u.ExplorationVersions.v5_36,e.ConditionalFormattingDataLabels=u.ExplorationVersions.v5_37,e.DrillthroughSectionType=u.ExplorationVersions.v5_38,e.ReverseStackOrder=u.ExplorationVersions.v5_39,e.ShapeMapIrelandLaoisSpelling=u.ExplorationVersions.v5_39,e.AzureMapsCategoryLabels=u.ExplorationVersions.v5_40,e.AzureMapsShowLabels=u.ExplorationVersions.v5_40,e.SmallMultiplesUnsharedAxes=u.ExplorationVersions.v5_40,e.Hackathon2022=u.ExplorationVersions.v5_41,e.SmartNarrativeToggleButton=u.ExplorationVersions.v5_41,e.TextboxIndent=u.ExplorationVersions.v5_41,e.ConditionalFormattingForStrings=u.ExplorationVersions.v5_41,e.OnObjectShowByDefault=u.ExplorationVersions.v5_41,e.BarChartHierarchyAxis=u.ExplorationVersions.v5_42,e.VCPadding=u.ExplorationVersions.v5_42,e.ScaledTooltip=u.ExplorationVersions.v5_43,e.GeocodingCultureUpdate2_0=u.ExplorationVersions.v5_44,e.QueryLimitOptions=u.ExplorationVersions.v5_44,e.MeasureDrivenDataLabels=u.ExplorationVersions.v5_44,e.TooltipPlaceholderText=u.ExplorationVersions.v5_44,e.TotalDataBars=u.CurrentExplorationVersion,e.TextboxAtMention=u.CurrentExplorationVersion,e.VisualCalculations=u.CurrentExplorationVersion,e.GoalVisual=u.CurrentExplorationVersion,e.PauseVisualQueries=u.CurrentExplorationVersion,e.SlicerPendingIcon=u.CurrentExplorationVersion,e.AINarratives=u.CurrentExplorationVersion,e.CardVisual=u.CurrentExplorationVersion,u.ExplorationStateVersionToExplorationVersion=((e={})[u.ExplorationStateVersions.v1_8]=u.ExplorationVersions.v5_29,e[u.ExplorationStateVersions.v1_9]=u.ExplorationVersions.v5_30,e[u.ExplorationStateVersions.v1_10]=u.ExplorationVersions.v5_31,e[u.ExplorationStateVersions.v1_11]=u.ExplorationVersions.v5_32,e[u.ExplorationStateVersions.v1_12]=u.ExplorationVersions.v5_33,e[u.ExplorationStateVersions.v1_13]=u.ExplorationVersions.v5_34,e[u.ExplorationStateVersions.v1_14]=u.ExplorationVersions.v5_35,e[u.ExplorationStateVersions.v1_15]=u.ExplorationVersions.v5_36,e[u.ExplorationStateVersions.v1_15]=u.ExplorationVersions.v5_37,e[u.ExplorationStateVersions.v1_16]=u.ExplorationVersions.v5_39,e[u.ExplorationStateVersions.v1_17]=u.ExplorationVersions.v5_40,e[u.ExplorationStateVersions.v1_18]=u.ExplorationVersions.v5_41,e[u.ExplorationStateVersions.v1_19]=u.ExplorationVersions.v5_42,e[u.ExplorationStateVersions.v1_20]=u.ExplorationVersions.v5_43,e[u.ExplorationStateVersions.v1_21]=u.ExplorationVersions.v5_45,e),u.setExplorationStateVersionToExplorationVersion=function(e){u.ExplorationStateVersionToExplorationVersion=e},u.DefaultCategoryColorVisualsToUpgrade=["barChart","clusteredBarChart","clusteredColumnChart","columnChart","comboChart","dataDotClusteredColumnComboChart","dataDotStackedColumnComboChart","funnel","hundredPercentStackedBarChart","hundredPercentStackedColumnChart","lineStackedColumnComboChart","lineClusteredColumnComboChart","map","filledMap","shapeMap","scatterChart"],u.ComboSmallMultipleFormattingVisualTypes=[o.lineClusteredColumnComboChart.name,o.lineStackedColumnComboChart.name],e=[o.areaChart.name,o.barChart.name,o.clusteredBarChart.name,o.clusteredColumnChart.name,o.columnChart.name,o.hundredPercentStackedBarChart.name,o.hundredPercentStackedColumnChart.name,o.lineChart.name,o.stackedAreaChart.name,o.ribbonChart.name],x=__spreadArray(__spreadArray([],e,!0),u.ComboSmallMultipleFormattingVisualTypes,!0),u.CartesianExpressionBasedFormattingVisualTypes=[o.areaChart.name,o.lineChart.name,o.stackedAreaChart.name,o.realTimeLineChart.name,o.scatterChart.name,o.waterfallChart.name,o.dataDotChart.name,o.columnChart.name,o.clusteredColumnChart.name,o.hundredPercentStackedColumnChart.name,o.barChart.name,o.clusteredBarChart.name,o.hundredPercentStackedBarChart.name,o.ribbonChart.name,o.comboChart.name,o.lineClusteredColumnComboChart.name,o.lineStackedColumnComboChart.name,o.dataDotClusteredColumnComboChart.name,o.dataDotStackedColumnComboChart.name,o.histogram.name],u.CartesianExpressionBasedFormattingLabelVisualTypes=_.without(u.CartesianExpressionBasedFormattingVisualTypes,o.realTimeLineChart.name,o.scatterChart.name,o.histogram.name),u.CartesianExpressionBasedFormattingDataPointAndAxisExtentVisualTypes=_.without(u.CartesianExpressionBasedFormattingVisualTypes,o.realTimeLineChart.name),u.CartesianExpressionBasedFormattingTotalsVisualTypes=[p.visuals.plugins.stackedAreaChart.name,p.visuals.plugins.columnChart.name,p.visuals.plugins.clusteredColumnChart.name,p.visuals.plugins.barChart.name,p.visuals.plugins.clusteredBarChart.name,p.visuals.plugins.lineClusteredColumnComboChart.name,p.visuals.plugins.lineStackedColumnComboChart.name,p.visuals.plugins.dataDotClusteredColumnComboChart.name,p.visuals.plugins.dataDotStackedColumnComboChart.name],u.CartesianExpressionBasedFormattingValueAxisSecVisualTypes=[p.visuals.plugins.lineClusteredColumnComboChart.name,p.visuals.plugins.lineStackedColumnComboChart.name,p.visuals.plugins.dataDotClusteredColumnComboChart.name,p.visuals.plugins.dataDotStackedColumnComboChart.name],u.ErrorBarsVisualTypes=[p.visuals.plugins.lineChart.name,p.visuals.plugins.clusteredBarChart.name,p.visuals.plugins.clusteredColumnChart.name,p.visuals.plugins.barChart.name,p.visuals.plugins.columnChart.name,p.visuals.plugins.hundredPercentStackedBarChart.name,p.visuals.plugins.hundredPercentStackedColumnChart.name,p.visuals.plugins.ribbonChart.name,p.visuals.plugins.lineStackedColumnComboChart.name,p.visuals.plugins.lineClusteredColumnComboChart.name],u.GeocodingTypes=[o.azureMap.name,o.filledMap.name,o.heatMap.name,o.map.name],u.AddedObjectPropertyVersions=[{property:{objectName:"general",propertyName:"altText"},version:u.ExplorationVersions.v3_1},{property:{objectName:"visualLink",propertyName:"type"},version:u.ExplorationVersions.v3_5},{property:{objectName:"visualLink",propertyName:"type",matchByContents:function(e){return e.value===g.Bookmark}},version:c.bookmarks},{property:{objectName:"labels",propertyName:"enableBackground"},version:u.ExplorationVersions.v3_9},{property:{objectName:"labels",propertyName:"backgroundColor"},version:u.ExplorationVersions.v3_9},{property:{objectName:"labels",propertyName:"backgroundTransparency"},version:u.ExplorationVersions.v3_9},{property:{objectName:"categoryLabels",propertyName:"labelEnableBackground"},version:u.ExplorationVersions.v3_9},{property:{objectName:"categoryLabels",propertyName:"labelBackgroundColor"},version:u.ExplorationVersions.v3_9},{property:{objectName:"categoryLabels",propertyName:"labelBackgroundTransparency"},version:u.ExplorationVersions.v3_9},{property:{objectName:"dateRange",propertyName:"anchorDate"},version:u.ExplorationVersions.v3_9},{property:{objectName:"categoryAxis",propertyName:"maxMarginFactor"},version:u.ExplorationVersions.v3_9},{property:{objectName:"categoryAxis",propertyName:"innerPadding"},version:u.ExplorationVersions.v3_9},{property:{objectName:"columnFormatting",propertyName:"labelDisplayUnits"},version:u.ExplorationVersions.v3_12},{property:{objectName:"columnFormatting",propertyName:"labelPrecision"},version:u.ExplorationVersions.v3_12},{property:{objectName:"visualTooltip",propertyName:"type",matchByContents:function(e){return e.value===f.Canvas}},version:c.CanvasTooltips},{property:{objectName:"lineStyles",propertyName:"lineStyle"},version:u.ExplorationVersions.v3_13,types:[p.visuals.plugins.lineClusteredColumnComboChart.name,p.visuals.plugins.lineStackedColumnComboChart.name]},{property:{objectName:"legend",propertyName:"legendMarkerRendering"},version:u.ExplorationVersions.v3_13,types:[p.visuals.plugins.lineClusteredColumnComboChart.name,p.visuals.plugins.lineStackedColumnComboChart.name]},{property:{objectName:"legend",propertyName:"defaultToCircle"},version:u.ExplorationVersions.v3_13,types:[p.visuals.plugins.lineClusteredColumnComboChart.name,p.visuals.plugins.lineStackedColumnComboChart.name]},{property:{objectName:"legend",propertyName:"matchLineColor"},version:u.ExplorationVersions.v3_13,types:[p.visuals.plugins.lineClusteredColumnComboChart.name,p.visuals.plugins.lineStackedColumnComboChart.name]},{property:{objectName:"visualLink",propertyName:"type",matchByContents:function(e){return e.value===g.Qna}},version:c.QnaLink},{property:{objectName:"labels",propertyName:"funnelLabelStyle"},version:u.ExplorationVersions.v3_14,types:[p.visuals.plugins.funnel.name]},{property:{objectName:"dataPoint",propertyName:"fillRule",matchByContents:V},version:u.ExplorationVersions.v3_15},{property:{objectName:"values",propertyName:"backColor",matchByContents:V},version:u.ExplorationVersions.v3_15},{property:{objectName:"values",propertyName:"fontColor",matchByContents:V},version:u.ExplorationVersions.v3_15},{property:{objectName:"outspace",propertyName:s},version:c.OutspaceFormatting,types:["page"]},{property:{objectName:"visualHeader",propertyName:s},version:c.StylableVisualContainerHeader},{property:{objectName:"visualTooltip",propertyName:"show"},version:u.ExplorationVersions.v3_16},{property:{objectName:"categoryAxis",propertyName:"axisType",matchByContents:function(e){return e.value===p.visuals.axisType.categorical}},version:c.DotPlotVisual,types:[p.visuals.plugins.scatterChart.name]},{property:{objectName:"searchBox",propertyName:s},version:u.ExplorationVersions.v3_19,types:[p.visuals.plugins.slicer.name]},{property:{objectName:"rowHeaders",propertyName:"showExpandCollapseButtons"},version:c.ExpandCollapse,types:[p.visuals.plugins.pivotTable.name]},{property:{objectName:"dataPoint",propertyName:"fill",matchByContents:function(e,t){return t&&t.data&&1===t.data.length&&l.isWildcard(t.data[0])}},version:c.CartesianConditionalFormatting,types:u.DefaultCategoryColorVisualsToUpgrade},{property:{objectName:"filterCard",propertyName:s},version:c.OutspacePaneFormatting,types:["page"]},{property:{objectName:"outspacePane",propertyName:s},version:c.OutspacePaneFormatting,types:["page"]},{property:{objectName:"outspacePane",propertyName:"expanded"},version:c.OutspacePaneFormatting,types:["report"]},{property:{objectName:"outspacePane",propertyName:"visible"},version:c.OutspacePaneFormatting,types:["report"]},{property:{objectName:"visualLink",propertyName:"tooltip"},version:c.VisualLinkTooltip},{property:{objectName:"general",propertyName:"requireSingleSelect"},version:c.FilterRequireSingleSelect,types:["filter"]},{property:{objectName:"title",propertyName:"titleWrap"},version:c.TitleWordWrap},{property:{objectName:"border",propertyName:"radius"},version:c.VisualBorderRadius},{property:{objectName:"visualLink",propertyName:"webUrl"},version:c.WebUrlAction},{property:{objectName:"selection",propertyName:"strictSingleSelect"},version:c.StrictSingleSelect,types:[p.visuals.plugins.slicer.name]},{property:{objectName:"visualTooltip",propertyName:"fontColor"},version:c.DefaultTooltipFormatting},{property:{objectName:"visualTooltip",propertyName:"fontSize"},version:c.DefaultTooltipFormatting},{property:{objectName:"visualTooltip",propertyName:"fontFamily"},version:c.DefaultTooltipFormatting},{property:{objectName:"visualTooltip",propertyName:"background"},version:c.DefaultTooltipFormatting},{property:{objectName:"visualTooltip",propertyName:"transparency"},version:c.DefaultTooltipFormatting},{property:{objectName:"displayArea",propertyName:"verticalAlignment"},version:c.DisplayAreaVerticalAlignment,types:["page"]},{property:{objectName:"section",propertyName:"verticalAlignment"},version:c.DisplayAreaVerticalAlignment,types:["report"]},{property:{objectName:"title",propertyName:"text",isExprBound:!0},version:c.ExpressionBoundVisualTitles},{property:{objectName:"indicator",propertyName:"fontSize"},version:u.ExplorationVersions.v4_1,types:[p.visuals.plugins.kpi.name]},{property:{objectName:"labels",propertyName:"labelPosition"},version:u.ExplorationVersions.v4_1,types:[p.visuals.plugins.lineChart.name]},{property:{objectName:"title",propertyName:"fontColor",matchByContents:function(e,t){e=e&&e.solid&&e.solid.color;return!(v.isConstant(e)||v.isThemeDataColor(e))}},version:c.ColorConditionalFormatting},{property:{objectName:"title",propertyName:"background",matchByContents:function(e,t){e=e&&e.solid&&e.solid.color;return!(v.isConstant(e)||v.isThemeDataColor(e))}},version:c.ColorConditionalFormatting},{property:{objectName:"labels",propertyName:"color",matchByContents:function(e,t){e=e&&e.solid&&e.solid.color;return!(v.isConstant(e)||v.isThemeDataColor(e))}},version:c.ColorConditionalFormatting,types:[p.visuals.plugins.card.name]},{property:{objectName:"categoryLabels",propertyName:"color",matchByContents:function(e,t){e=e&&e.solid&&e.solid.color;return!(v.isConstant(e)||v.isThemeDataColor(e))}},version:c.ColorConditionalFormatting,types:[p.visuals.plugins.card.name]},{property:{objectName:"subTotals",propertyName:"rowSubtotalsLabel"},types:[p.visuals.plugins.pivotTable.name],version:u.ExplorationVersions.v4_2},{property:{objectName:"subTotals",propertyName:"columnSubtotalsLabel"},types:[p.visuals.plugins.pivotTable.name],version:u.ExplorationVersions.v4_2},{property:{objectName:"subTotals",propertyName:"levelSubtotalLabel"},types:[p.visuals.plugins.pivotTable.name],version:u.ExplorationVersions.v4_2},{property:{objectName:"total",propertyName:"label"},types:[p.visuals.plugins.tableEx.name],version:u.ExplorationVersions.v4_2},{property:{objectName:"visualHeader",propertyName:"showTooltipButton"},version:c.VisualHeaderTooltip},{property:{objectName:"visualHeaderTooltip",propertyName:"section"},version:c.VisualHeaderTooltip},{property:{objectName:"visualHeaderTooltip",propertyName:"text"},version:c.VisualHeaderTooltip},{property:{objectName:"visualHeaderTooltip",propertyName:"titleFontColor"},version:c.VisualHeaderTooltip},{property:{objectName:"visualHeaderTooltip",propertyName:"fontSize"},version:c.VisualHeaderTooltip},{property:{objectName:"visualHeaderTooltip",propertyName:"fontFamily"},version:c.VisualHeaderTooltip},{property:{objectName:"visualHeaderTooltip",propertyName:"background"},version:c.VisualHeaderTooltip},{property:{objectName:"visualHeaderTooltip",propertyName:"transparency"},version:c.VisualHeaderTooltip},{property:{objectName:"dataPoint",propertyName:"fill",matchByContents:function(e,t){return!v.isConstant(e&&e.solid&&e.solid.color)}},version:c.GaugeConditionalFormatting,types:[p.visuals.plugins.gauge.name]},{property:{objectName:"background",propertyName:"color",matchByContents:function(e,t){e=e&&e.solid&&e.solid.color;return!(v.isConstant(e)||v.isThemeDataColor(e))}},version:c.ExpressionBoundVisualBackground},{property:{objectName:"keyDrivers",propertyName:"allowKeyDriversCounting",matchByContents:function(e){return!0===e.value}},version:c.KeyDriversCounting},{types:[p.visuals.plugins.pivotTable.name,p.visuals.plugins.tableEx.name],property:{objectName:"values",propertyName:"icon"},version:u.ExplorationVersions.v5_1},{property:{objectName:"text",propertyName:"fontFamily"},types:[p.visuals.plugins.textbox.name],version:u.ExplorationVersions.v5_3},{property:{objectName:"text",propertyName:"fontSize"},types:[p.visuals.plugins.textbox.name],version:u.ExplorationVersions.v5_3},{property:{objectName:"text",propertyName:"color"},types:[p.visuals.plugins.textbox.name],version:u.ExplorationVersions.v5_3},{property:{objectName:"general",propertyName:"altText",isExprBound:!0},version:c.ExpressionBoundAltText},{property:{objectName:"border",propertyName:"color",isExprBound:!0},version:c.ExpressionBoundBorderColor},{property:{objectName:"dataPoint",propertyName:"target",isExprBound:!0},version:c.ExpressionBoundGaugeColors,types:[p.visuals.plugins.gauge.name]},{property:{objectName:"labels",propertyName:"color",isExprBound:!0},version:c.ExpressionBoundGaugeColors,types:[p.visuals.plugins.gauge.name]},{property:{objectName:"target",propertyName:"color",isExprBound:!0},version:c.ExpressionBoundGaugeColors,types:[p.visuals.plugins.gauge.name]},{property:{objectName:"calloutValue",propertyName:"color",isExprBound:!0},version:c.ExpressionBoundGaugeColors,types:[p.visuals.plugins.gauge.name]},{property:{objectName:"pageRefresh",propertyName:"show"},version:c.AutomaticPageRefresh,types:["page"]},{property:{objectName:"pageRefresh",propertyName:"duration"},version:c.AutomaticPageRefresh,types:["page"]},{property:{objectName:"text",propertyName:"text",isExprBound:!0},version:c.ExpressionBoundActions,types:[p.visuals.plugins.actionButton.name]},{property:{objectName:"text",propertyName:"fontColor",isExprBound:!0},version:c.ExpressionBoundActions,types:[p.visuals.plugins.actionButton.name]},{property:{objectName:"icon",propertyName:"lineColor",isExprBound:!0},version:c.ExpressionBoundActions,types:[p.visuals.plugins.actionButton.name]},{property:{objectName:"outline",propertyName:"lineColor",isExprBound:!0},version:c.ExpressionBoundActions,types:[p.visuals.plugins.actionButton.name]},{property:{objectName:"fill",propertyName:"fillColor",isExprBound:!0},version:c.ExpressionBoundActions,types:[p.visuals.plugins.actionButton.name]},{property:{objectName:"visualLink",propertyName:"tooltip",isExprBound:!0},version:c.ExpressionBoundActions},{types:[p.visuals.plugins.kpi.name],property:{objectName:"indicator",propertyName:"fontFamily"},version:c.AdditionalKPISettings},{types:[p.visuals.plugins.kpi.name],property:{objectName:"indicator",propertyName:"fontColor"},version:c.AdditionalKPISettings},{types:[p.visuals.plugins.kpi.name],property:{objectName:"indicator",propertyName:"verticalAlignment"},version:c.AdditionalKPISettings},{types:[p.visuals.plugins.kpi.name],property:{objectName:"indicator",propertyName:"horizontalAlignment"},version:c.AdditionalKPISettings},{types:[p.visuals.plugins.kpi.name],property:{objectName:"trendline",propertyName:"transparency"},version:c.AdditionalKPISettings},{types:[p.visuals.plugins.kpi.name],property:{objectName:"goals",propertyName:"goalText"},version:c.AdditionalKPISettings},{types:[p.visuals.plugins.kpi.name],property:{objectName:"goals",propertyName:"fontSize"},version:c.AdditionalKPISettings},{types:[p.visuals.plugins.kpi.name],property:{objectName:"goals",propertyName:"goalFontFamily"},version:c.AdditionalKPISettings},{types:[p.visuals.plugins.kpi.name],property:{objectName:"goals",propertyName:"goalFontColor"},version:c.AdditionalKPISettings},{types:[p.visuals.plugins.kpi.name],property:{objectName:"goals",propertyName:"distanceLabel"},version:c.AdditionalKPISettings},{types:[p.visuals.plugins.kpi.name],property:{objectName:"goals",propertyName:"percentageLabelPrecision"},version:c.AdditionalKPISettings},{types:[p.visuals.plugins.kpi.name],property:{objectName:"goals",propertyName:"titleFontSize"},version:c.AdditionalKPISettings},{types:[p.visuals.plugins.kpi.name],property:{objectName:"goals",propertyName:"distanceFontFamily"},version:c.AdditionalKPISettings},{types:[p.visuals.plugins.kpi.name],property:{objectName:"goals",propertyName:"distanceFontColor"},version:c.AdditionalKPISettings},{types:[p.visuals.plugins.kpi.name],property:{objectName:"goals",propertyName:"direction"},version:c.AdditionalKPISettings},{types:[p.visuals.plugins.kpi.name],property:{objectName:"period",propertyName:"show"},version:c.AdditionalKPISettings},{types:[p.visuals.plugins.kpi.name],property:{objectName:"period",propertyName:"fontSize"},version:c.AdditionalKPISettings},{types:[p.visuals.plugins.kpi.name],property:{objectName:"period",propertyName:"periodFontFamily"},version:c.AdditionalKPISettings},{types:[p.visuals.plugins.kpi.name],property:{objectName:"period",propertyName:"periodFontColor"},version:c.AdditionalKPISettings},{types:[p.visuals.plugins.pivotTable.name,p.visuals.plugins.tableEx.name],property:{objectName:"values",propertyName:"webURL"},version:u.ExplorationVersions.v5_6},{types:[p.visuals.plugins.decompositionTreeVisual.name],property:{objectName:p.visuals.decompositionTreeObjectNames.categoryLabels,propertyName:p.visuals.decompositionTreeObjectPropertyNames.categoryLabelFontColor},version:u.ExplorationVersions.v5_6},{types:[p.visuals.plugins.decompositionTreeVisual.name],property:{objectName:p.visuals.decompositionTreeObjectNames.categoryLabels,propertyName:p.visuals.decompositionTreeObjectPropertyNames.categoryLabelFontFamily},version:u.ExplorationVersions.v5_6},{types:[p.visuals.plugins.decompositionTreeVisual.name],property:{objectName:p.visuals.decompositionTreeObjectNames.categoryLabels,propertyName:p.visuals.decompositionTreeObjectPropertyNames.categoryLabelFontSize},version:u.ExplorationVersions.v5_6},{types:[p.visuals.plugins.decompositionTreeVisual.name],property:{objectName:p.visuals.decompositionTreeObjectNames.dataLabels,propertyName:p.visuals.decompositionTreeObjectPropertyNames.dataLabelFontColor},version:u.ExplorationVersions.v5_6},{types:[p.visuals.plugins.decompositionTreeVisual.name],property:{objectName:p.visuals.decompositionTreeObjectNames.dataLabels,propertyName:p.visuals.decompositionTreeObjectPropertyNames.dataLabelFontFamily},version:u.ExplorationVersions.v5_6},{types:[p.visuals.plugins.decompositionTreeVisual.name],property:{objectName:p.visuals.decompositionTreeObjectNames.dataLabels,propertyName:p.visuals.decompositionTreeObjectPropertyNames.dataLabelFontSize},version:u.ExplorationVersions.v5_6},{types:[p.visuals.plugins.decompositionTreeVisual.name],property:{objectName:p.visuals.decompositionTreeObjectNames.dataLabels,propertyName:p.visuals.decompositionTreeObjectPropertyNames.dataLabelDisplayUnits},version:u.ExplorationVersions.v5_6},{types:[p.visuals.plugins.decompositionTreeVisual.name],property:{objectName:p.visuals.decompositionTreeObjectNames.dataLabels,propertyName:p.visuals.decompositionTreeObjectPropertyNames.dataLabelPrecision},version:u.ExplorationVersions.v5_6},{types:[p.visuals.plugins.decompositionTreeVisual.name],property:{objectName:p.visuals.decompositionTreeObjectNames.dataBars,propertyName:p.visuals.decompositionTreeObjectPropertyNames.dataBarBackgroundColor},version:u.ExplorationVersions.v5_6},{types:[p.visuals.plugins.decompositionTreeVisual.name],property:{objectName:p.visuals.decompositionTreeObjectNames.dataBars,propertyName:p.visuals.decompositionTreeObjectPropertyNames.dataBarWidthPercent},version:u.ExplorationVersions.v5_6},{types:[p.visuals.plugins.decompositionTreeVisual.name],property:{objectName:p.visuals.decompositionTreeObjectNames.levelHeader,propertyName:p.visuals.decompositionTreeObjectPropertyNames.levelHeaderBackgroundColor},version:u.ExplorationVersions.v5_6},{types:[p.visuals.plugins.decompositionTreeVisual.name],property:{objectName:p.visuals.decompositionTreeObjectNames.levelHeader,propertyName:p.visuals.decompositionTreeObjectPropertyNames.levelTitleFontColor},version:u.ExplorationVersions.v5_6},{types:[p.visuals.plugins.decompositionTreeVisual.name],property:{objectName:p.visuals.decompositionTreeObjectNames.levelHeader,propertyName:p.visuals.decompositionTreeObjectPropertyNames.levelTitleFontFamily},version:u.ExplorationVersions.v5_6},{types:[p.visuals.plugins.decompositionTreeVisual.name],property:{objectName:p.visuals.decompositionTreeObjectNames.levelHeader,propertyName:p.visuals.decompositionTreeObjectPropertyNames.levelTitleFontSize},version:u.ExplorationVersions.v5_6},{types:[p.visuals.plugins.decompositionTreeVisual.name],property:{objectName:p.visuals.decompositionTreeObjectNames.levelHeader,propertyName:p.visuals.decompositionTreeObjectPropertyNames.levelSubtitleFontColor},version:u.ExplorationVersions.v5_6},{types:[p.visuals.plugins.decompositionTreeVisual.name],property:{objectName:p.visuals.decompositionTreeObjectNames.levelHeader,propertyName:p.visuals.decompositionTreeObjectPropertyNames.levelSubtitleFontFamily},version:u.ExplorationVersions.v5_6},{types:[p.visuals.plugins.decompositionTreeVisual.name],property:{objectName:p.visuals.decompositionTreeObjectNames.levelHeader,propertyName:p.visuals.decompositionTreeObjectPropertyNames.levelSubtitleFontSize},version:u.ExplorationVersions.v5_6},{types:[p.visuals.plugins.decompositionTreeVisual.name],property:{objectName:p.visuals.decompositionTreeObjectNames.levelHeader,propertyName:p.visuals.decompositionTreeObjectPropertyNames.showSubtitles},version:u.ExplorationVersions.v5_6},{types:[p.visuals.plugins.decompositionTreeVisual.name],property:{objectName:p.visuals.decompositionTreeObjectNames.tree,propertyName:p.visuals.decompositionTreeObjectPropertyNames.connectorDefaultColor},version:u.ExplorationVersions.v5_6},{types:["page"],property:{objectName:"outspacePane",propertyName:"inputBoxColor"},version:c.FilterPaneSearchBoxFormatting},{types:["page"],property:{objectName:"outspacePane",propertyName:"searchTextSize"},version:c.FilterPaneSearchBoxFormatting},{types:[p.visuals.plugins.actionButton.name],property:{objectName:"visualLink",propertyName:"navigationSection"},version:u.ExplorationVersions.v5_8},{types:[p.visuals.plugins.actionButton.name],property:{objectName:"visualLink",propertyName:"drillthroughSection"},version:u.ExplorationVersions.v5_8},{property:{objectName:"y2Axis",propertyName:"show"},version:c.LineChartDualAxis},{property:{objectName:"y2Axis",propertyName:"secAxisLabel"},version:c.LineChartDualAxis},{property:{objectName:"y2Axis",propertyName:"secLogAxisScale"},version:c.LineChartDualAxis},{property:{objectName:"y2Axis",propertyName:"secStart"},version:c.LineChartDualAxis},{property:{objectName:"y2Axis",propertyName:"secEnd"},version:c.LineChartDualAxis},{property:{objectName:"y2Axis",propertyName:"secShowAxisTitle"},version:c.LineChartDualAxis},{property:{objectName:"y2Axis",propertyName:"secAxisStyle"},version:c.LineChartDualAxis},{property:{objectName:"y2Axis",propertyName:"secLabelColor"},version:c.LineChartDualAxis},{property:{objectName:"y2Axis",propertyName:"secFontFamily"},version:c.LineChartDualAxis},{property:{objectName:"y2Axis",propertyName:"secFontSize"},version:c.LineChartDualAxis},{property:{objectName:"y2Axis",propertyName:"secLabelDisplayUnits"},version:c.LineChartDualAxis},{property:{objectName:"y2Axis",propertyName:"secLabelPrecision"},version:c.LineChartDualAxis},{property:{objectName:"y2Axis",propertyName:"secTitleColor"},version:c.LineChartDualAxis},{property:{objectName:"y2Axis",propertyName:"secTitleFontFamily"},version:c.LineChartDualAxis},{property:{objectName:"y2Axis",propertyName:"secTitleFontSize"},version:c.LineChartDualAxis},{property:{objectName:"y2Axis",propertyName:"secTitleText"},version:c.LineChartDualAxis},{types:[p.visuals.plugins.decompositionTreeVisual.name],property:{objectName:p.visuals.decompositionTreeObjectNames.tree,propertyName:p.visuals.decompositionTreeObjectPropertyNames.barsPerLevel},version:c.DecompTreeBarsPerLevel},{types:["page"],property:{objectName:"pageRefresh",propertyName:"refreshType"},version:c.ChangeDetectionRefresh},{property:{objectName:"visualHeader",propertyName:"showPersonalizeVisualButton"},version:c.AllowInlineExploration},{property:{objectName:"general",propertyName:"isInvertedSelectionMode"},version:c.FilterSelectAll,types:["filter"]},{types:[p.visuals.plugins.slicer.name],property:{objectName:"data",propertyName:"mode",matchByContents:function(e){return e.value===p.visuals.slicerMode.relativeTime}},version:c.RelativeTimeFilter},{types:["tableEx","pivotTable"],property:{objectName:"values",propertyName:"backColor",matchByContents:function(e,t){return void 0!==N(t)}},version:u.ExplorationVersions.v5_9},{types:["tableEx","pivotTable"],property:{objectName:"values",propertyName:"fontColor",matchByContents:function(e,t){return void 0!==N(t)}},version:u.ExplorationVersions.v5_9},{types:["tableEx","pivotTable"],property:{objectName:"values",propertyName:"icon",matchByContents:function(e,t){t=N(t);return void 0!==t&&1!==t}},version:u.ExplorationVersions.v5_9},{types:["tableEx","pivotTable"],property:{objectName:"values",propertyName:"webURL",matchByContents:function(e,t){t=N(t);return void 0!==t&&1!==t}},version:u.ExplorationVersions.v5_9},{types:[p.visuals.plugins.actionButton.name],property:{objectName:"fill",propertyName:"image"},version:u.ExplorationVersions.v5_10},{types:[p.visuals.plugins.actionButton.name],property:{objectName:"visualLink",propertyName:"enabledTooltip",isExprBound:!0},version:u.ExplorationVersions.v5_10},{types:[p.visuals.plugins.actionButton.name],property:{objectName:"visualLink",propertyName:"disabledTooltip",isExprBound:!0},version:u.ExplorationVersions.v5_10},{types:[p.visuals.plugins.actionButton.name],property:{objectName:"visualLink",propertyName:"drillthroughSection",isExprBound:!0},version:u.ExplorationVersions.v5_10},{types:[p.visuals.plugins.actionButton.name],property:{objectName:"visualLink",propertyName:"navigationSection",isExprBound:!0},version:u.ExplorationVersions.v5_10},{types:[p.visuals.plugins.image.name,p.visuals.plugins.basicShape.name],property:{objectName:"visualLink",propertyName:"navigationSection"},version:u.ExplorationVersions.v5_10},{types:[p.visuals.plugins.slicer.name,p.visuals.plugins.filterSlicer.name],property:{objectName:"items",propertyName:"steppedLayoutIndentation"},version:u.ExplorationVersions.v5_10},{types:[p.visuals.plugins.slicer.name,p.visuals.plugins.filterSlicer.name],property:{objectName:"items",propertyName:"expandCollapseToggleType"},version:u.ExplorationVersions.v5_10},{types:[p.visuals.plugins.kpi.name],property:{objectName:"indicator",propertyName:"iconSize"},version:c.KpiScalingIndicatorIcon},{types:[p.visuals.plugins.kpi.name],property:{objectName:"indicator",propertyName:"showIcon"},version:c.KpiScalingIndicatorIcon},{types:[p.visuals.plugins.lineChart.name,p.visuals.plugins.areaChart.name,p.visuals.plugins.stackedAreaChart.name],property:{objectName:"dataPoint",propertyName:"showAllDataPoints"},version:c.LineChartExplicitDots},{types:[p.visuals.plugins.map.name,p.visuals.plugins.filledMap.name,p.visuals.plugins.heatMap.name],property:{objectName:"dataPoint",propertyName:"transparency"},version:c.BingMapStyling},{types:[p.visuals.plugins.map.name,p.visuals.plugins.filledMap.name,p.visuals.plugins.heatMap.name],property:{objectName:"mapControls",propertyName:"minZoom"},version:c.BingMapStyling},{types:[p.visuals.plugins.map.name,p.visuals.plugins.filledMap.name,p.visuals.plugins.heatMap.name],property:{objectName:"mapControls",propertyName:"maxZoom"},version:c.BingMapStyling},{types:[p.visuals.plugins.map.name,p.visuals.plugins.filledMap.name,p.visuals.plugins.heatMap.name],property:{objectName:"mapStyles",propertyName:"showLabels"},version:c.BingMapStyling},{types:[p.visuals.plugins.filledMap.name],property:{objectName:"stroke",propertyName:"show"},version:c.BingMapStyling},{types:[p.visuals.plugins.filledMap.name],property:{objectName:"stroke",propertyName:"strokeColor"},version:c.BingMapStyling},{types:[p.visuals.plugins.filledMap.name],property:{objectName:"stroke",propertyName:"strokeWidth"},version:c.BingMapStyling},{types:[p.visuals.plugins.textbox.name],property:__assign(__assign({},p.visuals.textboxProps.general.paragraphs),{matchByContents:function(e,t){if(p.StructuralObjectDefinition.isParagraphsDefinition(e))for(var r=0,i=e;r<i.length;r++){var a=i[r];if(a&&!_.isEmpty(a.textRuns))for(var n=0,o=a.textRuns;n<o.length;n++){var s=o[n];if(p.ParagraphsDefinition.isTextRunConditionalDefinition(s))return!0}}return!1}}),version:c.ConditionalParagraphs},{types:[p.visuals.plugins.decompositionTreeVisual.name],property:{objectName:p.visuals.decompositionTreeObjectNames.tree,propertyName:p.visuals.decompositionTreeObjectPropertyNames.defaultClickAction},version:c.DecompositionTreeVisual},{types:[p.visuals.plugins.decompositionTreeVisual.name],property:{objectName:p.visuals.decompositionTreeObjectNames.tree,propertyName:p.visuals.decompositionTreeObjectPropertyNames.responsiveLayout},version:c.DecompositionTreeVisual},{types:[p.visuals.plugins.decompositionTreeVisual.name],property:{objectName:p.visuals.decompositionTreeObjectNames.tree,propertyName:p.visuals.decompositionTreeObjectPropertyNames.effectiveBarsPerLevel},version:c.DecompositionTreeVisual},{types:[p.visuals.plugins.decompositionTreeVisual.name],property:{objectName:p.visuals.decompositionTreeObjectNames.dataBars,propertyName:p.visuals.decompositionTreeObjectPropertyNames.dataBarColor},version:c.DecompositionTreeVisual},{types:[p.visuals.plugins.decompositionTreeVisual.name],property:{objectName:p.visuals.decompositionTreeObjectNames.dataBars,propertyName:p.visuals.decompositionTreeObjectPropertyNames.axisStart},version:c.DecompositionTreeVisual},{types:[p.visuals.plugins.decompositionTreeVisual.name],property:{objectName:p.visuals.decompositionTreeObjectNames.dataBars,propertyName:p.visuals.decompositionTreeObjectPropertyNames.axisEnd},version:c.DecompositionTreeVisual},{types:[p.visuals.plugins.decompositionTreeVisual.name],property:{objectName:"general",propertyName:"formatString"},version:c.DecompositionTreeVisual},{types:[p.visuals.plugins.qnaVisual.name],property:{objectName:"inputBox",propertyName:"warningColor"},version:c.QnaWarningUnderlineColor},{types:[p.visuals.plugins.slicer.name,p.visuals.plugins.filterSlicer.name],property:{objectName:"header",propertyName:"text"},version:c.SlicerHeaderText},{types:[p.visuals.plugins.barChart.name,p.visuals.plugins.columnChart.name,p.visuals.plugins.clusteredBarChart.name,p.visuals.plugins.clusteredColumnChart.name,p.visuals.plugins.hundredPercentStackedBarChart.name,p.visuals.plugins.hundredPercentStackedColumnChart.name,p.visuals.plugins.scatterChart.name],property:{objectName:"legend",propertyName:"showGradientLegend"},version:c.GradientLegend},{types:[p.visuals.plugins.qnaVisual.name],property:{objectName:"inputBox",propertyName:"commitButtonBackgroundColor"},version:c.QnaActionButtonsColor},{property:{objectName:"dropShadow",propertyName:"*"},version:c.DropShadow},{types:["page"],property:{objectName:"personalizeVisual",propertyName:"perspectiveRef"},version:c.PersonalizeVisualPerspective},{types:["page"],property:{objectName:"personalizeVisual",propertyName:"show"},version:c.PersonalizeVisualPerspectiveToggle},{property:{objectName:"general",propertyName:"keepLayerOrder"},version:c.KeepLayerOrder},{property:p.visuals.textboxProps.values.expr,types:[p.visuals.plugins.textbox.name],version:c.NarrativeVisual},{property:p.visuals.textboxProps.values.formatString,types:[p.visuals.plugins.textbox.name],version:c.NarrativeVisual},{types:[p.visuals.plugins.areaChart.name,p.visuals.plugins.barChart.name,p.visuals.plugins.columnChart.name,p.visuals.plugins.dataDotStackedColumnComboChart.name,p.visuals.plugins.lineStackedColumnComboChart.name,p.visuals.plugins.hundredPercentStackedBarChart.name,p.visuals.plugins.hundredPercentStackedColumnChart.name,p.visuals.plugins.stackedAreaChart.name],property:{objectName:"totals",propertyName:"show"},version:c.StackedTotalDataLabels},{types:[p.visuals.plugins.barChart.name,p.visuals.plugins.columnChart.name,p.visuals.plugins.dataDotStackedColumnComboChart.name,p.visuals.plugins.lineStackedColumnComboChart.name,p.visuals.plugins.hundredPercentStackedBarChart.name,p.visuals.plugins.hundredPercentStackedColumnChart.name,p.visuals.plugins.stackedAreaChart.name],property:{objectName:"totals",propertyName:"color"},version:c.StackedTotalDataLabels},{types:[p.visuals.plugins.barChart.name,p.visuals.plugins.columnChart.name,p.visuals.plugins.dataDotStackedColumnComboChart.name,p.visuals.plugins.lineStackedColumnComboChart.name,p.visuals.plugins.hundredPercentStackedBarChart.name,p.visuals.plugins.hundredPercentStackedColumnChart.name,p.visuals.plugins.stackedAreaChart.name],property:{objectName:"totals",propertyName:"labelDisplayUnits"},version:c.StackedTotalDataLabels},{types:[p.visuals.plugins.barChart.name,p.visuals.plugins.columnChart.name,p.visuals.plugins.dataDotStackedColumnComboChart.name,p.visuals.plugins.lineStackedColumnComboChart.name,p.visuals.plugins.hundredPercentStackedBarChart.name,p.visuals.plugins.hundredPercentStackedColumnChart.name,p.visuals.plugins.stackedAreaChart.name],property:{objectName:"totals",propertyName:"labelPrecision"},version:c.StackedTotalDataLabels},{types:[p.visuals.plugins.barChart.name,p.visuals.plugins.columnChart.name,p.visuals.plugins.dataDotStackedColumnComboChart.name,p.visuals.plugins.lineStackedColumnComboChart.name,p.visuals.plugins.hundredPercentStackedBarChart.name,p.visuals.plugins.hundredPercentStackedColumnChart.name,p.visuals.plugins.stackedAreaChart.name],property:{objectName:"totals",propertyName:"enableBackground"},version:c.StackedTotalDataLabels},{types:[p.visuals.plugins.barChart.name,p.visuals.plugins.columnChart.name,p.visuals.plugins.dataDotStackedColumnComboChart.name,p.visuals.plugins.lineStackedColumnComboChart.name,p.visuals.plugins.hundredPercentStackedBarChart.name,p.visuals.plugins.hundredPercentStackedColumnChart.name,p.visuals.plugins.stackedAreaChart.name],property:{objectName:"totals",propertyName:"backgroundColor"},version:c.StackedTotalDataLabels},{types:[p.visuals.plugins.barChart.name,p.visuals.plugins.columnChart.name,p.visuals.plugins.dataDotStackedColumnComboChart.name,p.visuals.plugins.lineStackedColumnComboChart.name,p.visuals.plugins.hundredPercentStackedBarChart.name,p.visuals.plugins.hundredPercentStackedColumnChart.name,p.visuals.plugins.stackedAreaChart.name],property:{objectName:"totals",propertyName:"backgroundTransparency"},version:c.StackedTotalDataLabels},{types:[p.visuals.plugins.barChart.name,p.visuals.plugins.columnChart.name,p.visuals.plugins.dataDotStackedColumnComboChart.name,p.visuals.plugins.lineStackedColumnComboChart.name,p.visuals.plugins.hundredPercentStackedBarChart.name,p.visuals.plugins.hundredPercentStackedColumnChart.name,p.visuals.plugins.stackedAreaChart.name],property:{objectName:"totals",propertyName:"fontSize"},version:c.StackedTotalDataLabels},{types:[p.visuals.plugins.barChart.name,p.visuals.plugins.columnChart.name,p.visuals.plugins.dataDotStackedColumnComboChart.name,p.visuals.plugins.lineStackedColumnComboChart.name,p.visuals.plugins.hundredPercentStackedBarChart.name,p.visuals.plugins.hundredPercentStackedColumnChart.name,p.visuals.plugins.stackedAreaChart.name],property:{objectName:"totals",propertyName:"fontFamily"},version:c.StackedTotalDataLabels},{types:[p.visuals.plugins.barChart.name,p.visuals.plugins.columnChart.name,p.visuals.plugins.dataDotStackedColumnComboChart.name,p.visuals.plugins.lineStackedColumnComboChart.name,p.visuals.plugins.hundredPercentStackedBarChart.name,p.visuals.plugins.hundredPercentStackedColumnChart.name],property:{objectName:"totals",propertyName:"showPositiveAndNegative"},version:c.StackedTotalDataLabels},{property:{objectName:"outspacePane",propertyName:"checkboxAndApplyColor"},types:["page"],version:c.FilterPaneCheckboxAndApplyColor},{types:[p.visuals.plugins.lineChart.name],property:{objectName:t.capabilityObjectName,propertyName:i.anomalyDetectionPropertyNames.show},version:c.AnomalyDetection},{types:[p.visuals.plugins.lineChart.name],property:{objectName:t.capabilityObjectName,propertyName:i.anomalyDetectionPropertyNames.transform},version:c.AnomalyDetection},{types:[p.visuals.plugins.lineChart.name],property:{objectName:t.capabilityObjectName,propertyName:t.sensitivitySliceName},version:c.AnomalyDetection},{types:[p.visuals.plugins.lineChart.name],property:{objectName:t.capabilityObjectName,propertyName:i.anomalyDetectionPropertyNames.displayName},version:c.AnomalyDetection},{types:[p.visuals.plugins.lineChart.name],property:{objectName:t.capabilityObjectName,propertyName:i.anomalyDetectionPropertyNames.markerShape},version:c.AnomalyDetection},{types:[p.visuals.plugins.lineChart.name],property:{objectName:t.capabilityObjectName,propertyName:i.anomalyDetectionPropertyNames.markerShapeSize},version:c.AnomalyDetection},{types:[p.visuals.plugins.lineChart.name],property:{objectName:t.capabilityObjectName,propertyName:i.anomalyDetectionPropertyNames.markerColor},version:c.AnomalyDetection},{types:[p.visuals.plugins.lineChart.name],property:{objectName:t.capabilityObjectName,propertyName:i.anomalyDetectionPropertyNames.confidenceBandStyle},version:c.AnomalyDetection},{types:[p.visuals.plugins.lineChart.name],property:{objectName:t.capabilityObjectName,propertyName:i.anomalyDetectionPropertyNames.transparency},version:c.AnomalyDetection},{types:[p.visuals.plugins.lineChart.name],property:{objectName:t.capabilityObjectName,propertyName:i.anomalyDetectionPropertyNames.confidenceBandColor},version:c.AnomalyDetection},{types:[p.visuals.plugins.lineChart.name],property:{objectName:t.capabilityObjectName,propertyName:p.visuals.AnomalyDetectionColumns.CategoryValue},version:c.AnomalyDetection},{types:[p.visuals.plugins.lineChart.name],property:{objectName:t.capabilityObjectName,propertyName:p.visuals.AnomalyDetectionColumns.Value},version:c.AnomalyDetection},{types:[p.visuals.plugins.lineChart.name],property:{objectName:t.capabilityObjectName,propertyName:p.visuals.AnomalyDetectionColumns.ExpectedValue},version:c.AnomalyDetection},{types:[p.visuals.plugins.lineChart.name],property:{objectName:t.capabilityObjectName,propertyName:p.visuals.AnomalyDetectionColumns.ExpectedLow},version:c.AnomalyDetection},{types:[p.visuals.plugins.lineChart.name],property:{objectName:t.capabilityObjectName,propertyName:p.visuals.AnomalyDetectionColumns.ExpectedHigh},version:c.AnomalyDetection},{types:[p.visuals.plugins.lineChart.name],property:{objectName:t.capabilityObjectName,propertyName:p.visuals.AnomalyDetectionColumns.BatchStart},version:c.AnomalyDetection},{types:[p.visuals.plugins.lineChart.name],property:{objectName:t.capabilityObjectName,propertyName:p.visuals.AnomalyDetectionColumns.BatchEnd},version:c.AnomalyDetection},{types:[p.visuals.plugins.lineChart.name],property:{objectName:t.capabilityObjectName,propertyName:t.explainByPropertyName},version:c.AnomalyDetection},{types:[p.visuals.plugins.lineChart.name],property:{objectName:t.capabilityObjectName,propertyName:t.isAnomalyHighlighted},version:c.AnomalyDetection},{types:[p.visuals.plugins.decompositionTreeVisual.name],property:{objectName:p.visuals.decompositionTreeObjectNames.insights,propertyName:p.visuals.decompositionTreeObjectPropertyNames.isAINode},version:c.DecompositionInsights},{types:[p.visuals.plugins.areaChart.name,p.visuals.plugins.barChart.name,p.visuals.plugins.clusteredBarChart.name,p.visuals.plugins.clusteredColumnChart.name,p.visuals.plugins.columnChart.name,p.visuals.plugins.comboChart.name,p.visuals.plugins.dataDotClusteredColumnComboChart.name,p.visuals.plugins.dataDotStackedColumnComboChart.name,p.visuals.plugins.hundredPercentStackedBarChart.name,p.visuals.plugins.hundredPercentStackedColumnChart.name,p.visuals.plugins.lineChart.name,p.visuals.plugins.lineClusteredColumnComboChart.name,p.visuals.plugins.lineStackedColumnComboChart.name,p.visuals.plugins.ribbonChart.name,p.visuals.plugins.scatterChart.name,p.visuals.plugins.stackedAreaChart.name],property:{objectName:"zoom",propertyName:"*"},version:c.AxisZoom},{types:e,property:{objectName:"subheader",propertyName:"fontFamily"},version:c.CartesianSmallMultiples},{types:e,property:{objectName:"subheader",propertyName:"fontSize"},version:c.CartesianSmallMultiples},{types:e,property:{objectName:"subheader",propertyName:"fontColor",isExprBound:!1},version:c.CartesianSmallMultiples},{types:e,property:{objectName:"subheader",propertyName:"alignment"},version:c.CartesianSmallMultiples},{types:e,property:{objectName:"subheader",propertyName:"position"},version:c.CartesianSmallMultiples},{types:e,property:{objectName:"smallMultiplesLayout",propertyName:"layoutType"},version:c.CartesianSmallMultiples},{types:e,property:{objectName:"smallMultiplesLayout",propertyName:"rowCount"},version:c.CartesianSmallMultiples},{types:e,property:{objectName:"smallMultiplesLayout",propertyName:"columnCount"},version:c.CartesianSmallMultiples},{property:{objectName:"dataPoint",propertyName:"fill",isExprBound:!0},version:c.AzureMapConditionalColor,types:[p.visuals.plugins.azureMap.name]},{types:e,property:{objectName:"smallMultiplesLayout",propertyName:"backgroundColor",isExprBound:!1},version:c.CartesianSmallMultiplesGridlines},{types:e,property:{objectName:"smallMultiplesLayout",propertyName:"backgroundTransparency"},version:c.CartesianSmallMultiplesGridlines},{types:e,property:{objectName:"smallMultiplesLayout",propertyName:"gridLineType"},version:c.CartesianSmallMultiplesGridlines},{types:e,property:{objectName:"smallMultiplesLayout",propertyName:"gridLineColor"},version:c.CartesianSmallMultiplesGridlines},{types:e,property:{objectName:"smallMultiplesLayout",propertyName:"gridLineWidth"},version:c.CartesianSmallMultiplesGridlines},{types:e,property:{objectName:"smallMultiplesLayout",propertyName:"gridLineStyle"},version:c.CartesianSmallMultiplesGridlines},{types:[o.map.name,o.filledMap.name,o.heatMap.name],property:{objectName:"mapControls",propertyName:"geocodingCulture"},version:c.MapGeocodingCulture},{types:[p.visuals.plugins.azureMap.name],property:{objectName:"mapControls",propertyName:"showSelectionControl"},version:c.AzureMapSelectionControl},{types:e,property:{objectName:"subheader",propertyName:"titleWrap"},version:c.CartesianSmallMultiplesSubheaderFormatting},{types:["group"],property:{objectName:"lockAspect",propertyName:"show"},version:c.VisualContainerGroupLockAspect},{types:[p.visuals.plugins.lineChart.name],property:{objectName:"xAxisReferenceLine",propertyName:"*"},version:c.lineChartVerticalReferenceLine},{types:x,property:{objectName:"smallMultiplesLayout",propertyName:"gridPadding"},version:c.CartesianSmallMultiplesPadding},{types:x,property:{objectName:"smallMultiplesLayout",propertyName:"advancedPaddingOptions"},version:c.CartesianSmallMultiplesPadding},{types:x,property:{objectName:"smallMultiplesLayout",propertyName:"columnPaddingInner"},version:c.CartesianSmallMultiplesPadding},{types:x,property:{objectName:"smallMultiplesLayout",propertyName:"columnPaddingOuter"},version:c.CartesianSmallMultiplesPadding},{types:x,property:{objectName:"smallMultiplesLayout",propertyName:"rowPaddingInner"},version:c.CartesianSmallMultiplesPadding},{types:x,property:{objectName:"smallMultiplesLayout",propertyName:"rowPaddingOuter"},version:c.CartesianSmallMultiplesPadding},{types:u.ComboSmallMultipleFormattingVisualTypes,property:{objectName:"subheader",propertyName:"fontFamily"},version:c.CartesianSmallMultiplesCombo},{types:u.ComboSmallMultipleFormattingVisualTypes,property:{objectName:"subheader",propertyName:"fontSize"},version:c.CartesianSmallMultiplesCombo},{types:u.ComboSmallMultipleFormattingVisualTypes,property:{objectName:"subheader",propertyName:"fontColor",isExprBound:!1},version:c.CartesianSmallMultiplesCombo},{types:u.ComboSmallMultipleFormattingVisualTypes,property:{objectName:"subheader",propertyName:"alignment"},version:c.CartesianSmallMultiplesCombo},{types:u.ComboSmallMultipleFormattingVisualTypes,property:{objectName:"subheader",propertyName:"position"},version:c.CartesianSmallMultiplesCombo},{types:u.ComboSmallMultipleFormattingVisualTypes,property:{objectName:"smallMultiplesLayout",propertyName:"layoutType"},version:c.CartesianSmallMultiplesCombo},{types:u.ComboSmallMultipleFormattingVisualTypes,property:{objectName:"smallMultiplesLayout",propertyName:"rowCount"},version:c.CartesianSmallMultiplesCombo},{types:u.ComboSmallMultipleFormattingVisualTypes,property:{objectName:"smallMultiplesLayout",propertyName:"columnCount"},version:c.CartesianSmallMultiplesCombo},{types:u.ComboSmallMultipleFormattingVisualTypes,property:{objectName:"smallMultiplesLayout",propertyName:"backgroundColor",isExprBound:!1},version:c.CartesianSmallMultiplesCombo},{types:u.ComboSmallMultipleFormattingVisualTypes,property:{objectName:"smallMultiplesLayout",propertyName:"backgroundTransparency"},version:c.CartesianSmallMultiplesCombo},{types:u.ComboSmallMultipleFormattingVisualTypes,property:{objectName:"smallMultiplesLayout",propertyName:"gridLineType"},version:c.CartesianSmallMultiplesCombo},{types:u.ComboSmallMultipleFormattingVisualTypes,property:{objectName:"smallMultiplesLayout",propertyName:"gridLineColor"},version:c.CartesianSmallMultiplesCombo},{types:u.ComboSmallMultipleFormattingVisualTypes,property:{objectName:"smallMultiplesLayout",propertyName:"gridLineWidth"},version:c.CartesianSmallMultiplesCombo},{types:u.ComboSmallMultipleFormattingVisualTypes,property:{objectName:"smallMultiplesLayout",propertyName:"gridLineStyle"},version:c.CartesianSmallMultiplesCombo},{types:u.ComboSmallMultipleFormattingVisualTypes,property:{objectName:"subheader",propertyName:"titleWrap"},version:c.CartesianSmallMultiplesCombo},{types:[p.visuals.plugins.areaChart.name,p.visuals.plugins.barChart.name,p.visuals.plugins.clusteredBarChart.name,p.visuals.plugins.clusteredColumnChart.name,p.visuals.plugins.columnChart.name,p.visuals.plugins.comboChart.name,p.visuals.plugins.dataDotClusteredColumnComboChart.name,p.visuals.plugins.dataDotStackedColumnComboChart.name,p.visuals.plugins.hundredPercentStackedBarChart.name,p.visuals.plugins.hundredPercentStackedColumnChart.name,p.visuals.plugins.lineChart.name,p.visuals.plugins.lineClusteredColumnComboChart.name,p.visuals.plugins.lineStackedColumnComboChart.name,p.visuals.plugins.ribbonChart.name,p.visuals.plugins.scatterChart.name,p.visuals.plugins.stackedAreaChart.name],property:{objectName:"categoryAxis",propertyName:"invertAxis"},version:c.InvertAxis},{types:[p.visuals.plugins.areaChart.name,p.visuals.plugins.barChart.name,p.visuals.plugins.clusteredBarChart.name,p.visuals.plugins.clusteredColumnChart.name,p.visuals.plugins.columnChart.name,p.visuals.plugins.comboChart.name,p.visuals.plugins.dataDotClusteredColumnComboChart.name,p.visuals.plugins.dataDotStackedColumnComboChart.name,p.visuals.plugins.hundredPercentStackedBarChart.name,p.visuals.plugins.hundredPercentStackedColumnChart.name,p.visuals.plugins.lineChart.name,p.visuals.plugins.lineClusteredColumnComboChart.name,p.visuals.plugins.lineStackedColumnComboChart.name,p.visuals.plugins.ribbonChart.name,p.visuals.plugins.scatterChart.name,p.visuals.plugins.stackedAreaChart.name,p.visuals.plugins.waterfallChart.name],property:{objectName:"valueAxis",propertyName:"invertAxis"},version:c.InvertAxis},{types:[p.visuals.plugins.areaChart.name,p.visuals.plugins.barChart.name,p.visuals.plugins.clusteredBarChart.name,p.visuals.plugins.clusteredColumnChart.name,p.visuals.plugins.columnChart.name,p.visuals.plugins.comboChart.name,p.visuals.plugins.dataDotClusteredColumnComboChart.name,p.visuals.plugins.dataDotStackedColumnComboChart.name,p.visuals.plugins.hundredPercentStackedBarChart.name,p.visuals.plugins.hundredPercentStackedColumnChart.name,p.visuals.plugins.lineChart.name,p.visuals.plugins.lineClusteredColumnComboChart.name,p.visuals.plugins.lineStackedColumnComboChart.name,p.visuals.plugins.ribbonChart.name,p.visuals.plugins.scatterChart.name,p.visuals.plugins.stackedAreaChart.name],property:{objectName:"y2Axis",propertyName:"secInvertAxis"},version:c.InvertAxis},{types:[p.visuals.plugins.areaChart.name,p.visuals.plugins.barChart.name,p.visuals.plugins.clusteredBarChart.name,p.visuals.plugins.clusteredColumnChart.name,p.visuals.plugins.columnChart.name,p.visuals.plugins.comboChart.name,p.visuals.plugins.dataDotClusteredColumnComboChart.name,p.visuals.plugins.dataDotStackedColumnComboChart.name,p.visuals.plugins.hundredPercentStackedBarChart.name,p.visuals.plugins.hundredPercentStackedColumnChart.name,p.visuals.plugins.lineChart.name,p.visuals.plugins.lineClusteredColumnComboChart.name,p.visuals.plugins.lineStackedColumnComboChart.name,p.visuals.plugins.ribbonChart.name,p.visuals.plugins.scatterChart.name,p.visuals.plugins.stackedAreaChart.name],property:{objectName:"valueAxis",propertyName:"secInvertAxis"},version:c.InvertAxis},{property:{objectName:"visualTooltip",propertyName:"actionFontColor"},version:c.EnhancedTooltips},{property:{objectName:"visualTooltip",propertyName:"themedTitleFontColor"},version:c.EnhancedTooltips},{property:{objectName:"visualTooltip",propertyName:"themedValueFontColor"},version:c.EnhancedTooltips},{property:{objectName:"visualTooltip",propertyName:"themedBackground"},version:c.EnhancedTooltips},{property:{objectName:"fill",propertyName:"fillColor",isExprBound:!0},version:u.ExplorationVersions.v5_21,types:[p.visuals.plugins.shape.name]},{property:{objectName:"outline",propertyName:"lineColor",isExprBound:!0},version:u.ExplorationVersions.v5_21,types:[p.visuals.plugins.shape.name]},{property:{objectName:"text",propertyName:"text",isExprBound:!0},version:u.ExplorationVersions.v5_21,types:[p.visuals.plugins.shape.name]},{property:{objectName:"text",propertyName:"fontColor",isExprBound:!0},version:u.ExplorationVersions.v5_21,types:[p.visuals.plugins.shape.name]},{property:{objectName:"shadow",propertyName:"color",isExprBound:!0},version:u.ExplorationVersions.v5_21,types:[p.visuals.plugins.shape.name]},{property:{objectName:"glow",propertyName:"color",isExprBound:!0},version:u.ExplorationVersions.v5_21,types:[p.visuals.plugins.shape.name]},{types:[o.map.name,o.filledMap.name,p.visuals.plugins.heatMap.name],property:{objectName:"mapControls",propertyName:"showLassoButton"},version:c.ShowLassoButton},{types:[p.visuals.plugins.lineChart.name,p.visuals.plugins.areaChart.name,p.visuals.plugins.stackedAreaChart.name],property:{objectName:"dataPoint",propertyName:"fill",matchByContents:function(e,t){return!t||t.data&&1===t.data.length&&l.isWildcard(t.data[0])}},version:c.LineChartExplicitDotsDefault},{types:[o.shapeMap.name],property:{objectName:"shape",propertyName:"map",matchByContents:function(e){if(e){e=e.name;if(e)return e.value===y.franceRegionsV2}return!1}},version:c.ShapeMapFranceUpdatedRegions},{property:{objectName:"visualHeaderTooltip",propertyName:"themedTitleFontColor"},version:c.EnhancedTooltipsForVisualHeaderTooltip},{property:{objectName:"visualHeaderTooltip",propertyName:"themedBackground"},version:c.EnhancedTooltipsForVisualHeaderTooltip},{types:[p.visuals.plugins.lineChart.name,p.visuals.plugins.areaChart.name,p.visuals.plugins.stackedAreaChart.name],property:{objectName:"dataPoint",propertyName:"transparency"},version:c.AreaChartTransparency},{types:x,property:{objectName:"subheader",propertyName:"show"},version:c.SmallMultiplesResponsive},{types:x,property:{objectName:"subheader",propertyName:"fontColor",isExprBound:!0},version:u.ExplorationVersions.v5_22},{types:x,property:{objectName:"smallMultiplesLayout",propertyName:"backgroundColor",isExprBound:!0},version:u.ExplorationVersions.v5_22},{types:__spreadArray([p.visuals.plugins.azureMap.name,p.visuals.plugins.donutChart.name,p.visuals.plugins.pieChart.name,p.visuals.plugins.map.name,p.visuals.plugins.filledMap.name,p.visuals.plugins.shapeMap.name,p.visuals.plugins.treemap.name],u.CartesianExpressionBasedFormattingVisualTypes,!0),property:{objectName:"legend",propertyName:"labelColor",isExprBound:!0},version:c.ConditionalFormattingUpdates},{types:__spreadArray([p.visuals.plugins.azureMap.name,p.visuals.plugins.donutChart.name,p.visuals.plugins.pieChart.name,p.visuals.plugins.funnel.name,p.visuals.plugins.map.name,p.visuals.plugins.filledMap.name,p.visuals.plugins.shapeMap.name],u.CartesianExpressionBasedFormattingDataPointAndAxisExtentVisualTypes,!0),property:{objectName:"dataPoint",propertyName:"fill",isExprBound:!0},version:c.ConditionalFormattingUpdates},{types:__spreadArray([p.visuals.plugins.donutChart.name,p.visuals.plugins.pieChart.name,p.visuals.plugins.funnel.name,p.visuals.plugins.map.name,p.visuals.plugins.filledMap.name,p.visuals.plugins.sunburst.name,p.visuals.plugins.treemap.name],u.CartesianExpressionBasedFormattingLabelVisualTypes,!0),property:{objectName:"labels",propertyName:"color",isExprBound:!0},version:c.ConditionalFormattingUpdates},{types:u.CartesianExpressionBasedFormattingTotalsVisualTypes,property:{objectName:"totals",propertyName:"color",isExprBound:!0},version:c.ConditionalFormattingUpdates},{types:[p.visuals.plugins.funnel.name],property:{objectName:"percentBarLabel",propertyName:"color",isExprBound:!0},version:c.ConditionalFormattingUpdates},{types:[p.visuals.plugins.funnel.name],property:{objectName:"categoryAxis",propertyName:"color",isExprBound:!0},version:c.ConditionalFormattingUpdates},{types:u.CartesianExpressionBasedFormattingDataPointAndAxisExtentVisualTypes,property:{objectName:"categoryAxis",propertyName:"start",isExprBound:!0},version:c.ConditionalFormattingUpdates},{types:u.CartesianExpressionBasedFormattingDataPointAndAxisExtentVisualTypes,property:{objectName:"categoryAxis",propertyName:"end",isExprBound:!0},version:c.ConditionalFormattingUpdates},{types:u.CartesianExpressionBasedFormattingDataPointAndAxisExtentVisualTypes,property:{objectName:"categoryAxis",propertyName:"titleColor",isExprBound:!0},version:c.ConditionalFormattingUpdates},{types:u.CartesianExpressionBasedFormattingDataPointAndAxisExtentVisualTypes,property:{objectName:"categoryAxis",propertyName:"gridlineColor",isExprBound:!0},version:c.ConditionalFormattingUpdates},{types:u.CartesianExpressionBasedFormattingVisualTypes,property:{objectName:"categoryAxis",propertyName:"labelColor",isExprBound:!0},version:c.ConditionalFormattingUpdates},{types:u.CartesianExpressionBasedFormattingDataPointAndAxisExtentVisualTypes,property:{objectName:"valueAxis",propertyName:"start",isExprBound:!0},version:c.ConditionalFormattingUpdates},{types:u.CartesianExpressionBasedFormattingDataPointAndAxisExtentVisualTypes,property:{objectName:"valueAxis",propertyName:"end",isExprBound:!0},version:c.ConditionalFormattingUpdates},{types:u.CartesianExpressionBasedFormattingDataPointAndAxisExtentVisualTypes,property:{objectName:"valueAxis",propertyName:"titleColor",isExprBound:!0},version:c.ConditionalFormattingUpdates},{types:u.CartesianExpressionBasedFormattingDataPointAndAxisExtentVisualTypes,property:{objectName:"valueAxis",propertyName:"gridlineColor",isExprBound:!0},version:c.ConditionalFormattingUpdates},{types:u.CartesianExpressionBasedFormattingVisualTypes,property:{objectName:"valueAxis",propertyName:"labelColor",isExprBound:!0},version:c.ConditionalFormattingUpdates},{types:u.CartesianExpressionBasedFormattingValueAxisSecVisualTypes,property:{objectName:"valueAxis",propertyName:"secStart",isExprBound:!0},version:c.ConditionalFormattingUpdates},{types:u.CartesianExpressionBasedFormattingValueAxisSecVisualTypes,property:{objectName:"valueAxis",propertyName:"secEnd",isExprBound:!0},version:c.ConditionalFormattingUpdates},{types:[p.visuals.plugins.areaChart.name,p.visuals.plugins.lineChart.name],property:{objectName:"y2Axis",propertyName:"secStart",isExprBound:!0},version:c.ConditionalFormattingUpdates},{types:[p.visuals.plugins.areaChart.name,p.visuals.plugins.lineChart.name],property:{objectName:"y2Axis",propertyName:"secEnd",isExprBound:!0},version:c.ConditionalFormattingUpdates},{types:[p.visuals.plugins.multiRowCard.name],property:{objectName:"cardTitle",propertyName:"color",isExprBound:!0},version:c.ConditionalFormattingUpdates},{types:[p.visuals.plugins.multiRowCard.name],property:{objectName:"dataLabels",propertyName:"color",isExprBound:!0},version:c.ConditionalFormattingUpdates},{types:[p.visuals.plugins.multiRowCard.name,p.visuals.plugins.treemap.name],property:{objectName:"categoryLabels",propertyName:"color",isExprBound:!0},version:c.ConditionalFormattingUpdates},{types:[p.visuals.plugins.gauge.name],property:{objectName:"axis",propertyName:"min",isExprBound:!0},version:c.ConditionalFormattingUpdates},{types:[p.visuals.plugins.gauge.name],property:{objectName:"axis",propertyName:"max",isExprBound:!0},version:c.ConditionalFormattingUpdates},{types:[p.visuals.plugins.gauge.name],property:{objectName:"axis",propertyName:"target",isExprBound:!0},version:c.ConditionalFormattingUpdates},{types:[p.visuals.plugins.slicer.name],property:{objectName:"slider",propertyName:"color",isExprBound:!0},version:c.ConditionalFormattingUpdates},{types:[p.visuals.plugins.slicer.name],property:{objectName:"header",propertyName:"fontColor",isExprBound:!0},version:c.ConditionalFormattingUpdates},{types:[p.visuals.plugins.slicer.name],property:{objectName:"header",propertyName:"background",isExprBound:!0},version:c.ConditionalFormattingUpdates},{property:{objectName:"visualLink",propertyName:"showDefaultTooltip"},version:c.SuppressDefaultTooltip},{property:{objectName:"shape",propertyName:"arrowheadSize"},version:c.ShapeFormattingFeatures,types:[p.visuals.plugins.shape.name,p.visuals.plugins.actionButton.name]},{property:{objectName:"shape",propertyName:"arrowStemWidth"},version:c.ShapeFormattingFeatures,types:[p.visuals.plugins.shape.name,p.visuals.plugins.actionButton.name]},{property:{objectName:"shape",propertyName:"chevronAngle"},version:c.ShapeFormattingFeatures,types:[p.visuals.plugins.shape.name,p.visuals.plugins.actionButton.name]},{property:{objectName:"shape",propertyName:"isocelesTriangleTipPosition"},version:c.ShapeFormattingFeatures,types:[p.visuals.plugins.shape.name,p.visuals.plugins.actionButton.name]},{property:{objectName:"shape",propertyName:"parallelogramSlant"},version:c.ShapeFormattingFeatures,types:[p.visuals.plugins.shape.name,p.visuals.plugins.actionButton.name]},{property:{objectName:"shape",propertyName:"trapezoidSlant"},version:c.ShapeFormattingFeatures,types:[p.visuals.plugins.shape.name,p.visuals.plugins.actionButton.name]},{property:{objectName:"shape",propertyName:"hexagonSlant"},version:c.ShapeFormattingFeatures,types:[p.visuals.plugins.shape.name,p.visuals.plugins.actionButton.name]},{property:{objectName:"shape",propertyName:"octagonSnipSize"},version:c.ShapeFormattingFeatures,types:[p.visuals.plugins.shape.name,p.visuals.plugins.actionButton.name]},{property:{objectName:"shape",propertyName:"speechBubbleHeight"},version:c.ShapeFormattingFeatures,types:[p.visuals.plugins.shape.name,p.visuals.plugins.actionButton.name]},{property:{objectName:"shape",propertyName:"speechBubbleTailPosition"},version:c.ShapeFormattingFeatures,types:[p.visuals.plugins.shape.name,p.visuals.plugins.actionButton.name]},{property:{objectName:"shape",propertyName:"speechBubbleTailAngle"},version:c.ShapeFormattingFeatures,types:[p.visuals.plugins.shape.name,p.visuals.plugins.actionButton.name]},{property:{objectName:"shape",propertyName:"rectangleRoundedCurve"},version:c.ShapeFormattingFeatures,types:[p.visuals.plugins.shape.name,p.visuals.plugins.actionButton.name]},{property:{objectName:"shape",propertyName:"tabCutCornerSnipSizeTopRight"},version:c.ShapeFormattingFeatures,types:[p.visuals.plugins.shape.name,p.visuals.plugins.actionButton.name]},{property:{objectName:"shape",propertyName:"tabCutCornerSnipSizeTop"},version:c.ShapeFormattingFeatures,types:[p.visuals.plugins.shape.name,p.visuals.plugins.actionButton.name]},{property:{objectName:"shape",propertyName:"tabCutCornerSnipSizeBottom"},version:c.ShapeFormattingFeatures,types:[p.visuals.plugins.shape.name,p.visuals.plugins.actionButton.name]},{property:{objectName:"shape",propertyName:"tabRoundCornerTopRight"},version:c.ShapeFormattingFeatures,types:[p.visuals.plugins.shape.name,p.visuals.plugins.actionButton.name]},{property:{objectName:"shape",propertyName:"tabRoundCornerTop"},version:c.ShapeFormattingFeatures,types:[p.visuals.plugins.shape.name,p.visuals.plugins.actionButton.name]},{property:{objectName:"shape",propertyName:"tabRoundCornerBottom"},version:c.ShapeFormattingFeatures,types:[p.visuals.plugins.shape.name,p.visuals.plugins.actionButton.name]},{property:{objectName:"xAxisReferenceLine",propertyName:"*"},version:c.XAxisRefLineImprovements,types:[p.visuals.plugins.areaChart.name,p.visuals.plugins.columnChart.name,p.visuals.plugins.barChart.name,p.visuals.plugins.clusteredBarChart.name,p.visuals.plugins.clusteredColumnChart.name,p.visuals.plugins.hundredPercentStackedBarChart.name,p.visuals.plugins.hundredPercentStackedColumnChart.name,p.visuals.plugins.comboChart.name,p.visuals.plugins.lineStackedColumnComboChart.name,p.visuals.plugins.lineClusteredColumnComboChart.name,p.visuals.plugins.ribbonChart.name,p.visuals.plugins.stackedAreaChart.name]},{property:{objectName:"xAxisReferenceLine",propertyName:"value",isExprBound:!0},version:c.XAxisRefLineImprovements,types:[p.visuals.plugins.lineChart.name]},{property:{objectName:"xAxisReferenceLine",propertyName:"shadeRegion"},version:c.XAxisRefLineImprovements,types:[p.visuals.plugins.lineChart.name]},{property:{objectName:"xAxisReferenceLine",propertyName:"shadeColor"},version:c.XAxisRefLineImprovements,types:[p.visuals.plugins.lineChart.name]},{property:{objectName:"xAxisReferenceLine",propertyName:"shadeTransparency"},version:c.XAxisRefLineImprovements,types:[p.visuals.plugins.lineChart.name]},{property:{objectName:"title",propertyName:"heading"},version:c.AccessibilityTopLevelNav},{property:{objectName:"text",propertyName:"leftMargin"},version:c.ButtonTileFormatting,types:[p.visuals.plugins.actionButton.name]},{property:{objectName:"text",propertyName:"rightMargin"},version:c.ButtonTileFormatting,types:[p.visuals.plugins.actionButton.name]},{property:{objectName:"text",propertyName:"topMargin"},version:c.ButtonTileFormatting,types:[p.visuals.plugins.actionButton.name]},{property:{objectName:"text",propertyName:"bottomMargin"},version:c.ButtonTileFormatting,types:[p.visuals.plugins.actionButton.name]},{property:{objectName:"icon",propertyName:"image"},version:c.ButtonTileFormatting,types:[p.visuals.plugins.actionButton.name]},{property:{objectName:"icon",propertyName:"leftMargin"},version:c.ButtonTileFormatting,types:[p.visuals.plugins.actionButton.name]},{property:{objectName:"icon",propertyName:"rightMargin"},version:c.ButtonTileFormatting,types:[p.visuals.plugins.actionButton.name]},{property:{objectName:"icon",propertyName:"topMargin"},version:c.ButtonTileFormatting,types:[p.visuals.plugins.actionButton.name]},{property:{objectName:"icon",propertyName:"bottomMargin"},version:c.ButtonTileFormatting,types:[p.visuals.plugins.actionButton.name]},{property:{objectName:"icon",propertyName:"placement"},version:c.ButtonTileFormatting,types:[p.visuals.plugins.actionButton.name]},{property:{objectName:"icon",propertyName:"iconSize"},version:c.ButtonTileFormatting,types:[p.visuals.plugins.actionButton.name]},{property:{objectName:"shape",propertyName:"*"},version:c.ButtonTileFormatting,types:[p.visuals.plugins.actionButton.name]},{property:{objectName:"shadow",propertyName:"*"},version:c.ButtonTileFormatting,types:[p.visuals.plugins.actionButton.name]},{property:{objectName:"glow",propertyName:"*"},version:c.ButtonTileFormatting,types:[p.visuals.plugins.actionButton.name]},{property:{objectName:"rotation",propertyName:"*"},version:c.ButtonTileFormatting,types:[p.visuals.plugins.actionButton.name]},{property:{objectName:"seriesLabels",propertyName:"*"},version:c.LineChartSeriesLabels,types:[p.visuals.plugins.comboChart.name,p.visuals.plugins.lineChart.name,p.visuals.plugins.areaChart.name,p.visuals.plugins.stackedAreaChart.name,p.visuals.plugins.lineClusteredColumnComboChart.name,p.visuals.plugins.lineStackedColumnComboChart.name]},{types:[p.visuals.plugins.waterfallChart.name],property:{objectName:"valueAxis",propertyName:"totalsEnabled"},version:c.WaterfallChartTotals},{types:[p.visuals.plugins.azureMap.name],property:{objectName:"heatMapLayer",propertyName:"*"},version:c.AzureMapHeatmapLayer},{types:[p.visuals.plugins.pageNavigator.name,p.visuals.plugins.bookmarkNavigator.name],property:{objectName:"background",propertyName:"show"},version:c.NavigatorVisuals},{types:[p.visuals.plugins.pageNavigator.name,p.visuals.plugins.bookmarkNavigator.name],property:{objectName:"visualHeader",propertyName:"show"},version:c.NavigatorVisuals},{property:{objectName:"slices",propertyName:"startAngle"},version:c.DonutChartStartAngle,types:[p.visuals.plugins.donutChart.name,p.visuals.plugins.pieChart.name]},{types:[p.visuals.plugins.donutChart.name,p.visuals.plugins.pieChart.name],property:{objectName:"slices",propertyName:"borderWidth"},version:c.PieChartMarginBetweenSlices},{types:[p.visuals.plugins.donutChart.name,p.visuals.plugins.pieChart.name],property:{objectName:"slices",propertyName:"borderColor"},version:c.PieChartMarginBetweenSlices},{types:[p.visuals.plugins.donutChart.name,p.visuals.plugins.pieChart.name],property:{objectName:"slices",propertyName:"explode"},version:c.PieChartMarginBetweenSlices},{types:[p.visuals.plugins.pieChart.name],property:{objectName:"slices",propertyName:"innerRadiusRatio"},version:c.PieChartMarginBetweenSlices},{types:__spreadArray([p.visuals.plugins.azureMap.name,p.visuals.plugins.donutChart.name,p.visuals.plugins.pieChart.name,p.visuals.plugins.map.name,p.visuals.plugins.filledMap.name,p.visuals.plugins.shapeMap.name,p.visuals.plugins.treemap.name,p.visuals.plugins.heatMap.name],u.CartesianExpressionBasedFormattingVisualTypes,!0),property:{objectName:"legend",propertyName:"bold"},version:c.BoldItalicUnderlineComponent},{types:__spreadArray([p.visuals.plugins.azureMap.name,p.visuals.plugins.donutChart.name,p.visuals.plugins.pieChart.name,p.visuals.plugins.map.name,p.visuals.plugins.filledMap.name,p.visuals.plugins.shapeMap.name,p.visuals.plugins.treemap.name,p.visuals.plugins.heatMap.name],u.CartesianExpressionBasedFormattingVisualTypes,!0),property:{objectName:"legend",propertyName:"italic"},version:c.BoldItalicUnderlineComponent},{types:__spreadArray([p.visuals.plugins.azureMap.name,p.visuals.plugins.donutChart.name,p.visuals.plugins.pieChart.name,p.visuals.plugins.map.name,p.visuals.plugins.filledMap.name,p.visuals.plugins.shapeMap.name,p.visuals.plugins.treemap.name,p.visuals.plugins.heatMap.name],u.CartesianExpressionBasedFormattingVisualTypes,!0),property:{objectName:"legend",propertyName:"underline"},version:c.BoldItalicUnderlineComponent},{types:__spreadArray([p.visuals.plugins.funnel.name,p.visuals.plugins.scatterChart.name],u.CartesianExpressionBasedFormattingVisualTypes,!0),property:{objectName:"categoryAxis",propertyName:"bold"},version:c.BoldItalicUnderlineComponent},{types:__spreadArray([p.visuals.plugins.funnel.name,p.visuals.plugins.scatterChart.name],u.CartesianExpressionBasedFormattingVisualTypes,!0),property:{objectName:"categoryAxis",propertyName:"italic"},version:c.BoldItalicUnderlineComponent},{types:__spreadArray([p.visuals.plugins.funnel.name,p.visuals.plugins.scatterChart.name],u.CartesianExpressionBasedFormattingVisualTypes,!0),property:{objectName:"categoryAxis",propertyName:"underline"},version:c.BoldItalicUnderlineComponent},{types:__spreadArray([],u.CartesianExpressionBasedFormattingVisualTypes,!0),property:{objectName:"categoryAxis",propertyName:"titleBold"},version:c.BoldItalicUnderlineComponent},{types:__spreadArray([],u.CartesianExpressionBasedFormattingVisualTypes,!0),property:{objectName:"categoryAxis",propertyName:"titleItalic"},version:c.BoldItalicUnderlineComponent},{types:__spreadArray([],u.CartesianExpressionBasedFormattingVisualTypes,!0),property:{objectName:"categoryAxis",propertyName:"titleUnderline"},version:c.BoldItalicUnderlineComponent},{types:__spreadArray([p.visuals.plugins.scatterChart.name],u.CartesianExpressionBasedFormattingVisualTypes,!0),property:{objectName:"valueAxis",propertyName:"bold"},version:c.BoldItalicUnderlineComponent},{types:__spreadArray([p.visuals.plugins.scatterChart.name],u.CartesianExpressionBasedFormattingVisualTypes,!0),property:{objectName:"valueAxis",propertyName:"italic"},version:c.BoldItalicUnderlineComponent},{types:__spreadArray([p.visuals.plugins.scatterChart.name],u.CartesianExpressionBasedFormattingVisualTypes,!0),property:{objectName:"valueAxis",propertyName:"underline"},version:c.BoldItalicUnderlineComponent},{types:__spreadArray([],u.CartesianExpressionBasedFormattingVisualTypes,!0),property:{objectName:"valueAxis",propertyName:"titleBold"},version:c.BoldItalicUnderlineComponent},{types:__spreadArray([],u.CartesianExpressionBasedFormattingVisualTypes,!0),property:{objectName:"valueAxis",propertyName:"titleItalic"},version:c.BoldItalicUnderlineComponent},{types:__spreadArray([],u.CartesianExpressionBasedFormattingVisualTypes,!0),property:{objectName:"valueAxis",propertyName:"titleUnderline"},version:c.BoldItalicUnderlineComponent},{types:__spreadArray([],u.CartesianExpressionBasedFormattingVisualTypes,!0),property:{objectName:"valueAxis",propertyName:"secBold"},version:c.BoldItalicUnderlineComponent},{types:__spreadArray([],u.CartesianExpressionBasedFormattingVisualTypes,!0),property:{objectName:"valueAxis",propertyName:"secItalic"},version:c.BoldItalicUnderlineComponent},{types:__spreadArray([],u.CartesianExpressionBasedFormattingVisualTypes,!0),property:{objectName:"valueAxis",propertyName:"secUnderline"},version:c.BoldItalicUnderlineComponent},{types:__spreadArray([],u.CartesianExpressionBasedFormattingVisualTypes,!0),property:{objectName:"valueAxis",propertyName:"secTitleBold"},version:c.BoldItalicUnderlineComponent},{types:__spreadArray([],u.CartesianExpressionBasedFormattingVisualTypes,!0),property:{objectName:"valueAxis",propertyName:"secTitleItalic"},version:c.BoldItalicUnderlineComponent},{types:__spreadArray([],u.CartesianExpressionBasedFormattingVisualTypes,!0),property:{objectName:"valueAxis",propertyName:"secTitleUnderline"},version:c.BoldItalicUnderlineComponent},{types:__spreadArray([],u.CartesianExpressionBasedFormattingVisualTypes,!0),property:{objectName:"y2Axis",propertyName:"secBold"},version:c.BoldItalicUnderlineComponent},{types:__spreadArray([],u.CartesianExpressionBasedFormattingVisualTypes,!0),property:{objectName:"y2Axis",propertyName:"secItalic"},version:c.BoldItalicUnderlineComponent},{types:__spreadArray([],u.CartesianExpressionBasedFormattingVisualTypes,!0),property:{objectName:"y2Axis",propertyName:"secUnderline"},version:c.BoldItalicUnderlineComponent},{types:__spreadArray([],u.CartesianExpressionBasedFormattingVisualTypes,!0),property:{objectName:"y2Axis",propertyName:"secTitleBold"},version:c.BoldItalicUnderlineComponent},{types:__spreadArray([],u.CartesianExpressionBasedFormattingVisualTypes,!0),property:{objectName:"y2Axis",propertyName:"secTitleItalic"},version:c.BoldItalicUnderlineComponent},{types:__spreadArray([],u.CartesianExpressionBasedFormattingVisualTypes,!0),property:{objectName:"y2Axis",propertyName:"secTitleUnderline"},version:c.BoldItalicUnderlineComponent},{types:__spreadArray([p.visuals.plugins.azureMap.name,p.visuals.plugins.card.name,p.visuals.plugins.donutChart.name,p.visuals.plugins.funnel.name,p.visuals.plugins.gauge.name,p.visuals.plugins.pieChart.name,p.visuals.plugins.map.name,p.visuals.plugins.filledMap.name,p.visuals.plugins.shapeMap.name,p.visuals.plugins.treemap.name],u.CartesianExpressionBasedFormattingVisualTypes,!0),property:{objectName:"labels",propertyName:"bold"},version:c.BoldItalicUnderlineComponent},{types:__spreadArray([p.visuals.plugins.azureMap.name,p.visuals.plugins.card.name,p.visuals.plugins.donutChart.name,p.visuals.plugins.funnel.name,p.visuals.plugins.gauge.name,p.visuals.plugins.pieChart.name,p.visuals.plugins.map.name,p.visuals.plugins.filledMap.name,p.visuals.plugins.shapeMap.name,p.visuals.plugins.treemap.name],u.CartesianExpressionBasedFormattingVisualTypes,!0),property:{objectName:"labels",propertyName:"italic"},version:c.BoldItalicUnderlineComponent},{types:__spreadArray([p.visuals.plugins.azureMap.name,p.visuals.plugins.card.name,p.visuals.plugins.donutChart.name,p.visuals.plugins.funnel.name,p.visuals.plugins.gauge.name,p.visuals.plugins.pieChart.name,p.visuals.plugins.map.name,p.visuals.plugins.filledMap.name,p.visuals.plugins.shapeMap.name,p.visuals.plugins.treemap.name],u.CartesianExpressionBasedFormattingVisualTypes,!0),property:{objectName:"labels",propertyName:"underline"},version:c.BoldItalicUnderlineComponent},{types:__spreadArray([],u.CartesianExpressionBasedFormattingVisualTypes,!0),property:{objectName:"seriesLabels",propertyName:"bold"},version:c.BoldItalicUnderlineComponent},{types:__spreadArray([],u.CartesianExpressionBasedFormattingVisualTypes,!0),property:{objectName:"seriesLabels",propertyName:"italic"},version:c.BoldItalicUnderlineComponent},{types:__spreadArray([],u.CartesianExpressionBasedFormattingVisualTypes,!0),property:{objectName:"seriesLabels",propertyName:"underline"},version:c.BoldItalicUnderlineComponent},{types:[p.visuals.plugins.azureMap.name,p.visuals.plugins.card.name,p.visuals.plugins.multiRowCard.name,p.visuals.plugins.donutChart.name,p.visuals.plugins.scatterChart.name,p.visuals.plugins.pieChart.name,p.visuals.plugins.map.name,p.visuals.plugins.filledMap.name,p.visuals.plugins.shapeMap.name,p.visuals.plugins.treemap.name,p.visuals.plugins.heatMap.name],property:{objectName:"categoryLabels",propertyName:"bold"},version:c.BoldItalicUnderlineComponent},{types:[p.visuals.plugins.azureMap.name,p.visuals.plugins.card.name,p.visuals.plugins.multiRowCard.name,p.visuals.plugins.donutChart.name,p.visuals.plugins.scatterChart.name,p.visuals.plugins.pieChart.name,p.visuals.plugins.map.name,p.visuals.plugins.filledMap.name,p.visuals.plugins.shapeMap.name,p.visuals.plugins.treemap.name,p.visuals.plugins.heatMap.name],property:{objectName:"categoryLabels",propertyName:"italic"},version:c.BoldItalicUnderlineComponent},{types:[p.visuals.plugins.azureMap.name,p.visuals.plugins.card.name,p.visuals.plugins.multiRowCard.name,p.visuals.plugins.donutChart.name,p.visuals.plugins.scatterChart.name,p.visuals.plugins.pieChart.name,p.visuals.plugins.map.name,p.visuals.plugins.filledMap.name,p.visuals.plugins.shapeMap.name,p.visuals.plugins.treemap.name,p.visuals.plugins.heatMap.name],property:{objectName:"categoryLabels",propertyName:"underline"},version:c.BoldItalicUnderlineComponent},{types:[p.visuals.plugins.multiRowCard.name],property:{objectName:"dataLabels",propertyName:"bold"},version:c.BoldItalicUnderlineComponent},{types:[p.visuals.plugins.multiRowCard.name],property:{objectName:"dataLabels",propertyName:"italic"},version:c.BoldItalicUnderlineComponent},{types:[p.visuals.plugins.multiRowCard.name],property:{objectName:"dataLabels",propertyName:"underline"},version:c.BoldItalicUnderlineComponent},{types:[p.visuals.plugins.multiRowCard.name],property:{objectName:"cardTitle",propertyName:"bold"},version:c.BoldItalicUnderlineComponent},{types:[p.visuals.plugins.multiRowCard.name],property:{objectName:"cardTitle",propertyName:"italic"},version:c.BoldItalicUnderlineComponent},{types:[p.visuals.plugins.multiRowCard.name],property:{objectName:"cardTitle",propertyName:"underline"},version:c.BoldItalicUnderlineComponent},{types:[p.visuals.plugins.funnel.name],property:{objectName:"percentBarLabel",propertyName:"bold"},version:c.BoldItalicUnderlineComponent},{types:[p.visuals.plugins.funnel.name],property:{objectName:"percentBarLabel",propertyName:"italic"},version:c.BoldItalicUnderlineComponent},{types:[p.visuals.plugins.funnel.name],property:{objectName:"percentBarLabel",propertyName:"underline"},version:c.BoldItalicUnderlineComponent},{types:[p.visuals.plugins.gauge.name],property:{objectName:"target",propertyName:"bold"},version:c.BoldItalicUnderlineComponent},{types:[p.visuals.plugins.gauge.name],property:{objectName:"target",propertyName:"italic"},version:c.BoldItalicUnderlineComponent},{types:[p.visuals.plugins.gauge.name],property:{objectName:"target",propertyName:"underline"},version:c.BoldItalicUnderlineComponent},{types:[p.visuals.plugins.gauge.name],property:{objectName:"calloutValue",propertyName:"bold"},version:c.BoldItalicUnderlineComponent},{types:[p.visuals.plugins.gauge.name],property:{objectName:"calloutValue",propertyName:"italic"},version:c.BoldItalicUnderlineComponent},{types:[p.visuals.plugins.gauge.name],property:{objectName:"calloutValue",propertyName:"underline"},version:c.BoldItalicUnderlineComponent},{types:[p.visuals.plugins.kpi.name],property:{objectName:"goals",propertyName:"bold"},version:c.BoldItalicUnderlineComponent},{types:[p.visuals.plugins.kpi.name],property:{objectName:"goals",propertyName:"italic"},version:c.BoldItalicUnderlineComponent},{types:[p.visuals.plugins.kpi.name],property:{objectName:"goals",propertyName:"underline"},version:c.BoldItalicUnderlineComponent},{types:[p.visuals.plugins.kpi.name],property:{objectName:"goals",propertyName:"titleBold"},version:c.BoldItalicUnderlineComponent},{types:[p.visuals.plugins.kpi.name],property:{objectName:"goals",propertyName:"titleItalic"},version:c.BoldItalicUnderlineComponent},{types:[p.visuals.plugins.kpi.name],property:{objectName:"goals",propertyName:"titleUnderline"},version:c.BoldItalicUnderlineComponent},{types:[p.visuals.plugins.kpi.name],property:{objectName:"lastDate",propertyName:"bold"},version:c.BoldItalicUnderlineComponent},{types:[p.visuals.plugins.kpi.name],property:{objectName:"lastDate",propertyName:"italic"},version:c.BoldItalicUnderlineComponent},{types:[p.visuals.plugins.kpi.name],property:{objectName:"lastDate",propertyName:"underline"},version:c.BoldItalicUnderlineComponent},{types:[p.visuals.plugins.kpi.name],property:{objectName:"indicator",propertyName:"bold"},version:c.BoldItalicUnderlineComponent},{types:[p.visuals.plugins.kpi.name],property:{objectName:"indicator",propertyName:"italic"},version:c.BoldItalicUnderlineComponent},{types:[p.visuals.plugins.kpi.name],property:{objectName:"indicator",propertyName:"underline"},version:c.BoldItalicUnderlineComponent},{types:[p.visuals.plugins.decompositionTreeVisual.name],property:{objectName:"categoryLabels",propertyName:"categoryLabelBold"},version:c.BoldItalicUnderlineComponent},{types:[p.visuals.plugins.decompositionTreeVisual.name],property:{objectName:"categoryLabels",propertyName:"categoryLabelItalic"},version:c.BoldItalicUnderlineComponent},{types:[p.visuals.plugins.decompositionTreeVisual.name],property:{objectName:"categoryLabels",propertyName:"categoryLabelUnderline"},version:c.BoldItalicUnderlineComponent},{types:[p.visuals.plugins.decompositionTreeVisual.name],property:{objectName:"dataLabels",propertyName:"dataLabelBold"},version:c.BoldItalicUnderlineComponent},{types:[p.visuals.plugins.decompositionTreeVisual.name],property:{objectName:"dataLabels",propertyName:"dataLabelItalic"},version:c.BoldItalicUnderlineComponent},{types:[p.visuals.plugins.decompositionTreeVisual.name],property:{objectName:"dataLabels",propertyName:"dataLabelUnderline"},version:c.BoldItalicUnderlineComponent},{types:[p.visuals.plugins.decompositionTreeVisual.name],property:{objectName:"levelHeader",propertyName:"levelTitleBold"},version:c.BoldItalicUnderlineComponent},{types:[p.visuals.plugins.decompositionTreeVisual.name],property:{objectName:"levelHeader",propertyName:"levelTitleItalic"},version:c.BoldItalicUnderlineComponent},{types:[p.visuals.plugins.decompositionTreeVisual.name],property:{objectName:"levelHeader",propertyName:"levelTitleUnderline"},version:c.BoldItalicUnderlineComponent},{types:[p.visuals.plugins.decompositionTreeVisual.name],property:{objectName:"levelHeader",propertyName:"levelSubtitleBold"},version:c.BoldItalicUnderlineComponent},{types:[p.visuals.plugins.decompositionTreeVisual.name],property:{objectName:"levelHeader",propertyName:"levelSubtitleItalic"},version:c.BoldItalicUnderlineComponent},{types:[p.visuals.plugins.decompositionTreeVisual.name],property:{objectName:"levelHeader",propertyName:"levelSubtitleUnderline"},version:c.BoldItalicUnderlineComponent},{types:__spreadArray([],u.CartesianExpressionBasedFormattingVisualTypes,!0),property:{objectName:"subheader",propertyName:"bold"},version:c.BoldItalicUnderlineComponent},{types:__spreadArray([],u.CartesianExpressionBasedFormattingVisualTypes,!0),property:{objectName:"subheader",propertyName:"italic"},version:c.BoldItalicUnderlineComponent},{types:__spreadArray([],u.CartesianExpressionBasedFormattingVisualTypes,!0),property:{objectName:"subheader",propertyName:"underline"},version:c.BoldItalicUnderlineComponent},{types:[p.visuals.plugins.pivotTable.name,p.visuals.plugins.tableEx.name],property:{objectName:"columnHeaders",propertyName:"bold"},version:c.BoldItalicUnderlineComponent},{types:[p.visuals.plugins.pivotTable.name,p.visuals.plugins.tableEx.name],property:{objectName:"columnHeaders",propertyName:"italic"},version:c.BoldItalicUnderlineComponent},{types:[p.visuals.plugins.pivotTable.name,p.visuals.plugins.tableEx.name],property:{objectName:"columnHeaders",propertyName:"underline"},version:c.BoldItalicUnderlineComponent},{types:[p.visuals.plugins.pivotTable.name,p.visuals.plugins.tableEx.name],property:{objectName:"values",propertyName:"bold"},version:c.BoldItalicUnderlineComponent},{types:[p.visuals.plugins.pivotTable.name,p.visuals.plugins.tableEx.name],property:{objectName:"values",propertyName:"italic"},version:c.BoldItalicUnderlineComponent},{types:[p.visuals.plugins.pivotTable.name,p.visuals.plugins.tableEx.name],property:{objectName:"values",propertyName:"underline"},version:c.BoldItalicUnderlineComponent},{types:[p.visuals.plugins.tableEx.name],property:{objectName:"total",propertyName:"bold"},version:c.BoldItalicUnderlineComponent},{types:[p.visuals.plugins.tableEx.name],property:{objectName:"total",propertyName:"italic"},version:c.BoldItalicUnderlineComponent},{types:[p.visuals.plugins.tableEx.name],property:{objectName:"total",propertyName:"underline"},version:c.BoldItalicUnderlineComponent},{types:[p.visuals.plugins.pivotTable.name],property:{objectName:"rowTotal",propertyName:"bold"},version:c.BoldItalicUnderlineComponent},{types:[p.visuals.plugins.pivotTable.name],property:{objectName:"rowTotal",propertyName:"italic"},version:c.BoldItalicUnderlineComponent},{types:[p.visuals.plugins.pivotTable.name],property:{objectName:"rowTotal",propertyName:"underline"},version:c.BoldItalicUnderlineComponent},{types:[p.visuals.plugins.pivotTable.name],property:{objectName:"columnTotal",propertyName:"bold"},version:c.BoldItalicUnderlineComponent},{types:[p.visuals.plugins.pivotTable.name],property:{objectName:"columnTotal",propertyName:"italic"},version:c.BoldItalicUnderlineComponent},{types:[p.visuals.plugins.pivotTable.name],property:{objectName:"columnTotal",propertyName:"underline"},version:c.BoldItalicUnderlineComponent},{types:[p.visuals.plugins.pivotTable.name],property:{objectName:"rowHeaders",propertyName:"bold"},version:c.BoldItalicUnderlineComponent},{types:[p.visuals.plugins.pivotTable.name],property:{objectName:"rowHeaders",propertyName:"italic"},version:c.BoldItalicUnderlineComponent},{types:[p.visuals.plugins.pivotTable.name],property:{objectName:"rowHeaders",propertyName:"underline"},version:c.BoldItalicUnderlineComponent},{types:[p.visuals.plugins.pivotTable.name],property:{objectName:"subTotals",propertyName:"bold"},version:c.BoldItalicUnderlineComponent},{types:[p.visuals.plugins.pivotTable.name],property:{objectName:"subTotals",propertyName:"italic"},version:c.BoldItalicUnderlineComponent},{types:[p.visuals.plugins.pivotTable.name],property:{objectName:"subTotals",propertyName:"underline"},version:c.BoldItalicUnderlineComponent},{types:[p.visuals.plugins.barChart.name,p.visuals.plugins.columnChart.name,p.visuals.plugins.dataDotStackedColumnComboChart.name,p.visuals.plugins.lineStackedColumnComboChart.name,p.visuals.plugins.hundredPercentStackedBarChart.name,p.visuals.plugins.hundredPercentStackedColumnChart.name,p.visuals.plugins.stackedAreaChart.name],property:{objectName:"totals",propertyName:"bold"},version:c.BoldItalicUnderlineComponent},{types:[p.visuals.plugins.barChart.name,p.visuals.plugins.columnChart.name,p.visuals.plugins.dataDotStackedColumnComboChart.name,p.visuals.plugins.lineStackedColumnComboChart.name,p.visuals.plugins.hundredPercentStackedBarChart.name,p.visuals.plugins.hundredPercentStackedColumnChart.name,p.visuals.plugins.stackedAreaChart.name],property:{objectName:"totals",propertyName:"italic"},version:c.BoldItalicUnderlineComponent},{types:[p.visuals.plugins.barChart.name,p.visuals.plugins.columnChart.name,p.visuals.plugins.dataDotStackedColumnComboChart.name,p.visuals.plugins.lineStackedColumnComboChart.name,p.visuals.plugins.hundredPercentStackedBarChart.name,p.visuals.plugins.hundredPercentStackedColumnChart.name,p.visuals.plugins.stackedAreaChart.name],property:{objectName:"totals",propertyName:"underline"},version:c.BoldItalicUnderlineComponent},{types:[p.visuals.plugins.qnaVisual.name],property:{objectName:"inputBox",propertyName:"questionBold"},version:c.BoldItalicUnderlineComponent},{types:[p.visuals.plugins.qnaVisual.name],property:{objectName:"inputBox",propertyName:"questionItalic"},version:c.BoldItalicUnderlineComponent},{types:[p.visuals.plugins.qnaVisual.name],property:{objectName:"inputBox",propertyName:"questionUnderline"},version:c.BoldItalicUnderlineComponent},{types:[p.visuals.plugins.qnaVisual.name],property:{objectName:"suggestions",propertyName:"headerBold"},version:c.BoldItalicUnderlineComponent},{types:[p.visuals.plugins.qnaVisual.name],property:{objectName:"suggestions",propertyName:"headerItalic"},version:c.BoldItalicUnderlineComponent},{types:[p.visuals.plugins.qnaVisual.name],property:{objectName:"suggestions",propertyName:"headerUnderline"},version:c.BoldItalicUnderlineComponent},{types:[p.visuals.plugins.qnaVisual.name],property:{objectName:"suggestions",propertyName:"cardBold"},version:c.BoldItalicUnderlineComponent},{types:[p.visuals.plugins.qnaVisual.name],property:{objectName:"suggestions",propertyName:"cardItalic"},version:c.BoldItalicUnderlineComponent},{types:[p.visuals.plugins.qnaVisual.name],property:{objectName:"suggestions",propertyName:"cardUnderline"},version:c.BoldItalicUnderlineComponent},{types:[p.visuals.plugins.slicer.name,p.visuals.plugins.filterSlicer.name],property:{objectName:"header",propertyName:"bold"},version:c.BoldItalicUnderlineComponent},{types:[p.visuals.plugins.slicer.name,p.visuals.plugins.filterSlicer.name],property:{objectName:"header",propertyName:"italic"},version:c.BoldItalicUnderlineComponent},{types:[p.visuals.plugins.slicer.name,p.visuals.plugins.filterSlicer.name],property:{objectName:"header",propertyName:"underline"},version:c.BoldItalicUnderlineComponent},{types:[p.visuals.plugins.slicer.name,p.visuals.plugins.filterSlicer.name],property:{objectName:"items",propertyName:"bold"},version:c.BoldItalicUnderlineComponent},{types:[p.visuals.plugins.slicer.name,p.visuals.plugins.filterSlicer.name],property:{objectName:"items",propertyName:"italic"},version:c.BoldItalicUnderlineComponent},{types:[p.visuals.plugins.slicer.name,p.visuals.plugins.filterSlicer.name],property:{objectName:"items",propertyName:"underline"},version:c.BoldItalicUnderlineComponent},{types:[p.visuals.plugins.slicer.name,p.visuals.plugins.filterSlicer.name],property:{objectName:"date",propertyName:"bold"},version:c.BoldItalicUnderlineComponent},{types:[p.visuals.plugins.slicer.name,p.visuals.plugins.filterSlicer.name],property:{objectName:"date",propertyName:"italic"},version:c.BoldItalicUnderlineComponent},{types:[p.visuals.plugins.slicer.name,p.visuals.plugins.filterSlicer.name],property:{objectName:"date",propertyName:"underline"},version:c.BoldItalicUnderlineComponent},{types:[p.visuals.plugins.slicer.name,p.visuals.plugins.filterSlicer.name],property:{objectName:"numericInputStyle",propertyName:"bold"},version:c.BoldItalicUnderlineComponent},{types:[p.visuals.plugins.slicer.name,p.visuals.plugins.filterSlicer.name],property:{objectName:"numericInputStyle",propertyName:"italic"},version:c.BoldItalicUnderlineComponent},{types:[p.visuals.plugins.slicer.name,p.visuals.plugins.filterSlicer.name],property:{objectName:"numericInputStyle",propertyName:"underline"},version:c.BoldItalicUnderlineComponent},{property:{objectName:"title",propertyName:"bold"},version:c.BoldItalicUnderlineComponent},{property:{objectName:"title",propertyName:"italic"},version:c.BoldItalicUnderlineComponent},{property:{objectName:"title",propertyName:"underline"},version:c.BoldItalicUnderlineComponent},{property:{objectName:"visualTooltip",propertyName:"bold"},version:c.BoldItalicUnderlineComponent},{property:{objectName:"visualTooltip",propertyName:"italic"},version:c.BoldItalicUnderlineComponent},{property:{objectName:"visualTooltip",propertyName:"underline"},version:c.BoldItalicUnderlineComponent},{types:[p.visuals.plugins.textbox.name],property:__assign(__assign({},p.visuals.textboxProps.general.paragraphs),{matchByContents:function(e,t){if(p.StructuralObjectDefinition.isParagraphsDefinition(e))for(var r=0,i=e;r<i.length;r++){var a=i[r];if(a&&!_.isEmpty(a.listType))return!0}return!1}}),version:c.TextboxSuperSubScriptBulletedList},{types:[o.rdlVisual.name],property:{objectName:"toolbar",propertyName:"pageNavigation"},version:c.RdlVisualToolbarConfig},{types:[o.rdlVisual.name],property:{objectName:"toolbar",propertyName:"useFloatingToolbar"},version:c.RdlVisualToolbarConfig},{types:[o.rdlVisual.name],property:{objectName:"toolbar",propertyName:"openReportButton"},version:c.RdlVisualToolbarConfig},{types:[o.rdlVisual.name],property:{objectName:"toolbar",propertyName:"position"},version:c.RdlVisualToolbarConfig},{types:[o.rdlVisual.name],property:{objectName:"export",propertyName:"show"},version:c.RdlVisualToolbarConfig},{types:[o.rdlVisual.name],property:{objectName:"export",propertyName:"exportExcel"},version:c.RdlVisualToolbarConfig},{types:[o.rdlVisual.name],property:{objectName:"export",propertyName:"exportPDF"},version:c.RdlVisualToolbarConfig},{types:[o.rdlVisual.name],property:{objectName:"export",propertyName:"exportAccessiblePDF"},version:c.RdlVisualToolbarConfig},{types:[o.rdlVisual.name],property:{objectName:"export",propertyName:"exportCSV"},version:c.RdlVisualToolbarConfig},{types:[o.rdlVisual.name],property:{objectName:"export",propertyName:"exportPPTX"},version:c.RdlVisualToolbarConfig},{types:[o.rdlVisual.name],property:{objectName:"export",propertyName:"exportWord"},version:c.RdlVisualToolbarConfig},{types:[o.rdlVisual.name],property:{objectName:"export",propertyName:"exportMHTML"},version:c.RdlVisualToolbarConfig},{types:[o.rdlVisual.name],property:{objectName:"export",propertyName:"exportXML"},version:c.RdlVisualToolbarConfig},{property:p.visuals.scorecardProps.scorecard.showCommandBar,types:[o.scorecard.name],version:c.ScorecardCommandBarToggle},{types:[p.visuals.plugins.azureMap.name],property:{objectName:"heatMapLayer",propertyName:"mapTransparency"},version:c.AzureMapHeatmapOpacityToTransparency},{types:[p.visuals.plugins.tableEx.name,p.visuals.plugins.pivotTable.name],property:{objectName:"sparklines",propertyName:"*"},version:c.Sparklines},{types:[p.visuals.plugins.slicer.name,p.visuals.plugins.filterSlicer.name],property:{objectName:"date",propertyName:"hideDatePickerButton"},version:c.SlicerAccessibility},{types:[p.visuals.plugins.slicer.name,p.visuals.plugins.filterSlicer.name],property:{objectName:"items",propertyName:"padding"},version:c.SlicerAccessibility},{types:[p.visuals.plugins.slicer.name,p.visuals.plugins.filterSlicer.name],property:{objectName:"items",propertyName:"accessibilityContrastProperties"},version:c.SlicerAccessibility},{types:[p.visuals.plugins.azureMap.name],property:{objectName:"mapControls",propertyName:"geocodingCulture"},version:c.AzureMapsGeocoding},{types:[p.visuals.plugins.comboChart.name,p.visuals.plugins.dataDotClusteredColumnComboChart.name,p.visuals.plugins.dataDotStackedColumnComboChart.name,p.visuals.plugins.lineClusteredColumnComboChart.name,p.visuals.plugins.lineStackedColumnComboChart.name],property:{objectName:"legend",propertyName:"legendMarkerRendering"},version:c.RemoveDefaultToCircleToggle},{types:[p.visuals.plugins.tableEx.name,p.visuals.plugins.pivotTable.name],property:{objectName:"grid",propertyName:"outlineStyle"},version:c.UpgradeOutlineProperties},{types:[p.visuals.plugins.tableEx.name,p.visuals.plugins.pivotTable.name],property:{objectName:"columnHeaders",propertyName:"outlineWeight"},version:c.UpgradeOutlineProperties},{types:[p.visuals.plugins.tableEx.name,p.visuals.plugins.pivotTable.name],property:{objectName:"columnHeaders",propertyName:"outlineColor"},version:c.UpgradeOutlineProperties},{types:[p.visuals.plugins.pivotTable.name],property:{objectName:"rowHeaders",propertyName:"outlineWeight"},version:c.UpgradeOutlineProperties},{types:[p.visuals.plugins.pivotTable.name],property:{objectName:"rowHeaders",propertyName:"outlineColor"},version:c.UpgradeOutlineProperties},{types:[p.visuals.plugins.tableEx.name],property:{objectName:"total",propertyName:"outlineWeight"},version:c.UpgradeOutlineProperties},{types:[p.visuals.plugins.tableEx.name],property:{objectName:"total",propertyName:"outlineColor"},version:c.UpgradeOutlineProperties},{types:[p.visuals.plugins.tableEx.name,p.visuals.plugins.pivotTable.name],property:{objectName:"values",propertyName:"outlineWeight"},version:c.UpgradeOutlineProperties},{types:[p.visuals.plugins.tableEx.name,p.visuals.plugins.pivotTable.name],property:{objectName:"values",propertyName:"outlineColor"},version:c.UpgradeOutlineProperties},{property:{objectName:"visualHeaderTooltip",propertyName:"type"},version:c.SplitHelpTooltip},{property:{objectName:"legend",propertyName:"position",matchByContents:function(e,t){e=e&&e.value;return e===n.topRight||e===n.bottomRight}},version:c.LegendPositionNewFormatPane,types:[p.visuals.plugins.areaChart.name,p.visuals.plugins.azureMap.name,p.visuals.plugins.barChart.name,p.visuals.plugins.clusteredBarChart.name,p.visuals.plugins.clusteredColumnChart.name,p.visuals.plugins.columnChart.name,p.visuals.plugins.donutChart.name,p.visuals.plugins.filledMap.name,p.visuals.plugins.hundredPercentStackedBarChart.name,p.visuals.plugins.hundredPercentStackedColumnChart.name,p.visuals.plugins.lineChart.name,p.visuals.plugins.lineClusteredColumnComboChart.name,p.visuals.plugins.lineStackedColumnComboChart.name,p.visuals.plugins.map.name,p.visuals.plugins.pieChart.name,p.visuals.plugins.ribbonChart.name,p.visuals.plugins.scatterChart.name,p.visuals.plugins.shapeMap.name,p.visuals.plugins.stackedAreaChart.name,p.visuals.plugins.treemap.name,p.visuals.plugins.waterfallChart.name]},{types:[p.visuals.plugins.pivotTable.name,p.visuals.plugins.tableEx.name],property:{objectName:"stylePreset",propertyName:"name",matchByContents:function(e){return e.value===p.visuals.stylePresets.TablixStylePresetsName.AlternatingRowsNew}},version:c.NewAlternatingRowsStyle},{types:[p.visuals.plugins.tableEx.name],property:{objectName:"accessibility",propertyName:"altTextColumns"},version:c.AltTextColumns},{types:[p.visuals.plugins.tableEx.name],property:{objectName:"accessibility",propertyName:"rowWithReferenceText"},version:c.RowWithReferenceText},{types:[p.visuals.plugins.lineChart.name,p.visuals.plugins.clusteredBarChart.name,p.visuals.plugins.clusteredColumnChart.name,p.visuals.plugins.lineStackedColumnComboChart.name,p.visuals.plugins.lineClusteredColumnComboChart.name,p.visuals.plugins.barChart.name,p.visuals.plugins.columnChart.name,p.visuals.plugins.hundredPercentStackedBarChart.name,p.visuals.plugins.hundredPercentStackedColumnChart.name,p.visuals.plugins.ribbonChart.name],property:{objectName:"error",propertyName:"*"},version:c.ErrorBars},{types:[p.visuals.plugins.gauge.name],property:{objectName:"calloutValue",propertyName:"fontFamily"},version:c.GaugeChartCalloutTextFormatting},{types:[p.visuals.plugins.gauge.name],property:{objectName:"calloutValue",propertyName:"bold"},version:c.GaugeChartCalloutTextFormatting},{types:[p.visuals.plugins.gauge.name],property:{objectName:"calloutValue",propertyName:"italic"},version:c.GaugeChartCalloutTextFormatting},{types:[p.visuals.plugins.gauge.name],property:{objectName:"calloutValue",propertyName:"underline"},version:c.GaugeChartCalloutTextFormatting},{types:[p.visuals.plugins.slicer.name,p.visuals.plugins.filterSlicer.name],property:{objectName:"slider",propertyName:"handleBorderColor",isExprBound:!0},version:c.SlicerSliderColors},{types:[p.visuals.plugins.slicer.name,p.visuals.plugins.filterSlicer.name],property:{objectName:"slider",propertyName:"handleFillColor",isExprBound:!0},version:c.SlicerSliderColors},{types:[p.visuals.plugins.slicer.name,p.visuals.plugins.filterSlicer.name],property:{objectName:"slider",propertyName:"secondaryLineColor",isExprBound:!0},version:c.SlicerSliderColors},{types:[p.visuals.plugins.actionButton.name,p.visuals.plugins.shape.name,p.visuals.plugins.pageNavigator.name,p.visuals.plugins.bookmarkNavigator.name],property:{objectName:"text",propertyName:"italic"},version:c.ShapeButtonTextFormatting},{types:[p.visuals.plugins.actionButton.name,p.visuals.plugins.shape.name,p.visuals.plugins.pageNavigator.name,p.visuals.plugins.bookmarkNavigator.name],property:{objectName:"text",propertyName:"bold"},version:c.ShapeButtonTextFormatting},{types:[p.visuals.plugins.actionButton.name,p.visuals.plugins.shape.name,p.visuals.plugins.pageNavigator.name,p.visuals.plugins.bookmarkNavigator.name],property:{objectName:"text",propertyName:"underline"},version:c.ShapeButtonTextFormatting},{property:{objectName:"visualHeaderTooltip",propertyName:"bold"},version:c.HelpTooltipBIU},{property:{objectName:"visualHeaderTooltip",propertyName:"italic"},version:c.HelpTooltipBIU},{property:{objectName:"visualHeaderTooltip",propertyName:"underline"},version:c.HelpTooltipBIU},{types:[p.visuals.plugins.azureMap.name],property:{objectName:"filledMap",propertyName:"*"},version:c.AzureMapsFilledMap},{types:[p.visuals.plugins.scatterChart.name,p.visuals.plugins.waterfallChart.name],property:{objectName:"categoryAxis",propertyName:"titleItalic"},version:c.CartesianBiuFontProperties},{types:[p.visuals.plugins.scatterChart.name,p.visuals.plugins.waterfallChart.name],property:{objectName:"categoryAxis",propertyName:"titleBold"},version:c.CartesianBiuFontProperties},{types:[p.visuals.plugins.scatterChart.name,p.visuals.plugins.waterfallChart.name],property:{objectName:"categoryAxis",propertyName:"titleUnderline"},version:c.CartesianBiuFontProperties},{types:[p.visuals.plugins.scatterChart.name,p.visuals.plugins.waterfallChart.name],property:{objectName:"valueAxis",propertyName:"titleItalic"},version:c.CartesianBiuFontProperties},{types:[p.visuals.plugins.scatterChart.name,p.visuals.plugins.waterfallChart.name],property:{objectName:"valueAxis",propertyName:"titleBold"},version:c.CartesianBiuFontProperties},{types:[p.visuals.plugins.scatterChart.name,p.visuals.plugins.waterfallChart.name],property:{objectName:"valueAxis",propertyName:"titleUnderline"},version:c.CartesianBiuFontProperties},{types:[p.visuals.plugins.waterfallChart.name,p.visuals.plugins.treemap.name,p.visuals.plugins.lineChart.name,p.visuals.plugins.areaChart.name,p.visuals.plugins.columnChart.name,p.visuals.plugins.barChart.name,p.visuals.plugins.pieChart.name,p.visuals.plugins.clusteredBarChart.name,p.visuals.plugins.clusteredColumnChart.name,p.visuals.plugins.comboChart.name,p.visuals.plugins.donutChart.name,p.visuals.plugins.funnel.name,p.visuals.plugins.hundredPercentStackedBarChart.name,p.visuals.plugins.hundredPercentStackedColumnChart.name,p.visuals.plugins.lineStackedColumnComboChart.name,p.visuals.plugins.lineClusteredColumnComboChart.name,p.visuals.plugins.ribbonChart.name,p.visuals.plugins.stackedAreaChart.name],property:{objectName:"labels",propertyName:"color",matchByContents:function(e,t){return!_.isEmpty(null==t?void 0:t.data)}},version:c.ConditionalFormattingDataLabels},{types:[p.visuals.plugins.treemap.name],property:{objectName:"categoryLabels",propertyName:"color",matchByContents:function(e,t){return!_.isEmpty(null==t?void 0:t.data)}},version:c.ConditionalFormattingDataLabels},{types:[p.visuals.plugins.hundredPercentStackedBarChart.name,p.visuals.plugins.hundredPercentStackedColumnChart.name,p.visuals.plugins.lineStackedColumnComboChart.name,p.visuals.plugins.stackedAreaChart.name,p.visuals.plugins.barChart.name,p.visuals.plugins.columnChart.name],property:{objectName:"totals",propertyName:"color",matchByContents:function(e,t){return!_.isEmpty(null==t?void 0:t.data)}},version:c.ConditionalFormattingDataLabels},{types:[p.visuals.plugins.barChart.name,p.visuals.plugins.columnChart.name,p.visuals.plugins.ribbonChart.name,p.visuals.plugins.hundredPercentStackedBarChart.name,p.visuals.plugins.hundredPercentStackedColumnChart.name,p.visuals.plugins.lineStackedColumnComboChart.name,p.visuals.plugins.lineClusteredColumnComboChart.name,p.visuals.plugins.stackedAreaChart.name],property:{objectName:"categoryAxis",propertyName:"reverseStackOrder"},version:c.ReverseStackOrder},{types:[o.shapeMap.name],property:{objectName:"shape",propertyName:"map",matchByContents:function(e){if(e){e=e.name;if(e)return e.value===y.irelandCountiesV2}return!1}},version:c.ShapeMapIrelandLaoisSpelling},{types:[p.visuals.plugins.azureMap.name],property:{objectName:"categoryLabels",propertyName:"*"},version:c.AzureMapsCategoryLabels},{types:[p.visuals.plugins.azureMap.name],property:{objectName:"mapControls",propertyName:"showLabels"},version:c.AzureMapsShowLabels},{types:x,property:{objectName:"valueAxis",propertyName:"sharedAxis"},version:c.SmallMultiplesUnsharedAxes},{types:x,property:{objectName:"valueAxis",propertyName:"scaleToFit"},version:c.SmallMultiplesUnsharedAxes},{property:{objectName:"visualHeader",propertyName:"showSmartNarrativeButton"},version:c.SmartNarrativeToggleButton},{types:[p.visuals.plugins.tableEx.name,p.visuals.plugins.pivotTable.name],property:{objectName:"grid",propertyName:"imageWidth"},version:c.Hackathon2022},{types:[p.visuals.plugins.pageNavigator.name],property:{objectName:"pages",propertyName:"showByDefault"},version:c.Hackathon2022},{types:[p.visuals.plugins.pageNavigator.name],property:{objectName:"pages",propertyName:"showPage"},version:c.Hackathon2022},{types:[p.visuals.plugins.textbox.name],property:__assign(__assign({},p.visuals.textboxProps.general.paragraphs),{matchByContents:function(e,t){if(p.StructuralObjectDefinition.isParagraphsDefinition(e))for(var r=0,i=e;r<i.length;r++){var a=i[r];if(a&&!_.isEmpty(a.indent))return!0}return!1}}),version:c.TextboxIndent},{types:[p.visuals.plugins.areaChart.name,p.visuals.plugins.barChart.name,p.visuals.plugins.clusteredBarChart.name,p.visuals.plugins.clusteredColumnChart.name,p.visuals.plugins.columnChart.name,p.visuals.plugins.hundredPercentStackedBarChart.name,p.visuals.plugins.hundredPercentStackedColumnChart.name,p.visuals.plugins.lineChart.name,p.visuals.plugins.lineClusteredColumnComboChart.name,p.visuals.plugins.lineStackedColumnComboChart.name,p.visuals.plugins.ribbonChart.name,p.visuals.plugins.stackedAreaChart.name],property:{objectName:"labels",propertyName:"showByDefault"},version:c.OnObjectShowByDefault},{types:[p.visuals.plugins.areaChart.name,p.visuals.plugins.lineChart.name,p.visuals.plugins.lineClusteredColumnComboChart.name,p.visuals.plugins.lineStackedColumnComboChart.name,p.visuals.plugins.stackedAreaChart.name],property:{objectName:"seriesLabels",propertyName:"showByDefault"},version:c.OnObjectShowByDefault},{types:[p.visuals.plugins.areaChart.name,p.visuals.plugins.lineChart.name,p.visuals.plugins.lineClusteredColumnComboChart.name,p.visuals.plugins.lineStackedColumnComboChart.name,p.visuals.plugins.stackedAreaChart.name],property:{objectName:"lineStyles",propertyName:"showMarkerByDefault"},version:c.OnObjectShowByDefault},{types:[p.visuals.plugins.lineChart.name,p.visuals.plugins.lineStackedColumnComboChart.name,p.visuals.plugins.lineClusteredColumnComboChart.name],property:{objectName:"error",propertyName:"showMarkerByDefault"},version:c.OnObjectShowByDefault},{types:[p.visuals.plugins.barChart.name,p.visuals.plugins.hundredPercentStackedBarChart.name,p.visuals.plugins.clusteredBarChart.name],property:{objectName:"categoryAxis",propertyName:"concatenateLabels"},version:c.BarChartHierarchyAxis},{property:{objectName:"padding",propertyName:"*"},version:c.VCPadding},{property:{objectName:"subTitle",propertyName:"*"},version:c.VCPadding},{property:{objectName:"divider",propertyName:"*"},version:c.VCPadding},{property:{objectName:"spacing",propertyName:"*"},version:c.VCPadding},{types:u.GeocodingTypes,property:{objectName:"mapControls",propertyName:"geocodingCulture",matchByContents:function(e){return a.isNewToVersion(e.value,a.CultureVersions.v2_0)}},version:c.GeocodingCultureUpdate2_0},{types:[p.visuals.plugins.barChart.name,p.visuals.plugins.columnChart.name,p.visuals.plugins.clusteredBarChart.name,p.visuals.plugins.clusteredColumnChart.name,p.visuals.plugins.hundredPercentStackedBarChart.name,p.visuals.plugins.hundredPercentStackedColumnChart.name,p.visuals.plugins.ribbonChart.name,p.visuals.plugins.lineChart.name,p.visuals.plugins.comboChart.name,p.visuals.plugins.lineClusteredColumnComboChart.name,p.visuals.plugins.lineStackedColumnComboChart.name,p.visuals.plugins.areaChart.name,p.visuals.plugins.stackedAreaChart.name],property:{objectName:"labels",propertyName:"showDynamicLabels"},version:c.MeasureDrivenDataLabels},{types:[p.visuals.plugins.barChart.name,p.visuals.plugins.columnChart.name,p.visuals.plugins.clusteredBarChart.name,p.visuals.plugins.clusteredColumnChart.name,p.visuals.plugins.hundredPercentStackedBarChart.name,p.visuals.plugins.hundredPercentStackedColumnChart.name,p.visuals.plugins.ribbonChart.name,p.visuals.plugins.lineChart.name,p.visuals.plugins.comboChart.name,p.visuals.plugins.lineClusteredColumnComboChart.name,p.visuals.plugins.lineStackedColumnComboChart.name,p.visuals.plugins.areaChart.name,p.visuals.plugins.stackedAreaChart.name],property:{objectName:"labels",propertyName:"dynamicLabelValue"},version:c.MeasureDrivenDataLabels},{types:[p.visuals.plugins.gauge.name],property:{objectName:"calloutValue",propertyName:"showDynamicLabels"},version:c.MeasureDrivenDataLabels},{types:[p.visuals.plugins.gauge.name],property:{objectName:"calloutValue",propertyName:"dynamicLabelValue"},version:c.MeasureDrivenDataLabels},{property:{objectName:"visualLink",propertyName:"tooltipPlaceholderText"},version:c.TooltipPlaceholderText},{types:[p.visuals.plugins.textbox.name],property:__assign(__assign({},p.visuals.textboxProps.general.paragraphs),{matchByContents:function(e,t){if(p.StructuralObjectDefinition.isParagraphsDefinition(e))for(var r=0,i=e;r<i.length;r++){var a=i[r];if(a&&!_.isEmpty(a.textRuns))for(var n=0,o=a.textRuns;n<o.length;n++){var s=o[n];if(p.ParagraphsDefinition.isTextRunDefinition(s)&&s.mentionEmail)return!0}}return!1}}),version:c.TextboxAtMention},{types:[o.scorecard.name],property:{objectName:"scorecard",propertyName:"displayMode"},version:c.GoalVisual},{types:[o.scorecard.name],property:{objectName:"scorecard",propertyName:"goalIds"},version:c.GoalVisual},{types:[o.scorecard.name],property:{objectName:"visualization",propertyName:s},version:c.GoalVisual},{types:[p.visuals.plugins.pivotTable.name],property:{objectName:"rowHeaders",propertyName:"expandCompositeHierarchy"},version:c.VisualCalculations},{types:[p.visuals.plugins.slicer.name,p.visuals.plugins.filterSlicer.name],property:{objectName:"pendingChangesIcon",propertyName:"show"},version:c.SlicerPendingIcon},{types:[p.visuals.plugins.slicer.name,p.visuals.plugins.filterSlicer.name],property:{objectName:"pendingChangesIcon",propertyName:"color"},version:c.SlicerPendingIcon},{types:[p.visuals.plugins.slicer.name,p.visuals.plugins.filterSlicer.name],property:{objectName:"pendingChangesIcon",propertyName:"transparency"},version:c.SlicerPendingIcon},{types:[p.visuals.plugins.slicer.name,p.visuals.plugins.filterSlicer.name],property:{objectName:"pendingChangesIcon",propertyName:"position"},version:c.SlicerPendingIcon},{types:[p.visuals.plugins.slicer.name,p.visuals.plugins.filterSlicer.name],property:{objectName:"pendingChangesIcon",propertyName:"size"},version:c.SlicerPendingIcon},{types:[p.visuals.plugins.slicer.name,p.visuals.plugins.filterSlicer.name],property:{objectName:"pendingChangesIcon",propertyName:"showTooltip"},version:c.SlicerPendingIcon},{types:[p.visuals.plugins.slicer.name,p.visuals.plugins.filterSlicer.name],property:{objectName:"pendingChangesIcon",propertyName:"tooltipText"},version:c.SlicerPendingIcon},{types:[p.visuals.plugins.slicer.name,p.visuals.plugins.filterSlicer.name],property:{objectName:"pendingChangesIcon",propertyName:"tooltipLabel"},version:c.SlicerPendingIcon}],S=["minColor","midColor","maxColor","nullColor"],u.RenamedObjectPropertyVersions=[{currentId:{objectName:"dataPoint",propertyName:"fill"},previousId:{objectName:"dataPoint",propertyName:"defaultCategoryColor"},version:u.ExplorationVersions.v3_19,types:u.DefaultCategoryColorVisualsToUpgrade},{currentId:{objectName:"columnTotal",propertyName:"fontColor"},previousId:{objectName:"total",propertyName:"fontColor"},types:[p.visuals.plugins.pivotTable.name],version:c.splitGrandTotals,featureSwitch:"splitGrandTotals"},{currentId:{objectName:"rowTotal",propertyName:"fontColor"},previousId:{objectName:"total",propertyName:"fontColor"},types:[p.visuals.plugins.pivotTable.name],version:c.splitGrandTotals,featureSwitch:"splitGrandTotals"},{currentId:{objectName:"columnTotal",propertyName:"fontFamily"},previousId:{objectName:"total",propertyName:"fontFamily"},types:[p.visuals.plugins.pivotTable.name],version:c.splitGrandTotals,featureSwitch:"splitGrandTotals"},{currentId:{objectName:"rowTotal",propertyName:"fontFamily"},previousId:{objectName:"total",propertyName:"fontFamily"},types:[p.visuals.plugins.pivotTable.name],version:c.splitGrandTotals,featureSwitch:"splitGrandTotals"},{currentId:{objectName:"columnTotal",propertyName:"fontSize"},previousId:{objectName:"total",propertyName:"fontSize"},types:[p.visuals.plugins.pivotTable.name],version:c.splitGrandTotals,featureSwitch:"splitGrandTotals"},{currentId:{objectName:"rowTotal",propertyName:"fontSize"},previousId:{objectName:"total",propertyName:"fontSize"},types:[p.visuals.plugins.pivotTable.name],version:c.splitGrandTotals,featureSwitch:"splitGrandTotals"},{currentId:{objectName:"columnTotal",propertyName:"bold"},previousId:{objectName:"total",propertyName:"bold"},types:[p.visuals.plugins.pivotTable.name],version:c.splitGrandTotals,featureSwitch:"splitGrandTotals"},{currentId:{objectName:"rowTotal",propertyName:"bold"},previousId:{objectName:"total",propertyName:"bold"},types:[p.visuals.plugins.pivotTable.name],version:c.splitGrandTotals,featureSwitch:"splitGrandTotals"},{currentId:{objectName:"columnTotal",propertyName:"italic"},previousId:{objectName:"total",propertyName:"italic"},types:[p.visuals.plugins.pivotTable.name],version:c.splitGrandTotals,featureSwitch:"splitGrandTotals"},{currentId:{objectName:"rowTotal",propertyName:"italic"},previousId:{objectName:"total",propertyName:"italic"},types:[p.visuals.plugins.pivotTable.name],version:c.splitGrandTotals,featureSwitch:"splitGrandTotals"},{currentId:{objectName:"columnTotal",propertyName:"underline"},previousId:{objectName:"total",propertyName:"underline"},types:[p.visuals.plugins.pivotTable.name],version:c.splitGrandTotals,featureSwitch:"splitGrandTotals"},{currentId:{objectName:"rowTotal",propertyName:"underline"},previousId:{objectName:"total",propertyName:"underline"},types:[p.visuals.plugins.pivotTable.name],version:c.splitGrandTotals,featureSwitch:"splitGrandTotals"},{currentId:{objectName:"columnTotal",propertyName:"backColor"},previousId:{objectName:"total",propertyName:"backColor"},types:[p.visuals.plugins.pivotTable.name],version:c.splitGrandTotals,featureSwitch:"splitGrandTotals"},{currentId:{objectName:"rowTotal",propertyName:"backColor"},previousId:{objectName:"total",propertyName:"backColor"},types:[p.visuals.plugins.pivotTable.name],version:c.splitGrandTotals,featureSwitch:"splitGrandTotals"},{currentId:{objectName:"columnTotal",propertyName:"applyToHeaders"},previousId:{objectName:"total",propertyName:"applyToHeaders"},types:[p.visuals.plugins.pivotTable.name],version:c.splitGrandTotals,featureSwitch:"splitGrandTotals"},{currentId:{objectName:"rowTotal",propertyName:"applyToHeaders"},previousId:{objectName:"total",propertyName:"applyToHeaders"},types:[p.visuals.plugins.pivotTable.name],version:c.splitGrandTotals,featureSwitch:"splitGrandTotals"},{currentId:{objectName:"visualLink",propertyName:"showDefaultTooltip"},previousId:{objectName:"visualLink",propertyName:"suppressDefaultTooltip"},types:[p.visuals.plugins.pivotTable.name],version:c.ShowDefaultTooltip,upgrader:u.UpgradeUtils.convertSuppressDefaultTooltip,featureSwitch:"showDefaultTooltip"},{currentId:{objectName:"fillPoint",propertyName:"style"},previousId:{objectName:"fillPoint",propertyName:"show"},types:[p.visuals.plugins.scatterChart.name],version:c.FillPointShowToStyle,upgrader:u.UpgradeUtils.convertScatterChartFillPoint,featureSwitch:"fillPointStyle"},{currentId:{objectName:"categoryAxis",propertyName:"switchAxisPosition"},previousId:{objectName:"categoryAxis",propertyName:"position"},types:[p.visuals.plugins.barChart.name,p.visuals.plugins.clusteredBarChart.name,p.visuals.plugins.clusteredColumnChart.name,p.visuals.plugins.columnChart.name,p.visuals.plugins.hundredPercentStackedBarChart.name,p.visuals.plugins.hundredPercentStackedColumnChart.name,p.visuals.plugins.ribbonChart.name],version:c.PositionToSwitchAxisPosition,upgrader:u.UpgradeUtils.convertAxisPositionProperty},{currentId:{objectName:"valueAxis",propertyName:"switchAxisPosition"},previousId:{objectName:"valueAxis",propertyName:"position"},version:c.PositionToSwitchAxisPosition,types:[p.visuals.plugins.areaChart.name,p.visuals.plugins.barChart.name,p.visuals.plugins.clusteredBarChart.name,p.visuals.plugins.clusteredColumnChart.name,p.visuals.plugins.columnChart.name,p.visuals.plugins.hundredPercentStackedBarChart.name,p.visuals.plugins.hundredPercentStackedColumnChart.name,p.visuals.plugins.lineChart.name,p.visuals.plugins.lineClusteredColumnComboChart.name,p.visuals.plugins.lineStackedColumnComboChart.name,p.visuals.plugins.ribbonChart.name,p.visuals.plugins.scatterChart.name,p.visuals.plugins.stackedAreaChart.name,p.visuals.plugins.waterfallChart.name],upgrader:u.UpgradeUtils.convertAxisPositionProperty},{currentId:{objectName:"categoryAxis",propertyName:"logAxisScale"},previousId:{objectName:"categoryAxis",propertyName:"axisScale"},version:c.AxisScaleToLogAxisScale,types:[p.visuals.plugins.barChart.name,p.visuals.plugins.clusteredBarChart.name,p.visuals.plugins.clusteredColumnChart.name,p.visuals.plugins.columnChart.name,p.visuals.plugins.hundredPercentStackedBarChart.name,p.visuals.plugins.hundredPercentStackedColumnChart.name,p.visuals.plugins.ribbonChart.name,p.visuals.plugins.waterfallChart.name],upgrader:u.UpgradeUtils.convertAxisScaleProperty},{currentId:{objectName:"valueAxis",propertyName:"logAxisScale"},previousId:{objectName:"valueAxis",propertyName:"axisScale"},version:c.AxisScaleToLogAxisScale,types:[p.visuals.plugins.areaChart.name,p.visuals.plugins.barChart.name,p.visuals.plugins.clusteredBarChart.name,p.visuals.plugins.clusteredColumnChart.name,p.visuals.plugins.columnChart.name,p.visuals.plugins.hundredPercentStackedBarChart.name,p.visuals.plugins.hundredPercentStackedColumnChart.name,p.visuals.plugins.lineChart.name,p.visuals.plugins.lineClusteredColumnComboChart.name,p.visuals.plugins.lineStackedColumnComboChart.name,p.visuals.plugins.ribbonChart.name,p.visuals.plugins.scatterChart.name,p.visuals.plugins.stackedAreaChart.name,p.visuals.plugins.waterfallChart.name],upgrader:u.UpgradeUtils.convertAxisScaleProperty},{currentId:{objectName:"y2Axis",propertyName:"secLogAxisScale"},previousId:{objectName:"y2Axis",propertyName:"secAxisScale"},version:c.AxisScaleToLogAxisScale,types:[p.visuals.plugins.areaChart.name,p.visuals.plugins.lineChart.name,p.visuals.plugins.lineClusteredColumnComboChart.name,p.visuals.plugins.lineStackedColumnComboChart.name,p.visuals.plugins.stackedAreaChart.name],upgrader:u.UpgradeUtils.convertAxisScaleProperty},{currentId:{objectName:"valueAxis",propertyName:"secLogAxisScale"},previousId:{objectName:"valueAxis",propertyName:"secAxisScale"},version:c.AxisScaleToLogAxisScale,types:[o.comboChart.name,o.dataDotClusteredColumnComboChart.name,o.dataDotStackedColumnComboChart.name,o.lineClusteredColumnComboChart.name,o.lineStackedColumnComboChart.name],upgrader:u.UpgradeUtils.convertAxisScaleProperty},{currentId:{objectName:"columnHeaders",propertyName:"outlineStyle"},previousId:{objectName:"columnHeaders",propertyName:"outline"},version:c.OutlineDropdownToCheckboxes,types:[p.visuals.plugins.pivotTable.name,p.visuals.plugins.tableEx.name],upgrader:u.UpgradeUtils.convertOutlineValue,featureSwitch:"outlineDropdownToCheckboxes"},{currentId:{objectName:"rowHeaders",propertyName:"outlineStyle"},previousId:{objectName:"rowHeaders",propertyName:"outline"},version:c.OutlineDropdownToCheckboxes,types:[p.visuals.plugins.pivotTable.name,p.visuals.plugins.tableEx.name],upgrader:u.UpgradeUtils.convertOutlineValue,featureSwitch:"outlineDropdownToCheckboxes"},{currentId:{objectName:"values",propertyName:"outlineStyle"},previousId:{objectName:"values",propertyName:"outline"},version:c.OutlineDropdownToCheckboxes,types:[p.visuals.plugins.pivotTable.name,p.visuals.plugins.tableEx.name],upgrader:u.UpgradeUtils.convertOutlineValue,featureSwitch:"outlineDropdownToCheckboxes"},{currentId:{objectName:"total",propertyName:"outlineStyle"},previousId:{objectName:"total",propertyName:"outline"},version:c.OutlineDropdownToCheckboxes,types:[p.visuals.plugins.tableEx.name],upgrader:u.UpgradeUtils.convertOutlineValue,featureSwitch:"outlineDropdownToCheckboxes"},{currentId:{objectName:"grid",propertyName:"outlineStyle"},previousId:{objectName:"grid",propertyName:"outline"},version:c.OutlineDropdownToCheckboxes,types:[p.visuals.plugins.pivotTable.name,p.visuals.plugins.tableEx.name],upgrader:u.UpgradeUtils.convertOutlineValue,featureSwitch:"outlineDropdownToCheckboxes"},{currentId:{objectName:"header",propertyName:"outlineStyle"},previousId:{objectName:"header",propertyName:"outline"},version:c.OutlineDropdownToCheckboxes,types:[p.visuals.plugins.slicer.name,p.visuals.plugins.filterSlicer.name],upgrader:u.UpgradeUtils.convertOutlineValue,featureSwitch:"outlineDropdownToCheckboxes"},{currentId:{objectName:"searchBox",propertyName:"outlineStyle"},previousId:{objectName:"searchBox",propertyName:"outline"},version:c.OutlineDropdownToCheckboxes,types:[p.visuals.plugins.slicer.name,p.visuals.plugins.filterSlicer.name],upgrader:u.UpgradeUtils.convertOutlineValue,featureSwitch:"outlineDropdownToCheckboxes"},{currentId:{objectName:"items",propertyName:"outlineStyle"},previousId:{objectName:"items",propertyName:"outline"},version:c.OutlineDropdownToCheckboxes,types:[p.visuals.plugins.slicer.name,p.visuals.plugins.filterSlicer.name],upgrader:u.UpgradeUtils.convertOutlineValue,featureSwitch:"outlineDropdownToCheckboxes"},{currentId:{objectName:"card",propertyName:"outlineStyle"},previousId:{objectName:"card",propertyName:"outline"},version:c.OutlineDropdownToCheckboxes,types:[p.visuals.plugins.multiRowCard.name],upgrader:u.UpgradeUtils.convertOutlineValue,featureSwitch:"outlineDropdownToCheckboxes"},{currentId:{objectName:"categoryAxis",propertyName:"logAxisScale"},previousId:{objectName:"categoryAxis",propertyName:"axisScale"},version:c.RemainingCategoryLogAxisScale,types:[o.areaChart.name,o.lineChart.name,o.lineClusteredColumnComboChart.name,o.lineStackedColumnComboChart.name,o.scatterChart.name,o.stackedAreaChart.name],upgrader:u.UpgradeUtils.convertAxisScaleProperty,featureSwitch:"remainingCartesianCategoryLogAxisScale"}],u.UpdatedObjectPropertyVersions=[{property:{objectName:"categoryAxis",propertyName:"fontSize"},version:u.ExplorationVersions.v4_2,upgrader:u.UpgradeUtils.pxToPtUpgrader},{property:{objectName:"categoryAxis",propertyName:"titleFontSize"},version:u.ExplorationVersions.v4_2,upgrader:u.UpgradeUtils.pxToPtUpgrader},{property:{objectName:"valueAxis",propertyName:"fontSize"},version:u.ExplorationVersions.v4_2,upgrader:u.UpgradeUtils.pxToPtUpgrader},{property:{objectName:"valueAxis",propertyName:"titleFontSize"},version:u.ExplorationVersions.v4_2,upgrader:u.UpgradeUtils.pxToPtUpgrader},{property:{objectName:"valueAxis",propertyName:"secFontSize"},version:u.ExplorationVersions.v4_2,upgrader:u.UpgradeUtils.pxToPtUpgrader},{property:{objectName:"valueAxis",propertyName:"secTitleFontSize"},version:u.ExplorationVersions.v4_2,upgrader:u.UpgradeUtils.pxToPtUpgrader},{property:{objectName:"visualTooltip",propertyName:"fontSize"},version:u.ExplorationVersions.v4_2,upgrader:u.UpgradeUtils.pxToPtUpgrader},{property:{objectName:"outspacePane",propertyName:"titleSize"},version:u.ExplorationVersions.v5_1,upgrader:u.UpgradeUtils.pxToPtUpgrader},{property:{objectName:"outspacePane",propertyName:"headerSize"},version:u.ExplorationVersions.v5_1,upgrader:u.UpgradeUtils.pxToPtUpgrader},{property:{objectName:"filterCard",propertyName:"textSize"},version:u.ExplorationVersions.v5_1,upgrader:u.UpgradeUtils.pxToPtUpgrader}],u.ObjectVersioning=(i=u.AddedObjectPropertyVersions,t=u.RenamedObjectPropertyVersions,e=u.UpdatedObjectPropertyVersions,{added:(function(a){for(var n={},e=0;e<a.length;e++)!(function(e){var t=a[e];if(null!=t.types)for(var r=0,i=t.types;r<i.length;r++)P(i[r],t,n);else P(s,t,n)})(e);return n})(i),renamed:(function(n){for(var o={},e=0,t=n.length;e<t;e++)!(function(e){var t=n[e];if(null!=t.types)for(var r=0,i=t.types;r<i.length;r++)w(a=i[r],t,o);else for(var a in w(s,t,o),o)w(a,t,o)})(e);return o})(t),updated:e}),u.getVersionForObjectDefinitions=function(n,e,o,s,l){return d.visitPropertyExprs({definitions:n,descriptors:e,visitor:function(e,t,r,i){s=h.max(u.ExplorationVersionHelper.getVersionForSQExprWithDescriptor(e,i),s)}}),d.visitPropertyDefinitions(n,e,(function(e,t,r,i,a){e=e[t];s=h.max(s,p.data.DataViewObjectVersioning.getVersionForDefinition(u.ObjectVersioning.added,e,r,o,i,t,s,(function(){var e=d.getValue(n,{objectName:i,propertyName:t},r);if(e){e=d.getDataBoundExprs(e,r,l);if(!_.isEmpty(e))return!0}return!1}))),d.isObjectPropertySQExprWithContext(e)&&(s=h.max(s,c.NarrativeVisual))})),s}})(powerbi=powerbi||{}),(function(e){((e=(e=(e=e.explore||(e.explore={})).services||(e.services={})).upgrade||(e.upgrade={})).UtteranceDefinitionVersions||(e.UtteranceDefinitionVersions={})).v1_0="1.0"})(powerbi=powerbi||{}),(function(o){var e,r,t,i,s,l,a,n;e=(e=o.explore||(o.explore={})).util||(e.util={}),i=o.explore.services.upgrade.CurrentExplorationVersion,s=o.data.DataViewObjectDefinitions,l=o.explore.contracts.ExplorationObjectDescriptors,a=o.explore.services.upgrade.ExplorationVersions,n=jsCommon.Version,r=e.ThemeUtils||(e.ThemeUtils={}),t="CY18SU07",r.baseThemeVersions={CY17SU10:a.v3_6,CY17SU12:a.v3_7,CY18SU04:a.v3_12,CY18SU07:a.v3_15,CY19SU06:a.v5_3,CY19SU12:a.v5_6,CY20SU07:a.v5_13,CY20SU09:a.v5_15,CY21SU02:a.v5_18,CY21SU03:a.v5_19,CY21SU04:a.v5_20,CY21SU07:a.v5_24,CY21SU11:a.v5_27,CY22SU03:a.v5_30,CY22SU08:a.v5_35,CY22SU09:a.v5_37,CY22SU11:a.v5_40,CY23SU04:a.v5_43},r.ClassicBaseThemeName="Classic",r.DefaultBaseThemeName="Default",r.CustomThemeName="Custom",r.ClassicBaseThemeBuiltInThemeNames=["Classic","CityPark","Classroom","ColorblindSafe","Electric","HighContrast","Sunset","Twilight"],r.getVersionForBaseTheme=function(e){return r.baseThemeVersions[e]||a.v3_6},r.isBaseThemeCurrent=function(e){var t;return null!=(e=null==(e=null==e?void 0:e.baseTheme)?void 0:e.name)&&(e=r.getVersionForBaseTheme(e),t=r.getVersionForBaseTheme("CY23SU04"),n.ge(e,t))},r.getThemeMetadata=function(e,t,r){return o.getThemeMetadata(e,t,r||i)},r.getCurrentBaseThemeMetadata=function(e){return{name:e&&e.featureSwitches&&e.featureSwitches.useNewCY19SU06BaseTheme?"CY23SU04":t,version:i,type:2}},r.getClassicBaseThemeMetadata=function(){return{name:t,version:r.baseThemeVersions[t],type:2}},r.isAnyDefaultTheme=function(e){return n.ge(r.getVersionForBaseTheme(e),"5.3")},r.evaluateObjects=function(e,t,r){var i=e.themeCollection,a=o.explore.constants.ExplorationComponentType,n=e.objects,a=((a=t.getVisualObjects(i,a,void 0,l))&&(n=s.clone(n||{}),s.extend(n,a)),t.getVisualStyle(i)),t=o.data.DataViewTransform.evaluateMetadataOnceDataViewObjectDefinitions(n,l,a,r);e.evaluatedObjects=t.dataViewObjects}})(powerbi=powerbi||{}),(function(e){var t,u,r;function i(e){this.downgraders=e,this.objectsDowngrader=t.createVisualObjectsDowngrader(this.downgraders)}e=(e=e.explore||(e.explore={})).services||(e.services={}),t=e.downgrade||(e.downgrade={}),u=jsCommon.Version,t.createExplorationDowngrader=function(e){return new r(e)},i.prototype.getFinalExplorationVersion=function(e,t){t=u.max(t,this.getFinalExplorationForObjectsVersion(e,t));for(var r=0,i=this.downgraders;r<i.length;r++){var a=i[r];t=u.max(t,a.getMinDowngradeVersionForContract(e))}return t},i.prototype.downgrade=function(e,t){this.downgradeVisualObjects(e,t);for(var r=0,i=this.downgraders;r<i.length;r++)i[r].downgrade(e,t)},i.prototype.downgradeVisualObjects=function(e,t){e=e&&e.sections;if(e)for(var r=0,i=e;r<i.length;r++){var a=i[r],a=a&&a.visualContainers;if(!a)return;for(var n=0,o=a;n<o.length;n++){var s,l,p=o[n],p=p&&p.config&&p.config.singleVisual;p&&(s=p.visualType,(l=p.vcObjects)&&this.objectsDowngrader.downgrade(2,l,s,t),l=p.objects)&&this.objectsDowngrader.downgrade(1,l,s,t)}}},i.prototype.getFinalExplorationForObjectsVersion=function(e,t){e=e&&e.sections;if(e){for(var r=0,i=e;r<i.length;r++){var a=i[r],a=a&&a.visualContainers;if(!a)return;for(var n=0,o=a;n<o.length;n++){var s,l,p=o[n],p=p&&p.config&&p.config.singleVisual;p&&(s=p.visualType,(l=p.vcObjects)&&(t=u.max(t,this.objectsDowngrader.getFinalVisualObjectsVersion(2,l,t,s))),l=p.objects)&&(t=u.max(t,this.objectsDowngrader.getFinalVisualObjectsVersion(1,l,t,s)))}}return t}},r=i,t.ExplorationDowngrader=r})(powerbi=powerbi||{}),(function(h){var c,d,p,g,m,f,a,C,v,x,y,S,b,E,t,n,N,V,s,l,w,o,M,B,u,P,T,U,F,j,D,R,A,I,z,O,L,k,i;function e(e,t,r,i,a,n,o){this.visualPlugins=e,this.telemetryService=t,this.featureSwitchService=r,this.canvasListOrderNormalizeService=i,this.contextActivityService=a,this.userState=n,this.explorationUpgrader=d.upgrade.createExplorationUpgrader(r),this.explorationDowngrader=d.downgrade.createExplorationDowngrader(o)}function r(e,t,r,i){this.visualPlugins=e,this.explorationDowngrader=t,this.telemetryService=r,this.featureSwitchService=i,this.version=k}function q(e){null!=e.x&&null!=e.y&&null!=e.width&&null!=e.height||(jsCommon.Trace.error("deserializeVisualContainer found null in layout position: "+JSON.stringify({x:e.x,y:e.y,width:e.width,height:e.height})),null==e.x&&(e.x=0),null==e.y&&(e.y=0),null==e.width&&(e.width=0),null==e.height&&(e.height=0))}c=h.explore||(h.explore={}),d=c.services||(c.services={}),p=jsCommon.ArrayExtensions,g=h.explore.contracts.BookmarkExtensions,m=h.explore.services.upgrade.ComboSmallMultipleFormattingVisualTypes,f=h.explore.contracts,a=h.explore.services.upgrade.CurrentExplorationVersion,C=h.common.contracts.DataCacheModeType,v=h.data.DataViewObjectDefinitions,x=h.data.services.DataViewObjectSerializer,y=h.data.services.DisplayNameSerializer,S=h.data.ExpansionState,b=h.data.services.ExpansionStateSerializer,E=h.explore.services.upgrade.ExplorationFeatureVersions,t=h.explore.services.upgrade.ExplorationStateFeatureVersions,n=h.explore.services.upgrade.ExplorationStateVersions,N=h.explore.services.upgrade.ExplorationVersions,V=h.data.services.FilterExpressionMetadataSerializer,s=f.FilterContainer.ObjectType,l=f.FilterContainer.CommonObjectDescriptors,w=jsCommon.JsonExtensions,o=f.LinguisticSchemaSyncVersion,M=h.data.QueryProjectionCollection,B=h.contracts.ResourcePackageItemType,u=h.visualHost.utils.ResourcePackageUtils,P=h.data.services.SemanticQuerySerializer,T=h.data.SQExpr,U=h.data.SQExprUtils,F=jsCommon.StringExtensions,j=h.visualHost.ThemeUtils,D=jsCommon.Version,R=f.VisualContainer,A=f.VisualContainerGroup,I=c.util.VisualContainerUtils,z=f.VisualQuery,O="Gradient",d.createExplorationSerializer=function(e,t,r,i,a,n,o){return new L(e,t,r,i,a,n,o)},e.prototype.deepCopyExploration=function(e,t){return this.deserializeExploration(this.serializeExploration(e,t),[],!0)},e.prototype.ensureInitialized=function(){return this.visualPlugins.ensureBuiltInPlugins()},e.prototype.deserializeExploration=function(e,t,r,i,a,n){var o=this;if(e){var s=void 0,e=(n&&(s=n.createChildActivity({name:"Upgrade Exploration"})),this.explorationUpgrader.upgrade(e,t,r,a));if(s&&(s.setProperty("upgraderCount",null==a?void 0:a.upgraderCount),s.resolve()),!e)return;e.config;var l,p,u=e.config,c={id:e.id,width:void 0,height:void 0,sections:void 0,dataSources:void 0,reportId:e.reportId,themeCollection:j.cloneThemeCollection(u.themeCollection),bookmarks:[],mwcToken:e.mwcToken,capacityUri:e.capacityUri,publicCustomVisuals:e.publicCustomVisuals},d=(u.tags&&(c.tags=_.cloneDeep(u.tags)),u.slowDataSourceSettings&&(c.slowDataSourceSettings=_.cloneDeep(u.slowDataSourceSettings)),u.settings&&(c.settings=_.cloneDeep(u.settings)),u.objects&&(c.objects=x.deserializeObjects(u.objects,f.ExplorationObjectDescriptors)),u.bookmarks&&(t=jsCommon.PerfTimer.logTime((function(){var e=o.deserializeBookmarks(u.bookmarks);c.bookmarks=e})),n)&&n.setProperty("bookmarkDeserializationDuration",t),this.contextActivityService.upsertExplorationProperties({bookmarkCount:c.bookmarks?c.bookmarks.length:0}),e.userState&&(c.userState=this.deserializeUserState(e.userState)),e.activeWebBookmark&&(c.activeWebBookmark=this.deserializeWebBookmark(e.activeWebBookmark,r)),e.activeBookmark);if(d)for(var m=0,v=null!=(a=c.bookmarks)?a:[];m<v.length;m++){var y=v[m];if(!g.isBookmarkGroup(y)&&y.name===d.name){c.activeBookmark=y;break}}e.sections&&(s=_.sortBy(e.sections,(function(e){return void 0!==e.ordinal?e.ordinal:0})),l=c.settings&&c.settings.useStylableVisualContainerHeader,c.sections=_.map(s,(function(e){return o.deserializePage(e,l)})),c.filters=this.deserializeFilterContainers(e.filters),c.dataSources=f.createDataSourceArray(),e.resourcePackages&&(c.resourcePackages=this.deserializeResourcePackages(e.resourcePackages)),e.pods&&(c.pods=_.map(e.pods,(function(e){return o.deserializePod(e)}))),_.isNumber(u.activeSectionIndex)&&u.activeSectionIndex<e.sections.length&&(c.activeSectionIndex=u.activeSectionIndex),u.modelExtensions&&(c.modelExtensions=this.deserializeModelExtensions(u.modelExtensions)),i)&&(i.lastTimeAModelChangeWasDetectedInTheCluster&&!_.isEmpty(i.onPremModelConnectionString)?(p=jsCommon.DateExtensions.deserializeDate(i.lastTimeAModelChangeWasDetectedInTheCluster),this.updateVisualContainerCachingOptions(c,p,(function(e){e.useInitialCachedQuery=!0}),(function(e){e.useInitialCachedQuery=!1}))):_.isEmpty(i.onPremModelConnectionString)&&i.dataCacheMode===C.Import&&i.lastRefreshTime&&(p=jsCommon.DateExtensions.deserializeDate(i.lastRefreshTime),this.updateVisualContainerCachingOptions(c,p,(function(e){e.disableCacheOnServerForInitialLoad=!0}),(function(e){e.disableCacheOnServerForInitialLoad=!1})))),e.report&&(c.report=h.Prototype.inherit(e.report),e.report.linguisticSchemaId)&&(c.reportHasLinguisticSchema=!0),null!=u.defaultDrillFilterOtherVisuals&&(c.defaultDrillFilterOtherVisuals=u.defaultDrillFilterOtherVisuals),u.filterSortOrder&&(c.filterSortOrder=u.filterSortOrder),u.dataSourceVariables&&(c.dataSourceVariables=u.dataSourceVariables),u.creationSource&&(c.creationSource=u.creationSource),c.linguisticSchemaSyncVersion=this.deserializeLinguisticSchemaSyncVersion(u.linguisticSchemaSyncVersion)}return c},e.prototype.deserializeLinguisticSchemaSyncVersion=function(e){return null==e?o.Unspecified:e},e.prototype.updateVisualContainerCachingOptions=function(e,t,r,i){for(var a=0,n=e.sections;a<n.length;a++)for(var o=0,s=n[a].visualContainers;o<s.length;o++){var l=s[o];(l.cachedData&&l.cachedData.dataUpdatedTime&&l.cachedData.data&&0<=+l.cachedData.dataUpdatedTime-+t?r:i)(l)}},e.prototype.deserializeResourcePackages=function(e){for(var t=[],r=0,i=e;r<i.length;r++){var a=i[r];this.upgradeResourcePackage(a.resourcePackage),t.push(a.resourcePackage)}for(var n=0;n<t.length;++n)if(t[n])for(var o=t.length;--o>n;)t[o]&&t[n].name===t[o].name&&(t[o].id>t[n].id&&(t[n]=t[o]),t.splice(o,1));return t},e.prototype.deserializeLinkField=function(e){var t=P.deserializeExpr(e.fieldExpr);return{asAggregation:e.asAggregation,fieldExpr:t}},e.prototype.deserializePage=function(e,t){var r,i,a=this;if(e)return r={id:e.id,objectId:e.objectId,name:e.name,displayName:e.displayName,visualContainers:void 0,visualContainerGroups:void 0,size:{displayOption:void 0!==e.displayOption?e.displayOption:0,height:e.height||c.constants.ExploreCanvasConstants.DefaultCanvasHeight,width:e.width||c.constants.ExploreCanvasConstants.DefaultCanvasWidth},filters:this.deserializeFilterContainers(e.filters)},(e.originalHeight||e.originalWidth||e.originalDisplayOption)&&(r.originalSize={displayOption:e.originalDisplayOption,height:e.originalHeight,width:e.originalWidth}),e.transient&&(r.transient=e.transient),i=e.config,r.acceptsAllFiltersWhenLinked=i.acceptsAllFiltersWhenLinked,i.objects&&(r.objects=x.deserializeObjects(i.objects,f.Section.objectDescriptors)),null!=i.visibility&&(r.visibility=i.visibility),null!=i.type&&(r.type=i.type),null!=i.filterSortOrder&&(r.filterSortOrder=i.filterSortOrder),_.isEmpty(i.linkFields)||(r.linkFields=_.map(i.linkFields,(function(e){return a.deserializeLinkField(e)}))),i.dynamicConfig&&(r.dynamicConfig=this.deserializeDynamicConfig(i.dynamicConfig)),e.visualContainers&&((e=this.deserializeCanvasItems(e.visualContainers,null,t))?(r.visualContainers=e.visualContainers,r.visualContainerGroups=e.visualContainerGroups):(r.visualContainers=[],r.visualContainerGroups=[]),i.relationships)&&(r.relationships=this.deserializeRelationships(i.relationships,r.visualContainers)),r},e.prototype.deserializePod=function(e){if(e)return{id:e.id,name:e.name,boundSection:e.boundSection,parameters:this.deserializePodParameters(e.parameters),cortanaEnabled:e.cortanaEnabled,type:void 0===e.type?0:e.type,referenceScope:void 0===e.referenceScope?0:e.referenceScope,config:this.deserializePodConfig(e.config)}},e.prototype.deserializeRelationships=function(e,t){if(!_.isEmpty(e)){for(var r,i=0,a=e;i<a.length;i++){var n=a[i],n=this.deserializeRelationship(n,t);n&&(r=r||[]).push(n)}return r}},e.prototype.deserializeBookmarks=function(e){var i=this;if(e)return _.map(e,(function(e){var t,r;return i.isBookmarkGroup(e)?(t={displayName:e.displayName,name:e.name,children:i.deserializeBookmarks(e.children)},_.each(t.children,(function(e){return e.parentGroup=t})),t):(r=e.explorationState,r={displayName:e.displayName,name:e.name,explorationState:d.ExplorationState.deserialize(r,i.visualPlugins,i.featureSwitchService)},e.options&&(r.options=i.deserializeBookmarkOptions(e.options)),r)}))},e.prototype.deserializeBookmarkOptions=function(e){return e},e.prototype.deserializeUserState=function(e){if(!F.isNullOrUndefinedOrWhiteSpaceString(e)){e=w.tryParseJSON(e);if(e)try{return this.userState.deserialize(e,this.visualPlugins,this.featureSwitchService)}catch(e){return e&&this.telemetryService.logEvent(h.telemetry.PersistentStateSerializationError,{stack:e.stack,message:e.message}),{explorationState:null}}}},e.prototype.deserializeWebBookmark=function(e,t){e=d.WebBookmark.deserialize(e,this.visualPlugins,this.featureSwitchService);if(e.errors&&!t)for(var r=0,i=e.errors;r<i.length;r++){var a=i[r];this.telemetryService.logEvent(h.telemetry.SerializationError,{type:"WebBookmark",errorCode:a.code,stack:a.stack,message:a.message})}return e.contract},e.prototype.deserializeModelExtensions=function(e){var r=this;return p.extendWithName(_.map(e,(function(e){var t={name:e.name,extends:e.extends};return e.entities&&(t.entities=r.deserializeModelExtensionEntities(e.entities)),t})))},e.prototype.deserializeModelExtensionEntities=function(e){var r=this;return p.extendWithName(_.map(e,(function(e){var t=e.extends?{name:e.name,extends:e.extends}:{name:e.name};return e.measures&&(t.measures=r.deserializeModelExtensionMeasures(e.measures)),t})))},e.prototype.deserializeModelExtensionMeasures=function(e){var r=this;return p.extendWithName(_.map(e,(function(e){var t={name:e.name,dataCategory:e.dataCategory,dataType:e.dataType,expression:e.expression,errorMessage:e.errorMessage,hidden:e.hidden,references:r.deserializeExpressionReferences(e.references),formulaOverride:e.formulaOverride,formatInformation:e.formatInformation,displayFolder:e.displayFolder};return e.annotations&&(t.annotations=r.deserializeModelExtensionAnnotations(e.annotations)),e.measureTemplate&&(t.measureTemplate={daxTemplateName:e.measureTemplate.daxTemplateName,version:e.measureTemplate.version}),e.description&&(t.description=e.description),t})))},e.prototype.deserializeExpressionReferences=function(e){return e?{unrecognizedReferences:!!e.unrecognizedReferences,measures:e.measures||[]}:{unrecognizedReferences:!1,measures:[]}},e.prototype.deserializeModelExtensionAnnotations=function(e){return p.extendWithName(_.map(e,(function(e){return{name:e.name,value:e.value}})))},e.prototype.deserializeDynamicConfig=function(e){var t,r,i;return e.quickExplore&&(t=e.quickExplore.selectedFields,r=e.quickExplore.visualContainerConfigurations,e=e.quickExplore.layout,(i=i||{}).quickExplore={selectedFields:_.map(t,(function(e){return P.deserializeExpr(e)})),visualContainerConfigurations:_.map(r,(function(e){return{name:e.name,fields:_.map(e.fields,(function(e){return P.deserializeExpr(e)}))}}))},e)&&(i.quickExplore.layout=this.deserializeQuickExploreLayout(e)),i},e.prototype.deserializeQuickExploreLayout=function(e){var t;return e.combination?(t={version:e.combination.version},e.combination.dataTableName&&(t.dataTableName=e.combination.dataTableName),{combination:t}):e.related?(t={version:e.related.version},e.related.dataTableName&&(t.dataTableName=e.related.dataTableName),{related:t}):void 0},e.prototype.deserializeFilterCollection=function(e,t,r){if(e){e=this.explorationUpgrader.upgradeFilterCollection(e,t,r);if(e)return this.deserializeFilterContainers(e.filters)}},e.prototype.deserializeFilterContainer=function(e){return{name:e.name,type:f.FilterType[e.type],expression:e.expression?P.deserializeExpr(e.expression):void 0,filter:e.filter&&e.filter.Where?P.deserializeFilter(e.filter):void 0,restatement:e.restatement,cachedValueItems:y.deserializeFilterLabelIdPairs(e.cachedDisplayNames),howCreated:e.howCreated,isLinkedAsAggregation:e.isLinkedAsAggregation,isTransient:e.isTransient,isHiddenInViewMode:e.isHiddenInViewMode,objects:e.objects?x.deserializeObjects(e.objects,l):void 0,isLockedInViewMode:e.isLockedInViewMode,filterExpressionMetadata:e.filterExpressionMetadata?V.deserializeFilterExpressionMetadata(e.filterExpressionMetadata):void 0,displayName:e.displayName,ordinal:e.ordinal}},e.prototype.deserializeCanvasItems=function(e,t,r,i){if(!_.isEmpty(e)){for(var a=[],n=[],o={},s={},l=0,p=e;l<p.length;l++){var u=p[l],c=(u&&u.config,u.config),d=c.name,m=i&&i(u),u=this.deserializeCanvasItem(u,t,m),m=u.name;s[d]=m,f.isVisualContainer(u)&&a.push(u),(void 0===c.parentGroupName?n:(o[c.parentGroupName]||(o[c.parentGroupName]=[]),o[c.parentGroupName])).push(u)}var v,y={};for(v in o){var h=s[v];h?y[h]=o[v]:n.push.apply(n,o[v]||[])}return this.ensureVisualContainerGrouping(n,y,r),this.ensureNames(a),r?(this.ensureGroupZIndexNormalized(n),this.featureSwitchService.featureSwitches.accessibilityTopLevelNav?this.ensureGroupTabOrderNormalized(n,a):this.ensureListOrderNormalized(a,!1)):(n=__spreadArray([],a||[],!0),this.ensureListOrderNormalized(a)),{visualContainerGroups:n,visualContainers:a}}},e.prototype.deserializeCanvasItem=function(e,t,r){e&&e.config;var i=e.config;return i.singleVisual?this.deserializeVisualContainer(e,t,r):i.singleVisualGroup?this.deserializeVisualContainerGroup(e,t,r):void this.telemetryService.logEvent(h.telemetry.EXEmptyVisualContainerConfig)},e.prototype.deserializeVisualContainer=function(e,t,r){var i=e.config,r={name:r||i.name,id:t?void 0:e.id,layouts:p.createWithId(),config:{singleVisual:this.deserializeSingleVisual(i.singleVisual,e.prototypeQuery)}},t=(null!=e.visibility&&(r.visibility=e.visibility),null!=e.detailVisualLayout&&(r.detailVisualLayout=e.detailVisualLayout),i.name&&(r.prevName=i.name),void 0===e.dataBinaryBase64Encoded&&void 0===e.query&&void 0===e.dataTransforms||(r.cachedData={data:e.dataBinaryBase64Encoded,query:e.query,transforms:e.dataTransforms,dataUpdatedTime:e.dataUpdatedTime?jsCommon.DateExtensions.parseUtcDate(e.dataUpdatedTime):void 0}),r.filters=this.deserializeFilterContainers(e.filters),i.singleVisual.drillFilterOtherVisuals),e=(null!=t&&(r.drillFilterOtherVisuals=t),i.singleVisual.filterSortOrder);return null!=e&&(r.filterSortOrder=e),(t=r.layouts).push.apply(t,_.cloneDeep(i.layouts)||[]),_.forEach(r.layouts,(function(e){e.position&&q(e.position)})),r},e.prototype.deserializeVisualContainerGroup=function(e,t,r){var i=e.config,a=i.singleVisualGroup,r={name:r||i.name,id:t?void 0:e.id,children:[],displayName:a.displayName,groupMode:a.groupMode,layouts:p.createWithId(),isHidden:a.isHidden};return i.name&&(r.prevName=i.name),(t=r.layouts).push.apply(t,_.cloneDeep(i.layouts)||[]),a.objects&&(r.objects=x.deserializeObjects(a.objects,A.objectDescriptors)),r},e.prototype.deserializeRelationship=function(e,t){var r=p.findItemWithName(t,e.source),t=p.findItemWithName(t,e.target);if(0!==e.type&&r&&t)return{source:r,target:t,type:e.type}},e.prototype.deserializeFilterContainers=function(e){var t,r=this;if(!F.isNullOrUndefinedOrWhiteSpaceString(e))return t=[],(e=w.tryParseJSON(e))?e.map((function(e){return r.deserializeFilterContainer(e)})):t},e.prototype.deserializePodParameters=function(e){var t=this,r=[];return F.isNullOrUndefinedOrWhiteSpaceString(e)||(e=w.tryParseJSON(e))&&(r=e.map((function(e){return t.deserializePodParameter(e)}))),r},e.prototype.deserializePodParameter=function(e){return{name:e.name,boundFilter:e.boundFilter,fieldExpr:e.fieldExpr?P.deserializeExpr(e.fieldExpr):void 0,asAggregation:e.asAggregation,isLegacySingleSelection:e.isLegacySingleSelection}},e.prototype.deserializePodConfig=function(e){return F.isNullOrUndefinedOrWhiteSpaceString(e)?{acceptsFilterContext:0}:(void 0===(e=w.tryParseJSON(e)).acceptsFilterContext&&(e.acceptsFilterContext=0),e)},e.prototype.deserializeVisualQuery=function(e,t,r,i,a,n){var o=this.visualPlugins.capabilities(e.visualType),s=o&&o.expandCollapse&&o.expandCollapse.supportsMerge,l=o&&o.expandCollapse&&o.expandCollapse.collapseParentAfterRemovingChildLevel,o=o&&o.noDefaultProjections,r=new z(t,this.convertProjections(r,t.select(),a,n),b.deserializeExpansionStates(i,{supportsMerge:s,canCollapseRoot:o,collapseParentAfterRemovingChildLevel:l}));this.upgradeVisualQuery(r,e.visualType),e.query=r},e.prototype.deserializeSingleVisual=function(e,t){var r={visualType:e.visualType||e.visualConfig.visualType},i=(r.visualType,null!=e.autoSelectVisualType&&(r.autoSelectVisualType=e.autoSelectVisualType),e.visualConfig?e.visualConfig.projections:void 0),a=e.projections||{};if(i)for(var n=0,o=i;n<o.length;n++)(l=a[(s=o[n]).role])||(a[s.role]=l=[]),l.push(s);else if(a&&0<a.length)for(var s,l,i=a,a={},p=0,u=i;p<u.length;p++)(l=a[(s=u[p]).role])||(a[s.role]=l=[]),l.push(s);var i=e.prototypeQuery||(t?w.tryParseJSON(t):null),i=(i&&(t=P.deserializeQuery(i),this.deserializeVisualQuery(r,t,a,e.expansionStates,e.showAllRoles,e.queryFieldParametersByRole)),e.display),t=(null!=e.display&&(r.display=i),e.columnProperties&&(r.columnProperties=_.cloneDeep(e.columnProperties)),e.queryOptions),i=(t&&(r.queryOptions=_.cloneDeep(t)),e.syncGroup),t=(null!=i&&(r.syncGroup=_.cloneDeep(i)),e.hasDefaultSort),i=(null!=t&&(r.hasDefaultSort=t),this.visualPlugins.capabilities(r.visualType));return i&&e.objects?r.objects=x.deserializeObjects(e.objects,i.objects):(t=e.objects)&&(r.objects=x.deserializeObjects(t,null)),e.vcObjects&&(r.vcObjects=x.deserializeObjects(e.vcObjects,R.CommonObjectDescriptors),i=v.getObjectDefinition(r.vcObjects,"visualLink",void 0))&&(t=(t=e.vcObjects.visualLink[0].properties.qna)&&t.suggestedUtterances,_.isEmpty(t)||(i.properties.qna={suggestedUtterances:_.map(t,(function(e){return d.UtteranceDefinitionSerializer.deserialize(e)}))})),this.featureSwitchService.featureSwitches.mobileAuthoringFormattingUI&&this.deserializeMobileState(r,e),e.cachedFilterDisplayItems&&(r.cachedFilterDisplayItems=y.deserializeFilterLabelIdPairs(e.cachedFilterDisplayItems)),e.filterExpressionMetadata&&(r.filterExpressionMetadata=V.deserializeFilterExpressionMetadata(e.filterExpressionMetadata)),r},e.prototype.deserializeMobileState=function(e,t){t.mobileVcObjects&&(e.mobileVcObjects=x.deserializeObjects(t.mobileVcObjects,R.CommonObjectDescriptors)),t.mobileObjects&&(e.mobileObjects=x.deserializeObjects(t.mobileObjects,null==(t=this.visualPlugins.capabilities(e.visualType))?void 0:t.objects))},e.prototype.isBookmarkGroup=function(e){return void 0!==e.children},e.prototype.ensureVisualContainerGrouping=function(e,t,r,i){for(var a=0,n=e;a<n.length;a++){var o,s,l=n[a];i&&(l.parentGroup=i),!r&&f.isVisualContainer(l)&&l.parentGroup&&(o=l.layouts.withId(0),s=I.getAbsoluteVisualContainerPosition(o.position,0,l.parentGroup),o.position=s,l.parentGroup=void 0),f.isVisualContainerGroup(l)&&(t[l.name],l.children=t[l.name]||[],this.ensureVisualContainerGrouping(l.children,t,r,l))}},e.prototype.ensureGroupZIndexNormalized=function(e){if(!_.isEmpty(e)){this.ensureListOrderNormalizedInternal(e,!0,"z");for(var t=0,r=e;t<r.length;t++){var i=r[t];f.isVisualContainerGroup(i)&&this.ensureGroupZIndexNormalized(i.children)}}},e.prototype.ensureGroupTabOrderNormalized=function(e,t){_.isEmpty(e)||_.every(t,(function(e){e=e.layouts.withId(0);return e&&e.position&&null==e.position.tabOrder}))||(this.ensureGroupsHaveTabOrders(e)||this.upgradeTabOrderToHierarchy(e),this.ensureGroupTabOrderNormalizedHelper(e))},e.prototype.upgradeTabOrderToHierarchy=function(e){var i=this;_.map(e,(function(t){var e,r;f.isVisualContainerGroup(t)&&void 0===(null==(e=null==(e=t.layouts)?void 0:e.withId(0).position)?void 0:e.tabOrder)&&(i.upgradeTabOrderToHierarchy(t.children),r=Number.NEGATIVE_INFINITY,f.traverseVisualContainerGroups([t],(function(e){e=null==(e=null==(e=e.layouts)?void 0:e.withId(0).position)?void 0:e.tabOrder;(r=e?_.max([r,e]):r)!==Number.NEGATIVE_INFINITY&&(t.layouts.withId(0).position.tabOrder=r)})))}))},e.prototype.ensureGroupsHaveTabOrders=function(e){for(var t=0,r=e;t<r.length;t++){var i=r[t];if(f.isVisualContainerGroup(i)){var a=i.layouts.withId(0);if(void 0===(null==(a=null==a?void 0:a.position)?void 0:a.tabOrder))return!1;if(!this.ensureGroupsHaveTabOrders(i.children))return!1}}return!0},e.prototype.ensureGroupTabOrderNormalizedHelper=function(e){this.ensureTabOrderNormalized(e,!0),this.ensureTabOrderNormalized(e,!1);for(var t=0,r=e;t<r.length;t++){var i=r[t];f.isVisualContainerGroup(i)&&this.ensureGroupTabOrderNormalizedHelper(i.children)}},e.prototype.ensureListOrderNormalized=function(e,t){void 0===t&&(t=!0),_.isEmpty(e)||(t&&this.ensureListOrderNormalizedInternal(e,!0,"z"),_.every(e,(function(e){e=e.layouts.withId(0);return e&&e.position&&null==e.position.tabOrder})))||(this.ensureTabOrderNormalized(e,!0),this.ensureTabOrderNormalized(e,!1))},e.prototype.ensureTabOrderNormalized=function(e,t){var r=this,e=_.filter(e,(function(e){e=r.getListOrderPropertyFunction(e,"tabOrder");return t?0<=e||void 0===e:e&&e<0}));this.ensureListOrderNormalizedInternal(e,t,"tabOrder")},e.prototype.getListOrderPropertyFunction=function(e,t){e=e.layouts.withId(0);return e&&e.position&&e.position[t]},e.prototype.setListOrderPropertyFunction=function(e,t,r){e=e.layouts.withId(0);e&&e.position&&(e.position[t]=r)},e.prototype.ensureListOrderNormalizedInternal=function(e,t,r){var i=this,a=this.canvasListOrderNormalizeService.getContainerListOrders(e,(function(e){return i.getListOrderPropertyFunction(e,r)}));this.canvasListOrderNormalizeService.shouldNormalizeListOrder(a,t)&&(a=this.canvasListOrderNormalizeService.normalizeListOrder(a,t,(function(e){return i.getListOrderPropertyFunction(e,r)})),this.updateListOrders(e,a,r))},e.prototype.updateListOrders=function(e,t,r){for(var i=0,a=e;i<a.length;i++){var n=a[i],o=t[n.name];null!=o&&o!==this.getListOrderPropertyFunction(n,r)&&this.setListOrderPropertyFunction(n,r,o)}},e.prototype.ensureNames=function(e){for(var t,r=e.length,i={},a=0;a<r;a++){var n=e[a].name;_.isEmpty(n)?t=!0:i[n]=!0}if(t)for(a=0;a<r;a++){var o=e[a],s=o.name;_.isEmpty(s)&&(o.name=I.nextUniqueName(i),i[o.name]=!0)}},e.prototype.convertProjections=function(e,t,r,i){for(var a={},n=_.keys(i),o=_.keys(e),s=0,l=_.union(n,o);s<l.length;s++){var p=l[s],u=_.includes(r,p);a[p]=this.convertProjectionArray(e[p],t,u,i?i[p]:void 0)}return a},e.prototype.convertProjectionArray=function(e,t,r,i){var a,n=[];if(!_.isEmpty(e))for(var o=0,s=e;o<s.length;o++){var l=s[o],p=this.convertProjection(l,t);l.active&&(a=a||[]).push(p.queryRef),n.push(p)}var u=[];if(!_.isEmpty(i))for(var c=0,d=i;c<d.length;c++){var m=d[c],m={index:m.index,length:m.length,expr:P.deserializeExpr(m.expr)};u.push(m)}return new M(n,a,r,u)},e.prototype.convertProjection=function(e,t){var r=e.queryRef,t={queryRef:r=_.isNumber(e.queryRef)?t[e.queryRef].name:r};return e.format&&(t.format=e.format),e.hidden&&(t.hidden=!0),t},e.prototype.serializeExploration=function(e,t){return this.createSerializer().serializeExploration(e,t)},e.prototype.serializeModelExtensions=function(e){return this.createSerializer().serializeModelExtensions(e)},e.prototype.serializePage=function(e,t,r){return this.createSerializer().serializePage(e,t,r)},e.prototype.serializePageShallow=function(e,t,r){return this.createSerializer().serializePageShallow(e,t,r)},e.prototype.serializeVisualContainer=function(e,t){return this.createSerializer().serializeVisualContainer(e,t)},e.prototype.serializeVisualContainerGroup=function(e){return this.createSerializer().serializeVisualContainerGroup(e)},e.prototype.serializePod=function(e){return this.createSerializer().serializePod(e)},e.prototype.serializeFilterCollection=function(e){return this.createSerializer().serializeFilterCollection(e)},e.prototype.serializeResourcePackages=function(e){return this.createSerializer().serializeResourcePackages(e)},e.prototype.createSerializer=function(){return new i(this.visualPlugins,this.explorationDowngrader,this.telemetryService,this.featureSwitchService)},e.prototype.upgradeVisualQuery=function(e,t){if(t===h.visuals.plugins.filledMap.name&&e.projections[O]){var r=e.projections[O],i=e.projections.Size;if(i&&0<i.all.length)for(var a=i.all().length-1;0<=a;a--)e.removeProjection("Size",{fieldIndex:a});e.projections.Size=r,delete e.projections[O]}i=this.visualPlugins.capabilities(t);if(i){r=c.util.DrillUtils.getDrillableRoles(i),i=e.ensureDrillableRoles(r);if(!_.isEmpty(i)){for(var n={},o=0,s=i;o<s.length;o++){var l=s[o],p=e.projections[l],u=0;p&&(u=_.size(p.all())),n[l]=u}this.telemetryService.logEvent(h.telemetry.EXVisualDrillableRoleActiveItemsFixed,{visualType:t,fixedRoleByProjectionCount:JSON.stringify(n)})}}},e.prototype.upgradeResourcePackage=function(e){void 0===e.type&&(e.type=0)},e.prototype.getReferencedStaticResources=function(e){var t={},r=e.themeCollection.customTheme,i=e.themeCollection.baseTheme;if(this.addItemReference(t,e.resourcePackages,r&&r.type,r&&r.name),this.addItemReference(t,e.resourcePackages,i&&i.type,i&&i.name),!_.isEmpty(e.sections))for(var a=0,n=e.sections;a<n.length;a++){var o=n[a];if(d.StaticResourceReferences.addObjectsReferences(o.objects,f.Section.objectDescriptors,e.resourcePackages,t),!_.isEmpty(o.visualContainers))for(var s=0,l=o.visualContainers;s<l.length;s++){var p=l[s].config.singleVisual,u=p.objects,p=this.visualPlugins.capabilities(p.visualType);d.StaticResourceReferences.addObjectsReferences(u,p&&p.objects,e.resourcePackages,t)}}return t},e.prototype.addItemReference=function(e,t,r,i){var a;i&&r&&(t=u.findItemInPackages(t,r,i))&&(a=u.ensurePackageName(r),d.StaticResourceReferences.addItemReference(e,a,r,i,t.type))},e.prototype.parseExplorationConfigs=function(e){var t,r=this;if(e)return(t=this.parseConfig(e)).sections=_.map(e.sections,(function(e){return r.parsePageConfigs(e)})),t},e.prototype.parseConfig=function(e){var t=_.clone(e);return t.config=w.tryParseJSON(e.config)||{},t},e.prototype.parsePageConfigs=function(e){var t=this,r=this.parseConfig(e);return r.visualContainers=_.map(e.visualContainers,(function(e){return t.parseConfig(e)})),r},e.prototype.stringifyExplorationConfigs=function(e){var t=this,r=this.stringifyConfig(e);return r.sections=_.map(e.sections,(function(e){return t.stringifyPageConfigs(e)})),r},e.prototype.stringifyConfig=function(e){var t=_.clone(e);return t.config=JSON.stringify(e.config),t},e.prototype.stringifyPageConfigs=function(e){var t=this,r=this.stringifyConfig(e);return r.visualContainers=_.map(e.visualContainers,(function(e){return t.stringifyConfig(e)})),r},e.prototype.parseFilterCollectionConfig=function(e){if(e)return this.parseConfig(e)},e.prototype.stringifyFilterCollectionConfig=function(e){if(e)return this.stringifyConfig(e)},L=e,k=N.v5_37,d.getOldestSaveVersion=function(){return k},d.setOldestSaveVersion=function(e){k=e},r.prototype.serializeExploration=function(e,r){var t,i=this,a=e.sections,a=(r&&r.withTransientPages||(a=f.Section.filterTransient(a)),_.map(a,(function(e,t){return i.serializePage(e,t,r)}))),n=(_.isEmpty(e.pods)||(this.removeInvalidPods(e.sections,e.pods,this.telemetryService),t=_.map(e.pods,(function(e){return i.serializePod(e)}))),this.serializeExplorationShallowWithResourcePackages(e,r));if(n.sections=a,n.pods=t,!r||!r.forSave){var o=e.activeBookmark;if(o)for(var s=0,l=null!=(a=n.config.bookmarks)?a:[];s<l.length;s++){var p=l[s];if(void 0===p.children&&p.name===o.name){n.activeBookmark=p;break}}}return r&&r.forSave&&this.explorationDowngrader.downgrade(n,this.version),n},r.prototype.serializeBookmarks=function(e,r){var i=this;if(e){var a=n.v1_0,e=_.map(e,(function(e){if(g.isBookmarkGroup(e))return t={displayName:e.displayName,name:e.name,children:i.serializeBookmarks(e.children,r)},i.version=D.max(i.version,E.BookmarkGroup),t;d.ExplorationState.clearUnusedReferences(e.explorationState,r);var t={displayName:e.displayName,name:e.name,explorationState:d.ExplorationState.serialize(e.explorationState,i.featureSwitchService)};return a=D.max(t.explorationState.version,a),e.options&&(t.options=i.serializeBookmarkOptions(e.options),i.version=D.max(i.version,E.BookmarkOptions)),t}));switch(a){case n.v1_0:this.version=D.max(this.version,E.bookmarks);break;case n.v1_1:this.version=D.max(this.version,E.ExplorationState_v1_1);break;case n.v1_2:this.version=D.max(this.version,E.ExplorationState_v1_2);break;case n.v1_3:this.version=D.max(this.version,E.ExplorationState_v1_3);break;case n.v1_4:this.version=D.max(this.version,E.ExplorationState_v1_4);break;case n.v1_5:this.version=D.max(this.version,E.VisualFilterExpressionMetadata);break;case n.v1_6:this.version=D.max(this.version,E.AllowInlineExploration);break;case t.FieldParameters:this.version=D.max(this.version,E.QueryFieldParameters);break;case t.OnObject:this.version=D.max(this.version,E.OnObject)}return e}},r.prototype.serializeBookmarkOptions=function(e){return e},r.prototype.serializeQnaAction=function(e){if(e){e=e.suggestedUtterances;if(!_.isEmpty(e))return{suggestedUtterances:_.map(e,(function(e){return d.UtteranceDefinitionSerializer.serialize(e)}))}}},r.prototype.serializeExplorationShallowWithResourcePackages=function(e,t){var r=e.activeSectionIndex,i=this.createVersionedElementConfig(k),r=(this.version=D.max(this.version,i.version),i.themeCollection=j.cloneThemeCollection(e.themeCollection),_.isNumber(r)&&(i.activeSectionIndex=r),_.isEmpty(e.modelExtensions)||(this.version=D.max(this.version,N.v3_0),i.modelExtensions=this.serializeModelExtensions(e.modelExtensions)),_.isEmpty(e.bookmarks)||(r=this.serializeBookmarks(e.bookmarks,e),i.bookmarks=r),t&&t.excludeHighContrastTheme&&delete i.themeCollection.highContrastTheme,t&&t.forSave&&delete i.themeCollection.transientUserSetTheme,e.themeCollection.baseTheme),r=(r&&(this.version=D.max(this.version,h.explore.util.ThemeUtils.getVersionForBaseTheme(r.name))),F.isNullOrUndefinedOrWhiteSpaceString(e.dataSourceVariables)||(this.version=D.max(this.version,N.v4_2),i.dataSourceVariables=e.dataSourceVariables),e.tags&&(i.tags=e.tags),null!=e.defaultDrillFilterOtherVisuals&&(i.defaultDrillFilterOtherVisuals=e.defaultDrillFilterOtherVisuals,e.defaultDrillFilterOtherVisuals)&&(this.version=D.max(this.version,E.SectionCrossDrill)),null!=e.filterSortOrder&&(i.filterSortOrder=e.filterSortOrder,e.filterSortOrder)&&(this.version=D.max(this.version,E.FiltersSort)),e.slowDataSourceSettings&&(((r=_.cloneDeep(e.slowDataSourceSettings)).isCrossHighlightingDisabled||r.isFieldWellButtonEnabled||r.isFilterSelectionsButtonEnabled||r.isSlicerSelectionsButtonEnabled||r.isApplyAllButtonEnabled)&&(this.version=r.isApplyAllButtonEnabled?D.max(this.version,E.ApplyAll):D.max(this.version,E.slowDataSource)),i.slowDataSourceSettings=r),null!=e.linguisticSchemaSyncVersion&&(i.linguisticSchemaSyncVersion=e.linguisticSchemaSyncVersion,e.linguisticSchemaSyncVersion!==o.Unspecified)&&(this.version=D.max(this.version,E.LinguisticSchemaSyncVersion)),e.settings&&(((r=_.cloneDeep(e.settings)).isPersistentUserStateDisabled||r.hideVisualContainerHeader)&&(this.version=D.max(this.version,E.ExplorationSettings)),r.useStylableVisualContainerHeader&&(this.version=D.max(this.version,E.StylableVisualContainerHeader)),void 0!==r.exportDataMode&&0!==r.exportDataMode&&(this.version=D.max(this.version,E.ExportDataMode)),r.useNewFilterPaneExperience&&(this.version=D.max(this.version,E.NewFilterPaneExperience)),r.isReportAnnotationsDisabled&&(this.version=D.max(this.version,E.ReportAnnotations)),!0===r.defaultFilterActionIsDataFilter&&(this.version=D.max(this.version,E.DefaultFilterAction)),r.useCrossReportDrillthrough&&(this.version=D.max(this.version,E.CrossReportDrillthrough)),r.allowChangeFilterTypes&&(this.version=D.max(this.version,E.AllowChangeFilterTypes)),r.allowInlineExploration&&(this.version=D.max(this.version,E.AllowInlineExploration)),r.optOutNewFilterPaneExperience&&(this.version=D.max(this.version,E.MigrateFilterPaneExperience)),r.filterPaneHiddenInEditMode&&(this.version=D.max(this.version,E.FilterPaneHiddenInEditMode)),r.disableFilterPaneSearch&&(this.version=D.max(this.version,E.DisableFilterPaneSearch)),r.pagesPosition&&(this.version=D.max(this.version,E.PagesPosition)),r.useEnhancedTooltips&&(this.version=D.max(this.version,E.EnhancedTooltips)),r.useScaledTooltips&&(this.version=D.max(this.version,E.ScaledTooltip)),r.allowAutomatedInsightsNotification&&(this.version=D.max(this.version,E.AllowAutomatedInsightsNotification)),r.useDefaultAggregateDisplayName&&(this.version=D.max(this.version,E.DefaultAggregateDisplayName)),r.pauseQueries&&(this.version=D.max(this.version,E.PauseVisualQueries)),(r.queryLimitOption||r.customMemoryLimit||r.customTimeoutLimit)&&(this.version=D.max(this.version,E.QueryLimitOptions)),i.settings=r),e.objects&&(i.objects=this.serializeObjects(e.objects,f.ExplorationObjectDescriptors,"report")),t&&t.forSave?this.version=this.explorationDowngrader.getFinalExplorationVersion(e,this.version):this.version=a,this.serializeFilterContainers(e.filters,t));return e.creationSource&&(i.creationSource=e.creationSource,this.version=D.max(this.version,E.QuickExplore)),i.version=this.version,{id:e.id,report:e.report,reportId:e.reportId,theme:e.themeCollection.customTheme&&e.themeCollection.customTheme.name,filters:r,resourcePackages:this.serializeResourcePackages(e.resourcePackages,t),sections:void 0,config:i,layoutOptimization:this.getLayoutOptimizations(e),publicCustomVisuals:e.publicCustomVisuals}},r.prototype.serializeLinkField=function(e){var t=e.fieldExpr;return{asAggregation:e.asAggregation,fieldExpr:P.serializeExpr(t)}},r.prototype.serializeFilterCollection=function(e){var t;if(!_.isEmpty(e))return t=this.createVersionedElementConfig(k),{filters:this.serializeFilterContainers(e),config:t}},r.prototype.serializePage=function(e,t,r){var i=this.serializePageShallow(e,t,r);if(i.visualContainers=[],e.visualContainerGroups)this.serializeVisualContainerTreeToList(e.visualContainerGroups,i.visualContainers,r);else for(var a=0,n=e.visualContainers;a<n.length;a++){var o=n[a];i.visualContainers.push(this.serializeVisualContainer(o,r))}return i},r.prototype.serializeVisualContainerTreeToList=function(e,t,r){for(var i=!1,a=0,n=e;a<n.length;a++){var o=n[a];f.isVisualContainerGroup(o)?(i||(this.version=D.max(d.upgrade.ExplorationVersionHelper.getVersionForVisualContainerGroup(o),this.version),i=!0),t.push(this.serializeVisualContainerGroup(o)),this.serializeVisualContainerTreeToList(o.children,t,r)):t.push(this.serializeVisualContainer(o,r))}},r.prototype.isRegularPageUsingMeasureDrillthrough=function(e){var t=!1,r=!1;return e.type&&0!==e.type||(t=!0===e.acceptsAllFiltersWhenLinked,r=_.some(e.filters,(function(e){return e&&5===e.howCreated&&!e.isTransient&&(e.isLinkedAsAggregation||e.expression&&T.isMeasure(e.expression))}))),t||r},r.prototype.isMeasureDrillthroughPod=function(e){var t=!1,r=!1;return 1===e.type&&(t=e.config&&0===e.config.acceptsFilterContext,r=_.some(e.parameters,(function(e){return e.asAggregation||e.fieldExpr&&T.isMeasure(e.fieldExpr)}))),t||r},r.prototype.serializePageShallow=function(e,t,r){var i=this,t={id:e.id,name:e.name,displayName:e.displayName,filters:this.serializeFilterContainers(e.filters,r),ordinal:t,visualContainers:void 0,transient:e.transient,objectId:e.objectId,config:{}},a=(e.size&&(t.displayOption=e.size.displayOption,t.width=e.size.width,t.height=e.size.height),null!=r&&r.forSave||!e.originalSize||(t.originalDisplayOption=e.originalSize.displayOption,t.originalWidth=e.originalSize.width,t.originalHeight=e.originalSize.height),t.config);return _.isEmpty(e.relationships)||(a.relationships=this.serializeRelationships(e.relationships),r&&r.featureUsage&&(r.featureUsage.hasVisualRelationships=!0)),e.objects&&(a.objects=this.serializeObjects(e.objects,f.Section.objectDescriptors,"page")),null!=e.visibility&&(a.visibility=e.visibility,this.version=D.max(this.version,E.SectionVisibility)),null!=e.type&&(a.type=e.type,this.version=D.max(this.version,E.CanvasTooltips)),null!=e.filterSortOrder&&(a.filterSortOrder=e.filterSortOrder,this.version=D.max(this.version,E.FiltersSort)),a.acceptsAllFiltersWhenLinked=e.acceptsAllFiltersWhenLinked,this.isRegularPageUsingMeasureDrillthrough(e)&&(this.version=D.max(this.version,E.MeasureDrillthrough)),_.isEmpty(e.linkFields)||(a.linkFields=_.map(e.linkFields,(function(e){return i.serializeLinkField(e)})),this.version=D.max(this.version,E.CanvasTooltips)),e.dynamicConfig&&(a.dynamicConfig=this.serializePageDynamicConfig(e.dynamicConfig),this.version=D.max(this.version,E.QuickExplore),null!=(r=a.dynamicConfig.quickExplore))&&r.layout&&(this.version=D.max(this.version,E.QuickExploreLayout)),t},r.prototype.serializePod=function(e){var t=this.serializePodParameters(e.parameters);return this.isMeasureDrillthroughPod(e)&&(this.version=D.max(this.version,E.MeasureDrillthrough)),1===e.referenceScope&&(this.version=D.max(this.version,E.CrossReportDrillthrough)),{id:e.id,name:e.name,boundSection:e.boundSection,parameters:_.isEmpty(t)?void 0:JSON.stringify(t),cortanaEnabled:e.cortanaEnabled||void 0,type:0!==e.type?e.type:void 0,referenceScope:0!==e.referenceScope?e.referenceScope:void 0,config:this.serializePodConfig(e.config)}},r.prototype.serializeVisualContainer=function(e,t){_.forEach(e.layouts,(function(e){e.position&&q(e.position)}));var r,i=this.serializeVisualContainerConfig(e,t),a=e.layouts&&e.layouts.withId(0);return a?(a.position,r={id:e.id,x:a.position.x,y:a.position.y,z:a.position.z,width:a.position.width,height:a.position.height,config:i,filters:this.serializeFilterContainers(e.filters)},a.position.tabOrder&&(r.tabOrder=a.position.tabOrder)):r={id:e.id,config:i,filters:this.serializeFilterContainers(e.filters)},_.isEmpty(e.filters)||(a=this.visualPlugins.capabilities(e.config.singleVisual.visualType),c.FilterUtils.supportsFilterOutput(a)&&(this.version=D.max(this.version,E.VisualLevelSlicerFilters))),t&&t.withVisibility&&(null!=e.visibility&&(r.visibility=e.visibility),null!=e.detailVisualLayout)&&(r.detailVisualLayout=e.detailVisualLayout),t&&e.cachedData&&((t.withQuery||t.withData)&&(r.query=e.cachedData.queryObject?JSON.stringify(e.cachedData.queryObject):e.cachedData.query,r.dataTransforms=e.cachedData.transformsObject?h.data.services.DataViewTransformActionsSerializer.serializeTransformActions(e.cachedData.transformsObject):e.cachedData.transforms,r.dataUpdatedTime=e.cachedData.dataUpdatedTime?e.cachedData.dataUpdatedTime.toISOString():void 0),t.withData)&&(r.dataBinaryBase64Encoded=e.cachedData.dataObject?jsCommon.GzipUtility.compress(JSON.stringify(e.cachedData.dataObject)):e.cachedData.data),r},r.prototype.serializeVisualContainerGroup=function(e){this.version=D.max(this.version,E.VisualContainerGrouping);var t,r={name:e.name,layouts:_.cloneDeep(e.layouts),singleVisualGroup:{displayName:e.displayName,groupMode:e.groupMode,isHidden:e.isHidden}},i=(e.parentGroup&&(r.parentGroupName=e.parentGroup.name),e.objects&&(r.singleVisualGroup.objects=this.serializeObjects(e.objects,A.objectDescriptors,A.objectType)),e.layouts&&e.layouts.withId(0));return i?(i.position,t={id:e.id,x:i.position.x,y:i.position.y,z:i.position.z,width:i.position.width,height:i.position.height,config:r},this.featureSwitchService.featureSwitches.accessibilityTopLevelNav&&i.position.tabOrder&&(t.tabOrder=i.position.tabOrder)):t={id:e.id,config:r},t},r.prototype.serializeModelExtensions=function(e){var t=this;if(e)return _.map(e,(function(e){return{name:e.name,extends:e.extends,entities:t.serializeModelExtensionEntities(e.entities)}}))},r.prototype.serializeRelationship=function(e){return e.source.name,e.target.name,{source:e.source.name,target:e.target.name,type:e.type}},r.prototype.serializeVisualContainerConfig=function(e,t){var r=e.config&&e.config.singleVisual,i=(e.name,r.visualType,r.query),a=i?i.projections:void 0,n={name:e.name,layouts:_.cloneDeep(e.layouts),singleVisual:{visualType:r.visualType,projections:this.serializeQueryProjections(a),prototypeQuery:i?P.serializeQuery(i.defn):void 0}},o=(this.featureSwitchService.featureSwitches.visualCalculations&&(o=i)&&o.defn.select().some((function(e){return T.isNativeVisualCalc(e.expr)}))&&(this.version=D.max(this.version,E.VisualCalculations)),null!=r.autoSelectVisualType&&(this.version=D.max(this.version,E.OnObject),n.singleVisual.autoSelectVisualType=r.autoSelectVisualType),this.serializeQueryFieldParameters(a)),a=(_.isEmpty(o)||(this.version=D.max(this.version,E.QueryFieldParameters),n.singleVisual.queryFieldParametersByRole=o),_.some(e.layouts,(function(e){return e.position&&void 0!==e.position.tabOrder}))&&(this.version=D.max(this.version,E.AccessibilityTopLevelNav)),i&&S.hasExpansionState(i.expansionStates)&&(a=b.serializeExpansionStates(i.expansionStates),_.isEmpty(a)||(n.singleVisual.expansionStates=a,this.version=D.max(this.version,E.ExpandCollapse))),r.columnProperties);if(a&&!_.isEmpty(a)&&(this.version=D.max(this.version,N.v3_4),n.singleVisual.columnProperties=_.cloneDeep(a)),r.queryOptions&&(null!=r.queryOptions.allowBinnedLineSample&&(this.version=D.max(this.version,N.v3_3)),null!=r.queryOptions.allowOverlappingPointsSample&&(this.version=D.max(this.version,N.v3_5)),null!=r.queryOptions.keepProjectionOrder&&(this.version=D.max(this.version,N.v4_1)),n.singleVisual.queryOptions=_.cloneDeep(r.queryOptions)),r.display&&(this.version=D.max(this.version,E.visualHidden),n.singleVisual.display=_.cloneDeep(r.display)),i&&i.defn){r.visualType===h.visuals.plugins.slicer.name&&(a=i.projections)&&a[h.visuals.slicerRoles.value]&&1<a[h.visuals.slicerRoles.value].all().length&&(this.version=D.max(this.version,E.HierarchicalSlicer)),I.isSmallMultiplesVisual(r)&&(_.some(m,(function(e){return e===r.visualType}))?this.version=D.max(this.version,E.CartesianSmallMultiplesCombo):this.version=D.max(this.version,E.CartesianSmallMultiples));for(var s=0,l=i.defn.select();s<l.length;s++){var p=l[s];this.version=D.max(this.version,d.upgrade.ExplorationVersionHelper.getVersionForSQExpr(p.expr))}this.version=D.max(this.version,d.upgrade.ExplorationVersionHelper.getVersionForSortDefinitions(i.defn.orderBy()))}var u,a=this.serializeShowAllRoles(i?i.projections:void 0),a=(_.isEmpty(a)||(n.singleVisual.showAllRoles=a,t&&t.featureUsage&&(t.featureUsage.hasShowAllEnabled=!0)),r.visualType===h.visuals.plugins.ribbonChart.name&&(this.version=D.max(this.version,N.v3_5)),r.visualType===h.visuals.plugins.actionButton.name&&(this.version=D.max(this.version,E.ActionButton)),r.visualType===h.visuals.plugins.pythonVisual.name&&(this.version=D.max(this.version,N.v3_17)),r.visualType===h.visuals.plugins.keyDriversVisual.name&&(this.version=D.max(this.version,N.v4_1),r.query)&&!_.isEmpty(r.query.tryGetExprs(h.visuals.keyDriverRoleNames.details))&&(this.version=D.max(this.version,E.KeyDriversDetails)),r.visualType===h.visuals.plugins.qnaVisual.name&&(this.version=D.max(this.version,N.v5_4)),r.visualType===h.visuals.plugins.decompositionTreeVisual.name&&(this.version=D.max(this.version,N.v5_5)),r.visualType===h.visuals.plugins.azureMap.name&&(this.version=D.max(this.version,N.v5_13)),r.visualType===h.visuals.plugins.cardVisual.name&&(this.version=D.max(this.version,E.CardVisual)),r.visualType===h.visuals.plugins.shape.name&&(this.version=D.max(this.version,E.ShapeVisual)),r.visualType===h.visuals.plugins.pageNavigator.name&&(this.version=D.max(this.version,E.NavigatorVisuals)),r.visualType===h.visuals.plugins.bookmarkNavigator.name&&(this.version=D.max(this.version,E.NavigatorVisuals)),r.visualType===h.visuals.plugins.rdlVisual.name&&(this.version=D.max(this.version,E.RdlVisual)),r.visualType===h.visuals.plugins.scorecard.name&&(this.version=D.max(this.version,E.ScorecardVisual)),r.visualType===h.visuals.plugins.aiNarratives.name&&(this.version=D.max(this.version,E.AINarratives)),r.syncGroup&&(n.singleVisual.syncGroup=_.cloneDeep(r.syncGroup),this.version=D.max(this.version,E.VisualSyncGroup)),null!=e.drillFilterOtherVisuals&&(n.singleVisual.drillFilterOtherVisuals=e.drillFilterOtherVisuals,this.version=D.max(this.version,E.SectionCrossDrill)),null!=e.filterSortOrder&&(n.singleVisual.filterSortOrder=e.filterSortOrder,this.version=D.max(this.version,E.FiltersSort)),e.parentGroup&&(n.parentGroupName=e.parentGroup.name,this.version=D.max(this.version,E.VisualContainerGrouping)),r.hasDefaultSort&&(n.singleVisual.hasDefaultSort=r.hasDefaultSort),i?r.query.defn.select():jsCommon.ArrayExtensions.createWithName()),e=(r.objects&&(i=(e=this.visualPlugins.capabilities(r.visualType))&&e.objects,n.singleVisual.objects=this.serializeObjects(r.objects,i,r.visualType,a),(e=r).visualType===h.visuals.plugins.scatterChart.name&&e.query&&e.query.projections.Play&&!_.isEmpty(e.query.projections.Play.all())&&(u=!1,v.visitPropertyDefinitions(r.objects,i,(function(e,t,r,i,a){"fill"===t&&"dataPoint"===i&&null!=r&&(u=!0)})),u)&&(this.version=D.max(this.version,N.v5_1)),this.supportsScalarMarkers(r))&&D.lt(this.version,E.LineChartExplicitDots)&&this.upgradeIfScalarMarkersAreSet(r.objects),r.vcObjects);return e&&(n.singleVisual.vcObjects=this.serializeObjects(e,R.CommonObjectDescriptors,r.visualType,a),a=(i=v.getObjectDefinition(e,"visualLink",void 0))&&i.properties.qna)&&(n.singleVisual.vcObjects.visualLink[0].properties.qna=this.serializeQnaAction(a)),this.featureSwitchService.featureSwitches.mobileAuthoringFormattingUI&&this.serializeMobileState(r,n.singleVisual,null==t?void 0:t.forSave),r.cachedFilterDisplayItems&&(n.singleVisual.cachedFilterDisplayItems=y.serializeFilterLabelIdPairs(r.cachedFilterDisplayItems)),r.filterExpressionMetadata&&(n.singleVisual.filterExpressionMetadata=V.serializeFilterExpressionMetadata(r.filterExpressionMetadata,this.featureSwitchService.featureSwitches.serializeSpaceOptimization),this.version=D.max(this.version,E.VisualFilterExpressionMetadata)),this.version<E.DotPlotVisual&&(function(e){if(e.visualType===h.visuals.plugins.scatterChart.name){var t=h.visuals.scatterRoleNames.x,e=e.query,r=e?e.getRolesProjectionRefs([t]):void 0,r=_.size(r);if(1<r)return 1;if(1===r){r=e.tryGetExpr(t,0);if(r&&!U.isMeasure(r))return 1}}return})(r)&&(this.version=E.DotPlotVisual),n},r.prototype.serializeMobileState=function(e,t,r){r||(e.mobileVcObjects&&(t.mobileVcObjects=x.serializeObjects(e.mobileVcObjects,R.CommonObjectDescriptors,this.featureSwitchService.featureSwitches.serializeSpaceOptimization)),e.mobileObjects&&(t.mobileObjects=x.serializeObjects(e.mobileObjects,null==(r=this.visualPlugins.capabilities(e.visualType))?void 0:r.objects,this.featureSwitchService.featureSwitches.serializeSpaceOptimization)))},r.prototype.serializeObjects=function(e,t,r,i){var a=x.serializeObjects(e,t,this.featureSwitchService.featureSwitches.serializeSpaceOptimization);return this.isAtLatestVersion()||(this.version=D.max(this.version,d.upgrade.getVersionForObjectDefinitions(e,t,r,this.version,i))),a},r.prototype.isAtLatestVersion=function(){return this.version===a},r.prototype.serializeShowAllRoles=function(e){if(e)return e=_.pickBy(e,(function(e){return!0===e.showAll})),_.keys(e)},r.prototype.serializeQueryProjections=function(e){if(e){var t,r={};for(t in e){var i=e[t].all(),a=e[t].activeProjectionRefs;if(0<i.length){r[t]=[];for(var n=0,o=i;n<o.length;n++){var s=o[n],l=s.queryRef,p={queryRef:l};s.format&&(p.format=s.format),_.includes(a,l)&&(p.active=!0),s.hidden&&(p.hidden=s.hidden,this.version=D.max(this.version,E.VisualCalculations)),r[t].push(p)}}}return r}},r.prototype.serializeQueryFieldParameters=function(e){if(e){var t,r={};for(t in e){var i=e[t].getFieldParameters();if(0<i.length){r[t]=[];for(var a=0,n=i;a<n.length;a++){var o=n[a],o={index:o.index,length:o.length,expr:P.serializeExpr(o.expr)};r[t].push(o)}}}return r}},r.prototype.serializeModelExtensionEntities=function(e){var r=this;if(e)return _.map(e,(function(e){var t={name:e.name};return e.extends&&(t.extends=e.extends),e.measures&&(t.measures=r.serializeModelExtensionMeasures(e.measures)),t}))},r.prototype.serializeExpressionReferences=function(e){var t;if(e&&(e.unrecognizedReferences||!_.isEmpty(e.measures)))return t={unrecognizedReferences:e.unrecognizedReferences},_.isEmpty(e.measures)||(t.measures=e.measures),t},r.prototype.serializeModelExtensionAnnotations=function(e){if(e)return _.map(e,(function(e){return{name:e.name,value:e.value}}))},r.prototype.serializeModelExtensionMeasures=function(e){var r=this;if(e)return _.map(e,(function(e){var t={name:e.name,dataType:e.dataType,dataCategory:e.dataCategory,expression:e.expression,errorMessage:e.errorMessage,hidden:e.hidden,references:r.serializeExpressionReferences(e.references),formulaOverride:e.formulaOverride,formatInformation:e.formatInformation,displayFolder:e.displayFolder};return e.annotations&&(t.annotations=r.serializeModelExtensionAnnotations(e.annotations)),e.measureTemplate&&(t.measureTemplate={daxTemplateName:e.measureTemplate.daxTemplateName,version:e.measureTemplate.version}),e.description&&(t.description=e.description,r.version=D.max(r.version,E.description)),t}))},r.prototype.serializeFilterContainers=function(e,t){if(e){for(var r=[],i=0,a=e;i<a.length;i++){var n,o=a[i];o&&(0!==o.howCreated||c.FilterUtils.isFilterModified(o))&&(!o.isTransient||t&&t.withTransientFilters)&&(7===o.howCreated&&t&&t.forSave&&(o.howCreated=1),5===o.howCreated&&(this.version=D.max(this.version,N.v3_5)),o.isHiddenInViewMode&&(this.version=D.max(this.version,E.FilterContainerVisibilityControl)),o.isLockedInViewMode&&(this.version=D.max(this.version,E.FilterContainerVisibilityControl)),o.displayName&&(this.version=D.max(this.version,E.RenameFilters)),o.ordinal&&(this.version=D.max(this.version,E.FiltersSort)),o.type===f.FilterType.RelativeTime&&(this.version=D.max(this.version,E.RelativeTimeFilter)),o.type===f.FilterType.Advanced&&null!=(n=o.filter)&&n.conditions().some((function(e){e=h.data.SQExpr.isNot(e)?e.arg:e;return h.data.SQExpr.isCompare(e)&&h.data.SQExpr.isConstantText(e.right)&&""===e.right.value}))&&(this.version=D.max(this.version,E.IsEmptyFilterOperator)),!o.filterExpressionMetadata||_.isEmpty(o.filterExpressionMetadata.expressions)||_.isEmpty(o.filterExpressionMetadata.cachedValueItems)||(_.isEmpty(o.filterExpressionMetadata.jsonFilter)?this.version=D.max(this.version,E.FilterContainerFilterMetadata):this.version=D.max(this.version,E.GokSupportForCV)),n=o.filterExpressionMetadata?V.serializeFilterExpressionMetadata(o.filterExpressionMetadata,this.featureSwitchService.featureSwitches.serializeSpaceOptimization):void 0,r.push({name:o.name,expression:o.expression?P.serializeExpr(o.expression):void 0,filter:o.filter?P.serializeFilter(o.filter):void 0,type:f.FilterType[o.type],restatement:o.restatement,cachedDisplayNames:y.serializeFilterLabelIdPairs(o.cachedValueItems),howCreated:o.howCreated,isLinkedAsAggregation:o.isLinkedAsAggregation,isTransient:o.isTransient,objects:o.objects?this.serializeObjects(o.objects,l,s):void 0,isHiddenInViewMode:o.isHiddenInViewMode,isLockedInViewMode:o.isLockedInViewMode,filterExpressionMetadata:n,displayName:o.displayName,ordinal:o.ordinal}))}return JSON.stringify(r)}},r.prototype.createVersionedElementConfig=function(e){return{version:e}},r.prototype.serializeResourcePackages=function(e,a){if(!_.isEmpty(e)){for(var n=[],t=0,r=e;t<r.length;t++)!(function(e){var t,r,i=_.find(e.items,(function(e){return e.type===B.CustomVisualMetadata})),i=(i&&void 0!==i.content&&(t=_.isString(i.content)?jsCommon.JsonExtensions.tryParseJSON(i.content):i.content)&&(t.content=void 0,i.content=JSON.stringify(t)),e.items);i&&(r=["contentBlob","contentBlobUrl","promise"],a&&a.excludeResourceItemContent&&r.push("content"),i=_.map(i,(function(e){return _.omit(e,r)}))),n.push({resourcePackage:{id:e.id,name:e.name,type:e.type,items:i,disabled:!!e.disabled}})})(r[t]);return n}},r.prototype.getLayoutOptimizations=function(e){e=this.getDistinctLayouts(e);return this.getLayoutOptimizationFromLayouts(e)},r.prototype.getLayoutOptimizationFromLayouts=function(e){for(var t=0,r=0,i=e;r<i.length;r++)1===i[r].id&&(t|=1);return t},r.prototype.getDistinctLayouts=function(e){for(var e=e.sections,t=p.createWithId(),r=0,i=e;r<i.length;r++)for(var a=0,n=i[r].visualContainers;a<n.length;a++)for(var o=0,s=n[a].layouts;o<s.length;o++){var l=s[o];t.withId(l.id)||t.push(l)}return t},r.prototype.serializePodParameters=function(e){if(!_.isEmpty(e)){for(var t=[],r=0,i=e;r<i.length;r++){var a=i[r];t.push({name:a.name,boundFilter:a.boundFilter,fieldExpr:a.fieldExpr?P.serializeExpr(a.fieldExpr):void 0,asAggregation:a.asAggregation||void 0,isLegacySingleSelection:a.isLegacySingleSelection||void 0})}return t}},r.prototype.serializePodConfig=function(e){return _.isEmpty(e)||0===e.acceptsFilterContext?"{}":JSON.stringify(e)},r.prototype.serializeRelationships=function(e){if(!_.isEmpty(e)){for(var t,r=0,i=e;r<i.length;r++){var a=i[r],a=this.serializeRelationship(a);a&&(t=t||[]).push(a)}return t}},r.prototype.removeInvalidPods=function(e,n,t){var o,r=_.map(e,(function(e){return e.name})),i=_.remove(n,(function(e){return!_.includes(r,e.boundSection)})),i=_.size(i);0<i&&t.logEvent(h.telemetry.PodSerializationErrorFixed,{errorType:"NonExistingBoundSection",count:i}),_.size(n)<=_.size(e)||(i=_.groupBy(n,(function(e){return e.boundSection})),o=0,_.forEach(i,(function(e){var t=e.length;if(1<t){o++;for(var r=e[0].boundSection,i=_.findLastIndex(n,(function(e){return e.boundSection===r})),a=t-1;0<a&&0<=i;)n.splice(i,1),a--,i=_.findLastIndex(n,(function(e){return e.boundSection===r}),i-1)}})),0<o&&t.logEvent(h.telemetry.PodSerializationErrorFixed,{errorType:"DuplicateBoundSection",count:o}),0<(i=_.size(n)-_.size(e))&&(n=n.slice(0,_.size(e)),t.logEvent(h.telemetry.PodSerializationErrorFixed,{errorType:"ExceedingPodsNumberAfterInitialFix",count:i})))},r.prototype.supportsScalarMarkers=function(t){var e=[h.visuals.plugins.lineChart.name,h.visuals.plugins.areaChart.name,h.visuals.plugins.stackedAreaChart.name];return _.some(e,(function(e){return e===t.visualType}))},r.prototype.upgradeIfScalarMarkersAreSet=function(e){var t=v.getValue(e,{objectName:"categoryAxis",propertyName:"axisType"},null);t&&"Scalar"===h.data.SQConstantExpr.getTextValue(t)&&(t=v.getValue(e,{objectName:"lineStyles",propertyName:"showMarker"},null))&&h.data.SQConstantExpr.getBooleanValue(t)&&(this.version=D.max(this.version,E.LineChartExplicitDots))},r.prototype.serializePageDynamicConfig=function(e){var t,r,i;return e.quickExplore&&(t=e.quickExplore.selectedFields,r=e.quickExplore.visualContainerConfigurations,e=e.quickExplore.layout,(i=i||{}).quickExplore={selectedFields:_.map(t,(function(e){return P.serializeExpr(e)})),visualContainerConfigurations:_.map(r,(function(e){return{name:e.name,fields:_.map(e.fields,(function(e){return P.serializeExpr(e)}))}}))},e)&&(i.quickExplore.layout=this.serializeQuickExploreLayout(e),this.version=D.max(this.version,E.QuickExploreLayout)),i},r.prototype.serializeQuickExploreLayout=function(e){var t;return e.combination?(t={version:e.combination.version},e.combination.dataTableName&&(t.dataTableName=e.combination.dataTableName),{combination:t}):e.related?(t={version:e.related.version},e.related.dataTableName&&(t.dataTableName=e.related.dataTableName),{related:t}):void 0},i=r})(powerbi=powerbi||{}),(function(e){var c,d,t,r;function i(e){this.versionUpgraders=[c.v1_0.createVersionUpgrader(),c.v2_0.createVersionUpgrader(),c.v2_2.createVersionUpgrader(),c.v2_3.createVersionUpgrader(),c.v2_5.createVersionUpgrader(),c.v3_6_1.createVersionUpgrader(),c.v3_12_1.createVersionUpgrader(),c.v3_14.createVersionUpgrader(e),c.v3_14_1.createVersionUpgrader(),c.v3_15.createVersionUpgrader(),c.v3_18.createVersionUpgrader(),c.v3_19.createVersionUpgrader(),c.v3_20.createVersionUpgrader(e),c.v3_24.createVersionUpgrader(),c.v4_1.createVersionUpgrader(),c.v4_2.createVersionUpgrader(),c.v5_1.createVersionUpgrader(),c.v5_3.createVersionUpgrader(),c.v5_9.createVersionUpgrader(e),c.v5_11.createVersionUpgrader(),c.v5_16.createVersionUpgrader(e),c.v5_25.createVersionUpgrader(e),c.v5_28.createVersionUpgrader(),c.v5_31.createVersionUpgrader(e),c.v5_33.createVersionUpgrader(e),c.v5_38.createVersionUpgrader(e),c.v5_42.createVersionUpgrader()],this.objectsUpgrader=c.createVisualObjectsUpgrader(this.versionUpgraders)}e=(e=e.explore||(e.explore={})).services||(e.services={}),c=e.upgrade||(e.upgrade={}),d=jsCommon.Version,t=jsCommon.JsonExtensions,c.createExplorationUpgrader=function(e){return new r(e)},i.prototype.upgrade=function(e,t,r,i){if(this.upgradeElement(e,t,r,(function(e,t,r){return e.upgrade(t,r)}),i))return this.upgradeVisualObjects(t=e,e.config.version),e.config.version=c.CurrentExplorationVersion,t},i.prototype.upgradeFilterCollection=function(e,t,r){if(this.upgradeElement(e,t,r,(function(e,t){return e.upgradeFilterCollection(t)})))return e.config.version=c.CurrentExplorationVersion,e},i.prototype.getVersionUpgraders=function(){return this.versionUpgraders},i.prototype.upgradeElement=function(e,t,r,i,a){var n=this.getVersionedElementConfig(e),o=n.version&&_.isString(n.version)?n.version:d.ZeroStr;if(d.gt(o,c.CurrentExplorationVersion)){if(t.push({errorType:0}),!r)return}else for(var s=0,l=this.versionUpgraders;s<l.length;s++){var p=l[s],u=p.getVersion();(d.lt(u,"2.2")||d.gt(u,o))&&(i(p,e,o),a)&&a.upgraderCount++}return e},i.prototype.upgradeVisualObjects=function(e,t){t=t||d.ZeroStr;e=e&&e.sections;if(e)for(var r=0,i=e;r<i.length;r++){var a=i[r],a=a&&a.visualContainers;if(!a)return;for(var n=0,o=a;n<o.length;n++){var s,l,p=o[n],p=p&&p.config&&p.config.singleVisual;p&&(s=p.visualType,(l=p.vcObjects)&&this.objectsUpgrader.upgrade(2,l,s,t),l=p.objects)&&this.objectsUpgrader.upgrade(1,l,s,t)}}},i.prototype.getVersionedElementConfig=function(e){return _.isString(e.config)&&(e.config=t.tryParseJSON(e.config)),e.config||(e.config={version:d.ZeroStr}),e.config},r=i,c.ExplorationUpgrader=r})(powerbi=powerbi||{}),(function(p){var e,t,u,l,a,c,i,d,m,n,r,o;function s(){}function v(e){var t=e.column;if(t){e=y(e);if(e)return m.columnRef(e,t)}}function y(e){return m.entity(e.schema,e.entity,e.entityVar)}e=(e=p.explore||(p.explore={})).services||(e.services={}),e=(t=e.upgrade||(e.upgrade={})).v1_0||(t.v1_0={}),u=p.data.services.DataViewObjectSerializer,l=p.visuals.GradientUtils,a=jsCommon.JsonExtensions,c=p.visuals.labelStyle,i=p.visuals.plugins,d=p.data.services.SemanticQuerySerializer,m=p.data.SQExprBuilder,n=jsCommon.Version,e.createVersionUpgrader=function(){return new o},s.prototype.upgrade=function(e,t){if(e&&(e.filters=this.upgradeFilterContainers(e.filters),e.sections))for(var r=0,i=e.sections;r<i.length;r++){var a=i[r];if(a.filters=this.upgradeFilterContainers(a.filters),a.visualContainers)for(var n=0,o=a.visualContainers;n<o.length;n++){var s,l=o[n],l=(l.filters=this.upgradeFilterContainers(l.filters),l.config.singleVisual);l&&(s=l.visualType||l.visualConfig.visualType,l.objects=this.upgradeObjects(l.objects,s,t))}}},s.prototype.upgradeVisualObjects=function(e,t,r,i){},s.prototype.upgradeFilterCollection=function(e){e&&e.filters&&(e.filters=this.upgradeFilterContainers(e.filters))},s.prototype.getVersion=function(){return t.ExplorationVersions.v1_0},s.prototype.upgradeFilterContainers=function(e){if(!_.isEmpty(e)){e=a.tryParseJSON(e);if(e)for(var t=0,r=e;t<r.length;t++){var i=r[t];this.upgradeFilterContainer(i)}return JSON.stringify(e)}},s.prototype.upgradeFilterContainer=function(e){var t;!e.expression&&e.field&&(t=r.fieldDef(e.field))&&(e.expression=d.serializeExpr(t)),void 0===e.howCreated&&(e.howCreated=e.autoGenerated?0:1)},s.prototype.upgradeObjects=function(e,t,r){switch(this.dropMalformedSelectors(e),t){case i.filledMap.name:return this.upgradeObjectsFilledMap(e);case i.card.name:return this.upgradeObjectsCard(e);case i.donutChart.name:case i.pieChart.name:return r&&n.gt(r,"1.0")?e:this.upgradeObjectsDonutChart(e)}return e},s.prototype.dropMalformedSelectors=function(e){if(e)for(var t in e){var r=e[t];if(r)for(var i=r.length-1;0<=i;i--){var a=r[i].selector;a&&(a.metadata||delete a.metadata,_.isEmpty(Object.keys(a)))&&r.splice(i,1)}}},s.prototype.upgradeObjectsFilledMap=function(e){var t,r="dataPoint",i="fillRule",a=(e=e||{})[r];a||(e[r]=a=[]);for(var n=0,o=a;n<o.length;n++){var s=o[n];if(!s.selector){t=s;break}}return t||a.push(t={selector:null,properties:{}}),null==t.properties[i]&&(t.properties[i]=u.serializeObjectProperty(l.getDefaultFillRuleDefinition(),p.visuals.getFilledMapCapabilities().objects[r].properties[i])),e},s.prototype.upgradeObjectsCard=function(e){var t;return e&&(t=e.cardTitle)&&(e.categoryLabels=t,delete e.cardTitle),e},s.prototype.upgradeObjectsDonutChart=function(e){var t,r,i,a,n="categoryLabels",o="labels",s="labelStyle",l="show";if(e)return t=this.getMetadataOnceObjectDefn(e,o),r=!!(r=this.getPropertyExpr(t,l))&&d.deserializeExpr(r).value,(a=this.getMetadataOnceObjectDefn(e,n))?(l=!!(a=this.getPropertyExpr(a,l))&&d.deserializeExpr(a).value,r&&l?i=c.categoryAndData:r&&!l?i=c.data:!r&&l&&(i=c.category),delete e[n]):t&&t.properties[s]||(i=r?c.categoryAndData:c.category),null!=i&&(a=p.visuals.getDonutChartCapabilities().objects[o].properties,t||((l=e[o])||(e[o]=l=[]),t=_.find(l,(function(e){return!e.selector})))||l.push(t={properties:{}}),t.properties.show=u.serializeObjectProperty(m.boolean(!0),a.show),t.properties[s]=u.serializeObjectProperty(m.text(i),a[s])),e},s.prototype.getMetadataOnceObjectDefn=function(e,t){if(e){e=e[t];if(!_.isEmpty(e))return _.find(e,(function(e){return!e.selector}))}},s.prototype.getPropertyExpr=function(e,t){if(e){e=e.properties[t];if(e)return e.expr}},o=s,e.VersionUpgrader=o,(r||(r={})).fieldDef=function(e){return (function(e){var t=e.aggregate;if(void 0!==t){e=v(e)||y(e);if(e)return m.aggregate(e,t)}})(e)||v(e)||(function(e){var t=e.measure;if(t){e=y(e);if(e)return m.measureRef(e,t)}})(e)||y(e)}})(powerbi=powerbi||{}),(function(e){var t,r;function i(){}e=(e=e.explore||(e.explore={})).services||(e.services={}),((t=e.upgrade||(e.upgrade={})).v2_0||(t.v2_0={})).createVersionUpgrader=function(){return new r},i.prototype.upgrade=function(e){if(e&&e.sections)for(var t=0,r=e.sections;t<r.length;t++){var i=r[t];if(i.visualContainers)for(var a=0,n=i.visualContainers;a<n.length;a++){var o=n[a],s=o.config;s.layouts||(o={x:o.x,y:o.y,z:o.z,width:o.width,height:o.height},s.layouts=[{id:0,position:o}])}}},i.prototype.upgradeFilterCollection=function(e){},i.prototype.upgradeVisualObjects=function(e,t,r,i){},i.prototype.getVersion=function(){return t.ExplorationVersions.v2_0},r=i})(powerbi=powerbi||{}),(function(e){var t,a,r;function i(){}e=(e=e.explore||(e.explore={})).services||(e.services={}),e=(t=e.upgrade||(e.upgrade={})).v2_2||(t.v2_2={}),a=jsCommon.JsonExtensions,e.createVersionUpgrader=function(){return new r},i.prototype.upgrade=function(e){},i.prototype.upgradeFilterCollection=function(e){e&&e.filters&&(e.filters=this.upgradeFilterContainers(e.filters))},i.prototype.upgradeFilterContainers=function(e){if(!_.isEmpty(e)){e=a.tryParseJSON(e);if(e)for(var t=0,r=e;t<r.length;t++){var i=r[t];this.upgradeFilterContainer(i)}return JSON.stringify(e)}},i.prototype.upgradeFilterContainer=function(e){2!==e.howCreated||e.precedence||(e.precedence=0)},i.prototype.upgradeVisualObjects=function(e,t,r,i){},i.prototype.getVersion=function(){return t.ExplorationVersions.v2_2},r=i})(powerbi=powerbi||{}),(function(i){var e,t,a,n,r,o,s,l;function p(){}e=(e=i.explore||(i.explore={})).services||(e.services={}),e=(t=e.upgrade||(e.upgrade={})).v2_3||(t.v2_3={}),a=i.data.DataViewObjectDefinitions,n=i.data.services.DataViewObjectSerializer,r=i.visuals.plugins,o=i.visuals.slicerMode,s=i.data.SQExprBuilder,e.createVersionUpgrader=function(){return new l},p.prototype.upgrade=function(e){if(e&&e.sections)for(var t=0,r=e.sections;t<r.length;t++){var i=r[t];if(i.visualContainers)for(var a=0,n=i.visualContainers;a<n.length;a++){var o,s=n[a].config.singleVisual;s&&(o=s.visualType||s.visualConfig.visualType,s.objects=this.upgradeObjects(s.objects,o))}}},p.prototype.upgradeFilterCollection=function(e){},p.prototype.upgradeVisualObjects=function(e,t,r,i){},p.prototype.getVersion=function(){return t.ExplorationVersions.v2_3},p.prototype.upgradeObjects=function(e,t){return t===r.slicer.name?this.upgradeSlicerObjects(e):e},p.prototype.upgradeSlicerObjects=function(e){var t=a.ensure(e=e||{},"data",null),r=i.visuals.getSlicerCapabilities().objects.data.properties;return null==t.properties.mode&&(t.properties.mode=n.serializeObjectProperty(s.text(o.basic),r.mode)),e},l=p,e.VersionUpgrader=l})(powerbi=powerbi||{}),(function(e){var t,r,o,i,a;function n(){}t=(t=e.explore||(e.explore={})).services||(t.services={}),t=(r=t.upgrade||(t.upgrade={})).v2_5||(r.v2_5={}),o=e.data.DataViewObjectDefinitions,i=e.visuals.plugins,t.createVersionUpgrader=function(){return new a},n.prototype.upgrade=function(e){if(e&&e.sections)for(var t=0,r=e.sections;t<r.length;t++){var i=r[t];if(i.visualContainers)for(var a=0,n=i.visualContainers;a<n.length;a++){var o,s=n[a].config.singleVisual;s&&(o=s.visualType||s.visualConfig.visualType,s.objects=this.upgradeObjects(s.objects,o))}}},n.prototype.upgradeFilterCollection=function(e){},n.prototype.upgradeVisualObjects=function(e,t,r,i){},n.prototype.getVersion=function(){return r.ExplorationVersions.v2_5},n.prototype.upgradeObjects=function(e,t){return t===i.gauge.name?this.upgradeGaugeTarget(e):e},n.prototype.upgradeGaugeTarget=function(e){var t=o.getObjectDefinition(e=e||{},"labels",null);if(t)for(var r=o.ensure(e,"target",null),i=0,a=["show","labelDisplayUnits","labelPrecision","color"];i<a.length;i++){var n=a[i];null!=t.properties[n]&&(r.properties[n]=t.properties[n])}return e},a=n,t.VersionUpgrader=a})(powerbi=powerbi||{}),(function(e){var t,r,l,d,m,i;function a(){}t=(t=e.explore||(e.explore={})).services||(t.services={}),t=(r=t.upgrade||(t.upgrade={})).v3_6_1||(r.v3_6_1={}),l=e.GeoJsonTypes,d=e.visualHost.utils.ResourcePackageUtils,m=e.contracts.ResourcePackageItemType,t.createVersionUpgrader=function(){return new i},a.prototype.upgrade=function(e){if(e){var t=e.resourcePackages||[],r=_.find(t,(function(e){return 2===e.resourcePackage.type})),i=!r,a=(r=r||{resourcePackage:{id:void 0,items:[],name:d.ensurePackageName(2),type:2}}).resourcePackage.items;if(e.sections)for(var n=0,o=e.sections;n<o.length;n++){var s=o[n];if(s.visualContainers)for(var l=0,p=s.visualContainers;l<p.length;l++){var u=p[l].config.singleVisual;u&&this.upgradeSharedResourcePackages(u.objects,a)}}var c=e.config&&e.config.baseTheme;!c||_.find(a,(function(e){return e.name===c}))||a.push({name:c,type:m.BaseTheme,path:"BaseThemes/".concat(c,".json")}),i&&0<r.resourcePackage.items.length&&(t.push(r),e.resourcePackages||(e.resourcePackages=t))}},a.prototype.upgradeFilterCollection=function(){},a.prototype.upgradeVisualObjects=function(e,t,r,i){},a.prototype.getVersion=function(){return r.ExplorationVersions.v3_6_1},a.prototype.upgradeSharedResourcePackages=function(e,i){for(var t in e)for(var r=0,a=e[t];r<a.length;r++){var n,o=a[r],s=this;for(n in o.properties)!(function(e){var t,r,e=o.properties[e],e=e&&e.geoJson;e&&(t=(t=e.type.expr).Literal&&t.Literal.Value)&&s.removeQuotes(t)===l.shared&&(r=s.removeQuotes(e.name.expr.Literal.Value),_.find(i,(function(e){return e.name===r}))||i.push({name:r,type:m.ShapeMap,path:"Shapemaps/".concat(r,".json")}))})(n)}},a.prototype.removeQuotes=function(e){return e.substr(1,e.length-2)},i=a,t.VersionUpgrader=i})(powerbi=powerbi||{}),(function(e){var t,o,r;function i(e){}e=(e=e.explore||(e.explore={})).services||(e.services={}),e=(t=e.upgrade||(e.upgrade={})).v3_14||(t.v3_14={}),o=jsCommon.JsonExtensions,e.createVersionUpgrader=function(e){return new r(e)},i.prototype.upgrade=function(e){if(e&&e.sections)for(var t=0,r=e.sections;t<r.length;t++){var i=r[t],a=i.config,n=o.tryParseJSON(i.filters)||[];1===a.type?this.upgradeTooltipPage(n,a):0!==a.type&&null!=a.type||this.upgradeRegularPage(n,a),i.filters=JSON.stringify(n)}},i.prototype.upgradeFilterCollection=function(){},i.prototype.upgradeVisualObjects=function(e,t,r,i){},i.prototype.getVersion=function(){return t.ExplorationVersions.v3_14},i.prototype.upgradeTooltipPageLinkFields=function(e,t){var r=_.map(t.linkFields,(function(e){return{howCreated:5,isTransient:!1,isLinkedAsAggregation:e.asAggregation,expression:e.fieldExpr}}));e.push.apply(e,r||[]),t.linkFields=[]},i.prototype.upgradeTooltipPage=function(e,t){t.acceptsAllFiltersWhenLinked=!0,this.upgradeTooltipPageLinkFields(e,t)},i.prototype.upgradeRegularPage=function(e,t){if(t.acceptsAllFiltersWhenLinked=!1,e)for(var r=0,i=e;r<i.length;r++)i[r].isLinkedAsAggregation=!1},r=i,e.VersionUpgrader=r})(powerbi=powerbi||{}),(function(e){var t,r;function i(){}e=(e=e.explore||(e.explore={})).services||(e.services={}),(e=(t=e.upgrade||(e.upgrade={})).v3_14_1||(t.v3_14_1={})).createVersionUpgrader=function(){return new r},i.prototype.upgrade=function(e){if(e&&e.sections)for(var t=0,r=e.sections;t<r.length;t++){var i=r[t];if(i.visualContainers)for(var a=0,n=i.visualContainers;a<n.length;a++){var o=n[a].config.singleVisual;o&&this.upgradeSQExprToInt(o.objects)}}},i.prototype.upgradeFilterCollection=function(){},i.prototype.getVersion=function(){return t.ExplorationVersions.v3_14_1},i.prototype.upgradeVisualObjects=function(e,t,r,i){},i.prototype.upgradeSQExprToInt=function(e){for(var t in e)if("labels"===t||"bubbles"===t||"categoryLabels"===t)for(var r=0,i=e[t];r<i.length;r++){var a,n,o=i[r];for(a in o.properties)"bubbleSize"!==a&&"labelDensity"!==a&&"backgroundTransparency"!==a||(n=(n=o.properties[a])&&n.expr&&n.expr.Literal)&&(n.Value,/^'\d+(\.\d+)?'$/.test(n.Value))&&(n.Value=this.convertLiteralSQTextIntoNumber(n.Value)+"L")}},i.prototype.convertLiteralSQTextIntoNumber=function(e){return Math.floor(_.parseInt(e.substr(1,e.length-2)))},r=i,e.VersionUpgrader=r})(powerbi=powerbi||{}),(function(e){var t,r,i,u,a;function n(){}t=(t=e.explore||(e.explore={})).services||(t.services={}),t=(r=t.upgrade||(t.upgrade={})).v3_15||(r.v3_15={}),i=e.data.services.SemanticQuerySerializer,u=e.data.SQExprBuilder,t.createVersionUpgrader=function(){return new a},n.prototype.upgrade=function(e){if(e&&e.sections)for(var t=0,r=e.sections;t<r.length;t++){var i=r[t];if(i.visualContainers)for(var a=this,n=0,o=i.visualContainers;n<o.length;n++){var s=o[n];p=l=void 0,(s=(s=s).config.singleVisual)&&(l={},s.altText&&(l.general=[{properties:{altText:a.toExpr(u.text(s.altText))}}],delete s.altText),s.aspectRatio&&(p=s.aspectRatio,l.lockAspect=[{properties:{show:null!=p.show?a.toExpr(u.boolean(p.show)):void 0}}],delete s.aspectRatio),s.background&&(p=s.background,l.background=[{properties:{color:null!=p.color?{solid:{color:a.toExpr(u.text(p.color))}}:void 0,show:null!=p.show?a.toExpr(u.boolean(p.show)):void 0,transparency:null!=p.transparency?a.toExpr(u.integer(p.transparency)):void 0}}],delete s.background),s.border&&(p=s.border,l.border=[{properties:{color:null!=p.color?{solid:{color:a.toExpr(u.text(p.color))}}:void 0,show:null!=p.show?a.toExpr(u.boolean(p.show)):void 0}}],delete s.border),s.stylePresetName&&(l.stylePreset=[{properties:{name:a.toExpr(u.text(s.stylePresetName))}}],delete s.stylePresetName),s.title&&((p=s.title).show=null!=p.hidden?!p.hidden:p.show,l.title=[{properties:{alignment:null!=p.alignment?a.toExpr(u.text(p.alignment)):void 0,background:null!=p.background?{solid:{color:a.toExpr(u.text(p.background))}}:void 0,fontColor:null!=p.fontColor?{solid:{color:a.toExpr(u.text(p.fontColor))}}:void 0,fontFamily:null!=p.fontFamily?a.toExpr(u.text(p.fontFamily)):void 0,fontSize:null!=p.fontSize?a.toExpr(u.integer(p.fontSize)):void 0,show:null!=p.show?a.toExpr(u.boolean(p.show)):void 0,text:null!=p.text?a.toExpr(u.text(p.text)):void 0}}],delete s.title),s.visualLink&&(p=s.visualLink,l.visualLink=[{properties:{bookmark:null!=p.bookmark?a.toExpr(u.text(p.bookmark)):void 0,qna:p.qna,show:null!=p.show?a.toExpr(u.boolean(p.show)):void 0,type:null!=p.type?a.toExpr(u.text(p.type)):void 0}}],delete s.visualLink),s.visualTooltip&&(p=s.visualTooltip,l.visualTooltip=[{properties:{section:null!=p.section?a.toExpr(u.text(p.section)):void 0,type:null!=p.type?a.toExpr(u.text(p.type)):void 0}}],delete s.visualTooltip),a.clearUndefinedPropertiesVCObjects(l),_.isEmpty(l)||(s.vcObjects=l))}}var l,p},n.prototype.toExpr=function(e){return{expr:i.serializeExpr(e)}},n.prototype.clearUndefinedPropertiesVCObjects=function(e){for(var t in e){var r,i=e[t][0].properties;for(r in i)i[r]||delete i[r];_.isEmpty(i)&&delete e[t]}},n.prototype.upgradeFilterCollection=function(){},n.prototype.upgradeVisualObjects=function(e,t,r,i){},n.prototype.getVersion=function(){return r.ExplorationVersions.v3_15},a=n,t.VersionUpgrader=a})(powerbi=powerbi||{}),(function(e){var t,r,i,a;function n(){}t=(t=e.explore||(e.explore={})).services||(t.services={}),t=(r=t.upgrade||(t.upgrade={})).v3_18||(r.v3_18={}),i=e.explore.util.ThemeUtils,t.createVersionUpgrader=function(){return new a},n.prototype.upgrade=function(e){var t,r;e&&((r=e.config).themeCollection=t={},e.theme&&(t.customTheme=i.getThemeMetadata(e.theme,1,this.getVersion()),delete e.theme),r.baseTheme)&&(t.baseTheme=i.getThemeMetadata(r.baseTheme,2,this.getVersion()),delete r.baseTheme)},n.prototype.upgradeFilterCollection=function(){},n.prototype.upgradeVisualObjects=function(e,t,r,i){},n.prototype.getVersion=function(){return r.ExplorationVersions.v3_18},a=n,t.VersionUpgrader=a})(powerbi=powerbi||{}),(function(e){var t,l,r;function i(){}function p(e){var t="defaultCategoryColor";if(e&&e.dataPoint)for(var r=0,i=e.dataPoint;r<i.length;r++){var a=i[r];null==a.selector&&a.properties[t]&&(a.properties.fill=a.properties[t],delete a.properties[t])}}function u(e){return _.includes(t.DefaultCategoryColorVisualsToUpgrade,e)}e=(e=e.explore||(e.explore={})).services||(e.services={}),e=(t=e.upgrade||(e.upgrade={})).v3_19||(t.v3_19={}),l=jsCommon.JsonExtensions,e.createVersionUpgrader=function(){return new r},i.prototype.upgrade=function(e){if(e)for(var t=0,r=e.sections;t<r.length;t++)for(var i=0,a=r[t].visualContainers;i<a.length;i++){var n,o=a[i],s=o.config.singleVisual;s&&(n=s.objects,u(s.visualType))&&(p(n),s=l.tryParseJSON(o.dataTransforms))&&(p(s.objects),o.dataTransforms=JSON.stringify(s))}},i.prototype.upgradeFilterCollection=function(){},i.prototype.upgradeVisualObjects=function(e,t,r,i){},i.prototype.getVersion=function(){return t.ExplorationVersions.v3_19},r=i,e.VersionUpgrader=r,e.upgradeDefaultCategoryColorToFill=p,e.needsToUpgradeDefaultCategoryColor=u})(powerbi=powerbi||{}),(function(e){var o,t;function r(){}e=(e=e.explore||(e.explore={})).services||(e.services={}),(e=(o=e.upgrade||(e.upgrade={})).v4_2||(o.v4_2={})).createVersionUpgrader=function(){return new t},r.prototype.upgrade=function(e){if(e&&!_.isEmpty(e.sections))for(var t=0,r=e.sections;t<r.length;t++)for(var i=0,a=r[t].visualContainers;i<a.length;i++){var n=a[i],n=n.config&&n.config.singleVisual;o.UpgradeUtils.updateSingleVisualConfigPxToPt(n)}},r.prototype.upgradeFilterCollection=function(){},r.prototype.upgradeVisualObjects=function(e,t,r,i){},r.prototype.getVersion=function(){return o.ExplorationVersions.v4_2},t=r,e.VersionUpgrader=t})(powerbi=powerbi||{}),(function(e){var t,m,v,y,r;function i(){}t=(t=e.explore||(e.explore={})).services||(t.services={}),m=t.upgrade||(t.upgrade={}),v=m.v5_1||(m.v5_1={}),y=e.data.services.SemanticQuerySerializer,v.createVersionUpgrader=function(){return new r},i.prototype.upgrade=function(e){if(e&&!_.isEmpty(e.sections))for(var t=0,r=e.sections;t<r.length;t++){var i=r[t],a=(s=o=n=a=void 0,i);if(a&&a.config&&a.config.objects)for(var n=0,o=v.outspacePanePropertiesToUpdate;n<o.length;n++){var s=o[n];m.UpgradeUtils.upgradePropertyFromPxToPt(a.config.objects,s)}if(c=d=u=p=l=void 0,(l=i)&&l.config&&l.config.objects&&l.config.objects.filterCard)for(var l=l.config.objects.filterCard,p=0,u=l;p<u.length;p++){var c,d=u[p],d=d&&d.properties;d&&(c=d.textSize)&&(c=y.deserializeExpr(c.expr),d.textSize=m.UpgradeUtils.toExpr(m.UpgradeUtils.pxToPtExpr(c)))}}},i.prototype.upgradeFilterCollection=function(){},i.prototype.upgradeVisualObjects=function(e,t,r,i){},i.prototype.getVersion=function(){return m.ExplorationVersions.v5_1},r=i,v.VersionUpgrader=r,v.outspacePanePropertiesToUpdate=[{objectName:"outspacePane",propertyName:"titleSize"},{objectName:"outspacePane",propertyName:"headerSize"}]})(powerbi=powerbi||{}),(function(e){var o,t;function r(){}e=(e=e.explore||(e.explore={})).services||(e.services={}),(e=(o=e.upgrade||(e.upgrade={})).v5_3||(o.v5_3={})).createVersionUpgrader=function(){return new t},r.prototype.upgrade=function(e){if(e&&!_.isEmpty(e.sections))for(var t=0,r=e.sections;t<r.length;t++)for(var i=0,a=r[t].visualContainers;i<a.length;i++){var n=a[i],n=n.config&&n.config.singleVisual;o.UpgradeUtils.updateSingleVisualConfigTextboxPxToPt(n)}},r.prototype.upgradeFilterCollection=function(){},r.prototype.upgradeVisualObjects=function(e,t,r,i){},r.prototype.getVersion=function(){return o.ExplorationVersions.v5_3},t=r,e.VersionUpgrader=t})(powerbi=powerbi||{}),(function(e){var t,r;e=e.explore||(e.explore={}),t=(t=e.services||(e.services={})).UtteranceDefinitionSerializer||(t.UtteranceDefinitionSerializer={}),r=e.services.upgrade.UtteranceDefinitionVersions,t.serialize=function(e){return{Version:r.v1_0,Utterance:e.utterance}},t.deserialize=function(e){return{utterance:e.Utterance}}})(powerbi=powerbi||{}),(function(e){var t,a,n,o;t=(t=e.explore||(e.explore={})).services||(t.services={}),n=e.data.FieldExprPattern,o=e.data.SQExprConverter,(e=t.schemaItemActivationUtils||(t.schemaItemActivationUtils={})).setActiveSchemaItem=function(e,t,r){var t=o.asFieldPattern(t,r),i=(r=n.toFieldExprEntityItemPattern(t)).schema,r=r.entity,i=a.createActiveSchemaItem(i,r,t);e.setActiveItem(i)},e.trackItemThroughModelChange=function(e,t,r){if(e){for(var i=0,a=t.changes;i<a.length;i++){var n=a[i];if(n.itemDelete&&n.itemDelete.entity===e.entity&&(!n.itemDelete.property||e.property&&e.property===n.itemDelete.property||e.hierarchy&&e.hierarchy===n.itemDelete.property))return;n.entityRename&&e.entity===n.entityRename.before?e=__assign(__assign({},e),{entity:n.entityRename.after}):n.propertyRename&&e.entity===n.propertyRename.entity?((e=e.property&&e.property===n.propertyRename.before?__assign(__assign({},e),{property:n.propertyRename.after}):e).hierarchy||e.hierarchyLevel)&&e.hierarchy===n.propertyRename.before&&"Hierarchy"===n.propertyRename.objectType&&(e=__assign(__assign({},e),{hierarchy:n.propertyRename.after})):n.hierarchyLevelRename&&e.entity===n.hierarchyLevelRename.entity&&e.hierarchy===n.hierarchyLevelRename.hierarchy&&e.hierarchyLevel===n.hierarchyLevelRename.before?e=__assign(__assign({},e),{hierarchyLevel:n.hierarchyLevelRename.after}):n.measureMove&&e.entity===n.measureMove.source&&e.property===n.measureMove.property&&(e=__assign(__assign({},e),{entity:n.measureMove.destination}))}t=r.schema(e.schema);if(t)if(t.entities.withName(e.entity))return e.property?t.findProperty(e.entity,e.property)&&e:e.hierarchyLevel?t.findHierarchyLevel(e.entity,e.hierarchy,e.hierarchyLevel)&&e:(!e.hierarchy||t.findHierarchy(e.entity,e.hierarchy))&&e}},(a=t.ActiveSchemaItemFactory||(t.ActiveSchemaItemFactory={})).createActiveSchemaItem=function(e,t,r){return{schema:e,entity:t,property:n.getPropertyName(r),hierarchy:n.getHierarchyName(r)||r.hierarchyLevel&&r.hierarchyLevel.name,hierarchyLevel:r.hierarchyLevel&&r.hierarchyLevel.level}}})(powerbi=powerbi||{}),(function(e){var t,i,r,s,a;function l(){}function n(){}function o(){}function p(){}t=e.explore||(e.explore={}),e=t.services||(t.services={}),i=t.util.VisualContainerUtils,r=t.contracts.isVisualContainer,l.selectCanvasItem=function(e,t,r,i){void 0===r&&(r=0);e=s.createSelectableCanvasItem(e);t.selectElement(e,r,i)},l.unselectCanvasItem=function(e,t){var r=l.getSelectedCanvasItems(t);_.includes(r,e)&&l.selectCanvasItems(_.without(r,e),t)},l.selectSubSelection=function(e,t,r,i){t=s.createSubSelectableCanvasItem(t,r);e.selectElement(t,i)},l.selectCanvasItems=function(e,t,r){e=_.map(e,(function(e){return s.createSelectableCanvasItem(e)}));t.selectElements(e,0,r)},l.isCanvasItemSelected=function(e,t){t=l.getSelectedCanvasItems(t);return _.includes(t,e)},l.getSelectedCanvasItem=function(e){return _.first(l.getSelectedCanvasItems(e))},l.getSelectedCanvasItems=function(e){return _.chain(e.getSelectedElements()).map((function(e){return e.canvasItem})).compact().value()},l.getSelectedVisualContainers=function(e){return _.chain(l.getSelectedCanvasItems(e)).filter((function(e){return t.contracts.isVisualContainer(e)})).compact().value()},l.getSelectedVisualContainerGroups=function(e){return _.chain(l.getSelectedCanvasItems(e)).filter((function(e){return t.contracts.isVisualContainerGroup(e)})).compact().value()},l.hasMultipleVisualContainerSelection=function(e){return 1<l.getSelectedCanvasItems(e).length},l.getSelectedVisual=function(e){var e=l.getSelectedCanvasItems(e);if(1===e.length)return e=e[0],r(e)?e:void 0},l.getDefaultSelectedVisualInSingleOrMultiCase=function(e){var t,e=l.getSelectedCanvasItems(e),r=e[0];if(r)return t=i.getVisualType(r),_.every(e,(function(e){return i.getVisualType(e)===t}))?r:void 0},l.clearSubSelections=function(e){var t=e.getSelectedElements();if(t){for(var r=l.getSelectedVisualContainers(e),i=[],a=0,n=t;a<n.length;a++){var o=n[a];i.push(s.createSubSelectableCanvasItem(o.canvasItem,[]))}e.selectElements(i,1<r.length?1:0)}return t},e.selectionUtils=l,n.createSelectableCanvasItem=function(e){return a.createFromCanvasItem(e)},n.createSubSelectableCanvasItem=function(e,t){return a.createFromSubSelections(e,t)},s=n,e.SelectableItemFactory=s,o.equals=function(e,t){if(e.length!==t.length)return!1;for(var r=0,i=e.length;r<i;r++)if(!a.equals(e[r],t[r]))return!1;return!0},e.SelectableUtils=o,Object.defineProperty(p.prototype,"id",{get:function(){if(this._canvasItem)return this._canvasItem.id},enumerable:!1,configurable:!0}),Object.defineProperty(p.prototype,"canvasItem",{get:function(){return this._canvasItem},enumerable:!1,configurable:!0}),Object.defineProperty(p.prototype,"subSelections",{get:function(){return this._subSelections},enumerable:!1,configurable:!0}),p.createFromCanvasItem=function(e){var t=new p;return t._canvasItem=e,t},p.createFromSubSelections=function(e,t){e=p.createFromCanvasItem(e);return e._subSelections=t,e},p.equals=function(e,t){return(e=e||null)===(t=t||null)||!e==!t&&!(e.id!==t.id||e.canvasItem!==t.canvasItem||!_.isEqual(e.subSelections,t.subSelections))},a=p,e.SelectableItem=a})(powerbi=powerbi||{}),(function(e){var t,i,a,o;function r(e,t,r,i,a,n){this.services={visualPlugin:e,featureSwitchService:t,localizationService:r,userInfo:i,embedModeService:a,licenseServiceExtend:n}}t=(t=e.explore||(e.explore={})).services||(t.services={}),i=e.explore.util.ScriptVisualsUtil,a=e.explore.util.VisualContainerUtils,t.createScriptVisualsService=function(e,t,r,i,a,n){return new o(e,t,r,i,a,n)},r.prototype.addScriptVisualInfo=function(e,t){var r=a.getVisualType(e);this.services.visualPlugin.isScriptVisual(r)&&e.id&&(e={id:e.id,scriptType:i.getScriptVisualType(r)},t.push(e))},r.prototype.showEnableScriptVisualDialogIfRequiredAsync=function(e,t,r){return null},r.prototype.getScriptVisualErrorDetails=function(e,t){var r,i=this.services.localizationService,a=this.services.featureSwitchService.featureSwitches;if(0===e&&!a.scriptVisualEnabled)r=this.buildErrorDetails(i.get(this.getLocalizationKey("Error_VisualsNotSupported",e)));else{if(this.services.embedModeService&&this.services.embedModeService.isAnonymousLiveEmbed())return r=a.scriptVisualAnonymousEmbeddingEnabled?r:this.buildErrorDetails(i.get(this.getLocalizationKey("Error_VisualsNotSupportedInEmbedReports",e)));var n,o=this.getUserInfoForErrorDetails();o&&o.isViralTenant?r=this.buildErrorDetails(i.get(this.getLocalizationKey("Error_VisualsNotSupportedForViralTenant",e))):!1===a.rScriptVisualEnabled?r=this.buildErrorDetails(i.get(this.getLocalizationKey("Error_VisualsDisabledByAdmin",e))):(a=!1,n=this.services.embedModeService&&this.services.embedModeService.isReportEmbedScenario(),!this.services.licenseServiceExtend||Array.isArray(this.services.licenseServiceExtend)||n||(a=t&&this.services.licenseServiceExtend.isReportInPremiumCapacity(t)),o&&!1===o.isPremiumUser&&!a?r=this.buildErrorDetails(i.get(this.getLocalizationKey("Error_VisualsIsProFeature",e))):o&&void 0===o.isPremiumUser&&void 0===o.isViralTenant&&void 0===t&&(r=this.buildErrorDetails(i.get(this.getLocalizationKey("Error_VisualsNotSupportedWithThisOperation",e)))))}return r},r.prototype.overrideEmbeddedErrorDetails=function(e,t){var r=this.services.embedModeService&&(this.services.embedModeService.isAppTokenEmbed()||this.services.embedModeService.isSaasOrPaasEmbed()||this.services.embedModeService.isSecurePublishToWeb()),i=this.services&&this.services.localizationService;if(r&&t)return(r=t).helpLink="",r.message=i.get(this.getLocalizationKey("Error_VisualsEmbeddedText",e)),r.displayableErrorInfo=[{errorInfoKey:i.get(this.getLocalizationKey("Error_VisualsEmbeddedText",e)),errorInfoValue:i.get(this.getLocalizationKey("Error_VisualsErrorInEmbedReports",e))}],r},r.prototype.getLocalizationKey=function(e,t){var r;switch(t){case 0:r="R";break;case 1:r="Py";break;default:r=""}return r+e},r.prototype.shouldBlockScriptVisual=function(e,t){var r,i=this.services.featureSwitchService.featureSwitches,a=this.getUserInfoForErrorDetails(),n=this.services.embedModeService&&this.services.embedModeService.isAnonymousLiveEmbed(),o=this.services.embedModeService&&this.services.embedModeService.isReportEmbedScenario();switch(e){case 0:return n?!i.scriptVisualAnonymousEmbeddingEnabled||!i.scriptVisualEnabled:(r=!1,!(r=!this.services.licenseServiceExtend||Array.isArray(this.services.licenseServiceExtend)||o?r:t&&this.services.licenseServiceExtend.isReportInPremiumCapacity(t))&&(!i.scriptVisualEnabled||a&&a.isViralTenant||!i.rScriptVisualEnabled||a&&!a.isPremiumUser));case 1:return n?!i.scriptVisualAnonymousEmbeddingEnabled:!(r=!this.services.licenseServiceExtend||Array.isArray(this.services.licenseServiceExtend)||o?r:t&&this.services.licenseServiceExtend.isReportInPremiumCapacity(t))&&(a&&a.isViralTenant||a&&!a.isPremiumUser)}},r.prototype.canLaunchExternalIDE=function(){return!1},r.prototype.launchExternalIDE=function(e){return null},r.prototype.openOptionsDialogAsync=function(){return null},r.prototype.refreshScriptCustomVisuals=function(e){},r.prototype.triggerDataRefresh=function(){var e="Visual_Error_RefreshFailed",t=this.services.localizationService.get(e),r=this.services.localizationService.get("Visual_Warning_AutoRefreshNotSupported");return{message:r,displayableErrorInfo:[{errorInfoKey:t,errorInfoValue:r}],helpLink:"https://go.microsoft.com/fwlink/?linkid=2188979",helpLinkType:1,hideDebugInfo:!0,resourceKey:e}},r.prototype.buildErrorDetails=function(e){return{message:e,displayableErrorInfo:[],helpLink:"https://go.microsoft.com/fwlink/?linkid=829101",errorType:1}},r.prototype.getUserInfoForErrorDetails=function(){var e=this.services.userInfo,t=this.services.embedModeService&&this.services.embedModeService.isReportEmbedScenario();if(e&&!Array.isArray(e)&&!t)return{isViralTenant:e.userMetadata&&e.userMetadata.tenantMetadata&&0===e.userMetadata.tenantMetadata.tenantType,isPremiumUser:e.isPremiumUser}},o=r})(powerbi=powerbi||{}),(function(e){function t(){}e=(e=(e=e.explore||(e.explore={})).services||(e.services={})).undoRedoStrategy||(e.undoRedoStrategy={}),t.prototype.register=function(e,t,r){t=t();return{actionResult:t,succeeded:!(_.isBoolean(t)&&!t)}},t.prototype.getTopUndoFrame=function(){},t.prototype.canRedo=function(){return!1},t.prototype.canUndo=function(){return!1},t.prototype.canClear=function(){return!1},t.prototype.undo=function(){return!1},t.prototype.redo=function(){return!1},t.prototype.clear=function(){return!1},t.prototype.getReferences=function(){return{}},e.UndoRedoNoOp=t})(powerbi=powerbi||{}),(function(e){var i,a;function t(e,t){this.visualContainerName=e,this.action=t}function r(e,t,r){this.eventBridge=e,this.loggerService=t,this.strategy=r}e=e.explore||(e.explore={}),i=e.services||(e.services={}),t.prototype.equals=function(e){return!!e&&this.action===e.action&&this.visualContainerName===e.visualContainerName},i.ActionIdentifier=t,i.createUndoRedoService=function(e,t,r){return void 0===r&&(r=new i.undoRedoStrategy.UndoRedoNoOp),new a(e,t,r)},r.prototype.setStrategy=function(e){this.clear(),this.strategy=e},r.prototype.undo=function(){var e=this;this.verifyStrategy()&&this.canUndo()&&setTimeout((function(){e.strategy&&e.strategy.undo()&&(e.runSideEffects(),e.fireEvents())}))},r.prototype.redo=function(){var e=this;this.verifyStrategy()&&this.canRedo()&&setTimeout((function(){e.strategy&&e.strategy.redo()&&(e.runSideEffects(),e.fireEvents())}))},r.prototype.registerSideEffect=function(e){this.sideEffects||(this.sideEffects=[]),this.sideEffects.push(e)},r.prototype.clear=function(){this.verifyStrategy()&&(this.strategy.canClear()&&this.strategy.clear(),this.eventBridge.publishToChannel(i.events.undoRedoStackUpdated))},r.prototype.canRedo=function(){return this.verifyStrategy()&&this.strategy.canRedo()},r.prototype.canUndo=function(){return this.verifyStrategy()&&this.strategy.canUndo()},r.prototype.getTopUndoFrame=function(){return this.verifyStrategy()&&this.strategy.getTopUndoFrame()},r.prototype.undoRedoPostProcessing=function(e){this.loggerService.addUserAction({message:e,type:"UndoRedo"}),setTimeout(_.noop)},r.prototype.register=function(e,t,r){var i;return(this.verifyStrategy()?(i=(r=this.strategy.register(e,t,r)).actionResult,r.succeeded):(i=t(),!(_.isBoolean(i)&&!i)))&&(this.runSideEffects(e),this.fireEvents()),this.undoRedoPostProcessing(e),i},r.prototype.fireEvents=function(){this.eventBridge.publishToChannel(i.events.onReportChanged,{explorationContentChanged:!0}),this.eventBridge.publishToChannel(i.events.undoRedoStackUpdated)},r.prototype.runSideEffects=function(e){if(!_.isEmpty(this.sideEffects))for(var t=0,r=this.sideEffects;t<r.length;t++)r[t].run(e)},r.prototype.verifyStrategy=function(){return!!this.strategy},a=r})(powerbi=powerbi||{}),(function(e){var t,i,r,a,n,o;function s(e,t,r){this.handler=e,this.staticResourceReferences=t,this.telemetry=r,this.undoStack=new i(10),this.redoStack=new i(10),this.staticResourceReferences.addReferenceSource(this)}function l(e,t){this.handler=e,this.snapshot=this.handler.takeSnapshot(t)}function p(e){this.frames=e||[]}t=(t=(t=e.explore||(e.explore={})).services||(t.services={})).undoRedoStrategy||(t.undoRedoStrategy={}),i=jsCommon.CircularStack,r=e.telemetry.EXConsecutiveUndoCount,a=e.telemetry.EXUndoEventTime,s.prototype.register=function(e,t,r){var i=this,e=this.withTelemetry((function(){return i.captureUndoFrame(i.handler)}),"Capture",e),r=(e.recurringActionInfo=r,this.canMergeWithTopFrame(r)),e=this.startTransaction(e),t=t(),a=!(_.isBoolean(t)&&!t);return a?this.endTransaction(e,r):this.cancelTransaction(e),{succeeded:a,actionResult:t}},s.prototype.getReferences=function(){return this.addStackReferences(this.undoStack,this.addStackReferences(this.redoStack))},s.prototype.addStackReferences=function(e,t){t=t||{};for(var r=e.length;0<r--;)_.merge(t,e.item(r).getReferences());return t},s.prototype.undo=function(){var e=this,t=!1;return this.canUndo()&&(t=this.withTelemetry((function(){return e.rollbackTop(e.undoStack,e.redoStack)}),"Undo",""),this.telemetry.logEvent(r,{times:this.redoStack.length})),t},s.prototype.redo=function(){var e=this,t=!1;return t=this.canRedo()?this.withTelemetry((function(){return e.rollbackTop(e.redoStack,e.undoStack)}),"Redo",""):t},s.prototype.clear=function(){return this.undoStack.clear(),this.redoStack.clear(),!0},s.prototype.canRedo=function(){return 0<this.redoStack.length},s.prototype.canUndo=function(){return 0<this.undoStack.length},s.prototype.canClear=function(){return!0},s.prototype.getTopUndoFrame=function(){var e=this.undoStack.peek();return e?e.getFrame():void 0},s.prototype.withTelemetry=function(e,t,r){r=this.telemetry.startEvent(a,{description:r,event:t}),t=e();return r.resolve(),t},s.prototype.canMergeWithTopFrame=function(e){if(e&&this.canUndo()){var t=this.getTopUndoFrame();if(t&&void 0!==t.recurringActionInfo&&t.recurringActionInfo.equals(e))return!0}return!1},s.prototype.rollbackTop=function(e,t){var r,e=e.pop();if(e)return e=e.rollbackFrame(),(r=this.validTransactionCheck(e))&&t.push(e),r},s.prototype.isIPromise=function(e){return e&&e.finally},s.prototype.startTransaction=function(e){var t=new o;return this.currentTransaction||(this.currentTransaction=t,this.currentTransaction.addUndoFrame(e)),this.currentTransaction},s.prototype.endTransaction=function(e,t){t||(this.redoStack.clear(),this.validTransactionCheck(this.currentTransaction)&&this.undoStack.push(this.currentTransaction)),this.currentTransaction=void 0},s.prototype.cancelTransaction=function(e){this.currentTransaction=void 0},s.prototype.captureUndoFrame=function(e){return new n(e)},s.prototype.validTransactionCheck=function(e){return!!e},t.UndoRedoStack=s,l.prototype.rollbackFrame=function(){var e=new l(this.handler,this.snapshot);return this.handler.rollback(this.snapshot),e},l.prototype.getReferences=function(){return this.snapshot.getReferences&&this.snapshot.getReferences()},n=l,p.prototype.addUndoFrame=function(e){this.frames.push(e)},p.prototype.rollbackFrame=function(){return new p(_.map(this.frames,(function(e){if(e)return e.rollbackFrame()})))},p.prototype.getFrame=function(){return this.frames[0]},p.prototype.getReferences=function(){for(var e={},t=0,r=this.frames;t<r.length;t++){var i=r[t];_.merge(e,i.getReferences())}return e},o=p})(powerbi=powerbi||{}),(powerbi||(powerbi={})).columnPropertiesAuthoringModuleFactory=function(){return{getColumnPropertiesForExprs:function(e,t){var r=[];if(t.columnProperties)for(var i=0,a=e;i<a.length;i++){var n=a[i],o=t.query.defn.selectNameOf(n),o=t.columnProperties[o];o&&r.push({originalExpr:n,columnProperty:o})}return r},applyColumnPropertiesByExpr:function(t,e,r,i){(i=_.find(i,(function(e){return e.originalExpr===t})))&&(e=r.query.defn.selectNameOf(e),r.columnProperties[e]||(r.columnProperties[e]=i.columnProperty))}}},(function(V){var w,e,I,b,E,m,d,N,i,t,P,T,n,F,y,v,h,g,o,j,s,O,f,l,D,R,A,C,k,p;function a(e){return void 0!==e.expr}function u(e){return void 0!==e.role}function c(e,t,r){return e.name!==V.visuals.cartesianRoleNames.rows||!s.supportsSmallMultiplesDataViewMapping(null==r?void 0:r.dataViewMappings)||!(!(r=t.query)||!r.defn)&&(!!(r=V.data.QueryProjectionsByRole.getRole(r.projections,e.name))&&0<_.size(r.all())||t.hasUsedSmallMultiples)}function M(e,t,r){var i,a=e.properties[t];return r&&r[e.objectName]&&r[e.objectName].properties[t]&&(i=r[e.objectName].properties[t].type),E.encodePropertyValue(a,i||{})}function B(e,t,r,i,a,n){this.visualPluginService=e,this.geoTaggingService=t,this.aggrOps=r,this.featureSwitchService=i,this.visualAuthoringCustomizeOperations=a,this.displayNameService=n,this.visualPluginOps=V.explore.services.createVisualPluginOps(e,i)}w=V.explore||(V.explore={}),e=w.services||(w.services={}),I=jsCommon.ArrayExtensions,b=V.data.DataViewObjectDefinition,E=V.data.DataViewObjectDefinitions,m=V.data.DataViewObjectDescriptors,d=V.data.DataViewRoleWildcard,N=V.explore.util.DrillUtils,i=V.data.FieldExprPattern,t=V.visuals.GradientUtils,P=w.util.HierarchyUtils,T=jsCommon.JsonComparer,n=V.data.QueryProjectionCollection,F=V.data.QueryProjectionsByRole,y=V.data.ScopeIdentityExtractor,v=V.data.Selector,h=V.data.dsr.SelectToIdentityExpressionsVisitor,g=V.data.SemanticFilter,o=V.data.SemanticQuery,j=w.contracts.SingleVisualConfig,s=V.visuals.SmallMultiplesUtils,O=V.data.SQExpr,f=V.data.SQExprBuilder,l=V.data.SQExprConverter,D=V.explore.utils.SQExprToRoleDictionary,R=V.data.SQExprUtils,A=V.data.SQHierarchyExprUtils,C=V.explore.util.VisualContainerUtils,k=w.contracts.VisualQuery,e.createVisualAuthoringCore=function(e,t,r,i,a,n){return new p(e,t,r,i,a,n)},e.isRemoveExpressionOptions=a,e.isRemoveFieldOptions=u,e.applyPropertyChanges=function(e,t,r,a){if(!e)return!1;var i=!1;function n(e,t,r,i){a&&a(e.objectName,e.selector,t,r,i,i&&e.properties&&e.properties[t])}if(e.replace)for(var o=0,s=e.replace;o<s.length;o++){var l=s[o],p=E.ensure(r,l.objectName,l.selector),u={};for(C in l.properties)b.isValidPropertyName(C)&&(u[C]=M(l,C,t));var c=p.properties;if(!E.allPropertiesAreEqual(c,u)){for(var i=!0,d=0,m=E.getUnequalProperties(c,u);d<m.length;d++)n(l,C=m[d],c[C],u[C]);p.properties=u}}if(e.merge)for(var v=0,y=e.merge;v<y.length;v++){var h,l=y[v],p=E.ensure(r,l.objectName,l.selector);for(C in l.properties)b.isValidPropertyName(C)&&(h=M(l,C,t),E.propertiesAreEqual(p.properties[C],h)||(i=!0,n(l,C,p.properties[C],h),p.properties[C]=h))}if(e.remove)for(var g=0,f=e.remove;g<f.length;g++){l=f[g];if(p=E.getObjectDefinition(r,l.objectName,l.selector))for(var C in l.properties)b.isValidPropertyName(C)&&p.properties.hasOwnProperty(C)&&(i=!0,n(l,C,p.properties[C],void 0),delete p.properties[C])}if(e.removeObject)for(var x=0,S=e.removeObject;x<S.length;x++){l=S[x];if(p=E.getObjectDefinition(r,l.objectName,l.selector)){if(a)for(var C in p.properties)n(l,C,p.properties[C],void 0);i=E.deleteObjectDefinition(r,l.objectName,l.selector)||i}}return i},e.isRoleAllowedForSmallMultiples=c,B.prototype.create=function(e){var t=this.visualPluginService.capabilities(e.visualType),r=V.visualCapabilitiesHelperModuleFactory().create(t,this.geoTaggingService);if(r){var i,a=e.query||new k(o.create(),{},[]),n={visualType:e.visualType,query:a};for(i in e.autoSelectVisualType&&(n.autoSelectVisualType=!0),this.visualAuthoringCustomizeOperations.customizeOptions(n,e.schema),n.query.projections)this.ensureDependentObjectDefn(r.objectDescs,i,n);a=e.expr,t=!e.inFilterVisualContainer&&a&&!_.isArray(a)&&R.shouldUseAsFieldParameter(this.featureSwitchService.featureSwitches.fieldParametersAuthoring,e.schema,e.expr,!w.FilterUtils.supportsFilterOutput(t),this.visualPluginOps.isAnalysisVisual(e.visualType));if(_.isEmpty(a)||this.tryAdd(r,n,t,e))return{singleVisual:n}}},B.prototype.add=function(e,t,r){var i,t=t.singleVisual;return!(!t||(i=this.visualPluginService.capabilities(t.visualType),!(i=V.visualCapabilitiesHelperModuleFactory().create(i,this.geoTaggingService)))||(t.query||(t.query=new k(o.create(),{},[])),!this.tryAdd(i,t,r,e))||(this.visualAuthoringCustomizeOperations.customizeOptions(t,e.schema),B.clearConversionSourceContext(t),0))},B.prototype.toggleHidden=function(e,t,r){t=e.getQueryRef(t,{fieldIndex:r});e.toggleHidden(t)},B.prototype.remove=function(e,t,r){t=t.singleVisual;return!!t&&!!this.tryRemove(t.query,t.columnProperties,e,r)&&(B.clearConversionSourceContext(t),!0)},B.prototype.removeAllParametersAndProjectionsFromRole=function(e,t,r,i,a){var n=t&&t.config;if(n){var o=n&&n.singleVisual&&n.singleVisual.query;if(o){var s=o.getQueryFieldParametersByRole(e);if(s&&0<s.length){for(var o={},l=o[e]=[],p=0,u=s;p<u.length;p++){var c=u[p];l.push({parameter:c,result:[]})}this.resolveParameters(r,t,o,i,a,void 0);for(var d=s.length-1;0<=d;d--){c=s[d];this.remove({count:void 0,projOptions:{parameter:c},role:e,shouldRemoveParameter:!0},n,r)}}}}},B.prototype.move=function(e,t){var r,i=t.singleVisual;if(!i)return!1;if(e.sourceRole===e.targetRole&&!e.replacementExpressions)return!!i.query.moveProjection(e.targetRole,e.sourceIndex,e.targetIndex,e.sourceCount)&&(B.clearConversionSourceContext(i),!0);var a=[];if(!(null==(r=i.query)?void 0:r.getParameterByFieldIndex(e.sourceIndex,e.sourceRole))){var n=i.query.tryGetFieldExprs(e.sourceRole);if(_.isEmpty(n)||n.length<e.sourceCount)return!1;for(var o=0;o<e.sourceCount;o++)if(a[o]=n[e.sourceIndex+o],!a[o])return!1}return this.moveProjectionCore(t,a,e)},B.prototype.convert=function(e){var t=e.source;if(!t)return!1;var r=(r=t.conversionSourceContext)||(t.conversionSourceContext=this.createConversionSourceContext(t.query,t.visualType,t.syncGroup)),i=this.visualPluginService.capabilities(r.visualType),a=this.visualPluginService.capabilities(e.target);if(!i||!a||_.isEmpty(a.dataRoles))return!1;if(T.equals(i,a))n=this.visualPluginService.capabilities(t.visualType),this.convertRoleWildCardProperties(n,a,t.objects),t.query=r.query,t.visualType=e.target,t.visualType===e.target&&a.supportsSynchronizingFilterState&&(t.syncGroup=r.syncGroup);else if(e.skipRoleMapping)t.query=r.query,t.visualType=e.target;else{var n=e.schema,o=this.convertDrillableRoles(r.query,i,a,e.target,n),s=o.query,l=N.getDrillableRoles(a),p=this.getUniqueQueryFields(r.query,e.target),p=_.differenceWith(p,o.convertedFields,k.isEqualQueryFields),u=V.visualCapabilitiesHelperModuleFactory().create(a,this.geoTaggingService),o=V.visualCapabilitiesHelperModuleFactory().create(i,this.geoTaggingService),c=(u.orderByRolePreferences(n,p),F.clone(s.projections)),p=this.getExpressionRoleMappings(t.query,p),p=this.getConversionExprRoleList(p,o,u,n,e.target,t,c,l);if(_.isEmpty(p)&&_.isEmpty(s.projections))return!1;for(var d=0,m=p;d<m.length;d++){var v=m[d];v.isFieldParameter?s.addParameter(v.expr,v.roleName):s.add(v.expr,v.roleName,{nativeReferenceName:v.nativeReferenceName,isHidden:v.isHidden}),this.ensureDependentObjectDefn(u.objectDescs,v.roleName,t)}for(var y,o=N.getDrillableRoles(this.visualPluginService.capabilities(t.visualType)),h=(_.isEmpty(o)?(y=N.getDrillableRoles(i),r):(y=o,t)).query,g=0,f=l;g<f.length;g++){var C=f[g];if(s.projections[C]){s.ensureActiveItems(C);for(var x=0,S=y;x<S.length;x++){var b=S[x];h.projections[b]&&(s.projections[C].activeProjectionRefs=h.projections[b].activeProjectionRefs)}}}this.updateTargetShowAllInfo(r,s,u),s.removeUnusedOrderBy(),s.resetExpansionStates(),this.convertRoleWildCardProperties(i,a,t.objects),this.upgradePivotTableProperties(t.objects,t.visualType,e.target),t.query=s,t.visualType=e.target,this.visualAuthoringCustomizeOperations.customizeOptions(t,n)}return!0},B.prototype.convertRoleWildCardProperties=function(e,t,r){if(!_.isEmpty(r)){var i=_.chain(e.dataRoles).filter((function(e){return e.kind!==V.VisualDataRoleKind.Measure})).map((function(e){return e.name})).value(),a=_.chain(t.dataRoles).filter((function(e){return e.kind!==V.VisualDataRoleKind.Measure})).map((function(e){return e.name})).value();if(!_.isEmpty(i)&&!_.isEmpty(a))for(var n in r){n=r[n];if(!_.isEmpty(n))for(var o=0,s=n;o<s.length;o++){var l=s[o].selector;if(l&&!_.isEmpty(l.data))for(var p=0,u=l.data.length;p<u;p++){var c=l.data[p];v.isRoleWildcard(c)&&_.isEqual(_.sortBy(c.roles),_.sortBy(i))&&(l.data[p]=d.fromRoles(a))}}}}},B.prototype.upgradePivotTableProperties=function(e,t,r){"matrix"!==t&&"table"!==t||"pivotTable"!==r&&"tableEx"!==r||(E.moveProperty(e,"general",void 0,"textSize","grid"),E.moveProperty(e,"general",void 0,"autoSizeColumnWidth","columnHeaders")),"matrix"===t&&"pivotTable"===r&&(E.moveProperty(e,"general",void 0,"columnSubtotals","subTotals"),E.moveProperty(e,"general",void 0,"rowSubtotals","subTotals")),"table"===t&&"tableEx"===r&&E.moveProperty(e,"general",void 0,"totals","total")},B.prototype.setAggregate=function(e,t){var r;return!!t.singleVisual.query.setAggregate(e.role,e.index,e.newAggregate)&&(r=this.generateNativeReferenceNameForOperation(e,t),t.singleVisual.query.setNativeReferenceNameByRoleAndProjectionIndex(e.role,e.index,r),B.clearConversionSourceContext(t.singleVisual),!0)},B.prototype.removeAggregate=function(e,t){var r;return!!t.singleVisual.query.removeAggregate(e.role,e.index)&&(r=this.generateNativeReferenceNameForOperation(e,t),t.singleVisual.query.setNativeReferenceNameByRoleAndProjectionIndex(e.role,e.index,r),B.clearConversionSourceContext(t.singleVisual),!0)},B.prototype.setPercentOfGrandTotal=function(e,t){var r;return!!t.singleVisual.query.setPercentOfGrandTotal(e.role,e.index)&&(r=this.generateNativeReferenceNameForOperation(e,t),t.singleVisual.query.setNativeReferenceNameByRoleAndProjectionIndex(e.role,e.index,r),B.clearConversionSourceContext(t.singleVisual),!0)},B.prototype.removePercentOfGrandTotal=function(e,t){var r;return!!t.singleVisual.query.removePercentOfGrandTotal(e.role,e.index)&&(r=this.generateNativeReferenceNameForOperation(e,t),t.singleVisual.query.setNativeReferenceNameByRoleAndProjectionIndex(e.role,e.index,r),B.clearConversionSourceContext(t.singleVisual),!0)},B.prototype.setPercentOfRoleTotal=function(e,t){return!!t.singleVisual.query.setPercentOfRoleTotal(e.roleRefs,e.role,e.index)&&(B.clearConversionSourceContext(t.singleVisual),!0)},B.prototype.removePercentOfRoleTotal=function(e,t){return!!t.singleVisual.query.removePercentOfRoleTotal(e.role,e.index)&&(B.clearConversionSourceContext(t.singleVisual),!0)},B.prototype.updateVisualCalculation=function(e,t,r,i,a){var n=e.singleVisual.query;return!!n&&!!n.updateVisualCalculation(t,r,i,a)&&(B.clearConversionSourceContext(e.singleVisual),!0)},B.prototype.toggleShowAll=function(e,t){t.singleVisual.query.toggleShowAll(e),B.clearConversionSourceContext(t.singleVisual)},B.prototype.changeActiveProjection=function(e,t,r){e=t.query.projections[e];if(e){var i,a=_.uniqBy(e.all(),(function(e){return e.queryRef})),n=_.uniq(e.activeProjectionRefs),o=(i=_.isEmpty(n)?i:n.length)&&_.findIndex(a,(function(e){return e.queryRef===n[i-1]}));if(!(null==o||o<0)){if(1===r){if(!(1<=o))return;n.pop(),1!==i&&n[i-2]===a[o-1].queryRef||n.push(a[o-1].queryRef)}else{if(3===r&&(n.length=0),!(a.length>o+1))return;n.push(a[o+1].queryRef)}return B.clearConversionSourceContext(t),e.activeProjectionRefs=n}}},B.prototype.addDrillFilter=function(e,t,r,i,a){this.addDrill(e,t,r,i,a,2,!0)},B.prototype.addDrillToDetailsFilter=function(e,t,r,i,a){_.remove(t,(function(e){return!!e.expression&&R.isMeasure(e.expression)})),this.addDrill(e,t,r,i,a,0,!1)},B.prototype.addDrill=function(p,u,c,e,d,m,v){if(u&&c&&!_.isEmpty(e)&&d)for(var t=function(e){var t,r=c.defn.select().withName(e).expr,e=d.expr,i=O.isNot(e),a=(i&&(e=e.arg),y.getInExpr(e)),n=[],o=void 0,s=r.getKeyColumns(p);if(!_.isEmpty(a.values))for(var l=0;l<a.args.length;l++)!(function(t){var e=a.args[t];e&&-1!==R.indexOfExpr(s,e)&&(n.push(e),e=_.map(a.values,(function(e){return[e[t]]})),o=_.isEmpty(o)?e:_.chain(o).zip(e).map((function(e){return _.flatten(e)})).value())})(l);_.isEmpty(n)||_.isEmpty(o)||(e=f.inValues(n,o||[]),i&&(e=f.not(e)),i=V.DataViewScopeIdentity.filterFromIdentity([{kind:1,expr:e,key:d.key}]),e=_.filter(u,(function(e){return O.equals(r,e.expression)})),(t=v?_.find(e,(function(e){return e.howCreated===m})):t)?(t.filter=i,t.howCreated=m,t.precedence=0):(e={name:null,expression:r,filter:i,type:w.contracts.FilterType.Categorical,howCreated:m,precedence:0},u.push(e)))},r=0,i=e;r<i.length;r++)t(i[r])},B.prototype.removeDrillFilter=function(e,t){if(!e)return!1;var r;this.ensureFiltersArrayIsValid(e);for(var i=0,a=e.length;i<a;i++){var n=e[i];if(n&&(2===n.howCreated&&O.equals(t,n.expression))){r=i;break}}return void 0!==r&&(e.splice(r,1),!0)},B.prototype.setMatchingFilterToAuto=function(t,e){e.filters&&(e=_.find(e.filters,(function(e){return null!=e&&O.equals(e.expression,t)})))&&(e.howCreated=0)},B.prototype.removeAutoFilterFromContract=function(r,e,t){var i,a;r&&(i=r.filters)&&(a=r.config.singleVisual.query,t=null!=t?t:this.getRemoveOptionsQueryRefs(e,a),_.forEach(t,(function(e){var e=a.defn.select().withName(e),t=e?e.expr:void 0,e=I.filterArray(i,(function(e){return"removeAutoFilterFromContract: visualContainer with name ".concat(r.name," contains blank value in .filters"),null!=e&&0===e.howCreated&&O.equals(e.expression,t)}));0<e.length&&(e.length,w.FilterUtils.isFilterModified(e[0])?e[0].howCreated=1:_.remove(r.filters,e[0]))})),this.ensureFiltersArrayIsValid(i))},B.prototype.ensureFiltersArrayIsValid=function(e){if(null!=e)for(var t=e.length-1;0<=t;t--)null==e[t]&&e.splice(t,1)},B.prototype.getRemoveOptionsQueryRefs=function(e,t){var r,i=[],a=e,n=a.projOptions;if(a.role&&null!==n.fieldIndex){var o=n.fieldIndex,s=n.parameter;if(s)for(var l=null!=(n=s.length)?n:0,p=0;p<l;p++){var u=t.getQueryRef(a.role,{parameter:s,indexInParameter:p});i.push(u)}else for(var c=null!=(n=a.count)?n:1,p=0;p<c;p++)(u=t.getQueryRef(a.role,{fieldIndex:o+p}))&&i.push(u)}else e.expr&&(n=I.ensureArray(e.expr),r=t.defn.select(),_.forEach(n,(function(t){var e=_.filter(r,(function(e){e=e.expr;return O.isAggregation(e)&&(e=e.arg),O.equals(e,t)}));_.forEach(e,(function(e){e&&e.name&&i.push(e.name)}))})));return i},B.prototype.isEmptyQueryVisual=function(e){var t,e=e.config.singleVisual;return!!(e&&this.visualPluginOps.isQueryVisual(e.visualType)&&e.query&&0===e.query.defn.select().length&&_.isEmpty(e.query.getQueryFieldParameters()))&&!(!(t=this.visualPluginService.capabilities(e.visualType))||(t=V.ScriptResultUtil.extractScriptResultFromVisualConfig(t.dataViewMappings,e.objects))&&!jsCommon.StringExtensions.isNullOrUndefinedOrWhiteSpaceString(t.source))},B.prototype.setDefaultSort=function(e,t,r,i){if(e.config&&e.config.singleVisual){var e=e.config.singleVisual,a=i.capabilities(e.visualType);if(r.shouldApplyDefaultSort(e,a)){i=e.query;if(i){var r=i.defn,n=i.projections,o=r.select(),s=[],l=_.filter(a.dataRoles,(function(e){return!(_.has(e,"joinPredicate")||0===e.joinPredicate)}));if(_.some(l,(function(e){var e=F.getRole(n,e.name);if(e)return e=_.map(e.all(),(function(e){return o.withName(e.queryRef)})),_.some(e,(function(e){return e&&e.expr&&!_.isEmpty(e.expr.getOrderByColumns(t))}))})))e.hasDefaultSort&&(e.query=new k(r.orderBy([]),i.projections,i.expansionStates),e.hasDefaultSort=!1);else{for(var p,u=i.hasVisualCalcExpressions(),c=(u&&(p=r.orderBy(),_.some(p,(function(e){return R.isMeasure(e.expr)})))&&(e.query=new k(r.orderBy([]),i.projections,i.expansionStates),e.hasDefaultSort=!1),!1),d=0,m=l;d<m.length;d++){var v=m[d],y=F.getRole(n,v.name);if(y){var h=_.map(y.all(),(function(e){return e.queryRef}));if(h){for(var g=!1,f=[],C=this.shouldDefaultExpandSort(v.name,a.expandAndSort,h.length),x={direction:1,expr:null},S=0,b=h;S<b.length;S++){var E=b[S],N=o.withName(E),N=N&&N.expr;if(N&&R.isExprValidForSorting(N)&&(!u||!R.isMeasure(N))){var V=N.getMetadata(t);if(V){var w=1===V.kind&&V.type.numeric;if(C&&(V.type.text||V.type.temporal||V.type.numeric&&_.first(h)!==E?f.push({direction:1,expr:N}):C=!1),null==x.expr&&(N&&w&&(x.direction=2),x.expr=N),V.type.temporal&&(g=c=!0,!C))break;if(w&&(g=!0,!C))break}}}if(C&&_.isEmpty(s)){_.isEmpty(f),s=f;break}if(g&&(_.isEmpty(s)||c)&&(s=[x]),c||C)break}}}_.isEmpty(s)||(e.hasDefaultSort=!0,e.query=new k(r.orderBy(s),i.projections,i.expansionStates))}}}}},B.prototype.setDefaultExpandLevel=function(n,e,t,o,s,l){var p,u=this,c=e.capabilities(n.config.singleVisual.visualType);t&&c.expandAndSort&&_.includes(c.expandAndSort,t)&&n.config&&n.config.singleVisual&&(p=n.config.singleVisual.query)&&c.expandAndSort.forEach((function(e){var t=F.getRole(p.projections,e);if(t){var r=t.getQueryRefs();if(u.shouldDefaultExpandSort(e,c.expandAndSort,r.length)){var i=!1;if(s)if(1===l){var a=r.indexOf(s[e].projectionName);if(a<0)return;a===r.length-2&&r.length-1===s[e].totalNumberOfProjections?i=!0:a<r.length-1&&r.splice(a+1),i=!0}else 2===l&&(i=!!_.isEmpty(s)||s[e].currentPosition===s[e].totalNumberOfProjections);i&&(t.activeProjectionRefs=_.map(r,(function(e){return e})),u.setDrillMode(n,2,o))}}}))},B.prototype.ensureValidDrillState=function(e,t,r){for(var i=0,a=t;i<a.length;i++){var n=a[i],o=(this.removeDrillFilter(e.filters,n.expr),e.config.singleVisual.query),n=o.projections[n.roleName];n&&null!=(n=_.last(n.activeProjectionRefs))&&(o=o.defn.select().withName(n).expr,this.removeDrillFilter(e.filters,o))}this.ensureValidDrillMode(e,r)},B.prototype.ensureValidDrillMode=function(e,t){var r=e.drillMode;(1===r&&0===t.getSupportedDrillDirections(e)||2===r&&!t.canDrillToDetails(e))&&this.setDrillMode(e,0,t)},B.prototype.resolveParameters=function(b,E,e,N,V,w){var P={queryChange:!1,aliasChange:!1,outputFilterChange:!1,totalAddAttemptCount:0,totalAddSuccessCount:0,totalRemoveAttemptCount:0,totalRemoveSuccessCount:0,totalSuccessColumnCount:0,totalSuccessDateHierarchyCount:0,totalSuccessMeasureCount:0},T=E&&E.config&&E.config.singleVisual&&E.config.singleVisual.query;if(T){var F,t,j=[];for(F in e)for(var D=T.projections[F],R=D.getFieldParameters(),A=this,r=0,i=e[F];r<i.length;r++)!(function(e){var t=e.parameter,r=e.result,i=_.find(R,(function(e){return e.index===t.index}));if(!i)return;if(!O.equals(t.expr,i.expr))return;for(var a,n,o,s=D.getParameterProjections(i),l=_.map(s,(function(e){return T.defn.select().withName(e.queryRef).expr})),p=_.map(r,(function(e){return e.expr})),u=I.getLongestCommonSubsequence(p,l,O.equals),c=u.length-1,d=[],m=[],v=[],y=l.length-1;0<=y;y--)0<=c&&O.equals(l[y],u[c])?c--:(S={role:F,projOptions:{parameter:i,indexInParameter:y}},m.push(S),d.push(s[y].queryRef),a={expr:l[y],roleName:F},v.push(a));0<m.length&&(n=(e=A.removeWithValidation(T,d,m,E,b,v,N,V,void 0,!0)).removeSuccessCount,o=e.removeAttemptCount,e=e.outputFilterChange,P.totalRemoveSuccessCount+=n,P.totalRemoveAttemptCount+=o,P.outputFilterChange||(P.outputFilterChange=e));for(var c=0,h=0,g=0,y=0;y<p.length;y++){var f,C,x=r[y].alias,S={parameter:i,indexInParameter:y-(h-g)};0<u.length&&O.equals(p[y],u[c])?(c++,w&&(P.aliasChange=w(E,S,F,x)||P.aliasChange)):(C={expr:f=p[y],schema:b,targetRole:F,projOptions:S},h++,A.add(C,E.config,!1)&&(g++,O.isColumn(f)?P.totalSuccessColumnCount++:O.isMeasure(f)?P.totalSuccessMeasureCount++:O.isHierarchyLevel(f)&&P.totalSuccessDateHierarchyCount++,j.push(f),w)&&(P.aliasChange=w(E,S,F,x)||P.aliasChange))}P.totalAddAttemptCount+=h})(i[r]);P.totalAddSuccessCount=j.length,0<P.totalAddSuccessCount&&(t=this.runAddFieldValidation(E,b,j,N,V,void 0,!0),P.outputFilterChange||(P.outputFilterChange=t)),(0<P.totalAddSuccessCount||0<P.totalRemoveSuccessCount)&&(this.setDefaultSort(E,b,V,this.visualPluginService),C.setQueryKeepProjectionOrder(E),P.queryChange=!0)}return P},B.prototype.runAddFieldValidation=function(e,t,r,i,a,n,o,s,l,p){this.ensureValidDrillMode(e,i);var u=!1;if(o&&!this.featureSwitchService.featureSwitches.fieldParameterDynamicSlicer||(u=(null==(n=(n||this.updateFilterState.bind(this))(t,e,!1,!0,!0,void 0,p))?void 0:n.clearOrDefault)||(null==n?void 0:n.updateAll)),o||(this.setDefaultExpandLevel(e,this.visualPluginService,s,i,l,2),this.setDefaultSort(e,t,a,this.visualPluginService),C.setQueryKeepProjectionOrder(e)),_.isArray(r))for(var c=0,d=r;c<d.length;c++){var m=d[c];this.setMatchingFilterToAuto(m,e)}else this.setMatchingFilterToAuto(r,e);return u},B.prototype.removeWithValidation=function(e,t,r,i,a,n,o,s,l,p){var u=0,c=[],d=!1;this.removeAutoFilterFromContract(i,void 0,t);for(var m,v,y=0;y<r.length;y++){var h=this.remove(r[y],i.config,a);u+=h?1:0,h||c.push(y)}if(0<u){if(0<c.length){t=_.clone(t);for(var g=c.length-1;0<=g;g--)t.splice(c[g],1)}p||(m=this.captureCurrentActiveProjectionsByRole(i),this.setDefaultExpandLevel(i,this.visualPluginService,null==(v=_.first(r))?void 0:v.role,o,m,0)),this.ensureValidDrillState(i,n,o),this.isEmptyQueryVisual(i)?e=i.config.singleVisual.query=void 0:p||(this.setDefaultSort(i,a,s,this.visualPluginService),C.setQueryKeepProjectionOrder(i)),p&&!this.featureSwitchService.featureSwitches.fieldParameterDynamicSlicer||(d=(null==(v=(l||this.updateFilterState.bind(this))(a,i,!0,!0,!0,null))?void 0:v.clearOrDefault)||(null==v?void 0:v.updateAll)),p||this.clearUnusedObjectDefinitions(i,e,t)}return{removeAttemptCount:r.length,removeSuccessCount:u,outputFilterChange:d}},B.prototype.clearUnusedObjectDefinitions=function(e,t,r){_.forEach(r,(function(i){var a;t&&t.isUsed(i)||(a=e.config.singleVisual.objects,_.forEach(a,(function(e,t){var r=[];_.forEach(e,(function(e){e.selector&&e.selector.metadata===i&&r.push(e.selector)})),_.forEach(r,(function(e){E.deleteObjectDefinition(a,t,e)}))})))}))},B.prototype.updateFilterState=function(e,t,r,i,a,n){var o=t.config.singleVisual,s=this.visualPluginService.capabilities(o.visualType),s=s?s.objects:null;if(i&&this.ensureDefaultFilterApplied(e,o,r))return{clearOrDefault:!0,updateAll:!1};i=!1;if(a){r=this.updateFilterOutput(o,s,e);if(2===r)return{clearOrDefault:!0,updateAll:!1};i=1===r}a=t.config.singleVisual;return{clearOrDefault:!1,updateAll:i=!i&&n&&a&&a.objects&&E.getValue(a.objects,n,null)?!0:i}},B.prototype.ensureDefaultFilterApplied=function(e,t,r){var i=this.visualPluginService.capabilities(t.visualType),i=i?i.objects:null,a=m.findDefaultValue(i),n=t.query&&t.query.getUniqueQueryRefs();if(!a||_.isEmpty(n))return this.clearDefaultFilterOutput(t,i);for(var o=t.query.defn.select(),s=[],l=[],p=!0,u=0,c=_.map(n,(function(e){return o.withName(e).expr}));u<c.length;u++){var d=c[u];R.getDefaultValue(d,e)?p?s.push.apply(s,this.getExprKeyColumns(d,e)):l.push.apply(l,this.getExprKeyColumns(d,e)):p=!1}if(_.isEmpty(s)&&_.isEmpty(l)||r)return this.clearDefaultFilterOutput(t,i);t.objects||(t.objects={});a=m.findFilterOutput(i),n=g.getDefaultAnyValueFilter(s,l);return E.setValue(t.objects,a,null,n),!0},B.prototype.getExprKeyColumns=function(e,t){var r=l.asFieldPattern(e);return r.column||r.groupingColumn||r.hierarchyLevel?e.getKeyColumns(t):[e]},B.prototype.clearDefaultFilterOutput=function(e,t){var r;return!!e.objects&&!!(t=m.findFilterOutput(t))&&!(!(r=E.getValue(e.objects,t,null))||!g.isDefaultFilter(r)||(E.deleteProperty(e.objects,t.objectName,null,t.propertyName),0))},B.prototype.updateFilterOutput=function(e,t,r){var i;return e.objects&&(t=m.findFilterOutput(t))&&(i=E.getValue(e.objects,t,null))?this.featureSwitchService.featureSwitches.fieldParameterDynamicSlicer&&e.query?(r=this.updateFilterOutputForVisual(e.query,i,r),g.isSameFilter(r,i)?0:r?(E.setValue(e.objects,t,null,r),1):(E.deleteProperty(e.objects,t.objectName,null,t.propertyName),2)):(E.deleteProperty(e.objects,t.objectName,null,t.propertyName),2):0},B.prototype.updateFilterOutputForVisual=function(e,t,r){var i=e.getUniqueQueryRefs();if(!_.isEmpty(i)){var a=new h,n=e.defn.select(),o=_.map(i,(function(e){return n.withName(e).expr.accept(a,r)})).reduce((function(e,t){return e.concat(t)}),[]);if(!_.isEmpty(o)){for(var s,l=[],p=0,u=t.where();p<u.length;p++){var c=u[p],d=R.syncSQExprWithFilterIdenities(o,c.condition);d&&(d={target:c.target,condition:d,annotations:c.annotations},l.push(d))}return s=0<l.length?new g(t.from(),l):s}}},B.prototype.moveProjectionCore=function(e,t,r){var i=e.singleVisual;if(!i||!i.query)return!1;var a=r.sourceRole,n=r.targetRole,o=r.sourceIndex,s=r.targetIndex,l=r.replacementExpressions,p=r.schema,u=r.allowPartialReplace,c=j.clone(i),d=c.query.getParameterByFieldIndex(o,a),m=c.query.defn.orderBy(),v=t,y=(_.isEmpty(l)||(v=_.map(l,(function(e,t){t=v[t];return t?{expr:e,isFieldParameter:t.isFieldParameter,isHidden:t.isHidden}:{expr:e}}))),V.columnPropertiesAuthoringModuleFactory()),h=y.getColumnPropertiesForExprs(_.map(v,(function(e){return e.expr})),c),l={role:a,projOptions:{fieldIndex:o,parameter:d},count:t.length,shouldRemoveParameter:!0};if(!this.tryRemoveProjections(c.query,c.columnProperties,l))return!1;0<m.length&&c.query.orderBy(m);var t=this.visualPluginService.capabilities(i.visualType),g=V.visualCapabilitiesHelperModuleFactory().create(t,this.geoTaggingService);if(!g)return!1;var f=g.roles.withName(n);if(!f)return!1;var C=a===n&&s===o,l=!1;if(C){if(1===v.length&&R.shouldUseAsFieldParameter(this.featureSwitchService.featureSwitches.fieldParametersAuthoring,p,v[0].expr,this.featureSwitchService.featureSwitches.fieldParameterDynamicSlicer||!w.FilterUtils.supportsFilterOutput(t),this.visualPluginOps.isAnalysisVisual(c.visualType))){var x={expr:v[0].expr,schema:p,targetRole:n,projOptions:{fieldIndex:s}};if(!(l=this.tryAdd(g,c,!0,x)))return!1}}else if(d){x={expr:d.expr,schema:p,targetRole:n,projOptions:{fieldIndex:s},hideOnOverflow:r.hideOnOverflow};if(!(l=this.tryAdd(g,c,!0,x)))return!1}if(!l)for(var S=0;S<v.length;S++){var b=v[S].expr,E=v[S],N=(E.expr=this.aggregateIfNecessary(E.expr,f,p),E.isHidden=E.isHidden&&R.isMeasure(E.expr),C?void 0:v[S].nativeReferenceName),x={expr:E.expr,schema:p,targetRole:n,projOptions:{fieldIndex:s+S,nativeReferenceName:N,isHidden:E.isHidden},hideOnOverflow:r.hideOnOverflow};if(!this.tryAdd(g,c,!1,x)){if(0<S&&u)break;return!1}i.query.projections[a].showAll&&(N=v[S].expr.getMetadata(p),this.isShowAllRole(f.kind))&&N&&1!==N.kind&&(c.query.projections[n].showAll=!0),y.applyColumnPropertiesByExpr(b,E.expr,c,h)}return e.singleVisual=c,this.visualAuthoringCustomizeOperations.customizeOptions(e.singleVisual,p),B.clearConversionSourceContext(e.singleVisual),!0},B.prototype.aggregateIfNecessary=function(e,t,r){return null!=i.getAggregate(e,r)||t.kind!==V.VisualDataRoleKind.Measure||R.discourageAggregation(e,r)?t.kind===V.VisualDataRoleKind.Grouping?f.removeAggregate(e,r):e:this.aggrOps.createExprWithAggregate(e,r,!0,t.requiredTypes)},B.clearConversionSourceContext=function(e){e.conversionSourceContext=null},B.prototype.getConversionExprRoleList=function(o,s,l,p,u,c,d,m){function e(e){for(var t=[],r=0,i=o;r<i.length;r++){var a,n=i[r];n.isFieldParameter?t.push({expr:n.expr,isFieldParameter:n.isFieldParameter,roleName:n.roleName}):(a=e(n.expr))&&t.push({expr:a,nativeReferenceName:n.nativeReferenceName})}if(!_.isEmpty(t))return v.getCompatRolesForExprs(t,s,l,p,u,c,!0,d,m)}var v=this,t=this.getCompatRolesForExprs(o,s,l,p,u,c,!1,d,m);return _.isEmpty(t)&&(t=e((function(e){return R.isMeasure(e)?e:v.aggrOps.createExprWithAggregate(e,p,!0,null)}))),(t=_.isEmpty(t)?e((function(e){return R.isMeasure(e)?f.removeAggregate(e,p):e})):t)||[]},B.prototype.getCompatRolesForExprs=function(e,t,r,i,a,n,o,s,l){for(var p=[],u=s||{},c=new D(P.hierarchyLevelComparer),d=0,m=e;d<m.length;d++){var v=m[d],y=void 0,h=v.expr,g=v.isFieldParameter,f=v.roleName,C=v.nativeReferenceName,x=v.isHidden,S=(f&&(y=t.roles.withName(f)),this.getTargetRoleForConversion(v,t,r)),S=r.findCompatibleRole({queryProjections:u,schema:i,expr:h,targetRole:S,preferDrillableRoles:!1,roleToExprMap:c,useStrict:!0,isFieldParameter:g,sourceRole:g&&y,isHidden:v.isHidden});if(y=S&&S.role){y=this.ensureCorrectKeyInfluencersRole(a,y,void 0),v=this.ensureCorrectSmallMultiplesRole(n,r.capabilities,y,t.capabilities,f).name;if(!g){this.updateProjections(u,v,l);S=r.getNumberRangesForRoles(u)[v];if(this.shouldUseVariation(h,i,v,l,S,_.size(e)))return y=A.getSourceVariationExpr(h),p.push({expr:y,roleName:v,nativeReferenceName:C}),p}if(p.push({expr:h,isFieldParameter:g,roleName:v,nativeReferenceName:C,isHidden:x}),o)return p}}return p},B.prototype.shouldUseVariation=function(e,t,r,i,a,n){if(!_.includes(i,r)&&a&&a.max<n){i=l.asFieldPattern(e,t);if(i&&i.columnHierarchyLevelVariation)return!0}return!1},B.prototype.getExpressionRoleMappings=function(t,e){return _.map(e,(function(e){return{expr:e.expr,roleName:t.getRoleNameForExpr(e.expr),isFieldParameter:e.isFieldParameter,nativeReferenceName:e.nativeReferenceName,isHidden:e.isHidden}}))},B.prototype.getTargetRoleForConversion=function(e,t,r){if(!r.hasPreferredTypes()){var e=e.roleName,i=t.roles,t=t.capabilities,a=r.roles,r=r.capabilities,i=i.withName(e),a=a.withName(e);if(i&&a&&_.isEqual(i.kind,a.kind)){i=this.getDataViewMappingConditions(t),a=this.getDataViewMappingConditions(r);if(!i&&!a||this.getDoesTargetRoleMatchSourceRole(e,i,a))return e}}},B.prototype.getDoesTargetRoleMatchSourceRole=function(r,e,i){return e&&i&&!e.some((function(e,t){e=_.get(e,r,null),t=_.get(i[t],r,null);return e&&t&&!_.isEqual(e,t)}))},B.prototype.getDataViewMappingConditions=function(e){e=e.dataViewMappings&&e.dataViewMappings[0];return e&&e.conditions},B.prototype.updateProjections=function(e,t,r){var i={queryRef:t},a=F.getRole(e,t);a||(e[t]=a=new n([])),a.addProjection(i),_.includes(r,t)&&a.addActiveQueryReference(a.all()[0].queryRef)},B.prototype.createConversionSourceContext=function(e,t,r){return{query:e,visualType:t,syncGroup:r}},B.prototype.convertDrillableRoles=function(e,t,r,i,a){var n=new k(e.defn.select([]),{},[]),t=N.getDrillableRoles(t);return _.isEmpty(t)?{query:n,convertedFields:[]}:{query:n,convertedFields:this.convertDrillableProjections(r,i,e,a,t,n)}},B.prototype.convertDrillableProjections=function(e,t,r,i,a,n){for(var o=N.getDrillableRoles(e),s=[],l=0,p=a;l<p.length;l++){var u=p[l],u=this.getQueryFieldsForRole(r,u,t),u=this.convertDrillableFields(u,i,e,n),s=_.unionWith(s,u,k.isEqualQueryFields);if(_.isEmpty(o))break}return n.ensureDrillableRoles(o),s},B.prototype.getQueryFieldsForRole=function(e,t,r){return e.projections[t]?this.getQueryFields(r,(function(){return e.tryGetFieldExprs(t)})):[]},B.prototype.getUniqueQueryFields=function(e,t){return this.getQueryFields(t,(function(){return e.getUniqueQueryFields()}))},B.prototype.getQueryFields=function(e,t){t=t();if(this.visualPluginOps.isAnalysisVisual(e))for(var r=0,i=t;r<i.length;r++)i[r].isFieldParameter=!1;return t},B.prototype.convertDrillableFields=function(u,c,e,d){for(var m,v=V.visualCapabilitiesHelperModuleFactory().create(e,this.geoTaggingService),y=v.getNumberRangesForRoles(d),h=N.getDrillableRoles(e),g=_.isEmpty(h),f=new D(P.hierarchyLevelComparer),C=[],x=[],S=this,t=0,r=u;t<r.length;t++)!(function(e){var t=e.expr,r=e.queryName,i=e.nativeReferenceName;if(O.isHierarchyLevel(t)){var a=A.getSourceVariationExpr(e.expr);if(a&&_.find(x,(function(e){return O.equals(e,a)})))return C.push(e)}var n=v.findCompatibleRole({queryProjections:d.projections,schema:c,expr:t,preferDrillableRoles:!0,roleToExprMap:f,useStrict:!0,isFieldParameter:e.isFieldParameter}),n=n&&n.role;if(n){var o=n.name,s=y[o],l=-1;if(e.isFieldParameter)l=d.addParameter(t,n.name),C.push(e);else{var p=d.projections[o];if(g&&p&&(m=p.all().length,s)&&s.max&&s.max<=m)return;if(S.shouldUseVariation(e.expr,c,n.name,h,s,_.size(u)))return p=A.getSourceVariationExpr(e.expr),x.push(p),l=d.add(p,o,{exprName:r,nativeReferenceName:i});l=d.add(t,o,{exprName:r,nativeReferenceName:i})}-1<l&&C.push(e)}})(r[t]);return C},B.prototype.tryRemove=function(e,t,r,i){return u(r)?this.tryRemoveProjections(e,t,r):!!a(r)&&this.tryRemoveExpressions(e,r,i)},B.prototype.tryRemoveExpressions=function(e,t,r){var i,a=!1,n=t.fieldParameter;if(_.isArray(t.expr))for(var o=0,s=t.expr;o<s.length;o++)var l=s[o],a=e.removeExpr(l,!!t.ignoreAggregates,r,null==n?void 0:n.expr)||a;else a=e.removeExpr(t.expr,!!t.ignoreAggregates,r,null==n?void 0:n.expr);return a=t.shouldRemoveParameter&&n&&0===(null!=(i=n.length)?i:0)?e.removeParameter(n)||a:a},B.prototype.tryRemoveProjections=function(e,t,r){var i=r.role,a=r.projOptions.parameter,n=!1;if(a)var o=r.shouldRemoveParameter,s=r.projOptions.indexInParameter,n=this.removeParameterProjections(e,t,a,i,o,s);else for(var l=r.projOptions.fieldIndex,p=(null!=(a=r.count)?a:1)-1;0<=p;p--)if(!(n=this.removeProjection(e,t,i,{fieldIndex:l})))return!1;return n},B.prototype.removeParameterProjections=function(e,t,r,i,a,n){var o=!1;if(null!=n)var s={parameter:r,indexInParameter:n},o=this.removeProjection(e,t,i,s);else for(var l=(null!=(n=r.length)?n:0)-1;0<=l;l--){s={parameter:r,indexInParameter:l};if(!(o=this.removeProjection(e,t,i,s)))return!1}return o=a&&0===(null!=(n=r.length)?n:0)?e.removeParameterByRoleName(r,i)||o:o},B.prototype.removeProjection=function(e,t,r,i){var a=e.getQueryRef(r,i),r=e.removeProjection(r,i);return a&&!e.isUsed(a)&&t&&t[a]&&delete t[a],r},B.prototype.tryAdd=function(e,t,r,i){var a=i.expr,n=new D(P.hierarchyLevelComparer),o=!1,s=i.projOptions;if(_.isArray(a))for(var l=s&&s.fieldIndex,p=0,u=a;p<u.length;p++){var c=u[p],o=null!=this.tryAddQuery(e,t,i,c,s,n,r,i.hideOnOverflow)||o;null!=l&&s.fieldIndex++}else if(null==this.tryAddQuery(e,t,i,a,s,n,r,i.hideOnOverflow))return!1;if(!r){var d=N.getDrillableRoles(e.capabilities);if(t.query.ensureDrillableRoles(d),_.isArray(a))return o}return!0},B.prototype.tryAddQuery=function(e,t,r,i,a,n,o,s){s=e.findCompatibleRole({queryProjections:t.query.projections,schema:r.schema,expr:i,preferDrillableRoles:!1,roleToExprMap:n,targetRole:r.targetRole,isFieldParameter:o,overflowIsWarning:s,isHidden:a&&a.isHidden});if(s&&s.role&&this.tryHideOnOverflow(s,t.query,a)){var l,p,s=this.ensureCorrectKeyInfluencersRole(t.visualType,s.role,r.targetRole);if(this.featureSwitchService.featureSwitches.cartesianMultiplesAuthoring||c(s,t,e.capabilities)||(s=this.ensureCorrectSmallMultiplesRole(t,e.capabilities,s,void 0,void 0)),e.validateDuplicateColumnsInRole(s,i,t.query,o))return l=s.name,p=void 0,p=o?t.query.addParameter(i,l,a&&a.fieldIndex):(null==(o=null==a?{}:Object.assign({},a)).nativeReferenceName&&(o.nativeReferenceName=this.displayNameService.createUniqueNativeReference(i,r.schema,t.query,e.capabilities,void 0)),t.query.add(i,l,o)),this.ensureDependentObjectDefn(e.objectDescs,l,t),n.add(i,s),p}},B.prototype.tryHideOnOverflow=function(e,t,r){if(!e.error)return!0;if(e.error===V.DataViewAnalysis.DataViewMappingMatchErrorCode.conditionRangeTooLarge){if(r&&r.isHidden)return!0;var i=t.tryGetFieldExprs(e.role.name);if(_.isEmpty(i))return!1;for(var a=0;a<i.length;a++){var n=i[a];if(!n.isFieldParameter&&R.isMeasure(n.expr)&&!n.isHidden)return this.toggleHidden(t,e.role.name,a),!0}}return!1},B.prototype.generateNativeReferenceNameForOperation=function(e,t){var r,i,a=t.singleVisual.query.getQueryRefByProjectionIndex(e.role,e.index);return null==a?("queryRef does not exist while role ".concat(e.role,", projection index ").concat(e.index),""):(r=t.singleVisual.query.defn.select().withName(a),i=this.visualPluginService.capabilities(t.singleVisual.visualType),this.displayNameService.createUniqueNativeReference(r.expr,e.schema,t.singleVisual.query,i,a))},B.prototype.captureCurrentActiveProjectionsByRole=function(e){if(e){var t=this.visualPluginService.capabilities(e.config.singleVisual.visualType),r=e.config.singleVisual.query;if(r){var i={};if(t&&t.expandAndSort)return t.expandAndSort.forEach((function(e){var t=F.getRole(r.projections,e);t&&t.activeProjectionRefs&&(i[e]={projectionName:_.last(t.activeProjectionRefs),currentPosition:t.activeProjectionRefs.length,totalNumberOfProjections:t.getQueryRefs().length})})),i}}},B.prototype.ensureCorrectKeyInfluencersRole=function(e,t,r){return e!==V.visuals.plugins.keyDriversVisual.name||t.name!==V.visuals.keyDriverRoleNames.details||r?t:_.find(V.visuals.getKeyDriversCapabilities().dataRoles,(function(e){return e.name===V.visuals.keyDriverRoleNames.explainBy}))},B.prototype.ensureCorrectSmallMultiplesRole=function(e,t,r,i,a){var n;return null!=(n=this.featureSwitchService.featureSwitches)&&n.cartesianMultiplesAuthoring||!s.supportsSmallMultiplesDataViewMapping(null==t?void 0:t.dataViewMappings)||r.name!==V.visuals.cartesianRoleNames.rows||i&&a===V.visuals.cartesianRoleNames.rows&&s.supportsSmallMultiplesDataViewMapping(null==i?void 0:i.dataViewMappings)||e.hasUsedSmallMultiples?r:_.find(t.dataRoles,(function(e){return e.name===V.visuals.cartesianRoleNames.category}))},B.prototype.ensureDependentObjectDefn=function(e,t,r){if(e)for(var i in e){var a,n=e[i];for(a in n.properties){var o,s=n.properties[a];s.rule&&s.rule.inputRole===t&&(o=(o=r.objects)||(r.objects={}),(o=E.ensure(o,i,null)).properties[a]||(o.properties[a]=this.createDefaultDefinition(s.type)))}}},B.prototype.createDefaultDefinition=function(e){if(e.fillRule)return t.getDefaultFillRuleDefinition()},B.prototype.getSourceShowAllInfo=function(e){for(var t={},r=0,i=_.values(e);r<i.length;r++)for(var a=i[r],n=a.showAll,o=0,s=a.all();o<s.length;o++)t[s[o].queryRef]=n;return t},B.prototype.updateTargetShowAllInfo=function(e,t,r){for(var i=this.getSourceShowAllInfo(e.query.projections),a=0,n=_.keys(t.projections);a<n.length;a++){var o=n[a],s=r.roles.withName(o).kind;if(this.isShowAllRole(s))for(var l=0,p=t.projections[o].all();l<p.length;l++){var u=i[p[l].queryRef];u&&(t.projections[o].showAll=u)}}},B.prototype.isShowAllRole=function(e){return e===V.VisualDataRoleKind.Grouping||e===V.VisualDataRoleKind.GroupingOrMeasure},B.prototype.shouldDefaultExpandSort=function(e,t,r){return this.featureSwitchService.featureSwitches.easierHierarchicalAxis&&_.includes(t,e)&&1<r},B.prototype.setDrillMode=function(e,t,r){r.setDrillMode(e,t)},p=B})(powerbi=powerbi||{}),(function(v){var S,e,y,u,h,b,r,E,g,c,i,f;function C(e,t,r){this.displayNameService=e,this.featureSwitches=t,this.visualPluginService=r}function o(e,t,r){this.isRoleSortable=e,this.getSortableFieldsForRole=t,this.featureSwitchService=r,this.groups=[],this.allSortableFields=[],this.uniqueGroupKeys=[],this.uniqueRoles=[]}S=v.explore||(v.explore={}),e=S.services||(S.services={}),y=v.DataViewMapping,u=v.data.QueryProjectionsByRole,h=v.visuals.SmallMultiplesUtils,b=v.data.SQExpr,r=v.data.SQExprBuilder,E=v.data.SQExprUtils,g=v.explore.util.VisualContainerUtils,c=S.contracts.VisualQuery,e.createSortService=function(e,t,r){return new i(e,t,r)},C.prototype.getSortableFields=function(e){var t=e.visualType,r=this.visualPluginService.capabilities(t);return r&&this.isVisualSortable(r)?(t=this.createIsRoleSortableDelegate(t,e.compiledMappings),this.getGroupedSortableFieldsFromProjections(e.query,e.schema,r,e.columnProperties,t)):{sortableFields:[],sortGroups:[]}},C.prototype.createIsRoleSortableDelegate=function(e,t){var r,i=this.visualPluginService.getPlugin(e),e=this.visualPluginService.capabilities(e);return i.getSortableRoles&&e.sorting?(e={dataViewMappings:t,featureSwitches:this.featureSwitches.featureSwitches},r=i.getSortableRoles(e),_.isEmpty(r)?function(e){return!1}:function(e){return 0<=r.indexOf(e)}):function(e){return!0}},C.prototype.addSort=function(e,t){e&&e.defn&&t&&(e.defn=e.defn.orderBy(t))},C.prototype.removeSort=function(e,t){if(e&&e.defn&&t)for(var r=0,i=t;r<i.length;r++){var a=i[r];e.defn=e.defn.removeOrderBy(a.expr)}},C.prototype.resetSort=function(e){var t;e&&e.defn&&(t=e.defn.orderBy(),this.removeSort(e,t))},C.prototype.applyImplicitSort=function(e,t){if(!t)return e;var r=e.defn;if(!r)return e;for(var t=t.clauses,i=r.select(),a=[],n=0,o=t;n<o.length;n++){var s,l=o[n],p=u.getRole(e.projections,l.role);p&&(s=l.direction,a.push.apply(a,_.map(p.all(),(function(e){return{expr:i.withName(e.queryRef).expr,direction:s}}))))}return _.isEmpty(a)?e:new c(r.orderBy(a),e.projections,e.expansionStates)},C.prototype.shouldApplyDefaultSort=function(e,t){var r,i;return!(null!=(r=t.sorting)&&r.custom||null!=(r=t.sorting)&&r.implicit||!(r=e.query)||(i=g.createRoleKindByQueryRef(r),(null==(i=null==(t=null==(r=v.DataViewAnalysis.chooseDataViewMappings(r.projections,t.dataViewMappings,i,this.featureSwitches.featureSwitches))?void 0:r.supportedMappings)?void 0:t[0])?void 0:i.matrix)&&h.isSmallMultiplesDataViewMapping(i)))&&(e.hasDefaultSort||_.isEmpty(e.query.defn.orderBy()))},C.prototype.ensureValidSorting=function(e){var t=e.query,r=t.defn;if(!r)return t;var i=r.orderBy();if(_.isEmpty(i))return t;var e=this.getSortableFields(e).sortableFields,a=[];if(!_.isEmpty(e))for(var n=0,o=e;n<o.length;n++){var s=o[n];a.push.apply(a,this.createSortDefinitions(s))}for(var l=!1,p=i.length-1;0<=p;p--)!(function(t){if(_.find(a,(function(e){return b.equals(e.expr,i[t].expr)})))return;i.splice(t,1),l=!0})(p);return l?new c(r.orderBy(i),t.projections,t.expansionStates):t},C.prototype.isVisualSortable=function(e){return _.some(e.dataRoles,(function(e){return e.kind!==v.VisualDataRoleKind.Measure}))},C.prototype.getGroupedSortableFieldsFromProjections=function(a,n,o,s,e){var t,l=this,p=a.defn.select(),u=a.defn.orderBy(),r=g.createRoleKindByQueryRef(a),r=v.DataViewAnalysis.chooseDataViewMappings(a.projections,o.dataViewMappings,r,this.featureSwitches.featureSwitches),i=new f(e,function(e,t,r,i){e=a.getRolesActiveProjectionsRefs([e],!1);return _.isEmpty(e)?[]:l.createSortableFieldsForQueryRefs(n,p,e,u,o,s,0!==r,t,i)},this.featureSwitches);if(r.supportedMappings)for(var c=0,d=r.supportedMappings;c<d.length;c++){var m=d[c];m.matrix&&h.isSmallMultiplesDataViewMapping(m)?y.visitMatrix(m.matrix,i):m.categorical&&null!=(t=this.featureSwitches.featureSwitches)&&t.sortLegend&&y.visitCategorical(m.categorical,i)}return _.isEmpty(i.groups)?this.getDefaultGroupSortableFieldsFromProjections(a,r,n,o,s,e):{sortableFields:i.allSortableFields,sortGroups:i.groups}},C.prototype.getDefaultGroupSortableFieldsFromProjections=function(e,t,r,i,a,n){i.dataRoles;for(var o=[],s=e.defn.select(),l=e.defn.orderBy(),p=_.some(t.supportedMappings,(function(e){return e.categorical})),u=0,c=i.dataRoles;u<c.length;u++){var d,m=c[u].name;n(m)&&(d=e.getRolesActiveProjectionsRefs([m],!1),_.isEmpty(d)||(m=!_.isEmpty(e.projections[m].activeProjectionRefs),d=this.createSortableFieldsForQueryRefs(r,s,d,l,i,a,p&&m,C.DefaultSortGroupKey),o.push.apply(o,d)))}return this.createResultWithSortGroup(o)},C.prototype.createSortableFieldsForQueryRefs=function(o,s,e,l,p,u,c,d,m){for(var v,y=!1,h=Number.MAX_VALUE,g=[],f=[],C=[],x=this,t=0,r=e;t<r.length;t++)!(function(e){var t=s.withName(e),r=null==t?void 0:t.expr;if(!r||!E.isExprValidForSorting(r))return;var i=x.getDisplayNameFromQueryRef(o,s,e,p,u),a=x.applySortingScope(r,m),n=_.findIndex(l,(function(e){return b.equals(e.expr,a)}));n!==S.constants.invalidSortExprIndex&&(h=Math.min(h,n)),c?((y=y||n!==S.constants.invalidSortExprIndex)&&!v&&(v=l[n].direction),f.push({name:e,expr:r}),C.push(i)):(y=n!==S.constants.invalidSortExprIndex,v=y?l[n].direction:void 0,g.push({displayName:i,exprs:[t],active:y,orderByIndex:y?n:void 0,sortDirection:v,groupKey:d,scope:m}))})(r[t]);return c?_.isEmpty(f)?[]:[{displayName:C.join(" "),exprs:f,active:y,orderByIndex:y?h:void 0,sortDirection:y?v:void 0,groupKey:d,scope:m}]:g},C.prototype.getDisplayNameFromQueryRef=function(e,t,r,i,a){t=null==(t=t.withName(r))?void 0:t.expr;return t?this.displayNameService.getDisplayName(t,e,i,r,a):""},C.prototype.createResultWithSortGroup=function(e){var t=[];return _.isEmpty(e)||t.push({key:C.DefaultSortGroupKey,displayName:null,fields:e,isDefaultGroup:!0}),{sortableFields:e,sortGroups:t}},C.prototype.createSortDefinitions=function(e){for(var t=[],r=0,i=e.exprs;r<i.length;r++){var a=i[r];t.push({expr:this.applySortingScope(a.expr,e.scope),direction:null!=(a=e.sortDirection)?a:2})}return t},C.prototype.applySortingScope=function(e,t){return _.isEmpty(t)?e:r.scopedEval(e,t)},C.DefaultSortGroupKey="Default",i=C,e.SortService=i,o.prototype.visitRole=function(e,t){if(this.isRoleSortable(e))switch(t){case"MatrixColumnsGroup":case"CategoricalSeries":this.featureSwitchService.featureSwitches.sortLegend&&this.addRole(e,"Legend",1);break;case"MatrixRowsGroup":return void this.addRole(e,e,1);case"CategoricalCategory":return void this.addRole(e,"Category",1);case"MatrixIntersection":case"MatrixRowsScopedValue":return void this.addRole(e,"Rows",0,!0,[r.roleRef("Rows")]);case"CategoricalValue":case"CategoricalValueGroup":return void this.addRole(e,"Category",0,!0);default:return}},o.prototype.addRole=function(e,t,r,i,a){var n;if(i=void 0===i?!1:i){if(!(n=_.find(this.groups,(function(e){return e.key===t}))))return}else n={key:t,displayName:o.RoleToSortGroupDisplayName[t],fields:[]};r=this.getSortableFieldsForRole(e,t,r,a);_.isEmpty(r)||(_.includes(this.uniqueRoles,e)||((a=this.allSortableFields).push.apply(a,r),this.uniqueRoles.push(e)),(a=n.fields).push.apply(a,r),i)||_.includes(this.uniqueGroupKeys,n.key)||(this.groups.push(n),this.uniqueGroupKeys.push(n.key))},o.prototype.visitReduction=function(){},o.prototype.enterComposite=function(){},o.prototype.exitComposite=function(){},o.RoleToSortGroupDisplayName=((e={}).Rows="Sort_Group_Small_multiples",e.Category="Sort_Group_Axis",e.Legend="Sort_Group_Legend",e),f=o})(powerbi=powerbi||{}),(function(b){var E=b.DataViewAnalysis.DataViewMappingMatchErrorCode;b.visualCapabilitiesHelperModuleFactory=function(){var a=b,e=a.data,t=(r=a.explore).contracts,r=r.util,i=jsCommon.ArrayExtensions,o=a.DataViewMapping,s=a.DataViewAnalysis,c=r.DrillUtils,g=jsCommon.MathExtensions,l=e.SQExpr,p=e.SQExprConverter,f=t.VisualQuery,v=a.ValueType;function n(e){return e&&e.geography&&(e.geography.latitude||e.geography.longitude)}function u(e){return _.some(e.preferredTypes,(function(e){return n(e)||e.numeric}))}function d(e){return 0===e.cartesianKind||1===e.cartesianKind}y.prototype.findCompatibleRole=function(e){e.queryProjections,e.schema,e.expr,e.targetRole,e.roleToExprMap;var t=e.expr,r=e.roleToExprMap,i=e.targetRole,a=e.preferDrillableRoles;if(l.isHierarchyLevel(t)){var a=!0,n=this.getExistingTargetRoleForHierarchyLevelIfAny(t,r);if(n){if(i&&i!==n.name)return;i=n.name}}var n=p.asFieldPattern(t,e.schema),n=(n&&(o=n.column||n.columnAggr||n.groupingColumn||n.groupingColumnAggr||n.measure),{projections:e.queryProjections,metadata:t.getMetadata(e.schema),columnName:o?o.name:void 0,preferDrillableRoles:a,targetRole:i,isFieldParameter:e.isFieldParameter,useStrict:e.useStrict,sourceRole:e.sourceRole,overflowIsWarning:e.overflowIsWarning,isHidden:e.isHidden}),o=this.findRole(n);return o||(n.preferDrillableRoles=!e.preferDrillableRoles,o=this.findRole(n)),o&&r&&r.add(t,o.role),o},y.prototype.findRole=function(e){var t,r=this.roleMappings;if(!_.isEmpty(r)){for(var i=r[0].getValueType(e.metadata?e.metadata.type:void 0,e.columnName),a=this.roles.allRolesWithPreference(i?i.extendedType:void 0,e.projections,e.preferDrillableRoles,e.useStrict,e.sourceRole),n=0,o=e.targetRole?[e.targetRole]:a;n<o.length;n++)for(var s=o[n],l=0,p=r;l<p.length;l++){var u=p[l].checkRoleCompatibility(e,s,a);if(u&&!u.error)return u;u&&(t=u)}return t}},y.prototype.getExistingTargetRoleForHierarchyLevelIfAny=function(e,t){return t.get(e)},y.prototype.orderByRolePreferences=function(e,t){for(var r=this.roles.defns,i=0,a=t.length,n=0,o=r.length;n<o;n++){var s=r[n].preferredTypes;if(!_.isEmpty(s))for(var l=i;l<a;l++){var p=t[l],u=p.expr.getMetadata(e);if(u){var c=u.type;if(c)for(var d=0,m=s.length;d<m;d++)if(c.extendedType===v.fromDescriptor(s[d]).extendedType){t.splice(l,1),t.splice(i,0,p),i++;break}}}}},y.prototype.getNumberRangesForRoles=function(e){for(var t=_.map(this.roles.defns,(function(e){return e.name})),r=e instanceof f?e.projections:e,i={},a=0,n=t;a<n.length;a++)i[c=n[a]]={min:1/0,max:0};for(var o=0,s=_.filter(this.roleMappings,(function(e){return void 0===e.verifyMappingConditions({projections:r,roleNames:t,preferDrillableRoles:!0,ignoreMin:!0})}));o<s.length;o++)for(var l=s[o].getCondition(),p=0,u=t;p<u.length;p++){var c=u[p],d=l&&l[c],m=void 0,m=d?{min:g.max(d.min,0),max:g.min(d.max,1/0)}:{min:0,max:1/0};(v=i[c]).min=Math.min(m.min,v.min),v.max=Math.max(m.max,v.max)}for(var v,y=0,h=_.values(i);y<h.length;y++)(v=h[y]).min=Math.min(v.min,v.max);return i},y.prototype.getNonLatLongRoles=function(){var e=this.getLatLongRoleNames();return this.getFilteredRoleNames(e)},y.prototype.getFilteredRoleNames=function(e){for(var t=this.capabilities.dataViewMappings,r=[],i=0,a=t;i<a.length;i++){var n=a[i];n.categorical&&o.visitCategoricalCategories(n.categorical.categories,{visitRole:function(e){r.push(e)}}),n.matrix&&o.visitMatrixRows(n.matrix.rows,{visitRole:function(e){r.push(e)}})}return _.without.apply(_,__spreadArray([_.uniq(r)],e||[],!1))},y.prototype.getLatLongRoleNames=function(){return this.getRoleNames(u)},y.prototype.getCartesianGroupingOrMeasureRoleNames=function(){return this.getRoleNames(d)},y.prototype.getRoleNames=function(e){return _.chain(this.capabilities.dataRoles).filter(e).map((function(e){return e.name})).value()},y.prototype.hasPreferredTypes=function(){return _.some(this.capabilities.dataRoles,(function(e){return!_.isEmpty(e.preferredTypes)}))},y.prototype.validateDuplicateColumnsInRole=function(e,t,r,i){var a,n;return!(e.noDuplicates&&(e=e.name,a=r.projections)&&a[e]&&(i?(i=a[e].getFieldParameters(),i=_.map(i,(function(e){return e.expr})),_.some(i,(function(e){return l.equals(t,e)}))):(i=a[e].all(),a=_.map(i,(function(e){return e.queryRef})),n=r&&r.defn&&r.defn.select(),e=_.map(a,(function(e){return n.withName(e).expr})),_.some(e,(function(e){return l.equals(t,e)})))))};var m=y;function y(e,t,r,i){this.capabilities=e,this.roles=t,this.objectDescs=r,this.roleMappings=i}C.prototype.getCondition=function(){return this.condition},C.prototype.checkRoleCompatibility=function(e,t,r){if(e.projections,e.metadata,e.metadata){var i=this.roles.withName(t);if(i){if(e.isFieldParameter)return{role:i};var a=s.getPropertyCount(t,e.projections),a=(e.isHidden||a++,this.validateRoleCompatibility(i,e.metadata,a,e.preferDrillableRoles)),a=a?{code:a,roleName:t}:void 0;if(!a)if(!this.verifyMappingConditions({projections:e.projections,roleNames:_.without(r,t),preferDrillableRoles:e.preferDrillableRoles,ignoreMin:!1}))return{role:i};return a&&a.roleName===t&&a.code===E.conditionRangeTooLarge&&e.overflowIsWarning?{role:i,error:a.code}:void 0}}},C.prototype.getValueType=function(e,t){return e=e&&null==e.categoryString&&null!=(t=t&&this.geoTaggingService.getFieldType(t))?v.fromPrimitiveTypeAndCategory(e.primitiveType,t):e},C.prototype.verifyMappingConditions=function(e){e.projections,e.roleNames;for(var t=0,r=e.roleNames;t<r.length;t++){var i=r[t],a=this.roles.withName(i);if(!a)return{code:"roleDoesNotExist",roleName:i};var n=s.getPropertyCount(i,e.projections),n=this.validateRange({count:n,roleName:a.name,preferDrillableRoles:e.preferDrillableRoles,ignoreMin:e.ignoreMin});if(n)return{code:n,roleName:i}}},C.prototype.validateRoleCompatibility=function(e,t,r,i){var r=this.validateRange({count:r,roleName:e.name,preferDrillableRoles:i,ignoreMin:!1});if(r)return r;var i=e.kind;if(1===t.kind){if(i===a.VisualDataRoleKind.Grouping)return E.conditionKindExpectedGrouping}else if(i===a.VisualDataRoleKind.Measure)return E.conditionKindExpectedMeasure;r=e.requiredTypes;return r&&!v.isCompatibleTo(t.type,r)?"exprTypeMismatch":null!=(r=null==(i=t.type)?void 0:i.misc)&&r.sparkline&&!e.supportsSparklines?"sparklineSupportMismatch":void 0},C.prototype.isRoleDrillable=function(e){return _.includes(this.drillableRoles,e)&&(!this.condition[e]||void 0===this.condition[e].max||1===this.condition[e].max)},C.prototype.validateRange=function(e){var t;return!(!this.condition||e.preferDrillableRoles&&this.isRoleDrillable(e.roleName))&&(t=this.condition[e.roleName])?s.validateRange(e.count,t,e.ignoreMin):void 0};var h=C;function C(e,t,r,i){this.roles=e,this.geoTaggingService=t,this.condition=i,this.drillableRoles=r}S.prototype.withName=function(e){return i.findItemWithName(this.defns,e)},S.prototype.allRolesWithPreference=function(t,r,i,e,a){var n=this,o=_.map(this.defns,(function(e){return e.name}));return a?this.promoteAndPenalize(o,(function(e){return n.getRoleWeight(a,e)})):this.promoteAndPenalize(o,(function(e){return n.getTypeWeightForRole(t,e.preferredTypes)}),e),this.promoteAndPenalize(o,(function(e){return n.getProjectionWeightForRole(e,r,i)})),o},S.prototype.promoteAndPenalize=function(e,t,r){for(var i=0,a=0,n=this.defns;a<n.length;a++){var o=n[a],s=t(o);null!=s&&(o=e.splice(e.indexOf(o.name),1)[0],s!==S.penalize||r?s===S.promote&&e.splice(i++,0,o):e.push(o))}},S.prototype.getRoleWeight=function(e,t){return e.kind===t.kind||this.hasCommonTypes(e.requiredTypes,t.requiredTypes)||this.hasCommonTypes(e.requiredTypes,t.preferredTypes)||this.hasCommonTypes(e.preferredTypes,t.requiredTypes)||this.hasCommonTypes(e.preferredTypes,t.preferredTypes)?S.promote:S.penalize},S.prototype.hasCommonTypes=function(e,t){return!_.isEmpty(e)&&!_.isEmpty(t)&&!_.isEmpty(_.intersectionWith(e,t,_.isEqual))},S.prototype.getTypeWeightForRole=function(e,t){if(t){for(var r=S.penalize,i=0,a=t;i<a.length;i++){var n=a[i];if(e===v.fromDescriptor(n).extendedType){r=S.promote;break}}return r}},S.prototype.getProjectionWeightForRole=function(e,t,r){t=t[e.name],t=t&&t.projected();return!r&&!_.isEmpty(t)&&e.kind!==b.VisualDataRoleKind.Measure||r&&e.kind===b.VisualDataRoleKind.Measure?S.penalize:void 0},S.penalize=-1,S.promote=1;var x=S;function S(e){this.defns=e}return{create:function(e,t){if(e&&!_.isEmpty(e.dataRoles)){for(var r=e.dataViewMappings,i=new x(e.dataRoles),a=[],n=0,o=r;n<o.length;n++){var s=o[n].conditions;if(_.isEmpty(s))a.push(new h(i,t,c.getDrillableRoles(e)));else for(var l=0,p=s;l<p.length;l++){var u=p[l];a.push(new h(i,t,c.getDrillableRoles(e),u))}}return new m(e,i,e.objects,a)}},dataRoleWrapper:function(e){return new x(e)},isValueTypeDescriptorLatLong:n,isRoleCompatibleWithLatLong:u,isRoleCompatibleWithScatterXY:d}}})(powerbi=powerbi||{}),(function(o){var e,r,i,a,n,s,l,p;function t(e,t,r){this.index=e,this.restartToken=t,r&&(this.hierarchyLastNodeIndex=r)}function u(e,t,r,i,a){this.hasExecutedQuery=!0,this.dataProxy=e,this.promiseFactory=r,this.filterGenerator=t,this.dataSegments=[],this.telemetryV2Enabled=a,this.visualPluginService=i}function c(e){e=contextActivity.getAncestorActivityPropertiesOfEvent((function(e){return"Open Report"===e.name}),e);return e&&e.includesBootstrap}e=(e=o.explore||(o.explore={})).services||(e.services={}),r=jsCommon.PerfTimer,i=o.visuals.plugins,a=o.data.segmentation.DataViewMerger,n=o.data.WindowExpansionState,s=o.data.WindowExpansionStateBuilder,t.prototype.endsBeforeNode=function(e){this.hierarchyLastNodeIndex;for(var t=this.hierarchyLastNodeIndex,r=Math.min(t.length,e.length),i=0;i<r;i++){var a=t[i],n=e[i];if(a<n)return!0;if(n<a)return!1}return e.length>t.length},l=t,e.DataSegment=l,e.createExploreVisualDataProxyService=function(e,t,r,i,a){return new p(e,t,r,i,a=void 0===a?!1:a)},u.prototype.generateQuery=function(e){var t=r.start("visualQueryGenerator(".concat(e.config.visualType,")")),e=e.visualQueryGenerator.execute({config:e.config,dataSources:e.dataSources,schema:e.schema,additionalFilters:e.hostServices.getFilters(this.filterGenerator,e.schema),restartToken:this.getRestartToken(e),cacheResponseOnServer:!(!e.isInitialLoad&&!e.cacheResponseOnServer),allowResultFromClientCache:e.allowResultFromClientCache,dataWindow:e.viewport,cacheOptions:e.cacheOptions,clientCacheOnly:e.clientCacheOnly,dataSourceVariables:e.hostServices.getDataSourceVariables(),performanceActivity:e.performanceActivity,executionMetricsKind:e.executionMetricsKind,telemetryV2Enabled:this.telemetryV2Enabled,requestPriority:e.requestPriority,applicationContext:e.applicationContext,windowExpansion:this.getWindowExpansion(e),disableAnchorTime:!!e.hostServices.disableAnchorTime||e.config.visualType===i.qnaVisual.name,drillableRoles:e.drillableRoles,useNativeReferenceNameAsDisplayNames:e.useNativeReferenceNameAsDisplayNames,disableHidden:e.disableHidden,enableAllSubtotal:e.enableAllSubtotal});return t(),e},u.prototype.getSegmentRestartToken=function(e){if(!(e<=0))return this.dataSegments[e-1].restartToken},u.prototype.runQuery=function(t){var r=this,e=(t.config,this.promiseFactory.defer(this.telemetryV2Enabled)),i=_.last(this.dataSegments),i=i&&i.restartToken;if(1!==t.executionType||i){var a,n=t.generatedQuery||this.generateQuery(t);if(n)if(t.additionalDataViewKinds&&n.options&&(n.options.kinds|=t.additionalDataViewKinds),n.error)e.reject(n.error),this.generatedQuery=void 0;else{if(!(this.generatedQuery&&this.hasExecutedQuery&&t.preferCurrentData&&o.data.areEquivalentOptions(n.options,this.generatedQuery.options)))return n=this.ensureRestartToken(t,n),this.shouldDelayExecution(t,n)?(this.resolveEmptyResult(n,e),o.createRejectablePromise2(e)):(t.performanceActivity&&(n.options.isColdLoad=c(t.performanceActivity),i=t.performanceActivity.getProperty("parent"))&&"Visual Container Lifecycle"===i.name&&(i.lifecycleFlags|=4096),(a=this.dataProxy.execute(n.options)).then((function(e){return r.handleQueryResult(e,n,a,t.config.query)}),(function(e){throw r.generatedQuery=void 0,e})));this.generatedQuery=n,e.resolve(null)}else this.generatedQuery=void 0,e.reject()}else e.reject();return o.createRejectablePromise2(e)},u.prototype.cancelQuery=function(e){this.dataProxy.cancelQuery(e)},u.prototype.ensureRestartToken=function(e,t){return 1!==e.executionType&&(this.dataSegments=[],e.preferCurrentData)&&(t=this.generateQuery(e),e.additionalDataViewKinds)&&(t.options.kinds|=e.additionalDataViewKinds),t},u.prototype.getRestartToken=function(e){var t=this.dataSegments.length-1;return e.preferCurrentData?this.getSegmentRestartToken(t):1===e.executionType?this.getSegmentRestartToken(1+t):void 0},u.prototype.getWindowExpansion=function(e){if(e.config&&e.config.query&&e.config.query.expansionStates){var t=e.config.visualType,t=this.visualPluginService.capabilities(t);if(_.some(t.dataViewMappings,(function(e){return e&&e.matrix&&e.matrix.rows&&e.matrix.rows.dataReductionAlgorithm&&e.matrix.rows.dataReductionAlgorithm.topNPerLevel})))return t=this.windowExpansionState,3===e.executionType&&(e.windowExpansionState,t=e.windowExpansionState),e.windowExpansionTransform?e.windowExpansionTransform(t):n.mergeWithExpansionState(_.first(e.config.query.expansionStates),t,e.config.query.defn.select(),e.schema)}},u.prototype.shouldDelayExecution=function(e,t){return!t.options.query.command||t.deferred&&1!==e.executionType&&2!==e.executionType},u.prototype.resolveEmptyResult=function(e,t){this.generatedQuery=e,this.hasExecutedQuery=!1,t.resolve({dataReaderResult:{dataView:{metadata:{columns:[]}}}})},u.prototype.handleQueryResult=function(e,t,r,i){return this.hasExecutedQuery=!0,this.generatedQuery=t,r.matchesLastExecuteQuery&&(e=this.rewriteQueryResultWithoutPerformanceActivities(e)),this.addNewDataSegment(e&&e.dataReaderResult),this.addWindowExpansionState(t,i,e&&e.dataReaderResult),e},u.prototype.addWindowExpansionState=function(e,t,r){1===_.size(e.compiledMappings)&&e.compiledMappings[0].matrix&&e.compiledMappings[0].matrix.rows&&e.compiledMappings[0].matrix.rows.dataReductionAlgorithm&&e.compiledMappings[0].matrix.rows.dataReductionAlgorithm.topNPerLevel?this.windowExpansionState=s.fromDataview(r.dataView):this.windowExpansionState=null},u.prototype.addNewDataSegment=function(e){var t,r=e&&e.restartToken,e=e&&e.dataView,e=e&&e.matrix&&e.matrix.rows&&e.matrix.rows.root,i=this.dataSegments.length,e=_.isEmpty(e&&e.children)?new l(i,r):(t=_.last(this.dataSegments),t=t?(t.hierarchyLastNodeIndex,_.clone(t.hierarchyLastNodeIndex)):[],a.updateTreeLastNodeIndex(e,t),new l(i,r,t));this.dataSegments.push(e)},u.prototype.rewriteQueryResultWithoutPerformanceActivities=function(e){var t;return e&&e.dataReaderResult&&e.dataReaderResult.performanceActivities?(delete(t=__assign({},e.dataReaderResult)).performanceActivities,__assign(__assign({},e),{dataReaderResult:t})):e},u.prototype.canLoadMore=function(){var e=_.last(this.dataSegments);return null!=e&&null!=e.restartToken},u.prototype.lastExecutedQuery=function(){return this.generatedQuery},u.prototype.getNodeSegment=function(t){return _.find(this.dataSegments,(function(e){return!e.endsBeforeNode(t)}))},u.prototype.discardSegmentsFrom=function(e){this.dataSegments.length=e},u.prototype.getLastNodeIndex=function(){if(!_.isEmpty(this.dataSegments))return _.last(this.dataSegments).hierarchyLastNodeIndex},u.prototype.getSecondToLastNodeIndex=function(){if(this.dataSegments&&!(this.dataSegments.length<2))return __spreadArray([],this.dataSegments[this.dataSegments.length-2].hierarchyLastNodeIndex,!0)},p=u,e.isColdLoad=c})(powerbi=powerbi||{}),(function(M){var B,e,o,Z,i,v,U,x,S,d,y,T,h,l,F,g,f,j,r,D,m,R,p,$,C,u,t,ee,a,A,I,z,O,k,L,q,re,b,E,te,G,Q,H;function N(e,t,r,i,a,n,o,s,l,p,u,c,d,m){this.dataReaders=e,this.displayNames=t,this.visualPluginService=r,this.pluginOps=i,this.sortService=a,this.filterGenerator=n,this.aggrOps=o,this.featureSwitchService=s,this.transformPluginService=l,this.telemetryService=p,this.visualTimeSynchronizationService=u,this.visualQueryCapabilitiesService=c,this.cachePolicyProviderService=d,this.localizationService=m}function n(e,t,r){var i=k.call(this)||this;return i.schema=e,i.compiledMappings=t,i.query=r,i.pointsPerSparkline=52,i}function s(e,t,r,i){var a=q.call(this)||this;return a.query=e,a.queryRewrites=t,a.objects=r,a.context=i,a}function ie(e){return{index:e.index}}function ae(e,t){var r;!t||e[r=t.index]||(e[r]={displayName:"",queryName:t.queryName,expr:t.expr})}function W(e,t){return{code:t,getDetails:function(){return{displayableErrorInfo:[],message:e}}}}function V(e,t){return{visual:{objects:e.objects,descriptors:t.objects},visualContainer:{objects:e.vcObjects,descriptors:B.contracts.VisualContainer.CommonObjectDescriptors}}}function X(e,t,r,i,a){var n,o,s,l,p,u=[];switch(e.name){case M.visuals.plugins.map.name:case M.visuals.plugins.azureMap.name:s=t,l=_.some(s,(function(e){return"Category"===e.roleName&&e.code===d.conditionRangeTooLarge})),p=_.some(s,(function(e){return"X"===e.roleName&&e.code===d.conditionKindExpectedGrouping})),s=_.some(s,(function(e){return"Y"===e.roleName&&e.code===d.conditionKindExpectedGrouping})),n=l?"DataViewMappingError_LocationAndLatLongGroup":p||s?"DataViewMappingError_LatLongAggregateWithNoLocation":void 0;break;case M.visuals.plugins.scatterChart.name:l=t,p=i,s=_.some(l,(function(e){return e.roleName===M.visuals.scatterRoleNames.category&&e.code===d.conditionRangeTooLarge})),o=_.some(l,(function(e){return e.roleName===M.visuals.scatterRoleNames.play&&e.code===d.conditionRangeTooLarge})),l=_.some(l,(function(e){return e.roleName===M.visuals.scatterRoleNames.x&&(e.code===d.conditionKindExpectedGrouping||e.code===d.conditionKindExpectedMeasure)})),n=s?p.featureSwitches.useModernFormatPane?"DataViewMappingError_ScatterGroupingValues":"DataViewMappingError_ScatterGroupingDetails":o?"DataViewMappingError_ScatterGroupingPlayAxis":l?"DataViewMappingError_ScatterXMismatchType":void 0;break;case M.visuals.plugins.slicer.name:_.find(t,(function(e){return e.code===d.conditionNotHierarchicallyRelated}))&&(n="DataViewMappingError_ConditionNotHierarchicallyRelated")}if(!n&&!_.isEmpty(t)){var c=(function(e){if(_.isEmpty(e))return null;for(var t=[],r=0,i=e;r<i.length;r++){var a,n=i[r];void 0!==n.conditionIndex&&void 0!==n.mappingIndex&&(a=n.conditionIndex,n=n.mappingIndex,t[a]||(t[a]=[]),t[a][n]?t[a][n]++:t[a][n]=1)}for(var o,s,l=e.length+1,p=0;p<t.length;p++)for(var u=0;u<t[p].length;u++)void 0!==t[p][u]&&l>t[p][u]&&(l=t[o=p][u],s=u);var c=e[0];void 0!==o&&(c=_.find(e,(function(e){return e.conditionIndex===o&&e.mappingIndex===s})));return c})(t);switch(c.code){case d.conditionRangeTooLarge:n="DataViewMappingError_ConditionRangeTooLarge";break;case d.conditionRangeTooSmall:n="DataViewMappingError_ConditionRangeTooSmall";break;case d.conditionKindExpectedMeasure:n="DataViewMappingError_ConditionKindExpectedMeasure";break;case d.conditionKindExpectedGrouping:n="DataViewMappingError_ConditionKindExpectedGrouping";break;case d.conditionNotHierarchicallyRelated:return new te(n="DataViewMappingError_ConditionNotHierarchicallyRelated",r);case d.conditionSchemaCapabilities_TupleFilters_InstanceFilters:n="DataViewMappingError_ConditionSchemaCapabilities_TupleFilters";break;case d.conditionKindExpectedGroupingOrMeasure:break;default:c.code}u=[(function(t,e,r){var i=t.roleName;_.isEmpty(e)||(e=_.find(e,(function(e){return e.name===t.roleName})))&&e.displayName&&(i=M.data.getDisplayName(e.displayName,r));return i})(c,a,r)]}if(n)return W(r.format(n,u),n)}function c(e,t,r){this.localizationService=t,this.messageId="VisualContainer_FailedToLoadVisual",this.displayableErrorInfo=[{errorInfoKey:"",errorInfoValue:""}],this.errorCode=e,this.hideErrorHelperText=!1,"Missing_References"===e?(this.displayableErrorInfo[0].errorInfoKey="Missing_References_Details_Title",this.displayableErrorInfo[0].errorInfoValue=r,this.detailsMessageFormat="Missing_References_Details_Message",this.messageId="Missing_References_Message",this.errorSource="User"):"Broken_Filters"===e?(this.displayableErrorInfo[0].errorInfoKey="ServiceError_CannotLoadVisual",this.displayableErrorInfo[0].errorInfoValue=this.localizationService.get("Broken_Filters_Details_Message"),this.messageId="Broken_Filters_Message"):"ClientError_NoSupportedDataViewMappingFound"===e?(this.displayableErrorInfo[0].errorInfoKey="VisualDisplayError_Title",this.displayableErrorInfo[0].errorInfoValue=this.localizationService.get("ClientError_NoSupportedDataViewMappingFound_Message"),this.messageId="ClientError_NoSupportedDataViewMappingFound_Message"):"NoSupportRTS_PublishToWeb"===e?(this.displayableErrorInfo[0].errorInfoKey="VisualContainer_UnableToFindVisualKey",this.displayableErrorInfo[0].errorInfoValue=this.localizationService.get("NoSupportRTS_PublishToWeb_Message"),this.messageId="NoSupportRTS_PublishToWeb_Title",this.errorSource="User",this.hideErrorHelperText=!0):"DQP_No_MappedColumns_In_HierarchySlicers"===e?(this.displayableErrorInfo[0].errorInfoKey="VisualContainer_FailedToLoadVisual",this.displayableErrorInfo[0].errorInfoValue=this.localizationService.get("DQP_No_MappedColumns_In_HierarchySlicers"),this.errorSource="User",this.hideErrorHelperText=!0,this.hideDebugInfo=!0,this.helperLink="https://go.microsoft.com/fwlink/?linkid=2139315"):"DataViewMappingError_ConditionNotHierarchicallyRelated"===e&&(this.messageId="DataViewMappingError_ConditionNotHierarchicallyRelated",this.displayableErrorInfo[0].errorInfoKey="VisualContainer_FailedToLoadVisual",this.displayableErrorInfo[0].errorInfoValue=this.localizationService.get("DataViewMappingError_ConditionNotHierarchicallyRelated_Details"),this.errorSource="User",this.hideErrorHelperText=!0,this.hideDebugInfo=!0,this.helperLink="https://go.microsoft.com/fwlink/?linkid=2114278")}function K(e,t,r,i){this.displayNameService=r,this.incompatibleExprInfo=[];for(var a=0,n=e.select();a<n.length;a++){var o=n[a],s=u.asFieldPattern(o.expr);s&&s.percentOfGrandTotal&&this.incompatibleExprInfo.push({basePropertyName:l.getPropertyName(s),fieldDisplayName:this.displayNameService.getQualifiedDisplayName(o.expr,t,i)})}this.warnings=[]}function w(e){this.errorInfos=e}function P(e){this.highlightDisableType=e}B=M.explore||(M.explore={}),e=B.services||(B.services={}),o=M.data.CacheOptions,Z=jsCommon.ArrayExtensions,i=M.ClientErrorStrings,v=M.data.CompiledDataViewMapping,U=M.data.DataBoundObjectQueryExtender,x=M.data.DataReaderUtils,S=M.explore.contracts.DataSource,d=M.DataViewAnalysis.DataViewMappingMatchErrorCode,y=M.data.DataViewObjectDefinitions,T=M.data.DataViewObjectDescriptors,h=M.data.services.DataViewObjectSerializer,l=M.data.FieldExprPattern,F=M.data.FilterKindDetector,g=M.data.DataViewObjectDefinitions.isObjectPropertySQExpr,f=M.data.DataViewObjectDefinitions.isObjectPropertySQExprWithContext,j=M.data.PrimitiveValueEncoding,r=M.data.RelativeDateFilterPattern,D=M.data.ScalarKeyUtils,m=M.data.Selector,R=M.data.SemanticFilter,p=M.data.SemanticQuery,$=M.data.SQExpr,C=M.data.SQExprBuilder,u=M.data.SQExprConverter,t=M.data.SQExprRewriter,ee=M.data.SQExprUtils,a=jsCommon.StringExtensions,A=B.util.VisualContainerUtils,I=M.data.WindowExpansionState,e.createVisualQueryGenerator=function(e){return e.dataReaders,e.displayNameService,e.plugin,e.pluginOps,e.sortService,e.aggrOps,e.filterGenerator,e.featureSwitchService,e.transformPluginService,e.telemetryService,e.visualTimeSynchronizationService,new O(e.dataReaders,e.displayNameService,e.plugin,e.pluginOps,e.sortService,e.filterGenerator,e.aggrOps,e.featureSwitchService,e.transformPluginService,e.telemetryService,e.visualTimeSynchronizationService,e.visualQueryCapabilitiesService,e.cachePolicyProviderService,e.localizationService)},N.prototype.shouldExecute=function(e,t){var r,i;return!(!e||_.isEmpty(t)||B.contracts.VisualContainer.isHidden(e)||(r=e.visualType,!(i=this.visualPluginService.capabilities(r)))||this.pluginOps.isQueryDisabled(r,i)||!this.getQueryGenerator(t,e))&&(null==e.query||e.query.areAllProjectionsHidden()?((e=[(t=V(e,i)).visual]).push(t.visualContainer),!_.isEmpty(e)&&U.needsToExtend(p.create(),e)):this.pluginOps.isQueryVisual(r)&&!this.pluginOps.isAnalysisVisual(r))},N.prototype.execute=function(e){e.performanceActivity&&e.performanceActivity.isRunning()&&(t=e.performanceActivity.createChildActivity({name:"Query Generation"}));var t,r=e.config,i=e.dataSources;if(!_.isEmpty(i)){var a=x.findTypes(i,r.query&&r.query.defn);if(!_.isEmpty(a)){var n=this.getAnchorTimeQueryOptions(e.cacheOptions,!e.disableAnchorTime,e.additionalFilters,e.config),o=n.anchorTime,s=n.cacheOptions,n=n.relativeTimeError;if(n)return{options:null,error:n};var n=this.dataReaders.queryGenerator(a),l=this.getCompileMappingsResult(r,r&&r.visualType,e.schema,n,e.additionalFilters,e.dataViewMappingsOverride,e.performanceActivity),i=this.dataReaders.queryExtensionLookup(i);if(l){if(l.error)return{options:null,error:l.error};var p=l.compiled;if(p){if(p.query&&p.query.defn&&!_.isEmpty(p.query.defn.select())&&!_.isEmpty(p.query.defn.transforms()))for(var u={},c=0,d=p.query.defn.select();c<d.length;c++){var m=d[c];$.isTransformOutputRoleRef(m.expr)||(u[m.name]=m)}var v,y=this.getVisualCapabilities(e.config.visualType),h=N.compileFilters(e.additionalFilters,y),i=this.generateQuery(n,e.schema,p,y.dataRoles,r.queryOptions&&r.queryOptions.keepProjectionOrder,y.filterMappings,h.dataFilter,h.highlightFilter,e.restartToken,e.dataWindow,e.dataSourceVariables,null,i,e.executionMetricsKind,y.noDefaultProjections,this.getWindowExpansionState(r,e.windowExpansion,e.schema),o,e.disableHidden,e.enableAllSubtotal),o=i.result,g=i.query,f=i.resolvedQuery,C=e.additionalFilters?e.additionalFilters.queryRefsForSingleItemDrillFilters:void 0,a=this.dataReaders.readerType(a);if(a)return v=S.queried(e.dataSources,f),(a={type:a,query:{dataSources:S.dataReaderDataSources(v),command:o.command,cacheOptions:s,clientCacheOnly:e.clientCacheOnly,cacheResponseOnServer:e.cacheResponseOnServer,allowResultFromClientCache:e.allowResultFromClientCache,allowClientSideFilters:this.getAllowClientSideFiltersOrDefault(e,y),ignoreViewportForCache:e.ignoreViewportForCache,performanceActivity:e.performanceActivity,applicationContext:e.applicationContext},perfId:e.config.visualType}).kinds=this.pluginOps.targetedDataViewKinds(e.config.visualType,g),v=(function(d,m,k,M,e,B,U,v,y,t,r,i,h,a,n,z,g,o,f,L,q,G,Q){var s=o?o.dataFilter:null,C={},x=ee.buildExprEvaluationContext(e.defn.from());r&&(C.objects=r,h)&&_.some(h,(function(e){return e.selectExprReplaced}))&&((r=new re(e.defn,h,r,x)).rewrite(),C.objects=r.rewrittenObjects);s&&(C.isDataFilterApplied=!0);i&&(C.splits=i);_.isEmpty(e.expansionStates)||(C.expansionStates=e.expansionStates);var S,r={options:d,transforms:C,warnings:a,compiledMappings:n,deferred:f},i=(function(e,t){if(_.isEmpty(t))return{queryForTransformActions:e,internalToPublicSelectNameMappingsByRole:{}};for(var i=e.clone(),r=0,a=t;r<a.length;r++)!(function(e){var t,r;e.selectExprAdded?(t=i.defn.select(),r=e.selectExprAdded,t[r.selectIndex]=r.namedSQExpr,i.defn=i.defn.select(t)):e.projectionQueryRefChanged?(r=e.projectionQueryRefChanged,i.projections[r.role].replaceQueryRef(r.oldQueryRef,r.newInternalQueryRef)):e.aggregatesAdded||e.selectExprReplaced||JSON.stringify(e)})(a[r]);e=_.reduce(t,(function(e,t){var r,t=t.projectionQueryRefChanged;return t&&((r=e[t.role])||(e[t.role]=r={}),r[t.newInternalQueryRef]=t.oldQueryRef),e}),{});return{queryForTransformActions:i,internalToPublicSelectNameMappingsByRole:e}})(e,h),b=i.queryForTransformActions,E=i.internalToPublicSelectNameMappingsByRole,N=b.defn.select(),V=b.defn.orderBy(),l=b.projections;if(s){var a=s.where(),H=ee.buildExprEvaluationContext(s.from());if(_.some(a,(function(e){return e.condition&&!_.isEmpty(e.condition.validate(m,v,void 0,H))})))return r.error=new te("Broken_Filters",t),r}if(r.filterContext={dataFilters:o.dataFiltersUnmerged,highlightFilters:o.highlightFilter,highlightFiltersUnmerged:o.highlightFiltersUnmerged,query:B},l){var p,w=[],u={},c=void 0;for(p in l)for(var W=u[p]=[],P=l[p],P=(_.isEmpty(P.activeProjectionRefs)||((c=c||{})[p]=_.map(P.activeProjectionRefs,(function(e){return{queryRef:e}}))),Q?P.all():P.projected()),T=0,F=P;T<F.length;T++){var j=F[T],D=Z.indexWithName(N,j.queryRef);w.push({queryRef:j.queryRef,format:j.format,queryIndex:D,roleName:p,displayName:j.displayName}),W.push(D)}C.selects=[];for(var R=[],n=b.defn.transforms(),X=!_.isEmpty(n),K=function(e,t){i=w,r=e;var r,i=_.chain(i).compact().filter((function(e){return e.queryIndex===r})).value(),a=N[e],e=g&&g[a.name];if(!X||e){e&&(a=e);e=ee.buildExprEvaluationContext(b.defn.from());if(!_.isEmpty(a.expr.validate(m,v,void 0,e)))return R.push(a.expr),"continue";var e=a.expr.getMetadata(m,x),n={type:e.type,expr:a.expr},o=(!ee.isMeasure(a.expr)&&(_.isEmpty(d.query.command)||f||y.keepAllMetadataColumns)&&(n.identityExprs=k.produceIdentities(a.expr,m)),ee.getKpiMetadata(a.expr,m)),s=(o&&(n.kpi=o),G&&!_.isEmpty(a.nativeReferenceName)?n.displayName=a.nativeReferenceName:(o=(function(e,t){if(t)for(var r=0,i=t;r<i.length;r++){var a=i[r].projectionQueryRefChanged;if(a)if(a.newInternalQueryRef===e)return a.oldQueryRef}return e})(a.name,h),s=_.find(i,(function(e){return e.queryRef===a.name&&e.displayName})),n.displayName=s?s.displayName:U.getDisplayName(a.expr,m,y,o,M)),i[0]);s&&(o=s.format||e.format)&&(n.format=o)}else n={expr:a.expr,displayName:a.name};n.roles||(n.roles={});for(var l=0,p=i;l<p.length;l++){var u=p[l];u&&u.roleName&&(n.roles[u.roleName]=!0)}S=a.name,n.queryName=_.chain(Object.keys(n.roles)).map((function(e){return E[e]&&E[e][S]})).filter(_.isString).value()[0]||S;var c,s=_.find(L,(function(e){return e.queryName===n.queryName})),o=(_.isEmpty(null==s?void 0:s.relatedProjectionsQueryName)||(n.relatedSelects=_.map(s.relatedProjectionsQueryName,(function(e){return{queryName:e}}))),_.isEmpty(null==s?void 0:s.relatedObjects)||(n.relatedObjects=s.relatedObjects),e=V,c=a.expr,_.findIndex(e,(function(e){return $.equals(e.expr,c)}))),s=(-1!==o&&(i=V[o],n.sort=i.direction,n.sortOrder=o),ee.getDefaultValue(a.expr,m));s&&(n.defaultValue={value:s},e=a.expr.getKeyColumns(m),n.defaultValue.identityFieldsValues=ee.getDefaultValues(e,m));1===ee.getAggregateBehavior(a.expr,m)&&(n.discourageAggregationAcrossGroups=!0);i=ee.getParameterMetadata(a.expr,m);i&&(n.parameter=i),C.selects.push(n)},A=0,J=N.length;A<J;A++)K(A);if(h)for(var I=0,O=h;I<O.length;I++){var Y=O[I];Y.aggregatesAdded&&!(function(e,t){for(var r=0,i=e;r<i.length;r++){var a=i[r];if(a.queryName===t.originalQueryRef){var n={},o=t.aggregates;o.min&&(n.min=ie(o.min)),o.max&&(n.max=ie(o.max)),a.aggregateSources=n;break}}var s=t.aggregates;ae(e,s.min),ae(e,s.max)})(C.selects,Y.aggregatesAdded)}C.roles={ordering:u,drillableRoles:q},c&&(C.roles.activeItems=c,(function(e,t){var e=e&&e.roles,r=e&&e.activeItems;if(r)for(var i in r)for(var i=r[i],a=0,n=i;a<n.length;a++){var o=n[a];o.suppressConcat=_.includes(t,o.queryRef)}})(C,z)),r.error=te.create(R,m,t)}return r})(a,e.schema,n,r.columnProperties,g,f,this.displayNames,this.aggrOps,y,this.localizationService,p.objectDefinitions,o.splits,o.queryRewrites,l.warnings,p.mappings,C,u,h,i.deferred,p.additionalProjections,e.drillableRoles,e.useNativeReferenceNameAsDisplayNames,e.disableHidden),t&&t.resolve(),v.options.query&&(v.options.query.telemetryV2Enabled=e.telemetryV2Enabled,null!=e.requestPriority)&&(v.options.query.requestPriority=e.requestPriority),v}}}}},N.prototype.getCompiledDataViewMapping=function(e){var t=e.config,r=this.getQueryGenerator(e.dataSources,t);if(r){t=this.getCompileMappingsResult(t,t&&t.visualType,e.schema,r);if(t&&!t.error)return t.compiled.mappings}},N.prototype.getAnchorTimeQueryOptions=function(e,t,r,i){var a,n=!(null==(n=this.visualQueryCapabilitiesService)||!n.getCapabilities().disableAnchorTime),t=t&&this.hasRelativeTimeFilters(r,i),r=e;return n&&t?{anchorTime:null,cacheOptions:r,relativeTimeError:new te("NoSupportRTS_PublishToWeb",this.localizationService)}:(t&&(r=this.cachePolicyProviderService?this.cachePolicyProviderService.getRelativeTimeFilterQueryPolicy():o.AllowQuery,i=this.visualTimeSynchronizationService.getAnchorTime(),a=j.toTypeEncoded(i,M.ValueType.fromExtendedType(519))),{anchorTime:a,cacheOptions:r,relativeTimeError:null})},N.prototype.hasRelativeTimeFilters=function(e,t){return!(!e||!r.hasRelativeTimeFilter(e.dataFilter))||!!t&&!!t.query&&!!t.query.defn&&r.hasRelativeTimeFilter(t.query.defn)},N.prototype.executeForFlattenedQuery=function(e,t){var r=e.config,i=this.getQueryGenerator(e.dataSources,r);if(i){var a=this.getCompileMappingsResult(r,r&&r.visualType,e.schema,i,e.additionalFilters,e.dataViewMappingsOverride,e.performanceActivity);if(a&&!a.error){var n,o,a=a.compiled;if(a)return n=this.getVisualCapabilities(e.config.visualType),o=N.compileFilters(e.additionalFilters,n),this.generateFlattenedQuery(i,e.schema,a,n.dataRoles,r.queryOptions&&r.queryOptions.keepProjectionOrder,n.filterMappings,o.dataFilter,o.highlightFilter,e.restartToken,e.dataWindow,e.dataSourceVariables,t,n.noDefaultProjections,e.windowExpansion)}}},N.prototype.getQueryGenerator=function(e,t){if(!_.isEmpty(e)){t=t.query,e=x.findTypes(e,t&&t.defn);if(e)return this.dataReaders.queryGenerator(e)}},N.prototype.getVisualCapabilities=function(e){if(e)return(e=this.visualPluginService.getPlugin(e))&&e.capabilities},N.prototype.getCompileMappingsResult=function(e,t,r,i,a,n,o){if(e&&t&&r){var s=this.visualPluginService.getPlugin(t);if(s){var l=this.getVisualCapabilities(t),n=n||l.dataViewMappings,p=e.query,u=l.sorting?l.sorting.implicit:null,c=p?A.createRoleKindByQueryRef(p):{};if(n&&p){var d=M.DataViewAnalysis.chooseDataViewMappings(p.projections,n,c,this.featureSwitchService.featureSwitches,l.objects,e.objects,p.defn.select(),r);if(!d.supportedMappings){var m=X(s,d.mappingErrors,this.localizationService,this.featureSwitchService,l.dataRoles);if(m)return{error:m,compiled:null};var v,y=M.data.QueryProjectionsByRole.clone(p.projections);for(v in y){var h=y[v];h.activeProjectionRefs=_.map(h.activeProjectionRefs,(function(e){return"select"+M.obfuscate(e)}));for(var g=0,f=h.all();g<f.length;g++)f[g]?h.assignProjection({queryRef:"select"+M.obfuscate(f[g].queryRef)},g):h.assignProjection(null,g)}m=new te("ClientError_NoSupportedDataViewMappingFound",this.localizationService);return m.addDebugInfo("VisualType",t),m.addDebugInfo("QueryProjectionsByRole",JSON.stringify(y)),this.telemetryService.logEvent(M.telemetry.EXVisualQueryGeneratorError,{code:t,debugInfo:JSON.stringify(m.getDetails(this.localizationService).debugErrorInfo)}),{error:m,compiled:null}}m=this.compileMappingsWithProperties(t,r,p,d.supportedMappings,c,l.dataRoles,l,e.queryOptions,e.columnProperties,V(e,l),a,s.customizeQuery,u,i)}else t=V(e,l),m=this.compileNoMappingsWithProperties(r,p,c,n,l.dataRoles,t,a);d=[];if(m){if(m.error)return{error:m.error,compiled:null};d.push.apply(d,b.validateAndAdjustRolesIfNecessary(m.mappings,m.query,r,this.displayNames,l)||[]),d.push.apply(d,E.validateAndAdjustHighlightIfNecessary(a)||[]),m.warnings&&d.push.apply(d,m.warnings||[]);for(var C=this.telemetryService.getOpenActivityById(o&&o.getProperty("telemetryActivityId")),x=0,S=d;x<S.length;x++)this.telemetryService.logChildEvent(C&&C.event,M.telemetry.EXVisualQueryGeneratorWarning,{code:S[x].code})}return{compiled:m,warnings:d}}}},N.compileFilters=function(e,t){var r,i,a,n;return e&&(i=e.dataFilter,a=e.dataFiltersUnmerged,r=e.highlightFilter,n=e.highlightFiltersUnmerged),{dataFilter:i,dataFiltersUnmerged:a,highlightFilter:r,highlightFiltersUnmerged:n}},N.prototype.getAllowClientSideFiltersOrDefault=function(e,t){return _.isBoolean(e.allowClientSideFilters)?e.allowClientSideFilters:!!T.findSelfFilter(t.objects)},N.prototype.compileMappingsWithProperties=function(e,t,r,i,a,n,o,s,l,p,u,c,d,m){r=B.TransformGeneratorUtils.addTransforms(p.visual.objects,i,r,this.transformPluginService,o);o=M.data.compileDataView({mappings:i,queryDefn:r.defn,queryProjections:r.projections,schema:t,objectDescriptors:p.visual.descriptors,objectDefinitions:p.visual.objects,roles:n,featureSwitches:this.featureSwitchService.featureSwitches,transformPluginService:this.transformPluginService});if(this.hasMappedColumnsInHierarchySlicer(e,o))return{error:new te("DQP_No_MappedColumns_In_HierarchySlicers",this.localizationService),query:void 0,mappings:void 0,additionalProjections:void 0,objectDefinitions:void 0};if(c){var i=this.getSorts(o),v=this.featureSwitchService.featureSwitches,c=c({dataViewMappings:o,scopedAggregates:v.scopedAggregates,cartesianMultiples:v.cartesianMultiples});if(c&&c.error)return v=c.error.code,{error:W(this.localizationService.get(v),v),query:void 0,mappings:void 0,additionalProjections:void 0,objectDefinitions:void 0};if(!_.isEmpty(r.expansionStates)){var y=[],c=o[0].matrix;c&&(v=c.rows).for&&(y=_.map(v.for.in.items,(function(e){return e})));for(var h=0,g=r.expansionStates;h<g.length;h++){var f=g[h];if(!_.isEmpty(f.root.children))for(var C=0,x=f.levels.length;C<x;C++)for(var S=f.levels[C],b=0,E=y;b<E.length;b++){var N=E[b];N.queryName===S.queryRefs[0]&&2!==N.subtotalType&&(N.subtotalType=1)}}}c=this.getSorts(o);r=this.updateSorts(r,i,c)}for(var V=s,w=t,P=0,T=o;P<T.length;P++){var F=T[P];V&&!1===V.allowBinnedLineSample&&!(function(e){var e=e.categorical;e&&e.dataReductionAlgorithm&&e.dataReductionAlgorithm.binnedLineSample&&(e.dataReductionAlgorithm=void 0,e.categories&&(e.categories.dataReductionAlgorithm={sample:{}}),e.values)&&(e=e.values).group&&(e.group.dataReductionAlgorithm={top:{}})})(F),V&&!1===V.allowOverlappingPointsSample&&!(function(e){var t=e.categorical,e=e.matrix;{var r;t&&t.dataReductionAlgorithm&&t.dataReductionAlgorithm.overlappingPointsSample?(r=t.dataReductionAlgorithm.overlappingPointsSample.count,t.dataReductionAlgorithm={sample:{}},r&&(t.dataReductionAlgorithm.sample.count=r)):e&&e.rows&&e.rows.dataReductionAlgorithm&&e.rows.dataReductionAlgorithm.overlappingPointsSample&&(r=e.rows.dataReductionAlgorithm.overlappingPointsSample.count,e.rows.dataReductionAlgorithm={sample:{}},r)&&(e.rows.dataReductionAlgorithm.sample.count=r)}})(F),!(function(e){return _.every(e.schemas,(function(e){return e.capabilities&&e.capabilities.supportsTopNPerLevel}))})(w)&&!(function(e){e=e.matrix;{var t;e&&e.rows&&e.rows.dataReductionAlgorithm&&e.rows.dataReductionAlgorithm.topNPerLevel&&(t=e.rows.dataReductionAlgorithm.topNPerLevel.fallbackTopCount,e.rows.dataReductionAlgorithm={top:{}},t)&&(e.rows.dataReductionAlgorithm.top.count=t)}})(F)}r=B.TransformGeneratorUtils.removeUnsupportedTransforms(this.transformPluginService,r,o),r=this.sortService.applyImplicitSort(r,d),r=this.sortService.ensureValidSorting({query:r,schema:t,visualType:e,columnProperties:l,compiledMappings:o});v=z.setProperties(t,o,r,p.visual.objects,p.visual.descriptors),i=v.modifiedObjectDefinitions,c=v.addedScalarKeys,i=this.setFilteredToUniqueValueProperties(u,m,t,o,r,i),p.visual.objects=i,s=this.getQueryRefsByRole(r,n),d=[p.visual],p.visualContainer&&d.push(p.visualContainer),e=U.extend(r.defn,t,d,s,r.projections,a,u&&u.dataFilter,!0);if(e){for(var j=new B.contracts.VisualQuery(e.queryDefn,r.projections,r.expansionStates),D=e.additionalProjections,R=e.warnings,A=0,I=c;A<I.length;A++){var O=I[A],k=j.defn.selectNameOf(O.expr);O.roleItem.scalarKeyInfo||(O.roleItem.scalarKeyInfo={}),O.roleItem.scalarKeyInfo.scalarKeyQueryName=k}p.visual=this.addDefaultFormatStringsForDataBoundProperties(p.visual,t,ee.buildExprEvaluationContext(r.defn.from())),p.visual=this.rewriteObjectDefinitions(e.objectDefinitionRewrites,p.visual)}return{query:j||r,mappings:o,additionalProjections:D,warnings:R,objectDefinitions:p.visual.objects}},N.prototype.addDefaultFormatStringsForDataBoundProperties=function(e,t,r){var i={};for(u in e.objects){var a=e.descriptors[u];if(a)for(var n=0,o=e.objects[u];n<o.length;n++)for(d in(c=o[n]).properties){var s=a.properties[d];if(s&&s.formatStringProperty){var l=c.properties[d],p=void 0;if(g(l))p=l;else{if(!f(l))continue;p=l.value}y.getValue(e.objects,s.formatStringProperty,c.selector)||(l=p.getMetadata(t,r))&&(l.type||l.format)&&(p=null!=(p=l.format)?p:M.visuals.valueFormatter.getDefaultFormatString(l.type))&&y.setValue(i,s.formatStringProperty,c.selector,C.text(p))}}}if(!_.isEmpty(i))for(var u in e.objects=y.clone(e.objects),i)for(var c,d,m=0,v=i[u];m<v.length;m++)for(d in(c=v[m]).properties)y.setValue(e.objects,{objectName:u,propertyName:d},c.selector,c.properties[d]);return e},N.prototype.hasMappedColumnsInHierarchySlicer=function(e,t){if(e===M.visuals.plugins.slicer.name)for(var r=0,i=t;r<i.length;r++){var a=i[r],a=null==(a=null==a?void 0:a.metadata)?void 0:a.columns;if(1!==(null==a?void 0:a.length)&&_.some(a,(function(e){return 1===(null==(e=null==e?void 0:e.parameter)?void 0:e.kind)})))return!0}return!1},N.prototype.rewriteObjectDefinitions=function(e,t){if(!_.isEmpty(e)){t.objects=y.clone(t.objects);for(var r=0,i=e;r<i.length;r++){var a,n=i[r];for(a in t.objects)for(var o=0,s=t.objects[a];o<s.length;o++){var l=s[o];if(m.equals(l.selector,n.selector))for(var p in l.properties){var u=l.properties[p],c=void 0;if(g(u))c=u;else{if(!f(u))continue;c=u.value}$.equals(c,n.from)&&(l.properties[p]=n.to)}}}}return t},N.prototype.getSorts=function(e){for(var t=[],r=0,i=e;r<i.length;r++){for(var a=[],n=0,o=i[r].metadata.columns;n<o.length;n++){var s=o[n];s.sort&&a.push({queryName:s.queryName,sort:s.sort,sortOrder:s.sortOrder})}t.push(a)}return t},N.prototype.updateSorts=function(e,t,r){if(_.isEqual(t,r))return e;for(var i=[],a=e.defn.select(),n=0,o=r;n<o.length;n++)for(var s=o[n],l=0,p=_.sortBy(s,(function(e){return e.sortOrder}));l<p.length;l++){var u=p[l],c=a.withName(u.queryName);i.push({direction:u.sort,expr:c.expr})}return new B.contracts.VisualQuery(e.defn.orderBy(i),e.projections,e.expansionStates)},N.prototype.getQueryRefsByRole=function(t,e){var r={};if(!_.isEmpty(e))for(var i=0,a=e;i<a.length;i++){var n=a[i],o=t.tryGetExprs(n.name);r[n.name]=_.map(o,(function(e){return t.defn.selectNameOf(e)}))}return r},N.prototype.setFilteredToUniqueValueProperties=function(e,n,o,t,r,s){var l=this;if(!e||!e.dataFilter)return s;for(var p,u=r.defn.select(),c=e.dataFilter.where(),d=e.queryRefsForSingleItemDrillFilters,i=0,a=t;i<a.length;i++){var m=a[i];m&&m.categorical&&m.categorical.categories&&v.visitCategoricalCategories(m.categorical.categories,{visitRole:function(e){if(!_.isEmpty(e.items))for(var t=0,r=e.items;t<r.length;t++){var i=r[t],a=i.queryName;i.filteredToUniqueValueProperty&&_.includes(d,a)&&(a=u.withName(a),a=l.isColumnFilteredToUniqueValue(a.expr,c,o,n))&&(p=p||(s?y.clone(s):{}),l.setFilteredToUniqueValueProperty(a,i,p))}}})}return p||s},N.prototype.isColumnFilteredToUniqueValue=function(e,r,t,i){return!i||!i.hasAmbiguousEqualitySemantics||(e=e.getKeyColumns(t),_.every(e,(function(t){return _.some(r,(function(e){e=B.FilterUtils.getFilterValuesForColumn(t,e);if(1===_.size(e)){e=e[0];if($.isConstant(e)&&!i.hasAmbiguousEqualitySemantics(e))return!0}return!1}))})))},N.prototype.setFilteredToUniqueValueProperty=function(e,t,r){var i=t.filteredToUniqueValueProperty,e=C.boolean(e),t={metadata:t.queryName};y.setValue(r,i,t,e)},N.prototype.compileNoMappingsWithProperties=function(e,t,r,i,a,n,o){if(!t&&_.isEmpty(i)){t=new B.contracts.VisualQuery(p.create(),{},[]);var i=this.getQueryRefsByRole(t,a),s=[n.visual],s=(s.push(n.visualContainer),U.extend(t.defn,e,s,i,t.projections,r,o&&o.dataFilter,!0));if(s)return i=new B.contracts.VisualQuery(s.queryDefn,t.projections,t.expansionStates),r=s.additionalProjections,o=M.data.compileDataView({mappings:[{table:{rows:{for:{in:"*"}}}}],queryDefn:t.defn,queryProjections:t.projections,schema:e,objectDescriptors:n.visual.descriptors,objectDefinitions:n.visual.objects,roles:a,featureSwitches:this.featureSwitchService.featureSwitches,transformPluginService:this.transformPluginService}),n.visual=this.addDefaultFormatStringsForDataBoundProperties(n.visual,e,ee.buildExprEvaluationContext(t.defn.from())),n.visual=this.rewriteObjectDefinitions(s.objectDefinitionRewrites,n.visual),{query:i||t,mappings:o,additionalProjections:r,warnings:s.warnings,objectDefinitions:n.visual.objects}}},N.prototype.generateQuery=function(e,t,r,i,a,n,o,s,l,p,u,c,d,m,v,y,h,g,f){t=this.getQueryGeneratorOptions(t,r,i,a,n,o,s,l,p,u,c,d,m,v,y,h,g,f),i=e.execute(t);return{result:i,query:r.query,resolvedQuery:t.query,deferred:i.deferred}},N.prototype.generateFlattenedQuery=function(e,t,r,i,a,n,o,s,l,p,u,c,d,m){t=this.getQueryGeneratorOptions(t,r,i,a,n,o,s,l,p,u,c,void 0,void 0,d,m);return e.executeForQueryOnly?e.executeForQueryOnly(t):t.query},N.prototype.getQueryGeneratorOptions=function(e,t,r,i,a,n,o,s,l,p,u,c,d,m,v,y,h,g){var f=t.query,a=this.filterGenerator.resolveFilterTargets(e,f,r,a,n),n=(function(e){var t=e.orderBy();if(_.isEmpty(t))return e;for(var r=!1,i=0,a=t;i<a.length;i++){var n=a[i];$.isSparklineData(n.expr)&&(n.expr=n.expr.measure,r=!0)}return r?e.orderBy(t):e})(n=B.TransformGeneratorUtils.rewriteTransform(this.transformPluginService,a,f.projections,r,this.getQueryRefsByRole(t.query,r),t.additionalProjections,t.mappings)),a=new L(e,t.mappings,n);return n=n.rewrite(a),{query:u?u(n):n,queryExtensionLookup:c,mappings:t.mappings,additionalProjections:t.additionalProjections,highlightFilter:o,restartToken:s,dataWindow:l,highVolumeOverride:this.featureSwitchService&&this.featureSwitchService.featureSwitches.highVolume,expansionStates:t.query.expansionStates,dataSourceVariables:p,executionMetricsKinds:d,keepProjectionOrder:i,noDefaultProjections:m,windowExpansion:v,anchorTime:y,disableHidden:h,enableAllSubtotal:g}},N.prototype.getWindowExpansionState=function(e,t,r){var i=this.visualPluginService.capabilities(e.visualType);if(_.some(i.dataViewMappings,(function(e){return e&&e.matrix&&e.matrix.rows&&e.matrix.rows.dataReductionAlgorithm&&e.matrix.rows.dataReductionAlgorithm.topNPerLevel})))return t||I.mergeWithExpansionState(_.first(e.query.expansionStates),void 0,e.query.defn.select(),r)},O=N,(z||(z={})).setProperties=function(l,e,p,u,c){for(var d,m=[],t=0,r=e;t<r.length;t++){var i=r[t];v.visitMapping(i,{visitRole:function(e){if(e.items)for(var t=0,r=e.items;t<r.length;t++){var i=r[t];i.scalarKeyInfo&&i.scalarKeyInfo.scalarKeyMinProperty&&(d=d||(u?(a=h.serializeObjects(u,c),h.deserializeObjects(a,c)):{}),m.push((a=l,n=p,o=d,s=void 0,s=(i=i).scalarKeyInfo.scalarKeyMinProperty,M.contract.check(i.scalarKeyInfo.hasScalarKey,"Scalar key requested when not available"),n=n.defn.select().withName(i.queryName).expr,n=C.aggregate(D.getScalarKeyExpr(n,a),3),a=i.scalarKeyInfo.selector,y.setValue(o,s,a,n),{roleItem:i,expr:n})))}var a,n,o,s}})}return{modifiedObjectDefinitions:d||u,addedScalarKeys:m}},__extends(n,k=t),n.prototype.visitSparklineData=function(t){for(var e,r,i=this.pointsPerSparkline+1,a=t.grouping[0],a=($.isHierarchyLevel(a)&&null!=(r=null==(r=a.getMetadata(this.schema))?void 0:r.type)&&r.temporal&&(r=M.data.ScalarKeyUtils.getScalarKeyExpr(a,this.schema))&&(e=C.aggregate(r,3)),_.find(this.query.select(),(function(e){return $.equals(e.expr,t)}))),n=a.name,o=!1,s=0,l=this.compiledMappings;s<l.length;s++){var p=l[s];v.visitMapping(p,{visitRole:function(e){var e=_.find(e.items,(function(e){return e.queryName===n}));null!=(e=null==e?void 0:e.sparklineInfo)&&e.includeMinGroupingInterval&&(o=!0)}})}return C.sparklineData(t.measure,t.grouping,e,i,o)},L=n,__extends(s,q=t),s.prototype.rewrite=function(){for(var e in this.objects)for(var t=0;t<this.objects[e].length;t++){var r=this.objects[e][t];if(r.selector){r=r.selector,r=m.toScopeIdentities(r);if(!_.isEmpty(r)){this.rewrittenObjects||(this.rewrittenObjects=y.clone(this.objects));for(var i=0,a=r;i<a.length;i++){var n=a[i].expr;this.rewrittenObjects[e][t].selector={data:[M.data.createDataViewScopeIdentity(n.accept(this))]}}}}}},s.prototype.visitSelectRef=function(e){var t=e.expressionName,t=this.query.select().withName(t),r=t.expr,t=(t&&$.isColumn(t.expr)&&$.isSubqueryRef(t.expr.source)&&(r=ee.getSubqueryExpression(t.expr,this.context)),_.find(this.queryRewrites,(function(e){return e.selectExprReplaced&&$.equals(e.selectExprReplaced.originalExpr,r)})));return t?t.selectExprReplaced.replacedExpr:e},re=s,e.getDataViewMappingErrorFromFailures=X,c.create=function(e,a,n){if(!_.isEmpty(e)){for(var o=[],s=function(e,t){return e.hierarchy?e.hierarchy.name:e.hierarchyLevel?e.hierarchyLevel.name+"."+e.hierarchyLevel.level:t},t=0,r=e;t<r.length;t++)!(function(e){var e=u.asFieldPattern(e),t=void 0;if(e.sparklineData)var r=e.sparklineData.measure,i=_.first(e.sparklineData.grouping),r=s(r,l.getPropertyName(r)),i=s(i,l.getPropertyName(i)),t=n.format("VisualTitle_By_Template",r,i);else{r=l.toFieldExprEntityItemPattern(e);if(!r)return;i=s(e,l.getPropertyName(e)),e=(t="("+r.entity+") "+i,a.schema(r.schema)),e=e&&e.findProperty(r.entity,i);e&&e.errorMessage&&(t+=": "+e.errorMessage)}o.push(t)})(r[t]);return new c("Missing_References",n,o.join(", "))}},Object.defineProperty(c.prototype,"code",{get:function(){return this.errorCode},enumerable:!1,configurable:!0}),Object.defineProperty(c.prototype,"source",{get:function(){return this.errorSource},enumerable:!1,configurable:!0}),c.prototype.addDebugInfo=function(e,t){this.debugErrorInfo||(this.debugErrorInfo=[]),this.debugErrorInfo.push({errorInfoKey:e,errorInfoValue:t})},c.prototype.getDetails=function(e){var t=e.get(this.displayableErrorInfo[0].errorInfoKey),r=this.displayableErrorInfo[0].errorInfoValue;return this.detailsMessageFormat&&(r=a.format(e.get(this.detailsMessageFormat),r)),{message:e.get(this.messageId),displayableErrorInfo:[{errorInfoKey:t,errorInfoValue:r}],debugErrorInfo:(e=[{errorInfoKey:i.ClientErrorCode,errorInfoValue:this.code}]).concat.apply(e,this.debugErrorInfo||[]),hideErrorHelperText:this.hideErrorHelperText,hideDebugInfo:this.hideDebugInfo,helpLink:this.helperLink}},te=c,e.VisualQueryClientError=te,(b||(b={})).validateAndAdjustRolesIfNecessary=function(e,t,r,i,a){for(var n=new G(t.defn,r,i,a),o=0,s=e;o<s.length;o++){var l=s[o];v.visitMapping(l,n)}return n.warnings},K.prototype.visitRole=function(e){e.showAll&&0<this.incompatibleExprInfo.length&&(e.showAll=!1,this.warnings.push(new Q(this.incompatibleExprInfo)))},G=K,Object.defineProperty(w.prototype,"code",{get:function(){return"ShowAllDiabledWarning"},enumerable:!1,configurable:!0}),w.prototype.getDetails=function(e){var t=e.get("ShowAllDisabledWarning_Value"),r=_.map(this.errorInfos,(function(e){return e.fieldDisplayName})).join(", ");return{message:e.get("ShowAllDisabledWarning_Message"),displayableErrorInfo:[{errorInfoKey:e.get("ShowAllDiabledWarning_ErrorInfoKey"),errorInfoValue:a.format(t,r)}]}},Q=w,(E||(E={})).validateAndAdjustHighlightIfNecessary=function(e){if(e&&e.highlightFilter){var t=e.highlightFilter.where(),r=_.find(t,(function(e){return 3===F.runDetector(e.condition)})),t=_.find(t,(function(e){return $.isExists(e.condition)}));if(r||t)return e.dataFilter=e.dataFilter?R.merge([e.dataFilter,e.highlightFilter]):e.highlightFilter,e.highlightFilter=void 0,[new H(r?0:1)]}},Object.defineProperty(P.prototype,"code",{get:function(){switch(this.highlightDisableType){case 0:return"HighlightWithTOPNDisabledWarning";case 1:return"HighlightWithExistsFiltersDisabledWarning"}},enumerable:!1,configurable:!0}),P.prototype.getDetails=function(e){var t=0===this.highlightDisableType,r=t?"HighlightWithTOPNDisabledWarning_ErrorInfoKey":"HighlightWithExistFiltersDisabledWarning_ErrorInfoKey",i=t?"HighlightWithTOPNDisabledWarning_Value":"HighlightWithExistFiltersDisabledWarning_Value";return{message:e.get(t?"HighlightWithTOPNDisabledWarning_Message":"HighlightWithExistFiltersDisabledWarning_Message"),displayableErrorInfo:[{errorInfoKey:e.get(r),errorInfoValue:e.get(i)}]}},H=P})(powerbi=powerbi||{}),(function(s){var i,e,a,o,n;function t(e,t,r,i,a){this.visualPluginService=e,this.pluginOps=t,this.explorationNavigationService=r,this.featureSwitchService=i,this.visualCapabilitiesService=a}i=s.explore||(s.explore={}),e=i.services||(i.services={}),a=s.visuals.plugins,o=i.util.VisualContainerUtils,e.createVisualRelationshipService=function(e,t,r,i,a){return new n(e,t,r,i,a)},t.prototype.relationship=function(e,t,r){return this.getRelationship(e.relationships,t,r)},t.prototype.drillRelationship=function(e,t,r){e=this.getRelationship(e.relationships,t,r);if(e)return 2===(t=e).type?{source:e.source,target:e.target,type:1}:t},t.prototype.getRelationship=function(e,t,r){return _.find(e,(function(e){return e.source.name===t.name&&e.target.name===r.name}))},t.prototype.getIsCrossHighlightingDisabled=function(){var e=this.explorationNavigationService&&this.explorationNavigationService.getCurrentExploration(),e=e&&e.slowDataSourceSettings;return e&&e.isCrossHighlightingDisabled},t.prototype.relationshipFilterAction=function(e,t,r,i){e=this.relationship(e,t,r);return this.getRelationshipFilterAction(e,t,r,i)},t.prototype.drillRelationshipFilterAction=function(e,t,r,i){return t.drillFilterOtherVisuals?(e=this.drillRelationship(e,t,r),this.getRelationshipFilterAction(e,t,r,i)):3},t.prototype.shouldApplyCrossDrill=function(e,t,r,i){if(t!==r&&o.getVisualType(r)!==a.slicer.name){e=this.drillRelationshipFilterAction(e,t,r,i);if(1===e)return!0;if(0===e)if(1===this.defaultDrillFilterAction(t,r))return!0}return!1},t.prototype.getRelationshipFilterAction=function(e,t,r,i){if(e&&this.supportsFilterActionTarget(t,r,e.type))return e.type;var e=r&&r.config&&r.config.singleVisual,r=e&&r.config.singleVisual.visualType,a=this.visualPluginService.capabilities(r);if(this.getIsCrossHighlightingDisabled()&&!this.isSlicer(a,r)){var n=t&&t.config&&t.config.singleVisual,t=n&&t.config.singleVisual.visualType,o=this.visualPluginService.capabilities(t);if(!this.isFilter(o,t,n&&n.objects))return 3}if(a){o=e.query;if(o){t=this.visualPluginService.getPlugin(r);if(t&&t.isCrossFilteredByDefault){n=e.objects,r={mappings:a.dataViewMappings,queryDefn:o.defn,queryProjections:o.projections,schema:i,objectDescriptors:a.objects,objectDefinitions:n,roles:a.dataRoles,featureSwitches:this.featureSwitchService.featureSwitches,transformPluginService:s.data.transforms.createTransformPluginService()},e=s.data.compileDataView(r);if(t.isCrossFilteredByDefault({dataViewMappings:e}))return 3}}}return 0},t.prototype.isSlicer=function(e,t){return!!i.FilterUtils.tryGetFilterPropertyIdentifier(e,t,this.visualPluginService)},t.prototype.isFilter=function(e,t,r){return e?this.isSlicer(e,t):null!=i.FilterUtils.tryGetFilterProperty(e,t,this.visualPluginService,r)},t.prototype.supportsFilterActionTarget=function(e,t,r){var i=o.getVisualType(t),a=o.getVisualType(e);if(!_.isEmpty(a)&&!_.isEmpty(i))switch(r){case 1:case 3:return!0;case 2:var n=this.visualPluginService.capabilities(i);return(!n||n.supportsHighlight)&&!this.visualCapabilitiesService.hasFilterCapabilities(a)}return!1},t.prototype.supportsAnyFilterAction=function(e){var e=o.getVisualType(e);return!(_.isEmpty(e)||!this.pluginOps.isQueryVisual(e)&&!this.pluginOps.isQnaVisual(e)||(e=this.visualPluginService.capabilities(e))&&!1===e.supportsSelection)},t.prototype.defaultFilterAction=function(e,t){var r=this.explorationNavigationService&&this.explorationNavigationService.getCurrentExploration(),r=r&&r.settings;return r&&!!r.defaultFilterActionIsDataFilter||!this.supportsFilterActionTarget(e,t,2)?this.supportsFilterActionTarget(e,t,1)?1:void 0:2},t.prototype.defaultDrillFilterAction=function(e,t){e=this.defaultFilterAction(e,t);return e=2===e?1:e},n=t})(powerbi=powerbi||{}),(function(e){var t,o;function r(e){this.visualPlugins=e,this.collectedFilters=[]}t=(t=e.explore||(e.explore={})).services||(t.services={}),o=e.explore.util.VisualContainerUtils,r.prototype.collectFilters=function(e,t,r){if(!_.isEmpty(e))for(var i=0,a=e;i<a.length;i++){var n=a[i];n&&n.filter&&this.collectFilter(n.filter,n,r,t)}},r.prototype.collectFiltersForFilterContainer=function(e,t,r,i){if(e)for(var a=0,n=e;a<n.length;a++){var o=n[a];o.filter&&o!==r&&this.collectFilter(o.filter,o,i,t)}},r.prototype.collectFilter=function(e,t,r,i,a){var n;e&&(r&&(n=o.getVisualCapabilities(r,this.visualPlugins)),this.collectedFilters.push({filter:e,filterContainer:t,sourceVisualContainer:r,sourceVisualContainerCapabilities:n,scopeType:i,collectedFilterSource:a}))},r.prototype.getCollectedFilters=function(){return this.collectedFilters},t.FilterCollector=r})(powerbi=powerbi||{}),(function(e){var c,t,i,d,r,a,n,o,s;function u(e,t,r,i,a,n,o){var s={filter:e,scope:t,filterExpressionMetadata:o};if(r)s.restatement=r.restatement,s.type=r.type,s.isHidden=!!r.isHiddenInViewMode,s.filterExpressionMetadata=r.expression?{expressions:[r.expression]}:void 0,s.displayName=r.displayName,r.cachedValueItems&&s.filterExpressionMetadata?s.filterExpressionMetadata.cachedValueItems=v(r.cachedValueItems,0):r.filterExpressionMetadata&&(s.filterExpressionMetadata=r.filterExpressionMetadata);else if(i&&c.FilterUtils.supportsFilterOutput(a)&&i.config.singleVisual.query){e=i.config.singleVisual.query.defn.select(),t=i.config.singleVisual.cachedFilterDisplayItems,o=i.config.singleVisual.filterExpressionMetadata;if(1<=e.length&&t&&n===d.Slicer)s.filterExpressionMetadata={expressions:[e[0].expr],cachedValueItems:v(t,0)};else if(o)s.filterExpressionMetadata=o;else{s.filterExpressionMetadata={expressions:[]};for(var l=0,p=e;l<p.length;l++){var u=p[l];s.filterExpressionMetadata.expressions.push(u.expr)}}}return s}function m(e){var t;if(null!=e)return t={Restatement:e.restatement,type:e.type},e.expression&&(t.expression=a.serializeExpr(e.expression)),t}function v(e,t){for(var r=[],i=0,a=e;i<a.length;i++){var n=a[i],o={identities:[n.identity],valueMap:{}};o.valueMap[t]=n.displayName,r.push(o)}return r}function l(e,t){this.visualContainer=e,this.filterContainer=t,e&&(t=s.getVisualQuery(e))&&(this.visualSemanticQuery=t.defn),this.needToEnsurePrecedence=!1,this.shouldPruneUnnecessaryFilters=!1}c=e.explore||(e.explore={}),t=c.services||(c.services={}),i=jsCommon.ArrayExtensions,d=e.explore.contracts.CollectedFilterSource,r=e.data.SemanticFilter,a=e.data.services.SemanticQuerySerializer,n=e.data.SubqueryRewriter,o=e.data.TopNFilterPruner,s=c.util.VisualContainerUtils,t.toFilterData=u,t.generateSingleFilterMetadata=m,t.generateFilterMetadata=function(e){if(!_.isEmpty(e)){for(var t=[],r=0,i=e;r<i.length;r++){var a=i[r];t.push(m(a))}return t}},l.prototype.setSelectorFilter=function(e){this.selectorFilter=e,this.shouldPruneUnnecessaryFilters=!0},l.prototype.addDrillFilter=function(e){this.drillFilters=this.drillFilters||[],this.drillFilters.push(e)},l.prototype.addVisualFilter=function(e){this.visualSemanticQuery&&(e.filter=n.rewriteSubqueriesForContainingQuery(e.filter,this.visualSemanticQuery)),this.visualFilters=this.visualFilters||[],this.visualFilters.push(e),this.needToEnsurePrecedence=!0,this.shouldPruneUnnecessaryFilters=!0},l.prototype.addDrillthroughFilter=function(e){this.drillthroughFilters=this.drillthroughFilters||[],this.drillthroughFilters.push(e),this.needToEnsurePrecedence=!0},l.prototype.addSectionFilter=function(e){this.sectionFilters=this.sectionFilters||[],this.sectionFilters.push(e),this.needToEnsurePrecedence=!0},l.prototype.addReportFilter=function(e){this.reportFilters=this.reportFilters||[],this.reportFilters.push(e),this.needToEnsurePrecedence=!0},l.prototype.addCrossFilter=function(e){this.crossFilters=this.crossFilters||[],this.crossFilters.push(e),this.needToEnsurePrecedence=!0},l.prototype.addHighlight=function(e){this.highlightFilters=this.highlightFilters||[],this.highlightFilters.push(e)},l.prototype.addCollectedFilters=function(e,t,r){for(var i=0,a=e;i<a.length;i++){var n,o=a[i],s=o.filter,l=o.filterContainer,p=o.sourceVisualContainer;r&&!r(s,l,p)||(n=l,o.filterContainer&&o.filterContainer===this.filterContainer&&(n=null),s=u(s,o.scopeType,n,p,o.sourceVisualContainerCapabilities,o.collectedFilterSource),!l||2!==l.howCreated&&0!==l.precedence?o.sourceVisualContainer?o.sourceVisualContainer===this.visualContainer?this.addVisualFilter(s):this.addCrossFilter(s):5===l.howCreated?this.addDrillthroughFilter(s):1===o.scopeType?this.addSectionFilter(s):2===o.scopeType?this.addReportFilter(s):o.filterContainer&&o.filterContainer===this.filterContainer&&this.addVisualFilter(s):this.addDrillFilter(s),t&&l&&(this.metadata=this.metadata||[],this.metadata.push(m(l))))}},l.prototype.mergeHighlightFiltersBasedOnRelationship=function(e,t,r){var i=this;switch(t){case 0:case 2:if(!r){_.each(e,(function(e){return i.addHighlight(e)}));break}case 1:e&&_.each(e,(function(e){return i.addCrossFilter(e)}))}},l.prototype.getFilters=function(e){var e=this.getFilterData(e),t=this.highlightFilters&&r.merge(this.highlightFilters.map((function(e){return e.filter})));return{dataFilter:e?r.merge(_.map(e,(function(e){return e.filter}))):void 0,dataFiltersUnmerged:e,highlightFilter:t,highlightFiltersUnmerged:this.highlightFilters,filterMetadata:this.metadata}},l.prototype.getFilterData=function(e){var t,r,i,a,n;if(this.pruneUnnecessaryFilters(),e||this.ensurePrecedence(),this.drillFilters||this.sectionFilters||this.reportFilters||this.visualFilters||this.crossFilters||this.drillthroughFilters)return e=this.drillFilters||[],t=this.visualFilters||[],r=this.sectionFilters||[],i=this.drillthroughFilters||[],a=this.reportFilters||[],n=this.crossFilters||[],e.concat(t).concat(n).concat(r).concat(i).concat(a)},l.prototype.getCrossHighlightFilters=function(){var e,t;if(this.pruneUnnecessaryFilters(),this.ensurePrecedence(),this.selectorFilter||this.visualFilters)return e=this.selectorFilter?[this.selectorFilter]:[],t=this.visualFilters||[],e.concat(t)},l.prototype.getHighlightFilters=function(){return this.highlightFilters},l.prototype.clearHighlightFilters=function(){this.highlightFilters=void 0},l.prototype.getUnmergedDrillCrossFilter=function(){return this.pruneUnnecessaryFilters(),this.ensurePrecedence(),this.drillFilters},l.prototype.getCrossFilters=function(){return this.crossFilters},l.prototype.ensurePrecedence=function(){var e;this.needToEnsurePrecedence&&(this.visualFilters&&(e={visualFilters:this.visualFilters,crossFilters:this.crossFilters,reportFilters:this.reportFilters,drillThroughFilters:this.drillthroughFilters,sectionFilters:this.sectionFilters},this.visualFilters=t.FilterPrecedenceResolver.resolve(e)),this.needToEnsurePrecedence=!1)},l.prototype.pruneUnnecessaryFilters=function(){var r=this;this.shouldPruneUnnecessaryFilters&&(this.visualFilters&&this.selectorFilter&&this.visualFilters&&this.selectorFilter&&(this.visualFilters=i.filterArray(this.visualFilters,(function(e,t){return e.filter=o.removeUnnecessaryTopNFilters(e.filter,r.selectorFilter.filter),0<e.filter.where().length}))),this.shouldPruneUnnecessaryFilters=!1)},t.FilterBuilder=l})(powerbi=powerbi||{}),(function(u){var e,v,y,t,n,o,r,a,c,l,s,p,i,d,h,m,E;function g(e,t,r,i,a,n,o,s,l,p,u,c,d,m,v,y,h,g,f,C,x,S,b){this.queryExecutionServices=e,this.hostServices=t,this.promiseFactory=r,this.conceptualSchemaProxy=i,this.featureSwitchService=a,this.telemetryService=n,this.visualQueryGenerator=o,this.visualPlugin=s,this.visualPluginOps=l,this.filterGenerator=p,this.displayNameService=u,this.explorationNavigation=c,this.visualValidationService=d,this.resourceLoader=m,this.eventBridge=v,this.dataProxyService=y,this.dataSources=h,this.visualLifecycleService=g,this.resourceRegistration=f,this.cachePolicyProviderService=C,this.visualInsightsAnalysisHandler=x,this.visualParameterService=S,this.visualDataProxyExecutionService=b}e=u.explore||(u.explore={}),v=e.services||(e.services={}),y=u.data.CacheOptions,t=u.common,n=u.data.segmentation.DataViewMerger,o=u.data.services.DataViewTransformActionsSerializer,r=jsCommon.DateExtensions,a=e.util.ExplorationTelemetryUtil,c=u.data.dsr,l=u.explore.services.generateFilterMetadata,s=u.PbiPromise,p=u.visualHost.ResourcePackageReferenceResolver,i=u.explore.util.ResourcePackageUtils,d=u.visualHost.utils.ResourcePackageUtils,h=e.util.VisualContainerUtils,m=u.explore.util.VisualPerformanceActivityUtil,v.createVisualContainerQueryHandler=function(e,t,r,i,a,n,o,s,l,p,u,c,d,m,v,y,h,g,f,C,x,S,b){return new E(e,t,r,i,a,n,o,s,l,p,u,c,d,m,v,y,h,b,S,g,f,C,x)},g.prototype.attach=function(e){this.queryExecutionServices=e},g.prototype.cancelQuery=function(e){this.visualDataProxyExecutionService.cancelQuery(e),this.visualParameterService.cancelResolve(e)},g.prototype.generateApplicationContext=function(e,t){var r=this.explorationNavigation&&this.explorationNavigation.getCurrentExploration()&&this.explorationNavigation.getCurrentExploration().report,i=r&&r.objectId;return{DatasetId:r&&r.model&&r.model.dbName,Sources:[{ReportId:i,Operation:e,VisualId:t&&t.name}]}},g.prototype.runQuery=function(t){var r,i=this,e=m.updateParentWithNewLinkingActivity(t.performanceActivity,u.telemetry.EXRunQuery,this.telemetryService),a=t.performanceActivity,n=(this.featureSwitchService.featureSwitches.resolveParametersEvent&&(r=this.startResolveParametersPerformanceActivity(a)),this.startQueryPerformanceActivity(a)),o=this.dataSources.get(),s=t.contract,l=s.config.singleVisual,p=l.query&&l.query.hasQueryFieldParameters();return this.visualValidationService.shouldBlockVisualQuery&&this.visualValidationService.shouldBlockVisualQuery(s)||!(t.skipShouldRunQueryVerification||this.visualQueryGenerator.shouldExecute(l,o)||this.visualParameterService.shouldExecute(l,o))?(this.featureSwitchService.featureSwitches.resolveParametersEvent&&this.transitionResolveParametersToQuery(!1,r,n),n&&n.queryActivity.resolve(),e&&e.resolve(),!1):(a=n&&n.telemetryActivity,this.queryExecutionServices.notifyStart(a),r&&r.setProperty("start",jsCommon.performance.now()),a=this.resolveQueryParameters(t,r),(this.visualInsightsAnalysisHandler.supportsInsights(s)?a.then((function(e){if((e.queryChange||e.aliasChange)&&i.queryExecutionServices.applyResolveParametersUpdate(),i.featureSwitchService.featureSwitches.resolveParametersEvent&&i.transitionResolveParametersToQuery(!0,r,n),!p||i.visualQueryGenerator.shouldExecute(l,o))return i.visualInsightsAnalysisHandler.runInsights(s).then((function(e){if(e){if(e.error)throw e.error;e.queryExecutionOptions&&_.merge(t,e.queryExecutionOptions)}return i.runQueryImpl(t,o,s,n,e&&e.warnings)}))})):a.then((function(e){if((e.queryChange||e.aliasChange)&&i.queryExecutionServices.applyResolveParametersUpdate(),i.featureSwitchService.featureSwitches.resolveParametersEvent&&i.transitionResolveParametersToQuery(!0,r,n),!p||i.visualQueryGenerator.shouldExecute(l,o))return i.runQueryImpl(t,o,s,n,void 0)}))).catch((function(e){i.queryExecutionServices.handleErrors(e,n)})).finally((function(){i.queryExecutionServices.notifyEnd(),e&&e.resolve()})),!0)},g.prototype.transitionResolveParametersToQuery=function(e,t,r){t&&t.isRunning()&&(r&&r.queryActivity.isRunning()&&r.queryActivity.setProperty("start",jsCommon.performance.now()),e&&0<t.getProperty("metadataParameterCount")?t.resolve():t.cancel(!0))},g.prototype.resolveQueryParameters=function(i,a){var n=this,o=this.dataSources.get();return this.conceptualSchemaProxy.get(o).then((function(e){var t=n.generateApplicationContext(i.queryOperation,i.contract),r=n.getDatasetCacheOptions(i,o,!1),e={dataSources:o,schema:e,additionalFilters:n.hostServices.getFilters(n.filterGenerator,e),config:i.contract.config.singleVisual,cacheOptions:r,allowResultFromClientCache:i.allowResultFromClientCache,applicationContext:t,cacheResponseOnServer:i.cacheResponseOnServer,visual:i.contract,performanceActivity:a,metricsKind:i.executionMetricsKind};return n.visualParameterService.resolve(e)}))},g.prototype.runQueryImpl=function(a,n,o,s,r){var l,p=this,u=(!a.initialLoad&&this.hostServices&&this.updateCachedData(a),this.getDatasetCacheOptions(a,n,!0)),e=a.initialLoad&&this.featureSwitchService.featureSwitches.verboseTelemetry,t=(e&&(l=this.startVisualFirstLoadTelemetryEvent(u,n,o.name,s&&s.telemetryActivity)),t=this.generateApplicationContext(a.queryOperation,o),this.visualDataProxyExecutionService.runQuery({dataSources:n,contract:o,viewport:a.viewport,hostServices:this.hostServices,initialLoad:a.initialLoad,useVisualContainerCache:a.useVisualContainerCache,preferCurrentData:a.preferCurrentData,allowResultFromClientCache:a.allowResultFromClientCache,cacheResponseOnServer:a.cacheResponseOnServer,cacheResponseOnContract:a.cacheResponseOnContract,cacheOptions:u,clientCacheOnly:a.clientCacheOnly,visualFirstLoadEvent:l,performanceActivity:s&&s.queryActivity,executionMetricsKind:a.executionMetricsKind,canDefer:a.canDefer,requestPriority:a.requestPriority,applicationContext:t,windowExpansionTransform:a.windowExpansionTransform,skipShouldRunQueryVerification:a.skipShouldRunQueryVerification,previewGate:a.previewGate})),i=o.config.singleVisual.visualType,c=o.config.singleVisual.objects,d=this.loadResourcePackageReferences(i,c),m=(a.geocodingTracker&&a.geocodingTracker.newQuery(s&&s.rootActivity),!1);return t.previewPromise.then((function(t){t&&!m&&p.resolveResourcePackageReferences(i,t.dataProxyQuery.transforms.objects,s&&s.rootActivity).then((function(e){p.handleQueryResult(o,t.result,t.dataProxyQuery,e,null,null,!0,s,r)}))}),(function(e){})),t.finalPromise.then((function(e){var t=e&&e.result&&e.result.dataReaderResult,r=!!(u&y.AllowCache),i=(t&&r&&l&&(l.event.info.cacheResultFromServer=e.result.dataReaderResult.fromCache),p.getLastRefreshTime(n));return r&&t&&p.isResultStale(i,e.result.dataReaderResult.timestamp)?(r=!!(u&y.PreventRefresh),t=y.AllowQuery|y.CacheResult,t=r?t|y.PreventRefresh:t,l&&(l.event.info.staleCacheResultFromServer=!0),p.visualDataProxyExecutionService.runQuery({dataSources:n,contract:o,viewport:a.viewport,hostServices:p.hostServices,initialLoad:a.initialLoad,useVisualContainerCache:!1,preferCurrentData:a.preferCurrentData,allowResultFromClientCache:!1,cacheResponseOnServer:!1,cacheOptions:t,visualFirstLoadEvent:l,performanceActivity:s&&s.queryActivity,executionMetricsKind:a.executionMetricsKind,requestPriority:a.requestPriority,canDefer:a.canDefer}).finalPromise):e})).then((function(e){return d.then((function(){p.processQueryResult(a,e,s,r)}))})).finally((function(){m=!0,e&&l&&l.resolve()}))},g.prototype.startQueryPerformanceActivity=function(e){if(e&&e.isRunning())return{rootActivity:e,queryActivity:e.createChildActivity({name:"Query"}),telemetryActivity:this.telemetryService.getOpenActivityById(e&&e.getProperty("telemetryActivityId"))}},g.prototype.startResolveParametersPerformanceActivity=function(e){if(e)return e.createChildActivity({name:"Resolve Parameters"})},g.prototype.startVisualFirstLoadTelemetryEvent=function(e,t,r,i){e=!!(e&y.AllowCache),t=h.hasOnPremDataSource(t),i=i?this.telemetryService.startChildEvent(i.event,u.telemetry.EXVisualFirstLoad,{onPrem:t,isServerCacheEligible:e,visualName:r}):this.telemetryService.startEvent(u.telemetry.EXVisualFirstLoad,{onPrem:t,isServerCacheEligible:e,visualName:r});return a.addExplorationInfoToEvent(i.event,this.explorationNavigation),i},g.prototype.getCachedQueryOrGenerate=function(a){return __awaiter(this,void 0,u.Promise,(function(){var t,r,i;return __generator(this,(function(e){switch(e.label){case 0:if(t=m.updateParentWithNewLinkingActivity(a.performanceActivity,u.telemetry.EXGetCachedQueryOrGenerate,this.telemetryService),r=this.dataProxyService.lastExecutedQuery())return this.cachedQueryResult=void 0,[2,r];e.label=1;case 1:return e.trys.push([1,,4,5]),(i=this.cachedQueryResult)?[3,3]:[4,this.generateQuery(a)];case 2:i=e.sent(),e.label=3;case 3:return[2,i];case 4:return t&&t.resolve(),[7];case 5:return[2]}}))}))},g.prototype.generateQuery=function(i){return __awaiter(this,void 0,s,(function(){var t,r;return __generator(this,(function(e){switch(e.label){case 0:return t=this.dataSources.get(),[4,this.conceptualSchemaProxy.get(t)];case 1:return r=e.sent(),r={dataSources:t,schema:r,config:i.contract.config.singleVisual,hostServices:this.hostServices,visualQueryGenerator:this.visualQueryGenerator,executionType:0,preferCurrentData:null==i.preferCurrentData||i.preferCurrentData,viewport:i.viewport,allowResultFromClientCache:null==i.allowResultFromClientCache||i.allowResultFromClientCache,cacheOptions:void 0,performanceActivity:i.performanceActivity,executionMetricsKind:i.executionMetricsKind},r=this.visualDataProxyExecutionService.generateQuery(r),this.dataProxyService.lastExecutedQuery()?this.cachedQueryResult=void 0:this.cachedQueryResult=r,[2,r]}}))}))},g.prototype.updateCachedData=function(a){return __awaiter(this,void 0,u.Promise,(function(){var t,r,i;return __generator(this,(function(e){switch(e.label){case 0:return!1===a.cacheResponseOnContract?[2]:[4,this.generateQuery(__assign(__assign({},a),{performanceActivity:void 0}))];case 1:return t=e.sent(),r=a.contract,t&&!t.error&&r.cachedData&&(r.cachedData.dataUpdatedTime=void 0,i=this.visualPlugin.capabilities(r.config.singleVisual.visualType),r.cachedData.transformsObject=o.serializeDataViewTransformActions(t.transforms,i.objects),r.cachedData.queryObject=t.options.query.command,r.cachedData.dataObject=void 0),[2]}}))}))},g.prototype.loadMoreData=function(t){var r=this,e=this.startQueryPerformanceActivity(t.performanceActivity);this.queryExecutionServices.notifyStart(),this.getNextDataSegment(t,e).then((function(e){e&&r.mergeMoreData(e.result,e.dataProxyQuery,t.currentData,e.performanceActivityContext)})).catch((function(){e&&e.queryActivity.reject()})).finally((function(){r.queryExecutionServices.notifyEnd()}))},g.prototype.canLoadMoreData=function(){return this.visualDataProxyExecutionService.canLoadMoreData()},g.prototype.loadWindow=function(t){var r=this,i=this.startQueryPerformanceActivity(t.performanceActivity);this.queryExecutionServices.notifyStart(),this.visualDataProxyExecutionService.loadWindow({dataSources:this.dataSources.get(),contract:t.contract,hostServices:this.hostServices,viewport:t.viewport,useVisualContainerCache:t.useVisualContainerCache,performanceActivity:null==i?void 0:i.queryActivity,executionMetricsKind:t.executionMetricsKind,windowExpansionState:t.windowExpansionState}).then((function(e){r.handleLoadMoreDataWarnings(e&&e.result,e&&e.dataProxyQuery),r.processQueryResult(t,e,i,void 0)})).catch((function(e){r.queryExecutionServices.handleErrors(e),i&&i.queryActivity.reject()})).finally((function(){r.queryExecutionServices.notifyEnd()}))},g.prototype.getNextDataSegment=function(e,t){var r=this,i=t||this.startQueryPerformanceActivity(e.performanceActivity),a=this.promiseFactory.defer();return this.visualDataProxyExecutionService.canLoadMoreData()?this.visualDataProxyExecutionService.loadMoreData({dataSources:this.dataSources.get(),contract:e.contract,hostServices:this.hostServices,viewport:e.viewport,useVisualContainerCache:e.useVisualContainerCache,performanceActivity:null==i?void 0:i.queryActivity,executionMetricsKind:e.executionMetricsKind}).then((function(e){r.handleLoadMoreDataWarnings(e&&e.result,e&&e.dataProxyQuery);var t=e;i&&(t=__assign(__assign({},e),{performanceActivityContext:i})),a.resolve(t)}),(function(e){r.queryExecutionServices.handleErrors(e),i&&i.queryActivity.reject(),a.reject(e)})):(i&&i.queryActivity.reject(),a.reject("Cannot load more data")),a.promise},g.prototype.reloadDataSegment=function(e,t){var r=e.currentData&&e.currentData.dataView&&e.currentData.dataView.matrix&&e.currentData.dataView.matrix.rows&&e.currentData.dataView.matrix.rows.root;r&&(t=this.dataProxyService.getNodeSegment(t))&&0!==t.index&&(this.dataProxyService.discardSegmentsFrom(t.index),t=this.dataProxyService.getLastNodeIndex(),n.pruneTree(r,t))?this.loadMoreData(e):this.runQuery(e)},g.prototype.mergeMoreData=function(e,t,r,i){var t=g.getDataProxyQueryExecutionResultWarnings(e,t),a=e&&e.dataReaderResult?e.dataReaderResult.dataView:null;a?(r=r.dataView,n.mergeDataViews(r,a),a={dataView:r,dataViewSource:e&&e.dataViewSource,performanceActivities:e&&e.dataReaderResult&&e.dataReaderResult.performanceActivities,isFirstSegment:!1},_.isEmpty(t)||(a.warnings=t),this.queryExecutionServices.loadMergedData(a,i)):i&&i.queryActivity.resolve()},g.prototype.visualizeDataViewSource=function(r,i,a,e){var n,o,s=this,l=this.startQueryPerformanceActivity(e),e=r.config.singleVisual,e=this.visualPluginOps.targetedDataViewKinds(e.visualType,e.query),p=c.read(e,i.data,t.utils.getDsrReaderSwitches(this.featureSwitchService.featureSwitches)),e=p.error;e?this.queryExecutionServices.handleErrors(e):(n=this.dataSources.get(),o=r&&r.config&&r.config.singleVisual,n&&o&&this.conceptualSchemaProxy.get(n).then((function(e){var t,e=s.visualQueryGenerator.execute({config:o,dataSources:n,schema:e,additionalFilters:s.hostServices.getFilters(s.filterGenerator,e),restartToken:p.restartToken,dataWindow:a,dataSourceVariables:s.hostServices.getDataSourceVariables(),disableAnchorTime:!!s.hostServices.disableAnchorTime||s.visualPluginOps.isQnaVisual(o.visualType)});e&&((t=s.promiseFactory.defer()).resolve(e.options),s.handleQueryResult(r,{dataViewSource:i,dataReaderResult:p},{transforms:e.transforms,error:e.error,warnings:e.warnings,options:t.promise},null,{updateContractCache:!0},null,!1,l))})))},g.prototype.updateNonQueryVisual=function(e,t,r){var i,a=this,n=this.startQueryPerformanceActivity(r),o={dataView:null,dataViewSource:null};t?(i=e.config.singleVisual.visualType,e=e.config.singleVisual.objects,this.queryExecutionServices.notifyStart(),this.resolveResourcePackageReferences(i,e,r).then((function(e){a.queryExecutionServices.applyUpdate(o,t,e,n)})).finally((function(){a.queryExecutionServices.notifyEnd()}))):this.queryExecutionServices.applyUpdate(o,t,null,n)},g.prototype.updateContractCache=function(r,e,i){var t,a,n,o,s=this;return r&&(t=this.dataSources.get())?(a=r.cachedData&&r.cachedData.dataUpdatedTime?r.cachedData.dataUpdatedTime:null,n=e&&e.dataViewSource?e.dataViewSource.data:void 0,o=i&&i.error,e&&e.dataReaderResult&&e.dataReaderResult.disallowPersisting&&(n=a=null,o=new u.IgnorableClientError("VisualContainerQueryHandler.updateContractCache() cachingError")),this.conceptualSchemaProxy.get(t).then((function(t){return i.options.then((function(e){e={transforms:i.transforms,error:o,warnings:i.warnings,options:e,compiledMappings:i.compiledMappings};r.cachedData=h.createCacheEntry(s.visualPlugin,s.displayNameService,n,e,t,r.config.singleVisual,s.featureSwitchService.featureSwitches,l(r.filters),a)}))}))):this.promiseFactory.reject(null)},g.prototype.getLastRefreshTime=function(e){for(var t=0,r=e;t<r.length;t++){var i=r[t];if(i&&i.dsr&&i.dsr.lastRefreshTime)return i.dsr.lastRefreshTime}},g.prototype.processQueryResult=function(t,r,i,a){var e,n,o=this;r&&(n={updateContractCache:null==(e=t.cacheResponseOnContract)||e,updateServerCache:r.updateServerVisualContainerCache},this.resolveResourcePackageReferences(t.contract.config.singleVisual.visualType,r.dataProxyQuery.transforms.objects,i&&i.rootActivity).then((function(e){o.handleQueryResult(t.contract,r&&r.result,r.dataProxyQuery,e,n,t.currentData,!1,i,a)})))},g.prototype.isResultStale=function(e,t){e=r.tryDeserializeDate(e),t=r.parseIsoDate(t);return!(!e||!t)&&t<e},g.prototype.getDatasetCacheOptions=function(e,t,r){var i=e.contract.id,a=e.initialLoad,i=this.visualLifecycleService&&this.visualLifecycleService.has(i,r);if(this.featureSwitchService.featureSwitches.expandQueryCaching){if(this.isQueryCachingEnabledForAnyDataset(t))return this.cachePolicyProviderService.getInteractiveQueryPolicy(a&&i,e.interactiveQueryCachingSetting)}else if(a&&i&&this.isQueryCachingEnabledForAnyDataset(t))return y.AllowCache|y.AllowQuery|y.CacheResult},g.prototype.isQueryCachingEnabledForAnyDataset=function(e){return!!_.some(e,(function(e){return e.dsr&&e.dsr.isQueryCachingEnabled}))},g.prototype.handleQueryResult=function(t,e,r,i,a,n,o,s,l){var p,u,c,d,m=this;void 0===a&&(a={}),void 0===o&&(o=!1),this.queryExecutionServices.clearErrors(),e?(u={dataView:e.dataReaderResult?e.dataReaderResult.dataView:null,dataViewSource:e.dataViewSource||null,performanceActivities:e.dataReaderResult?e.dataReaderResult.performanceActivities:null},c=g.getDataProxyQueryExecutionResultWarnings(e,r)||[],l&&(c=_.concat(c,l)),_.isEmpty(c)||(u.warnings=c),(d=h.isSegment(u.dataView))&&(u.isFirstSegment=d),null!=(d=null==(d=this.featureSwitchService)?void 0:d.featureSwitches)&&d.queryContext&&(p=null==(d=e.dataReaderResult)?void 0:d.queryContext)&&(u.queryContext=p)):(u={dataView:n&&n.dataView,dataViewSource:n&&n.dataViewSource,isFirstSegment:n&&n.isFirstSegment},c=n&&n.warnings||[],l&&(c=_.concat(c,l)),_.isEmpty(c)||(u.warnings=c),null!=(l=null==(d=this.featureSwitchService)?void 0:d.featureSwitches)&&l.queryContext&&(p=null==n?void 0:n.queryContext)&&(u.queryContext=p)),this.queryExecutionServices.handleWarnings(c,r&&r.transforms),this.queryExecutionServices.applyUpdate(u,r.transforms,i,s,o),a&&a.updateContractCache&&(d=e&&e.dataViewSource?e.dataViewSource.data:void 0,l=this.updateContractCache(t,d,r),a.updateServerCache)&&l.then((function(){r.options.then((function(e){_.isEmpty(e.query.command)||(e={visualContainerId:t.id,query:JSON.stringify(e.query.command),dataTransforms:m.getCachedTransformsString(t)},m.eventBridge.publishToChannel(v.events.newQueryCacheResultAvailable,e))}))}))},g.prototype.handleLoadMoreDataWarnings=function(e,t){this.queryExecutionServices.clearErrors();e=g.getDataProxyQueryExecutionResultWarnings(e,t)||[];this.queryExecutionServices.handleWarnings(e,t&&t.transforms)},g.prototype.getCachedTransformsString=function(e){e=e.cachedData;if(e){e=e.transformsObject;if(e)return o.serializeTransformActions(e)}},g.prototype.loadResourcePackageReferences=function(e,t){var r=this,e=this.visualPlugin.capabilities(e),e=e&&e.objects,i=this.explorationNavigation.getCurrentExploration();return p.loadFromDataViewObjects(t,e,(function(){return i?i.resourcePackages:null}),this.resourceLoader,this.promiseFactory,(function(e,t){return r.ensureSharedResource(i,e,t)}))},g.prototype.ensureSharedResource=function(e,t,r){this.resourceRegistration&&(e=i.ensureResourcePackageType(e,2),d.findItemInPackage(e,t)||this.resourceRegistration.add(t,2,r))},g.prototype.resolveResourcePackageReferences=function(e,t,r){var e=this.visualPlugin.capabilities(e),e=e&&e.objects,i=this.explorationNavigation.getCurrentExploration();return p.loadAndResolveFromDataViewObjects(t,e,i?i.resourcePackages:null,this.resourceLoader,this.promiseFactory,void 0,r)},g.getDataProxyQueryExecutionResultWarnings=function(e,t){var r;return t&&!_.isEmpty(t.warnings)&&(r=r||[]).push.apply(r,t.warnings||[]),e&&e.dataReaderResult&&!_.isEmpty(e.dataReaderResult.warnings)&&(r=r||[]).push.apply(r,e.dataReaderResult.warnings||[]),r},E=g,v.VisualContainerQueryHandler=E})(powerbi=powerbi||{}),(function(e){var t,d,m,v;function y(e){if(!_.isEmpty(e))for(var t=0,r=e;t<r.length;t++){var i=r[t];if(_.some(i.filter.where(),(function(e){return 3===d.runDetector(e.condition)})))return!0}return!1}t=(t=e.explore||(e.explore={})).services||(t.services={}),d=e.data.FilterKindDetector,m=e.data.SemanticFilter,v=e.data.SubqueryRewriter,(t.FilterPrecedenceResolver||(t.FilterPrecedenceResolver={})).resolve=function(e){if(_.isEmpty(e.visualFilters))return e.visualFilters;for(var t=!1,r=[],i=0,a=e.visualFilters;i<a.length;i++){var n=(p=a[i]).filter.where().filter((function(e){return 0===d.runDetector(e.condition)})),t=t||y([p]);r.push.apply(r,n.map((function(e){return m.fromSQExpr(e.condition)})))}if(!t)return e.visualFilters;for(var o=[],s=0,l=e.visualFilters;s<l.length;s++){var p,u,c=p=l[s];y([p])&&(u=p.filter,_.isEmpty(r)||(u=v.makeSubqueriesLowerPrecedenceThanSpecificFilters(u,r)),_.isEmpty(e.crossFilters)||(u=v.makeSubqueriesLowerPrecedenceThanSpecificFilters(u,e.crossFilters.map((function(e){return e.filter})))),_.isEmpty(e.sectionFilters)||(u=v.makeSubqueriesLowerPrecedenceThanSpecificFilters(u,e.sectionFilters.map((function(e){return e.filter})))),_.isEmpty(e.drillThroughFilters)||(u=v.makeSubqueriesLowerPrecedenceThanSpecificFilters(u,e.drillThroughFilters.map((function(e){return e.filter})))),c={filter:u=_.isEmpty(e.reportFilters)?u:v.makeSubqueriesLowerPrecedenceThanSpecificFilters(u,e.reportFilters.map((function(e){return e.filter})))}),o.push(c)}return o}})(powerbi=powerbi||{}),(function(i){var e,t,a,r,g;function n(e){this.options=e}function o(e){var t=r.call(this)||this;return t.filterTargetRoles=e,t}e=(e=i.explore||(i.explore={})).services||(e.services={}),t=i.data.FilterKindDetector,a=i.data.SQScopedEvalExpr,n.prototype.resolveSemanticQuery=function(e){return e?e.where(this.resolveFilters(e.where()),e.from()):null},n.prototype.resolveFilters=function(e){var t=this;return e?_.map(e,(function(e){return t.resolveFilter(e)})):null},n.prototype.resolveFilter=function(e){if(!e)return null;if(e.target)return e;if(e.condition)switch(t.runDetector(e.condition)){case 0:return this.resolveColumnFilter(e);case 2:return this.resolveExistsFilter(e);case 1:return this.resolveMeasureFilter(e);case 3:return this.resolveSubqueryFilter(e);default:return}},n.prototype.resolveColumnFilter=function(e){return{condition:e.condition,annotations:e.annotations}},n.prototype.resolveMeasureFilter=function(e){var t,r,i,a,n,o,s=this,l=null,p=((l=this.options.mappings&&this.options.mappings.measureFilter?this.options.mappings.measureFilter.targetRoles:l)&&_.some(l,(function(e){return s.options.queryProjections[e]}))||(l=this.getDefaultMeasureFilterTargetRoles()),e.condition);if(l){for(var u=0,c=l;u<c.length;u++){var d=c[u],d=this.options.queryProjections[d];if(d)for(var m=this,v=0,y=d.all();v<y.length;v++){var h=y[v];o=n=i=a=i=void 0,i=m.options.select.filter((function(e){return e.name===h.queryRef})),a=i[0].expr,i=i[0].name,n=a.getMetadata(m.options.schema),o=t&&t[i],n&&1!==n.kind&&!o&&(r||(r=[],t={}),r.push(a),t[i]=!0)}}p=g.rewrite(p,l)}return{target:r,condition:p,annotations:e.annotations}},n.prototype.resolveExistsFilter=function(e){return e.target,e},n.prototype.resolveSubqueryFilter=function(e){return{condition:e.condition,annotations:e.annotations}},n.prototype.getDefaultMeasureFilterTargetRoles=function(){return(this.options.dataRoles?this.options.dataRoles.filter((function(e){return e.kind===i.VisualDataRoleKind.Grouping||e.kind===i.VisualDataRoleKind.GroupingOrMeasure})):[]).map((function(e){return e.name}))},e.VisualFilterMappingResolver=n,r=i.data.SQExprRewriter,__extends(o,r),o.rewrite=function(e,t){t=new o(t);return e.accept(t)},o.prototype.visitScopedEval=function(e){var t=this,r=_.filter(e.scope,(function(e){return!i.data.SQExpr.isRoleRef(e)||_.includes(t.filterTargetRoles,e.role)}));return r.length===e.scope.length?e:new a(e.expression,r)},g=o})(powerbi=powerbi||{}),(function(c){var a,o,r,i,n,s,l,d;function e(e,t,r,i,a,n,o,s,l,p,u,c){this.telemetryService=e,this.eventBridge=t,this.explorationNavigation=r,this.dataSourcesService=i,this.conceptualSchemaProxy=a,this.globalEventBridge=n,this.visualTimeSynchronizationService=o,this.notificationBarService=s,this.localizationService=l,this.errorService=p,this.reportRefreshCacheService=u,this.reportRefreshConfigProxy=c,this.visualsLoaded=!1,this.timerExpired=!1,this.isRunning=!1,this.refreshDelayedCount=0,this.refreshPaused=!1,this.subscriptionManager=t.createChannelSubscriptionManager()}a=c.explore||(c.explore={}),o=a.services||(a.services={}),r=c.explore.contracts.AutoPageRefreshOption,i=c.common.constants.MaxInt32,n=c.common.events.reportRefreshStateChanged,s=c.explore.util,o.AutoPageRefreshErrorId="apr_error_notification_bar",o.createReportRefreshService=function(e,t,r,i,a,n,o,s,l,p,u,c){return new d(e,t,r,i,a,n,o,s,l,p,u,c)},l={autoRefreshEnabled:!0,refreshIntervalSeconds:1},e.prototype.subscribeEvents=function(){var e=this;null==this.subscriptionManager&&(this.subscriptionManager=this.eventBridge.createChannelSubscriptionManager()),this.subscriptionManager.subscribe(o.events.sectionChanged,(function(){return e.onSectionChanged()})).subscribe(c.common.events.printSectionReady,(function(){return e.onVisualsLoaded()})).subscribe(o.events.sectionObjectsEvaluated,(function(){return e.onSectionsObjectsEvaluated()})).subscribe(o.events.modelChanged,(function(){return e.onModelChanged()}))},e.prototype.init=function(t){return void 0===t&&(t=!0),__awaiter(this,void 0,c.Promise,(function(){return __generator(this,(function(e){switch(e.label){case 0:return this.triggerNotifications=t,[4,this.loadPageSettings()];case 1:return e.sent(),[4,this.updateRefreshState()];case 2:return e.sent(),this.subscribeEvents(),[2]}}))}))},e.prototype.destroy=function(){var e;this.stopRefresh(),null!=(e=this.subscriptionManager)&&e.unsubscribeAll(),this.subscriptionManager=void 0},e.prototype.refreshData=function(){this.reportRefreshCacheService.tryClearDSRCache()&&this.eventBridge.publishToChannel(o.events.visualContainerChanged,{affectContainer:function(){return!0}})},e.prototype.setRefreshPaused=function(e){this.refreshPaused=e},e.prototype.getRefreshStats=function(){return{adminConfig:this.adminConfig,effectiveRefreshInterval:this.effectiveRefreshInterval,lastRefreshTimestamp:this.lastUpdateDate?this.lastUpdateDate.toLocaleTimeString():void 0}},e.prototype.loadAdminSettings=function(){var a;return __awaiter(this,void 0,c.Promise,(function(){var t,r,i;return __generator(this,(function(e){switch(e.label){case 0:return[4,this.isPageRefreshSupported()];case 1:if(!e.sent())return[2];if(!this.reportRefreshConfigProxy)return this.adminConfig=l,[2];t=null==(a=null==(a=this.explorationNavigation.getCurrentExploration())?void 0:a.report)?void 0:a.modelId,e.label=2;case 2:return e.trys.push([2,4,,5]),[4,(r=this).reportRefreshConfigProxy.getAPRConfig(t)];case 3:return r.adminConfig=e.sent(),[3,5];case 4:return i=e.sent(),this.telemetryService.logEvent(c.telemetry.EXGetAPRConfigFailure,{modelId:t}),this.sendNotification(this.localizationService.get("AutoPageRefresh_Error_GetAdminConfigErrorTryAgain"),!0,i,"FailedToGetAPRAdminConfig"),this.adminConfig=void 0,[2];case 5:return this.adminConfig?this.adminConfig.autoRefreshEnabled||this.sendNotification(this.localizationService.get("AutoPageRefresh_Error_AdminDisabled")):this.sendNotification(this.localizationService.get("AutoPageRefresh_Error_GetAdminConfigErrorTryAgain"),!0),[2]}}))}))},e.prototype.loadPageSettings=function(){return __awaiter(this,void 0,c.Promise,(function(){var t,r,i;return __generator(this,(function(e){switch(e.label){case 0:return r=this.explorationNavigation.getCurrentSection(),[4,this.isAPREnabledInSection(r)];case 1:return e.sent()?(t=this.refreshIntervalInMilliseconds,i=s.DurationParser.parseISODurationdString(r.evaluatedObjects.pageRefresh.duration||a.constants.ExploreCanvasConstants.DefaultTimeInterval),this.refreshIntervalInMilliseconds=s.DurationParser.durationParseResultAsMilliseconds(i)):this.refreshIntervalInMilliseconds=void 0,[2,this.refreshIntervalInMilliseconds!==t]}}))}))},e.prototype.onSectionsObjectsEvaluated=function(){return __awaiter(this,void 0,c.Promise,(function(){var t;return __generator(this,(function(e){switch(e.label){case 0:return[4,this.loadPageSettings()];case 1:return t=e.sent(),this.refreshIntervalInMilliseconds&&t?this.updateRefreshState():!this.refreshIntervalInMilliseconds&&this.isRunning&&this.stopRefresh(),[2]}}))}))},e.prototype.onModelChanged=function(){return __awaiter(this,void 0,c.Promise,(function(){var t;return __generator(this,(function(e){switch(e.label){case 0:return[4,this.getRefreshInterval()];case 1:return(t=e.sent())&&!this.isRunning?this.updateRefreshState():!t&&this.isRunning&&this.stopRefresh(),[2]}}))}))},e.prototype.getRefreshInterval=function(){return __awaiter(this,void 0,c.Promise,(function(){var t;return __generator(this,(function(e){switch(e.label){case 0:return[4,this.isPageRefreshSupported()];case 1:return e.sent()?this.refreshIntervalInMilliseconds&&this.adminConfig&&this.adminConfig.autoRefreshEnabled?(t=_.max([this.refreshIntervalInMilliseconds,1e3*this.adminConfig.refreshIntervalSeconds]),[2,_.min([i,t])]):[2]:[2,null]}}))}))},e.prototype.isPageRefreshSupported=function(){return __awaiter(this,void 0,c.Promise,(function(){var t;return __generator(this,(function(e){switch(e.label){case 0:return e.trys.push([0,2,,3]),[4,this.conceptualSchemaProxy.get(this.dataSourcesService.get())];case 1:return t=e.sent(),[3,3];case 2:return e.sent(),[2,!1];case 3:return[2,_.some(t.schemas,(function(e){return e.capabilities&&e.capabilities.supportsFastRefresh}))]}}))}))},e.prototype.updateRefreshState=function(){return __awaiter(this,void 0,c.Promise,(function(){var t;return __generator(this,(function(e){switch(e.label){case 0:return this.stopRefresh(),this.isRunning=!0,this.adminConfig||null==this.refreshIntervalInMilliseconds?[3,2]:[4,this.loadAdminSettings()];case 1:e.sent(),e.label=2;case 2:return[4,this.getRefreshInterval()];case 3:return null!=(t=e.sent())?this.runTimer(t):this.isRunning=!1,[2]}}))}))},e.prototype.triggerRefreshUponSectionChange=function(){return __awaiter(this,void 0,c.Promise,(function(){var t;return __generator(this,(function(e){switch(e.label){case 0:return t=this.explorationNavigation.getCurrentSection(),[4,this.isAPREnabledInSection(t)];case 1:return e.sent()&&this.triggerRefresh(),[2]}}))}))},e.prototype.onSectionChanged=function(){return __awaiter(this,void 0,c.Promise,(function(){return __generator(this,(function(e){switch(e.label){case 0:return[4,this.triggerRefreshUponSectionChange()];case 1:return e.sent(),this.lastUpdateDate=void 0,[4,this.loadPageSettings()];case 2:return e.sent(),[4,this.updateRefreshState()];case 3:return e.sent(),[2]}}))}))},e.prototype.onVisualsLoaded=function(){this.visualsLoaded=!0,this.timerExpired&&this.isRunning&&this.onTimerExpired()},e.prototype.stopRefresh=function(){this.nextUpdateDate=void 0,this.isRunning=!1,this.timerExpired=!1,this.clearTimeoutAndAnimationFrame(),this.notifyReportRefreshStateChanged(),this.notificationBarService.hide(o.AutoPageRefreshErrorId)},e.prototype.clearTimeoutAndAnimationFrame=function(){clearTimeout(this.timeoutId),this.timeoutId=void 0,cancelAnimationFrame(this.animationFrameId),this.animationFrameId=void 0},e.prototype.runTimer=function(e){var t=this;this.clearTimeoutAndAnimationFrame(),this.nextUpdateDate=new Date(Date.now()+e),this.notifyReportRefreshStateChanged(),this.timeoutId=setTimeout((function(){t.timeoutId=void 0,t.animationFrameId=requestAnimationFrame((function(){t.animationFrameId=void 0,t.onTimerTriggered()}))}),e)},e.prototype.onTimerTriggered=function(){return __awaiter(this,void 0,c.Promise,(function(){var t;return __generator(this,(function(e){switch(e.label){case 0:return this.timerExpired=!0,this.visualsLoaded?this.onTimerExpired():this.refreshDelayedCount+=1,[4,this.loadAdminSettings()];case 1:return e.sent(),[4,this.getRefreshInterval()];case 2:return null!=(t=e.sent())?this.runTimer(t):this.stopRefresh(),[2]}}))}))},e.prototype.triggerRefresh=function(){var e=this.explorationNavigation.getCurrentSection();this.reportRefreshCacheService.clearClientCache(e),this.visualTimeSynchronizationService.setAnchorTimeToNow(),this.eventBridge.publishToChannel(o.events.dataRefreshTriggered)},e.prototype.calculateEffectiveInterval=function(){this.effectiveRefreshInterval=this.lastUpdateDate?(new Date).getTime()-this.lastUpdateDate.getTime():void 0},e.prototype.onTimerExpired=function(){this.refreshPaused||(this.logTriggerRefresh(this.refreshDelayedCount),this.calculateEffectiveInterval(),this.lastUpdateDate=new Date,this.triggerRefresh(),this.timerExpired=!1,this.visualsLoaded=!1,this.refreshDelayedCount=0,this.notifyReportRefreshStateChanged())},e.prototype.logTriggerRefresh=function(u){return __awaiter(this,void 0,c.Promise,(function(){var t,r,i,a,n,o,s,l,p;return __generator(this,(function(e){switch(e.label){case 0:return t=this.explorationNavigation.getCurrentSection(),l=this.explorationNavigation.getCurrentExploration().report,r=this.explorationNavigation.getExplorationTelemetryData(),a=-1,n=i="",s=o="-1",l&&l.model&&(p=l.model,i=p.dbName,n=l.objectId,a=p.id),l=t.objectId,[4,this.getRefreshInterval()];case 1:return p=e.sent(),r&&(o=r.exid,s=r.exsid),this.telemetryService.logEvent(c.telemetry.TriggerRefresh,{reportId:n,pageId:l,dbName:i,modelId:a,interval:p,delayCount:u,exid:o,exsid:s}),[2]}}))}))},e.prototype.notifyReportRefreshStateChanged=function(){var e,t;this.triggerNotifications&&(e=void 0,(t=this.explorationNavigation.getCurrentExploration().report)&&(e=t.objectId),this.globalEventBridge.publishToChannel(n,{reportId:e,nextUpdateDate:this.nextUpdateDate,lastUpdateDate:this.lastUpdateDate}))},e.prototype.sendNotification=function(e,t,r,i){var a=this,n=(void 0===t&&(t=!1),{id:o.AutoPageRefreshErrorId,message:e,notificationType:1,actions:[]});r&&(n.secondaryLink={action:function(){a.errorService.error(e,i,{requestId:r.requestId,statusCode:r.status&&r.status.toString()})},displayText:this.localizationService.get("Generic_ShowDetails")}),t&&n.actions.push({action:function(){a.notificationBarService.hide(o.AutoPageRefreshErrorId),a.updateRefreshState()},displayText:this.localizationService.get("TryAgain")}),this.notificationBarService.notify(n)},e.prototype.isAPREnabledInSection=function(t){return __awaiter(this,void 0,c.Promise,(function(){return __generator(this,(function(e){switch(e.label){case 0:return[4,this.isPageRefreshSupported()];case 1:return e.sent()?[2,t&&t.evaluatedObjects&&t.evaluatedObjects.pageRefresh&&t.evaluatedObjects.pageRefresh.show&&(null==t.evaluatedObjects.pageRefresh.refreshType||t.evaluatedObjects.pageRefresh.refreshType===r.APR)]:[2,!1]}}))}))},d=e})(powerbi=powerbi||{}),(function(S){var e,b,E,v,r,N,V,w,P;function y(e,t){switch(e){case r.Forecast.name:return t.some((function(e){return S.DataViewMapping.isForecastDefined(e)}));case r.SampleAndDetectAnomaly.name:return t.some((function(e){return S.DataViewMapping.isAnomalyDefined(e)}));default:return 1}}e=(e=S.explore||(S.explore={})).TransformGeneratorUtils||(e.TransformGeneratorUtils={}),b=S.visuals.AnomalyDetectionTransformConstants,E=S.data.CompiledDataViewMapping,v=S.data.DataViewObjectDefinitions,r=S.data.transforms.plugins,N=S.data.SQExpr,V=S.data.SQExprBuilder,w=S.data.SQExprUtils,P=jsCommon.StringExtensions,e.addTransforms=function(a,e,o,t,r){if(!a)return o;function i(r){function e(t){var e;i.properties[t].type.queryTransform&&(e=_.filter(a[r],(function(e){var t=e,e=o;if(!t.selector||!_.isString(t.selector.metadata))return!0;var r=e.projections;if(r)for(var i in r){i=r[i];if(i){i=i.all();if(i)for(var a=0,n=i;a<n.length;a++)if(n[a].queryRef===t.selector.metadata)return!0}}return!1})),s.push.apply(s,_.map(e,(function(e){return{objectName:r,propertyName:t,object:e}}))))}var t,i=l[r];for(t in i.properties)e(t)}var n,s=[],l=r.objects;for(n in l)i(n);if(_.isEmpty(s))return o;for(var p=o.clone(),u=0,c=s;u<c.length;u++){var d,m=c[u],m=v.getValue(a,{objectName:m.objectName,propertyName:m.propertyName},m.object.selector);m&&y(m.algorithm,e)&&(d=t.getTransformPlugin(m.algorithm),p.addTransform(d,m.parameters,r))}return p},e.removeUnsupportedTransforms=function(e,t,r){var i=t.defn.transforms();if(_.isEmpty(i))return t;for(var a=t.clone(),n=0,o=i;n<o.length;n++){var s,l=o[n];y(l.algorithm,r)||(s=e.getTransformPlugin(l.algorithm),a.removeTransform(s,l.name))}return a},e.rewriteTransform=function(e,t,r,i,a,n,o){var s=t.transforms();if(_.isEmpty(s))return t;var l=t.select();if(_.isEmpty(l))return t;for(var p=(n=(function(e,o,s,l){for(var p=[],u=[],e=e.select(),t=0,r=e;t<r.length;t++)!(function(t){if(N.isTransformOutputRoleRef(t.expr))return p.push(t);var e=Object.keys(s),e=_.filter(e,(function(e){return _.includes(s[e],t.name)}));if(!_.isEmpty(e)){for(var r=!1,i=0,a=e;i<a.length;i++){var n=a[i];if(!o[n].activeProjectionRefs||_.includes(o[n].activeProjectionRefs,t.name)){p.push(t),r=!0;break}}return r||u.push(t)}_.isEmpty(l)||((e=_.find(l,(function(e){return e.queryName===t.name})))&&e.selector&&e.selector.data?p:u).push(t)})(r[t]);return{transformSelects:p,topLevelSelects:u}})(t,r,a,n)).transformSelects,n=n.topLevelSelects,u=[],c=0;c<s.length;c++){var d=s[c],m=e.getTransformPlugin(d.algorithm),v="input"+c,y="output"+c,d=(d.input.parameters=(function(e,t){t=_.find(t,(function(e){return S.DataViewMapping.isAnomalyDefined(e)}));{var r;t&&(t=t.categorical.dataReductionAlgorithm.binnedLineSample.warningCount,r=b.transformParameterSampleCountName,t)&&!_.find(e,(function(e){return e.name===r}))&&e.push({name:r,expr:V.integer(t)})}return e})(d.input.parameters,o),{algorithm:d.algorithm,name:d.name,input:{parameters:d.input.parameters,table:{name:v,columns:(function(e,l,p,u,t){var e=_.filter(e,(function(e){return!N.isTransformOutputRoleRef(e.expr)})),c=(function(e){for(var r,i,t=0,a=e;t<a.length;t++){var n=a[t];if(n.categorical&&(n=n.categorical.categories,_.isEmpty(n)||E.visitCategoricalCategories(n,{visitRole:function(e){var t=_.find(e.items,(function(e){return null==(e=e.scalarKeyInfo)?void 0:e.scalarKeyMinProperty}));t&&(r=e.role,i=t.scalarKeyInfo.scalarKeyQueryName)}})),r&&i)return{roleName:r,queryName:i}}})(t);return _.map(e,(function(e){var t=e,e=c,r=l,i=p,a=u,n=Object.keys(r),o=t.name===(null==e?void 0:e.queryName),s=o?e.roleName:_.find(n,(function(e){return _.includes(r[e],t.name)})),n=_.find(i,(function(e){return e.name===s})),i=!1;return{role:(i=null==e?null!=n:o||null!=s&&s!==e.roleName)?(function(t,e,r){e=_.find(e.inputRoles,(function(e){e=e.visualDataRoleMatching;return!e||!(void 0!==e.cartesianKind&&e.cartesianKind!==r.cartesianKind||void 0!==e.matchGrouping&&e.matchGrouping===w.isMeasure(t)||void 0!==e.matchMeasure&&e.matchMeasure!==w.isMeasure(t)||e.skipJoinPredicateNone&&0===r.joinPredicate)}));if(e)return e.name})(t.expr,a,n):void 0,expression:t}}))})(p,a,i,m,o)}},output:{table:{name:y,columns:(function(e,s,l){for(var p={},t=0,r=e;t<r.length;t++){var i=r[t];N.isTransformOutputRoleRef(i.expr)||(p[i.name]=!0)}return _.map(e,(function(t){var e,r,i;if(N.isTransformOutputRoleRef(t.expr)){var a,n=void 0;for(a in l){var o=l[a].all();_.some(o,(function(e){return e.queryRef===t.name}))&&(n=a)}e=n,r=t.expr,i=P.findUniqueName(p,t.name)}else r=V.columnRef(V.transformTableRef(s),t.name),i=t.name;return{role:e,expression:{name:i,expr:r}}}))})(p,v,r)}}}),p=_.map(d.output.table.columns,(function(e){var t=V.columnRef(V.transformTableRef(y),e.expression.name);return{name:e.expression.name,expr:t}}));u.push(d)}var h,g=_.last(u),f=t.orderBy(),f=(g&&!_.isEmpty(f)&&(h=_.map(f,(function(t){var e=_.find(l,(function(e){return N.equals(e.expr,t.expr)})),e=V.columnRef(V.transformTableRef(g.output.table.name),e.name);return{direction:t.direction,expr:e}}))),t.transforms(u));if(!_.isEmpty(n))for(var C=0,x=n;C<x.length;C++)!(function(t){var e=_.findIndex(l,(function(e){return e.name===t.name}));p.splice(e,0,t)})(x[C]);return f=f.select(p),f=h?f.orderBy(h):f},e.prototypeQueryFromRunnableQuery=function(i,e){var a;return _.isEmpty(i.transforms())||_.isEmpty(i.select())?i:(a=[],_.map(i.select().slice(0,e),(function(e){var t,r;N.isColumn(e.expr)&&N.isTransformTableRef(e.expr.source)?(t=e.expr.source.source,(r=_.find(i.transforms(),(function(e){return(null==(e=e.output.table)?void 0:e.name)===t})))&&(r=(function(e,t){e.output.table;var r=_.find(e.output.table.columns,(function(e){return e.expression.name===t.ref}));{var i;if(r)return i=r.expression.expr,!N.isColumn(i)||null==(e=_.find(null==(r=e.input.table)?void 0:r.columns,(function(e){return(null==(e=e.expression)?void 0:e.name)===i.ref})))?void 0:e.expression.expr}})(r,e.expr))&&!N.isTransformOutputRoleRef(r)&&a.push({name:e.name,expr:r})):a.push(e)})),i.createModified({select:a,transforms:null}))}})(powerbi=powerbi||{}),(function(e){var t,r;(t=(t=e.explore||(e.explore={})).constants||(t.constants={})).invalidSortExprIndex=-1,t.DefaultSchemaName=e.data.dsr.DefaultSchemaName,t.ExplorationSchemaName="extension",t.DefaultDrillFilterOtherVisuals=!0,t.SectionComponentType="page",t.ExplorationComponentType="report",t.GroupComponentType="group",t.MinContainerWidth=12,t.MinContainerHeight=12,t.xPositionValueAlertId="x_position",t.yPositionValueAlertId="y_position",(r=t.ExploreCanvasConstants||(t.ExploreCanvasConstants={})).DefaultCanvasWidth=960,r.DefaultCanvasHeight=720,r.DefaultCanvasBackgroundColor="#FFFFFF",r.DefaultCanvasOutspaceColor="#EAEAEA",r.DefaultCanvasOutspaceTransparency=0,r.DefaultOutspacePaneTransparency=0,r.DefaultControlForegroundColor="#000000",r.DefaultControlBackgroundColor="#ffffff",r.DefaultOutspacePaneCheckboxAndApplyColor="#117865",r.DefaultOutspacePaneCheckboxAndApplyForegroundColor="#ffffff",r.DefaultOutspacePaneApplyButtonDisabledForegroundColor="#BDBDBD",r.DefaultOutspacePaneWidth=200,r.OutspacePaneCollapsedWidth=32,r.OutspacePaneMinWidth=180,r.OutspacePaneMaxWidth=420,r.DefaultOutspacePaneBorder=!0,r.DefaultOutspacePaneBorderColor="#C8C8C8",r.DefaultOutspacePaneTitleSizePt=12,r.DefaultOutspaceSearchTextSizePt=10,r.DefaultOutspacePaneHeaderSizePt=9,r.DefaultOutspacePaneFontFamily="'Segoe UI', wf_segoe-ui_normal, helvetica, arial, sans-serif",r.DefaultAppliedFilterCardTransparency=0,r.DefaultAvailableFilterCardTransparency=0,r.DefaultFilterCardBorder=!0,r.DefaultFilterCardBorderColor="#C8C8C8",r.DefaultFilterCardTextSizePt=9,r.Available="Available",r.Applied="Applied",r.FilterCardSearchBoxBorderColor="#C8C6C4",r.FilterCardSearchBoxBackgroundColor="#FFFFFF",r.FilterCardFontColor="#252423",r.DefaultCanvasBackgroundTransparency=0,r.DefaultWidescreenWidth=1280,r.DefaultWidescreenHeight=720,r.DefaultCortanaWidth=296,r.DefaultCortanaHeight=592,r.DefaultLetterWidth=816,r.DefaultLetterHeight=1056,r.DefaultTooltipWidth=320,r.DefaultTooltipHeight=240,r.CanvasGutterSize=10,r.MobileFooterHeight=60,r.MobileFooterPadding=40,r.DefaultTimeInterval="PT30M",r.getDefaultCanvasBackground=function(){return{color:r.DefaultCanvasBackgroundColor,transparency:r.DefaultCanvasBackgroundTransparency}},r.getDefaultCanvasOutspace=function(){return{color:r.DefaultCanvasOutspaceColor,transparency:r.DefaultCanvasOutspaceTransparency}}})(powerbi=powerbi||{}),(function(v){var e,t,c,y,h,d,u,m;function a(){}e=v.explore||(v.explore={}),t=v.data,c=t.FieldExprPattern,y=t.SQExpr,h=jsCommon.StringExtensions,d=v.data.SQExprConverter,u=t.SQExprUtils,m=v.explore.util.VisualContainerUtils,a.getApplyStateInfoForInternallDrillthrough=function(e,t,r,i){void 0===r&&(r=!0);i={skipUnmatchedDrillthroughFilters:!1,filterMatchingBehavior:i=void 0===i?0:i},i=a.getFiltersState(e,i,t);return{state:{activeSection:r?e.name:void 0,sections:((t={})[e.name]={filters:i},t)},options:{clearUnmatchedData:!1,suppressDataSourceVariables:!0,suppressActiveSection:!r}}},a.getFiltersState=function(e,i,t){var a=[],n=t?__spreadArray([],t||[],!0):[],o={},s=i.filterMatchingBehavior;if(!_.isEmpty(e.filters))for(var r=0,l=e.filters;r<l.length;r++)!(function(t){if(5!==t.howCreated||t.isTransient)return;t.expression;var e=_.find(n,(function(e){return(1===s||!e.isTransient)&&e.filterExpressionMetadata&&1===e.filterExpressionMetadata.expressions.length&&y.equals(e.filterExpressionMetadata.expressions[0],t.expression)})),r=v.explore.services.convertToFilterContainerState(t);if(e)_.remove(n,e),r.filter=e.filter;else{if(i.skipUnmatchedDrillthroughFilters)return;r.filter=void 0}r.cachedValueItems=void 0,a.push(r),o[t.name]=!0})(l[r]);var p,t={exprIdentifiedMerges:a};if(0===s&&_.some(n,(function(e){return e.isTransient}))||1===s&&!_.isEmpty(n)){for(var u=[],c=0,d=n;c<d.length;c++){var m=d[c];m=m,p=void 0,p=h.findUniqueName(o,"transientFilter"),o[p]=!0,p={name:p,expression:_.isEmpty(m.filterExpressionMetadata)||1!==m.filterExpressionMetadata.expressions.length?void 0:m.filterExpressionMetadata.expressions[0],type:m.type,restatement:m.restatement,filter:m.filter,howCreated:5,isTransient:!0,displayName:m.displayName},u.push(p)}t.transientFilters=u}return t},a.getMatchedLinkFieldsFromParameters=function(e,t,r,i){e=_.map(e,(function(e){e={fieldExpr:e.fieldExpr,asAggregation:e.asAggregation};return null==e.asAggregation&&e.fieldExpr&&y.isMeasure(e.fieldExpr)&&(e.asAggregation=!1),e}));if(!_.isEmpty(e))return this.getMatchedLinkFields(e,t,r,i)},a.getMatchedLinkFields=function(e,o,s,l){for(var p=[],t=0,r=e;t<r.length;t++)!(function(e){var t=e.fieldExpr;if(!t)return;if(y.isMeasure(t))_.find(s,(function(e){return y.isMeasure(e)&&y.equals(e,t)}))&&p.push(e);else{var r=t.getKeyColumns(l);if(!_.isEmpty(r))if(e.asAggregation)for(var i=0,a=s;i<a.length;i++){var n=a[i];if(y.isAggregation(n)){n=n.arg.getKeyColumns(l);if(u.isSubset(r,n)){p.push(e);break}}}else u.isSubset(r,o)&&p.push(e)}})(r[t]);return p},a.getMeasuresFromSelectors=function(e,t,r){for(var i=[],a=m.getVisualQuery(t),n=0,o=e;n<o.length;n++){var s=o[n];if(s.metadata)for(var l=0,p=s.metadata;l<p.length;l++){var u=p[l],u=a.defn.select().withName(u);u&&u.expr&&(u=d.asFieldPattern(u.expr,r),u=c.getBaseSQExpr(u,r),i.push(u))}}return i},a.hasMeasureOrAsAggregationPodParameter=function(e,t){return(1===e||2===e)&&_.some(t,(function(e){return e.asAggregation||e.fieldExpr&&y.isMeasure(e.fieldExpr)}))},e.DrillthroughUtils=a})(powerbi=powerbi||{}),(function(e){var t,r,i,a,n,o,s;function l(e){var t=r.call(this)||this;return t.schema=e,t}t=(t=e.explore||(e.explore={})).util||(t.util={}),i=e.data.SQEntityExpr,a=e.data.SQExprRewriter,n=e.data.SQHierarchyExpr,o=e.data.SQHierarchyLevelExpr,s=e.data.SQPropertyVariationSourceExpr,__extends(l,r=a),l.prototype.visitEntity=function(e){var t=this.getVariationMapping(e);return t?new i(e.schema,t.sourceEntity.name):e},l.prototype.visitColumnRef=function(t){var e=t.source.accept(this);if(e!==t.source){var r=this.getVariationMapping(t.source);if(r){var i=_.find(r.variation.defaultHierarchy.levels,(function(e){return e.column.name===t.ref}));if(i)return new o(new n(new s(e,r.variation.name,r.sourceProperty.name),r.variation.defaultHierarchy.name),i.name)}}return t},l.prototype.getVariationMapping=function(e){e=this.schema.schema(e.schema).findVariationToHierarchyMappings(e.entity);if(e)return _.last(e)},a=l,t.VariationToHierarchyRewriter=a})(powerbi=powerbi||{}),(function(a){var g,e,f,C,x,l;function t(e,t,r,i,a,n,o,s){this.state=e,this.navigation=t,this.eventBridge=r,this.visibility=i,this.filterGenerator=a,this.explorationActivity=n,this.telemetryService=o,this.runningVisualService=s}g=a.explore||(a.explore={}),e=g.services||(g.services={}),f=a.explore,C=f.services.events,x=C.explorationFiltersContainerChanged,e.createExplorationStateManagerService=function(e,t,r,i,a,n,o,s){return new l(e,t,r,i,a,n,o,s)},t.prototype.exploration=function(){return this.navigation.getCurrentExploration()},t.prototype.capture=function(e,t){var r=this.exploration();if(r)return this.state.capture(r,e,t)},t.prototype.apply=function(e,t,r){var i=this.exploration(),e=this.state.apply(e,i,t,r);return this.applyImpact(e,i,r),e},t.prototype.captureFilterState=function(e){return this.state.captureFilterState(e)},t.prototype.applyFilterState=function(e,t){var r,i=this;_.isEmpty(e)||(r=this.state.applyFilterState(e,t),this.explorationActivity.doActivity((function(e){i.eventBridge.publishToChannel(C.visualContainerChanged,{affectContainer:function(e){return _.includes(r.visualContainers,e)},parentActivity:e})}),(function(e){return i.telemetryService.startChildActivity(e&&e.event,a.telemetry.EXExplorationStateApplyImpact)})))},t.prototype.applyImpact=function(m,v,y){var h=this;this.explorationActivity.doActivity((function(e){var t=m.dataSourceVariables,r=[],i=(m.objects&&h.eventBridge.publishToChannel(C.explorationObjectsChanged),2===m.filterScope&&(h.eventBridge.publishToChannel(x,{container:v}),t=!0),m.activeSection?h.navigation.updateActiveSection({targetSectionIndex:v.activeSectionIndex,forceUpdate:!0,parentActivity:e}):1===m.filterScope?(s=h.navigation.getCurrentSection(),h.eventBridge.publishToChannel(f.services.events.sectionFiltersContainerChanged,{container:s}),r=_.union(r,s.visualContainers)):0!==m.filterScope&&_.isEmpty(m.visualContainers)||(r=_.union(r,m.visualContainers)),[]),a=(t?(h.eventBridge.publishToChannel(C.visualContainerChanged,{affectContainer:_.stubTrue,parentActivity:e}),s=h.navigation.getCurrentSection(),i.push.apply(i,s.visualContainers||[])):_.isEmpty(r)||(h.eventBridge.publishToChannel(C.visualContainerChanged,{affectContainer:function(e){return _.includes(r,e)},parentActivity:e}),i.push.apply(i,r||[])),m.visualContainerGroups);if(_.isEmpty(a)||(h.eventBridge.publishToChannel(C.visualContainerGroupChanged,{affectContainer:function(e){return _.includes(a,e)}}),i.push.apply(i,a||[])),y.suppressDisplay||(m.visibility?h.visibility.set(m.visibility.visual,m.visibility.mode):y.targetVisualNames?(n=v.sections[v.activeSectionIndex],o=_.filter(n.visualContainers,(function(e){return _.includes(y.targetVisualNames,e.name)})),h.visibility.clearForVisualContainers(o)):h.visibility.clear(),_.isEmpty(i))||h.eventBridge.publishToChannel(C.canvasItemHiddenChanged,{changedItems:i}),!y.suppressData){var n,o,t=m.pendingHighlights,s=h.navigation.getCurrentSection();if(t){h.filterGenerator.setMultipleFiltersOnSelectData(v,s,t,e,void 0);for(var l=0,p=t;l<p.length;l++){var u=p[l],c=u.sourceVisualContainer,d=h.runningVisualService.getVisual(c),c=c.config.singleVisual;d?(u.filterExpressionMetadata&&g.FilterExpressionMetadataUtils.hydrateSelectorsByColumnWithValueDetails(u.selection,u.filterExpressionMetadata),d.setSelectedDatapoints(u.selection,!0)):c.pendingSelection=u.selection}}else y.targetVisualNames?(n=v.sections[v.activeSectionIndex],o=_.filter(n.visualContainers,(function(e){return _.includes(y.targetVisualNames,e.name)})),h.filterGenerator.clearCrossHighlightForVisualContainers(n,o,e,void 0)):h.filterGenerator.clearCrossHighlight(s,e,void 0)}}),(function(e){return h.telemetryService.startChildActivity(e&&e.event,a.telemetry.EXExplorationStateApplyImpact)}))},l=t})(powerbi=powerbi||{}),(function(d){var e,y,t,h,m,g,c,f,v,r,C,l,x,S,n,a,b,E,N,V,w,u,P,T,i,o;function F(e,t,r){if(!_.isEmpty(e)){for(var i,a={},n=0,o=e;n<o.length;n++){var s=o[n];r(s)||(s.isTransient?(a.transientFilters||(a.transientFilters=[]),a.transientFilters.push(p(s))):A(s)&&!_.isEmpty(s.name)?(a.nameIdentifiedMerges||(a.nameIdentifiedMerges={}),a.nameIdentifiedMerges[s.name]=p(s)):s.expression?(a.exprIdentifiedMerges||(a.exprIdentifiedMerges=[]),a.exprIdentifiedMerges.push(p(s))):3===(i=s).howCreated||4===i.howCreated?(a.typeIdentifiedMerges||(a.typeIdentifiedMerges=[]),a.typeIdentifiedMerges.push(p(s))):(_.isEmpty(s.name)&&(s.name=l.getNextFilterName(e)),a.nameIdentifiedMerges||(a.nameIdentifiedMerges={}),a.nameIdentifiedMerges[s.name]=p(s)))}if(!_.isEmpty(a))return a}}function p(e){return{name:e.name,type:e.type,filter:e.filter,expression:e.expression,restatement:e.restatement,howCreated:e.howCreated,isTransient:e.isTransient,cachedValueItems:e.cachedValueItems,filterExpressionMetadata:_.cloneDeep(e.filterExpressionMetadata)}}function j(e){return name,{name:e.name,type:e.type,filter:e.filter,expression:e.expression,restatement:e.restatement,howCreated:e.howCreated,isTransient:e.isTransient,cachedValueItems:e.cachedValueItems,filterExpressionMetadata:_.cloneDeep(e.filterExpressionMetadata),displayName:e.displayName}}function D(e,t){e.filter=t.filter,e.cachedValueItems=t.cachedValueItems,e.filterExpressionMetadata=_.cloneDeep(t.filterExpressionMetadata),e.type=t.type}function R(e){e.filter=void 0,e.cachedValueItems=void 0,e.filterExpressionMetadata=void 0}function A(e){return e.isHiddenInViewMode||e.isLockedInViewMode}function s(e,t,r){return!!t.filterState||(t=c.findFilterOutput(r),_.some([t],e))}function k(e){return _.some([{objectName:"outspacePane",propertyName:"expanded"},{objectName:"outspacePane",propertyName:"visible"}],e)}function I(e,t,r,i,a,n,o,s,l,p,u,c){this.expandCollapse=e,this.filterGenerator=t,this.plugins=r,this.visualPluginOps=i,this.aggrOps=a,this.featureSwitchService=n,this.sortService=o,this.drillService=s,this.telemetryService=u,this.nonDrillthroughIsLinkedAsAggregationCallback=function(e){return!1},this.visualAuthoringCore=m(r,l,a,n,p,c)}function O(e,t){var r=this;return(r=i.call(this)||this).valid=!0,r.query=e,r.schema=t,r}e=(e=d.explore||(d.explore={})).services||(e.services={}),y=d.data,t=d.explore,h=jsCommon.ArrayExtensions,m=d.explore.services.createVisualAuthoringCore,g=d.data.DataViewObjectDefinitions,c=d.data.DataViewObjectDescriptors,f=d.DataViewObjectProperty,v=y.DataViewTransform,r=d.explore.contracts.ExplorationObjectDescriptors,C=t.contracts,l=t.FilterUtils,x=t.PodUtils,S=y.ProjectionUtils,n=y.QueryProjectionCollection,a=d.data.dsr.SelectToIdentityExpressionsVisitor,b=d.data.SemanticFilter,E=d.data.SemanticQuery,N=d.data.SQExpr,V=d.explore.contracts.VisualContainer,w=t.util.VisualContainerUtils,u=t.util.PresentationUtils,P=d.explore.contracts.VisualQuery,e.createExplorationStateService=function(e,t,r,i,a,n,o,s,l,p,u,c){return new T(e,t,r,i,a,n,o,s,l,p,u,c)},e.convertToFilterContainerState=p,I.prototype.capture=function(e,t,r){var i=e.sections[e.activeSectionIndex],a={activeSection:i.name,filters:F(e.filters,0,this.nonDrillthroughIsLinkedAsAggregationCallback),sections:{}};if(this.featureSwitchService.featureSwitches.dataSourceVariablesOverride&&!r.suppressDataSourceVariables&&(a.dataSourceVariables=e.dataSourceVariables),e.objects&&(a.objects=this.captureExplorationObjects(e.objects)),r.captureAllSections)for(var n=0,o=e.sections;n<o.length;n++){var s=o[n];a.sections[s.name]=this.captureSection(s,t,e,r.capturePresentation)}else a.sections[i.name]=this.captureSection(i,t,e,r.capturePresentation);return a},I.prototype.captureExplorationObjects=function(e){return this.captureObjects(r,e,k)},I.prototype.captureFilterState=function(e){var t=this.captureFilterStateObjects(e.visualType,e.objects);return{visualType:e.visualType,objects:t,cachedFilterDisplayItems:e.cachedFilterDisplayItems}},I.prototype.captureSection=function(t,e,r,i){var a=this.getCrossHighlights(t);return{filters:F(t.filters,0,(function(e){return x.isLinkedAsAggregation(r,t,e)})),visualContainers:this.captureVisualContainers(t.visualContainers,a,e,i),visualContainerGroups:this.captureVisualContainerGroups(t.visualContainerGroups)}},I.prototype.getCrossHighlights=function(e){return e&&e.crossFilterSource&&e.crossFilterSource.highlight},I.prototype.captureVisualContainerGroups=function(e){for(var t,r=0,i=e;r<i.length;r++){var a,n,o=i[r];C.isVisualContainerGroup(o)&&(a={},null!=o.isHidden&&(a.isHidden=o.isHidden),_.isEmpty(o.children)||(n=this.captureVisualContainerGroups(o.children),a.children=n),null==a.isHidden&&null==a.children||((t=t||{})[o.name]=a))}return t},I.prototype.captureVisualContainers=function(e,n,o,s){for(var l={},p=this,t=0,r=e;t<r.length;t++)!(function(e){e.name;var t=e.config.singleVisual;if(!t)return;var r=void 0;_.isEmpty(n)||(i=_.find(n,(function(e){return e.sourceVisualContainer.config.singleVisual===t&&!_.isEmpty(e.selection)})))&&(r={selection:i.selection,filterExpressionMetadata:i.filterExpressionMetadata||void 0});var i={filters:F(_.union(e.filters,p.getAdditionalVisualFiltersToCapture(e,o)),0,p.nonDrillthroughIsLinkedAsAggregationCallback),singleVisual:{visualType:t.visualType,objects:p.captureVisualObjects(t.visualType,t.objects),cachedFilterDisplayItems:t.cachedFilterDisplayItems,filterExpressionMetadata:t.filterExpressionMetadata},highlight:r},r=(null!=t.autoSelectVisualType&&(i.singleVisual.autoSelectVisualType=t.autoSelectVisualType),e.visibility),r=(null!=r&&0!==r&&(i.visibility=r),V.isHidden(t)&&(i.singleVisual.hidden=!0),t.query),a=s&&t.presentationChangesApplied;(a||r&&r.hasQueryFieldParameters())&&(a&&(i.singleVisual.targetType=t.visualType),null!=t.autoSelectVisualType&&(i.singleVisual.targetAutoSelectVisualType=t.autoSelectVisualType),r)&&r.projections&&r.defn&&(i.singleVisual.projections=u.captureProjections(r,a)),r&&r.projections&&p.featureSwitchService.featureSwitches.fieldParameters&&(i.singleVisual.parameters=u.captureParameters(r)),r&&r.defn&&(i.singleVisual.orderBy=r.defn.orderBy()),r&&r.projections&&(i.singleVisual.activeProjections=p.captureActiveProjections(r)),r&&r.expansionStates&&(i.singleVisual.expansionStates=y.ExpansionState.clone(r.expansionStates)),l[e.name]=i})(r[t]);return l},I.prototype.captureActiveProjections=function(e){var t,r=e.defn.select();for(t in e.projections){var i,a=e.projections[t].activeProjectionRefs;_.isEmpty(a)||(a=_.map(a,(function(e){return r.withName(e).expr})),(i=i||{})[t]=a)}return i},I.prototype.captureVisualObjects=function(e,t){return this.captureFilterStateObjects(e,t)},I.prototype.captureFilterStateObjects=function(e,t){e=this.plugins.capabilities(e);return e&&e.objects?this.captureObjects(e.objects,t,s):{}},I.prototype.captureObjects=function(e,t,r){var i,a={};for(i in e){var n,o=e[i];for(n in o.properties){var s=o.properties[n],l={objectName:i,propertyName:n};(s.captureState||r(l,s,e))&&(s=g.getValue(t,l,null))&&g.setValue(a,l,null,s)}}var p={};return _.isEmpty(a)||(p.merge=a),p},I.prototype.apply=function(e,t,r,i){var a,n,o={visualContainers:[],visualContainerGroups:[],issues:[]};for(a in i.suppressActiveSection||this.applyActiveSection(e.activeSection,t,o),i.suppressData||i.targetVisualNames||this.applyFilters(e.filters,t,2,o,i.clearUnmatchedData,[],void 0,r,this.nonDrillthroughIsLinkedAsAggregationCallback),e.objects&&this.applyExplorationObjects(e.objects,t,o,i),e.sections){var s,l,p=h.findItemWithName(t.sections,a);p&&(s=e.sections[a],l=!i.suppressActiveSection||this.isActiveSection(p.name,t),this.applySection(t,s,p,r,o,i,l))}return o.activeSection&&null!=o.filterScope&&(n=t.sections[t.activeSectionIndex],w.clearSectionQueryCaches(n)),i.suppressDataSourceVariables||this.applyDataSourceVariables(e.dataSourceVariables,t,o),_.isEmpty(o.issues)||this.telemetryService.logEvent(d.telemetry.EXExplorationStateApplyImpactIssues,{context:"apply",issues:_.reduce(o.issues,(function(e,t){return e|t.type}),0)}),o},I.prototype.applyExplorationObjects=function(e,t,r,i){var a,n={},o=(e&&e.merge&&(n.merge=g.clone(e.merge)),t.objects||{});for(a in n.merge)for(var s=0,l=n.merge[a];s<l.length;s++){var p,u=l[s],c=g.ensure(o,a,u.selector);for(p in u.properties){var d=u.properties[p];this.shouldApplyExplorationProperty(a,i)&&!g.propertiesAreEqual(c.properties[p],d)&&(r.objects=!0,c.properties[p]=d)}}return r.objects&&!t.objects&&(t.objects=o),r},I.prototype.isDisplayOptions=function(e){return void 0!==e&&void 0!==e.outspacePane&&void 0!==e.visuals},I.prototype.shouldApplyExplorationProperty=function(e,t){return"outspacePane"===e&&this.isDisplayOptions(t.suppressDisplay)?!t.suppressDisplay.outspacePane:!t.suppressDisplay},I.prototype.applyFilterState=function(e,t){for(var r={visualContainers:[],visualContainerGroups:[],issues:[]},i=0,a=e;i<a.length;i++){var n=a[i],o=n.visual,s=n.state,l=o.config.singleVisual,p=this.plugins.capabilities(l.visualType),n=n.impacted;(this.applyObjects(s,l,s.objects,p.objects,t,r)||n)&&!_.includes(r.visualContainers,o)&&r.visualContainers.push(o)}return _.isEmpty(r.issues)||this.telemetryService.logEvent(d.telemetry.EXExplorationStateApplyImpactIssues,{context:"applyFilterState",issues:_.reduce(r.issues,(function(e,t){return e|t.type}),0)}),r},I.prototype.isActiveSection=function(e,t){return e===t.sections[t.activeSectionIndex].name},I.prototype.applyActiveSection=function(e,t,r){this.isActiveSection(e,t)||(0<=(e=h.indexWithName(t.sections,e))?(t.activeSectionIndex=e,r.activeSection=!0):r.issues.push({type:1}))},I.prototype.applyDataSourceVariables=function(e,t,r){e?(t.dataSourceVariables=e,r.dataSourceVariables=!0):t.dataSourceVariables=void 0},I.prototype.applyFilters=function(e,t,r,i,a,n,o,s,l){var p=!1,u=[],e={nameIdentifiedMerges:_.clone(e&&e.nameIdentifiedMerges||{}),exprIdentifiedMerges:__spreadArray([],e&&e.exprIdentifiedMerges||[],!0),typeIdentifiedMerges:__spreadArray([],e&&e.typeIdentifiedMerges||[],!0),transientFilters:__spreadArray([],e&&e.transientFilters||[],!0)},p=this.applyRemainingFilters(e,t,0===r,i,u,n,o,s,l)||p;if(a&&t.filters)for(var c=t.filters.length-1;0<=c;c--){var d=t.filters[c];d?d.type===C.FilterType.Passthrough||_.includes(u,d)||(2===d.howCreated?(t.filters.splice(c,1),this.addImpactCrossDrillSourceUpdate(o,t,0===r,i)):R(d),p=!0):t.filters.splice(c,1)}return p&&this.setMinimumFilterScope(i,r),p},I.prototype.applyRemainingFilters=function(e,t,r,i,a,n,o,s,l){var p=this.applyTransientFilters(e,t,a,i),p=this.applyMatchingFilterByName(e,t,a,i)||p;if(!_.isEmpty(e.nameIdentifiedMerges)){for(var u in e.nameIdentifiedMerges)e.exprIdentifiedMerges.push(e.nameIdentifiedMerges[u]);e.nameIdentifiedMerges={}}p=this.applyMatchingFilterByExpr(e,t,r,a,s,l,i)||p,p=this.applyMatchingFilterByType(e,t,a,i)||p;s=this.applyDrillFilters(e,t,a,n,i);return p=s||p,s&&this.addImpactCrossDrillSourceUpdate(o,t,r,i),p},I.prototype.addImpactCrossDrillSourceUpdate=function(e,t,r,i){t&&r?(r=this.filterGenerator.updateCrossDrillFromVisualContainersOperation(e,[t]),i.visualContainers=_.union(i.visualContainers,r)):i.issues.push({type:64})},I.prototype.applyMatchingFilterByName=function(i,a,n,o){if(_.isEmpty(i)||_.isEmpty(i.nameIdentifiedMerges)||_.isEmpty(a.filters))return!1;var e,s=!1,l=[];for(e in i.nameIdentifiedMerges)!(function(t){var r=i.nameIdentifiedMerges[t],e=(r.name!==t&&o.issues.push({type:4}),_.findIndex(a.filters,(function(e){return e.howCreated===r.howCreated&&!_.includes(n,e)&&e.name===t})));-1!==e&&(b.isSameFilter(a.filters[e].filter,r.filter)||(D(a.filters[e],r),s=!0),l.push(t),n.push(a.filters[e]))})(e);return l.forEach((function(e){delete i.nameIdentifiedMerges[e]})),s},I.prototype.applyMatchingFilterByExpr=function(p,u,c,d,m,v,y){if(_.isEmpty(p)||_.isEmpty(p.exprIdentifiedMerges))return!1;for(var h,g,f=!1,C=!1,x=__spreadArray([],p.exprIdentifiedMerges||[],!0),S=this;g=_.head(x);)!(function(){var r=g.howCreated;if(2===r)return x.splice(0,1);var e,t=_.remove(x,(function(e){return e===g||e.howCreated===r&&N.equals(e.expression,g.expression)})),i=[];if((u.filters||[]).forEach((function(e,t){!e||e.howCreated!==r||_.includes(d,e)||v(e)||!N.equals(e.expression,g.expression)||A(e)&&e.name!==g.name||i.push(t)})),_.isEmpty(i)&&c&&0===r&&(g.filter?(1!==t.length&&y.issues.push({type:8}),C||(C=!0,h=w.getAutoVisualFilterContainers(u,S.visualPluginOps,m,S.aggrOps)),(e=_.find(h,(function(e){return N.equals(e.expression,g.expression)})))&&((u.filters||(u.filters=[])).push(e),i.push(u.filters.length-1))):(_.remove(p.exprIdentifiedMerges,g),_.remove(t,g))),0<i.length){for(var a=Math.min(t.length,i.length);t.length>a;){var n=_.findIndex(t,(function(e){return _.isEmpty(e.filter)}));if(-1===n)break;t.splice(n,1)}for(var o=0;o<a;o++){var s=i[o];b.isSameFilter(u.filters[s].filter,t[o].filter)||(D(u.filters[s],t[o]),f=!0),d.push(u.filters[s])}for(o=a;o<t.length;o++){var l=j(t[o]);(u.filters||(u.filters=[])).push(l),d.push(l),f=!0}for(o=a;o<i.length;o++){s=i[o];R(u.filters[s]),f=!0}p.exprIdentifiedMerges=_.difference(p.exprIdentifiedMerges,t)}})();return f},I.prototype.applyDrillFilters=function(e,r,i,a,n){var o=!1;if(!(_.isEmpty(a)||_.isEmpty(e)||_.isEmpty(e.exprIdentifiedMerges))){for(var s=[],t=0,l=e.exprIdentifiedMerges;t<l.length;t++)!(function(t){var e;2!==t.howCreated||(_.find(a,(function(e){return N.equals(t.expression,e)}))?((e=_.find(r.filters,(function(e){return 2===e.howCreated&&!_.includes(i,e)&&N.equals(e.expression,t.expression)})))?(b.isSameFilter(e.filter,t.filter)||(D(e,t),o=!0),i.push(e)):(e=j(t),(r.filters||(r.filters=[])).push(e),i.push(e),o=!0),s.push(t)):n.issues.push({type:32}))})(l[t]);e.exprIdentifiedMerges=_.difference(e.exprIdentifiedMerges,s)}return o},I.prototype.applyMatchingFilterByType=function(e,r,i,a){var n=!1;if(!_.isEmpty(e)&&!_.isEmpty(e.typeIdentifiedMerges)){for(var o=[],t=0,s=e.typeIdentifiedMerges;t<s.length;t++)!(function(t){3!==t.howCreated&&4!==t.howCreated&&a.issues.push({type:16});var e=_.find(r.filters,(function(e){return e.howCreated===t.howCreated&&!_.includes(i,e)}));e?(D(e,t),i.push(e)):(e=j(t),(r.filters||(r.filters=[])).push(e),i.push(e)),o.push(t),n=!0})(s[t]);e.typeIdentifiedMerges=_.difference(e.typeIdentifiedMerges,o)}return n},I.prototype.applyTransientFilters=function(e,r,i,a){var n=!1;if(!_.isEmpty(e)&&!_.isEmpty(e.transientFilters)){for(var t=0,o=e.transientFilters;t<o.length;t++)!(function(t){5===t.howCreated&&!0===t.isTransient||a.issues.push({type:2});var e=_.find(r.filters,(function(e){return e.isTransient&&!_.includes(i,e)&&b.isSameFilter(e.filter,t.filter)}));e?(D(e,t),i.push(e)):(e=j(t),(r.filters||(r.filters=[])).push(e),i.push(e)),n=!0})(o[t]);e.transientFilters=[]}e=_.remove(r.filters,(function(e){return e&&e.isTransient&&!_.includes(i,e)}));return n=n||!_.isEmpty(e)},I.prototype.applySection=function(i,a,n,o,s,l,p){l.suppressData||l.targetVisualNames||this.applyFilters(a.filters,n,1,s,l.clearUnmatchedData,[],n,o,(function(e){return x.isLinkedAsAggregation(i,n,e)}));for(var u=this,e=0,t=n.visualContainers;e<t.length;e++)!(function(e){var t=e.name;if(l.targetVisualNames&&!_.includes(l.targetVisualNames,t))return;var t=a.visualContainers&&a.visualContainers[t],r=void 0;null!=t?(r=u.applyVisualState(i,t,n,e,o,s,l,p,!0),t.highlight&&!l.suppressData&&p&&u.isSelectionValid(t.highlight.selection,e.config.singleVisual,o)&&(null==s.pendingHighlights&&(s.pendingHighlights=[]),s.pendingHighlights.push({selection:t.highlight.selection,sourceVisualContainer:e,filterExpressionMetadata:t.highlight.filterExpressionMetadata}))):l.clearUnmatchedData&&(r=u.applyVisualState(i,{},n,e,o,s,l,p,!1)),_.isEmpty(r)||(t=_.without.apply(_,__spreadArray([r],s.visualContainers||[],!1)),(e=s.visualContainers).push.apply(e,t||[]))})(t[e]);for(var r=this.getCrossHighlights(n),c=0,d=n.visualContainerGroups;c<d.length;c++){var m,v=d[c];C.isVisualContainerGroup(v)&&null!=(m=a.visualContainerGroups&&a.visualContainerGroups[v.name])&&this.applyVisualGroupState(m,n,v,s,l,r)}},I.prototype.applyVisualState=function(e,t,r,i,a,n,o,s,l){var p,u,c,d,m,v,y,h=!1,g=t.singleVisual,f=(o.suppressData||(u=null==(u=null==(u=o.defaultPresentationState)?void 0:u[r.name])?void 0:u[i.name],c=p=!1,this.presentationChangesAllowed(e,o,i,g,this.visualPluginOps)&&(p=(e=this.applyPresentationChanges(i,g,u,g&&g.parameters,a)).changesApplied,c=e.parametersRemoved),u=!1,this.featureSwitchService.featureSwitches.fieldParameters&&(u=this.applyParameterStateByRole(a,i,g,c)),e=g&&g.orderBy,c=this.applySort(i.config.singleVisual,e,o.clearUnmatchedData),e=g&&g.activeProjections,e=this.applyActiveProjections(i.config.singleVisual,e,o.clearUnmatchedData),d=this.collectValidDrillExprs(i.config.singleVisual),d=this.applyFilters(t.filters,i,0,n,o.clearUnmatchedData,d,r,a,this.nonDrillthroughIsLinkedAsAggregationCallback),m=g&&g.expansionStates,m=this.applyExpansionStates(i,m,o.clearUnmatchedData,a,n),y=this.plugins.capabilities(i.config.singleVisual.visualType),f=g&&g.objects,v=!1,h=(v=y&&y.objects?this.applyObjects(g,i.config.singleVisual,f,y.objects,a,n):v)||p||c||e||d||m||u),[]);return this.getSuppressDisplayOptions(o).visuals||(null!=(y=t.visibility)&&s&&(n.visibility={visual:i,mode:y}),l&&!g)||(a=!1,g?a=!!g.hidden:o.suppressUnmatchedClearHidden&&(a=V.isHidden(i.config.singleVisual)),f.push.apply(f,this.applyHidden(a,i,r)||[])),h&&!_.includes(f,i)&&f.push(i),f},I.prototype.applyPresentationChanges=function(e,t,r,i,a){var n,o,s,l,p=e.config.singleVisual;return!t||(n=!t.targetType)&&!p.presentationChangesApplied?{changesApplied:!1,parametersRemoved:!1}:(o=!1,s=n?null==r?void 0:r.visualType:t.targetType,l=n?null==r?void 0:r.autoSelectVisualType:t.targetAutoSelectVisualType,r=n?null==r?void 0:r.projections:t.projections,s&&(o=s!==p.visualType,p.visualType=s),null!=l&&(o=o||l!==p.autoSelectVisualType,p.autoSelectVisualType=l),!p.query&&r&&(p.query=new P(E.create(),{},[])),t=p.query,r&&t?(this.applyVisualQueryPresentationChanges(t,r,i,e,a),p.presentationChangesApplied=!n,{changesApplied:!0,parametersRemoved:!0}):{changesApplied:p.presentationChangesApplied=o,parametersRemoved:!1})},I.prototype.applyParameterStateByRole=function(e,t,o,s){if(!o||!o.parameters)return!1;var r=t.config.singleVisual;if(!r.query&&s)r.query=new P(E.create(),{},[]);else if(!r.query)return!1;var l,i=o.parameters,p=r.query,u={},c=p.getResolveParameterResultsByRole();for(l in i){var d=i[l],m=(u[l]=[],p.projections[l]);if(m=!m&&s&&0<d.length?p.projections[l]=new n([]):m)for(var v=this,a=0;a<d.length;a++)!(function(e){var t=d[e];if(s){var r=p.addParameter(t.expr,l,t.index),i=m.getParameterByFieldIndex(r);(c[l]||(c[l]=[])).push({parameter:i,result:[]})}else{var r=_.find(u[l],(function(e){return N.equals(e.expr,t.expr)})),a=r?r.count:0,n=_.sortBy(m.findParameterBySQExpr(t.expr),(function(e){return e.index}));if(a>=n.length)return;i=n[a],r?r.count++:u[l].push({expr:t.expr,count:1})}n=c[l],a=_.find(n,(function(e){return e.parameter.index===i.index})),r=v.getProjectionsForParameter(d,e,o.projections,l);a.result=_.map(r,(function(e){return{expr:e,alias:void 0}}))})(a)}return this.visualAuthoringCore.resolveParameters(e,t,c,this.drillService,this.sortService,void 0).queryChange},I.prototype.getProjectionsForParameter=function(e,t,r,i){var a=[],n=e[t];if(void 0!==n.length&&0<n.length)for(var o=S.convertFieldIndexToProjectionIndexUsingParameters(n.index,e),s=o;s<o+n.length;s++)a.push(r[i][s]);return a},I.prototype.applyVisualQueryPresentationChanges=function(e,t,r,i,a){for(var n in e.projections)this.visualAuthoringCore.removeAllParametersAndProjectionsFromRole(n,i,a,this.drillService,this.sortService);for(var n in t){for(var o=this.getNonParameterExpressions(t[n],r,n),s=void 0,s=0;s<o.length;s++){var l=o[s],p=!1;if(e.projections[n])for(var u=e.tryGetExprs(n),c=s;c<u.length;c++){var d=u[c];if(y.SQExpr.equals(d,l,!0,!0,!0)){p=!0,c!==s&&e.moveProjection(n,c,s,1);break}}p||e.add(l,n,{fieldIndex:s})}if(e.projections[n])for(var m=e.tryGetExprs(n).length;m>o.length&&0<m;)e.removeProjection(n,{fieldIndex:--m})}for(var n in e.projections)if(null==(o=this.getNonParameterExpressions(t[n],r,n))||!o.length)for(var m=e.tryGetExprs(n).length,v=0;v<m;v++)e.removeProjection(n,{fieldIndex:0})},I.prototype.getNonParameterExpressions=function(e,t,a){if(e){for(var n=[],r=0;r<e.length;r++)!(function(r){var i=t&&t[a];if(i&&0<i.length&&_.find(i,(function(e){var t=S.convertFieldIndexToProjectionIndexUsingParameters(e.index,i);return void 0!==e.length&&0<e.length&&t<=r&&r<=t+e.length-1})))return;null!==e[r]&&n.push(e[r])})(r);return n}},I.prototype.applyVisualGroupState=function(i,a,n,o,s,l){var e,t,r=n.name;if(s.targetVisualNames&&!_.includes(s.targetVisualNames,r)||(r=void 0,this.getSuppressDisplayOptions(s).visuals||(e=i.isHidden,t=n.isHidden,null!=e&&e!==t&&(n.isHidden=e,r=!0),e&&!_.isEmpty(l)&&(t=this.clearCrossHighlightsForGroup(n,a,l),o.visualContainers=_.chain(o.visualContainers).concat(t).uniq().value())),r&&o.visualContainerGroups.push(n)),!_.isEmpty(i.children)){var p,u=this;for(p in i.children)!(function(t){var e=i.children[t],r=_.find(n.children,(function(e){return e.name===t}));if(!e||!r||!C.isVisualContainerGroup(r))return;u.applyVisualGroupState(e,a,r,o,s,l)})(p)}},I.prototype.getSuppressDisplayOptions=function(e){e=e.suppressDisplay;return this.isDisplayOptions(e)?e:{outspacePane:e,visuals:e}},I.prototype.applyFilterExpressionCache=function(e,t,r){r?this.clearFilterExpressionCache(t):(t.filterExpressionMetadata=e.filterExpressionMetadata,t.cachedFilterDisplayItems=e.cachedFilterDisplayItems)},I.prototype.clearFilterExpressionCache=function(e){e.filterExpressionMetadata=void 0,e.cachedFilterDisplayItems=void 0},I.prototype.applyHidden=function(e,t,r){var i=t.config.singleVisual;if(e!==V.isHidden(i))return V.setHidden(i,e),i=[t],e?_.chain(i).concat(this.clearCrossHighlightsForVisual(t,r)).uniq().value():i},I.prototype.clearCrossHighlightsForGroup=function(e,t,r){var i,a=[];return C.traverseVisualContainerGroups([e],(function(t){C.isVisualContainer(t)&&_.some(r,(function(e){return e.sourceVisualContainer===t}))&&a.push(t)})),(i=_.isEmpty(a)?i:this.clearCrossHighlightsForVisuals(a,t))||[]},I.prototype.clearCrossHighlightsForVisual=function(e,t){return this.clearCrossHighlightsForVisuals([e],t)},I.prototype.clearCrossHighlightsForVisuals=function(e,t){var r=__spreadArray([],e||[],!0);return r.push.apply(r,this.filterGenerator.clearCrossHighlightForVisualContainersOperation(t,e)||[]),_.uniq(r)},I.prototype.collectValidDrillExprs=function(e){var t=e.query;if(!t)return[];var r=t.defn.select();if(_.isEmpty(r))return[];var i,a=[];for(i in t.projections)for(var n=t.projections[i],o=n.activeProjectionRefs||[],s=_.last(o),l=0,p=n.all();l<p.length;l++){var u=p[l];if(s&&u.queryRef===s)break;u=r.withName(u.queryRef);a.push(u.expr)}return a},I.prototype.applyActiveProjections=function(e,o,t){var s=e.query;if(!s)return!1;function r(i){if(_.includes(p,i)){var a=o[i];if(d[i]||(d[i]=[]),!(r=s.projections[i]))return c=!0;var n=r.all();if(_.isEmpty(n))return c=!0;if(a.length>n.length)return c=!0;if(1!==a.length||u)for(var e=0;e<a.length;e++)!(function(e){var t=a[e],e=n[e],r=l.withName(e.queryRef);if(!N.equals(r.expr,t))return c=!0;d[i].push(e.queryRef)})(e);else{var t=a[0],r=_.find(n,(function(e){e=l.withName(e.queryRef);return N.equals(e.expr,t)}));if(!r)return c=!0;d[i].push(r.queryRef)}}}var l=s.defn.select(),e=this.plugins.capabilities(e.visualType),e=e&&e.drilldown||{roles:[],suppresDrillOperations:!1},p=e.roles,u=e.suppresDrillOperations,c=!1,d={};for(i in o)r(i);if(c)for(var i in s.projections)d[i]=[];var a=!1;for(i in s.projections)if(_.includes(p,i)){var n=s.projections[i],m=d[i];if(_.isEmpty(m)){if(!t)continue;var v=n.all();_.isEmpty(v)||(m=[_.head(v).queryRef])}h.sequenceEqual(n.activeProjectionRefs,m,(function(e,t){return e===t}))||(n.activeProjectionRefs=m,a=!0)}return a},I.prototype.applySort=function(e,t,r){var i,e=e.query;return!(!e||(i=e.defn.orderBy()||[],!t&&!r)||h.sequenceEqual(i,t=t||[],y.SQUtils.sqSortDefinitionEquals)||(e.orderBy(t),0))},I.prototype.applyObjects=function(e,t,r,i,a,n){var o={},r=(r&&(r.merge&&(o.merge=g.clone(r.merge)),r.remove)&&(o.remove=r.remove.slice()),t.objects||{}),s=c.findFilterOutput(i),l=this.plugins.getPlugin(t.visualType),l=(this.applyPluginUpdateSemantics(l,o,r,i),o.remove||(o.remove=this.getVisualPropertiesToRemove(t.visualType,r,o.merge)),this.mergeObjects(e,t,o.merge,r,n,a,s)),i=l.visualImpacted;return o.remove=o.remove.concat(l.removeList),this.removeObjects(t,r,o.remove,n,s)||i},I.prototype.updateQueryProjectionsFromExpansionState=function(p,e,u){var c=this;if(_.isEmpty(e))return!1;for(var t=function(s){function l(e){return e=s.roles[e],p.projections[e],"Invalid role ".concat(e),p.projections[e]&&p.projections[e].all()}function e(t){for(var i=0,a=l(0),n=0,o=0;o<_.size(s.levels)&&"break"!==(function(){if(n===_.size(a)){if(n=0,++i>=_.size(s.roles))return"break";if(!(a=l(i)))return"break"}var r=s.levels[o],e=_.findIndex(a,(function(e){var t=null==(t=S.tryGetExprByProjection(p.defn,e))?void 0:t.expr;return e.queryRef===_.first(r.queryRefs)&&c.verifyExpansionIdentities(r,t,u)}),t?n:0);if(-1===e)return"break";t&&n!==e&&p.moveProjection(s.roles[i],e,n,1)})();o++,n++);return o}var t=s.getVisibleDescendentsDepth(s.root,-1),r=Math.max(_.findLastIndex(s.levels,(function(e){return e.isPinned}))+1,t);if(!(r<=e(!1)))return{value:!1};_.remove(p.expansionStates,(function(e){return _.isEqual(e.roles,s.roles)})),e(!0);var r=s.clone(),i=(p.setActiveProjections(r.roles,t),p.getRolesUniqueProjectionRefs(r.roles)),a=_.findIndex(r.levels,(function(e){return e.isCollapsed}));r.updateLevels(i,-1===a?t:a),p.expansionStates||(p.expansionStates=[]),p.expansionStates.push(r)},r=0,i=e;r<i.length;r++){var a=t(i[r]);if("object"==typeof a)return a.value}return!0},I.prototype.applyExpansionStates=function(r,e,t,a,n){var i,o=this,s=r.config.singleVisual,l=s.query;return!(!l||(i=l.expansionStates||[],!e&&!t)||y.ExpansionState.areEqual(i,e=e||[]))&&((t=this.plugins.capabilities(s.visualType))&&t.expandCollapse&&t.expandCollapse.restoreProjectionsOrderFromBookmark?this.updateQueryProjectionsFromExpansionState(l,e,a):(l.expansionStates=y.ExpansionState.clone(_.filter(e,(function(e){1!==e.roles.length&&n.issues.push({type:256});var t=l.projections[e.roles[0]],i=t&&t.all()||[];return!(!o.expandCollapse.isEnabled(r,e.roles)||1!==e.roles.length||i.length<e.levels.length)&&_.every(e.levels,(function(e,t){var t=i[t],r=null==(r=S.tryGetExprByProjection(l.defn,t))?void 0:r.expr;return t.queryRef===e.queryRefs[0]&&o.verifyExpansionIdentities(e,r,a)}))}))),!0))},I.prototype.verifyExpansionIdentities=function(e,t,r){var i=new a;return _.isEmpty(e.identityKeys)||h.sequenceEqual(e.identityKeys,t.accept(i,r),N.equals)},I.prototype.applyPluginUpdateSemantics=function(e,t,r,i){if(t&&e&&e.mergeObjects){var a=d.visuals.visualStyles.create(),r=v.evaluateMetadataOnceDataViewObjectDefinitions(r,i,a,this.featureSwitchService.featureSwitches).dataViewObjects,i=v.evaluateMetadataOnceDataViewObjectDefinitions(t.merge||{},i,a,this.featureSwitchService.featureSwitches).dataViewObjects,a=e.mergeObjects({objects:r,changes:i});if(a){if(a.merge){t.merge={};for(var n=0,o=a.merge;n<o.length;n++)for(p in(l=o[n]).properties){var s=e.capabilities.objects[l.objectName].properties[p].type,s=g.encodePropertyValue(l.properties[p],s);g.setValue(t.merge,{objectName:l.objectName,propertyName:p},l.selector,s)}}if(a.remove){t.remove=[];for(var l,p,u=0,c=a.remove;u<c.length;u++)for(p in(l=c[u]).properties)t.remove.push({object:l.objectName,property:p,selector:l.selector})}}}},I.prototype.mergeObjects=function(e,t,r,i,a,n,o){var s={visualImpacted:!1,removeList:[]};if(!_.isEmpty(r))for(var l in r)for(var p=0,u=r[l];p<u.length;p++){var c,d=u[p],m=g.ensure(i,l,d.selector);for(c in d.properties){var v=d.properties[c];if(!g.propertiesAreEqual(m.properties[c],v)){if(o&&f.propertyIdentifiersEqual(o,{objectName:l,propertyName:c})){var y=!!this.isFilterValid(v,t,n);if(this.applyFilterExpressionCache(e,t,!y),!y){a.issues.push({type:128}),s.removeList.push({object:o.objectName,property:o.propertyName,selector:null});continue}this.setMinimumFilterScope(a,1)}m.properties[c]=v,s.visualImpacted=!0,t.objects||(t.objects=i)}}}return s},I.prototype.removeObjects=function(e,t,r,i,a){if(_.isEmpty(r))return!1;for(var n=!1,o=0,s=r;o<s.length;o++){var l=s[o],p=l.selector,u=l.object,l=l.property;g.deleteProperty(t,u,p,l)&&(n=!0,a)&&f.propertyIdentifiersEqual(a,{objectName:u,propertyName:l})&&(this.clearFilterExpressionCache(e),this.setMinimumFilterScope(i,1))}return n},I.prototype.getVisualPropertiesToRemove=function(e,t,r){var i=this.plugins.capabilities(e);if(!i||!i.objects)return[];var a,n=c.findFilterOutput(i.objects),o=[];for(a in i.objects){var s,l=i.objects[a];for(s in l.properties){var p,u=l.properties[s];u.persistUnmatchedState||(u.filterState||u.captureState||n&&f.propertyIdentifiersEqual(n,{objectName:a,propertyName:s}))&&(p=g.getValue(r,u={objectName:a,propertyName:s},null),g.getValue(t,u,null))&&!p&&o.push({object:a,property:s,selector:null})}}return o},I.prototype.isFilterValid=function(e,t,r){var t=t.query;return!!t&&(t=new o(t.defn,r),e.rewrite(t),t.valid)},I.prototype.isSelectionValid=function(e,t,r){var i,a;return!!(e=y.Selector.filterFromSelectorsByColumn(e))&&(i=new y.SemanticQueryRewriter(y.SQExprRemoveEntityVariablesRewriter.instance).rewriteFrom(e.from()),a=_.map(e.where(),(function(e){return{condition:e.condition.accept(y.SQExprRemoveEntityVariablesRewriter.instance)}})),e=new b(i,a),this.isFilterValid(e,t,r))},I.prototype.setMinimumFilterScope=function(e,t){e.filterScope?e.filterScope=Math.max(t,e.filterScope):e.filterScope=t},I.prototype.getAdditionalVisualFiltersToCapture=function(e,t){for(var r=[],i=0,a=w.getAutoVisualFilterContainers(e,this.visualPluginOps,t,this.aggrOps)||[];i<a.length;i++)!(function(t){_.find(e.filters,(function(e){return N.equals(e.expression,t.expression)}))||r.push(t)})(a[i]);return r},I.prototype.presentationChangesAllowed=function(e,t,r,i,a){var n;return!(!e.settings||!e.settings.allowInlineExploration||!t.applyPresentationChanges||!(e=r&&r.config&&r.config.singleVisual)||(n=i&&i.visualType,![function(e){return a.isQnaVisual(e)},function(e){return a.isQueryVisual(e)}].some((function(e){return e(n)})))||(t=e&&e.vcObjects,(r=g.getValue(t,{objectName:"visualHeader",propertyName:"showPersonalizeVisualButton"},null))&&!1===r.value))},T=I,i=y.SQExprRewriter,__extends(O,i),O.prototype.visitColumnRef=function(e){return this.valid=this.valid&&this.exprInSelects(e),e},O.prototype.exprInSelects=function(t){var e=_.some(this.query.select(),(function(e){return N.equals(e.expr,t,!0,!0)}));if(e)return!0;if(!this.schema)return e;for(var r=0,i=this.query.select();r<i.length;r++){var a=i[r].expr.getKeyColumns(this.schema);if(_.some(a,(function(e){return N.equals(t,e,!0,!0)})))return!0}return!1},o=O})(powerbi=powerbi||{}),(function(a){var n,e,o,s,l,p,u;function c(e,t){var r=a.data.SQExprUtils.getDefaultValue(e,t);if(r)return e=n.FilterUtils.getFormatter(e,t),a.data.RestatementHelper.fromDefault(e.format(r.value))}function d(e){return e.constant?e.constant.value:e.dateSpan?e.dateSpan.value:void 0}n=a.explore||(a.explore={}),e=(e=n.services||(n.services={})).filterRestatementUtil||(e.filterRestatementUtil={}),o=a.data.isFilterComparisonPattern,s=a.data.RelativeDateRangeHelper,l=a.data.SQExprBuilder,p=a.data.RelativeFilterType,u=a.data.RelativeDateFilterPattern,e.visitBetweenHelper=function(e){e.lower,e.upper;var t=e.lower.value,e=e.upper.value;return s.getDateRangeRestatement({min:t,max:e})},e.visitRelativeDateRangeHelper=function(e,t,r,i){return s.getRestatement(e.options,i,t,r)},e.visitComparisonFilterPatternHelper=function(e,t,r){var i=l.fieldExpr(e.arg);return e.condition.defaultValue?c(i,t):e.condition.anyValue?void 0:(i=n.FilterUtils.getFormatter(i,t),t=r||d(e.condition),a.data.RestatementHelper.fromCondition([new a.data.Condition(e.filterOperator,t,i)],2))},e.getDefaultValueRestatement=c,e.getAdvancedFilterPatternRestatement=function(e,t,r){return t=(function e(t,r){{var i;return o(t)?(i=l.fieldExpr(t.arg),i=n.FilterUtils.getFormatter(i,r),[new a.data.Condition(t.filterOperator,d(t.condition),i)]):__spreadArray(__spreadArray([],e(t.left,r)||[],!0),e(t.right,r)||[],!0)}})(e,t),a.data.RestatementHelper.fromCondition(t,e.logicalOperator,void 0,r)},e.updateRelativeTimeRestatementOnToggle=function(e,t,r,i,a,n){t.get(e).then((function(){var e,t=i.contract,t=u.extractParametersFromSemanticFilter(t.filter,p.Time),t=t&&t.options;t&&(e=n&&i.isFilterExpanded(),t=s.getRestatement(t,e,(function(e,t){return r.format(e,t)}),a),i.setRestatement(t))}))}})(powerbi=powerbi||{}),(function(a){var e,t,n,o,s,l;function r(e,t,r,i,a,n){this.schema=e,this.locOptions=t,this.visualTimeSynchronizationService=r,this.networkAvailabilityService=i,this.displayNameServiceVisitor=a,this.displayOptions=n}e=a.explore||(a.explore={}),t=e.services||(e.services={}),n=a.explore.util.DisplayNameServiceUtils,o=a.data.FieldExprPattern,s=a.data.SQExprBuilder,l=jsCommon.StringExtensions,r.prototype.visitIn=function(e){var r=this,i=e.args,t=e.values,t=_.map(t,(function(e){return _.map(e,(function(e,t){t=s.fieldExpr(i[t]),t=t&&t.getMetadata(r.schema);return a.visuals.valueFormatter.format(e.value,t&&t.format)})).join(" ")})),t=n.concatStrings(t,"Generic_Or",this.locOptions);return this.displayOptions&&this.displayOptions.includeFieldNamesInFilter?(e=e.args,e=_.map(e,(function(e){return o.visit(e,r.displayNameServiceVisitor)})).join(" "),l.format(this.locOptions.stringResourceProvider.get("VisualTitle_Is_Template"),e,t)):t},r.prototype.visitBetween=function(e){return t.filterRestatementUtil.visitBetweenHelper(e)},r.prototype.visitRelativeDateRange=function(e){var r=this;return t.filterRestatementUtil.visitRelativeDateRangeHelper(e,(function(e,t){return r.locOptions.stringResourceProvider.format(e,t)}),this.visualTimeSynchronizationService.getAnchorTime(),this.networkAvailabilityService.isNetworkAvailable())},r.prototype.visitTopN=function(e){},r.prototype.visitCompare=function(e){return t.filterRestatementUtil.visitComparisonFilterPatternHelper(e,this.schema)},r.prototype.visitAdvanced=function(e){return t.filterRestatementUtil.getAdvancedFilterPatternRestatement(e,this.schema)},r.prototype.visitComplex=function(e){},r.prototype.visitComposite=function(e){},r.prototype.visitHierarchical=function(e){},t.FilterRestatementVisitor=r})(powerbi=powerbi||{}),(function(a){var t,s,n,o;function e(e,t,r,i){var a=this;this.telemetryService=e,this.eventBridge=t,this.selectionService=r,this.explorationNavigation=i,this.selectionService=r,t.createChannelSubscriptionManager().subscribe(s.events.selectionChanged,(function(){return a.updatePopOutMode()}))}t=a.explore||(a.explore={}),s=t.services||(t.services={}),n=t.util.VisualContainerUtils,s.createVisibilityService=function(e,t,r,i){return new o(e,t,r,i)},e.prototype.get=function(e){var t=this.explorationNavigation.getCurrentSection(),t=t&&t.poppedOutElement;return t&&(e=e||27)&t.visibility?t.visualContainer:void 0},e.prototype.set=function(t,e,r){var i,a,n,o;void 0===r&&(r=!0),0===e?this.clearInternal(!0,r):(s.selectionUtils.selectCanvasItem(t,this.selectionService),i={visualContainer:t,visibility:e},a=this.explorationNavigation.getAllSections(),(a=_.find(a,(function(e){return 0<=e.visualContainers.indexOf(t)})))&&(o=a&&a.poppedOutElement,(n=(n=i)||null)===(o=(o=o)||null)||!n==!o&&n.visualContainer===o.visualContainer&&n.visibility===o.visibility||(this.clearInternal(!1,!1),this.setMode(i,e,r),a.poppedOutElement=i,this.poppableItem=i,this.raiseEvent(this.generateVisibilityChangedEventArgs(e)))))},e.prototype.clear=function(){this.clearInternal()},e.prototype.clearForVisualContainers=function(e){var t=this.explorationNavigation.getCurrentSection(),r=t&&t.poppedOutElement;if(r)for(var i=0,a=e;i<a.length;i++){var n=a[i];if(r.visualContainer===n){this.clearInternal();break}}},e.prototype.clearInternal=function(e,t){void 0===e&&(e=!0),void 0===t&&(t=!0);var r,i=this.explorationNavigation.getCurrentSection(),a=i&&i.poppedOutElement;a&&(r=this.poppableItem.visibility,this.setMode(a,0,t),i.poppedOutElement=void 0,e&&this.raiseEvent(this.poppableItem&&this.poppableItem.visualContainer===a.visualContainer?this.generateVisibilityChangedEventArgs(r):void 0),this.poppableItem=void 0)},e.prototype.isSeeDataMode=function(e){return e&&(2===e||8===e||16===e)},e.prototype.updatePopOutMode=function(){var e=s.selectionUtils.getDefaultSelectedVisualInSingleOrMultiCase(this.selectionService);e&&t.contracts.isVisualContainer(e)&&null!=e.visibility&&0!==e.visibility?this.set(e,e.visibility,!1):this.clearInternal(!0,!1)},e.prototype.raiseEvent=function(e){this.eventBridge.publishToChannel(s.events.visibilityChanged,e)},e.prototype.setMode=function(e,t,r){var i=e.visualContainer;r&&(r=(function(e){switch(e){case 1:return"Maximized";case 2:return"MaximizedWithData";case 8:return"MaximizedWithAccessibleData";case 4:return"Spotlight";case 16:return"VisualCalcEditing";default:return"Normal"}})(t),this.telemetryService.logEvent(a.telemetry.EXToggleVisualDisplay,{visualType:n.getVisualType(i),displayType:r,visualName:e.visualContainer.name})),i.visibility=t},e.prototype.generateVisibilityChangedEventArgs=function(e){return{preserveScroll:4===e}},o=e})(powerbi=powerbi||{}),(function(e){var t,r,i;function a(e){this.visualPlugins=e,this.visualPlugins}t=(t=e.explore||(e.explore={})).services||(t.services={}),r=e.data.DataViewObjectDescriptors,t.createVisualCapabilitiesService=function(e){return new i(e)},a.prototype.hasFilterCapabilities=function(e){e=this.visualPlugins.getPlugin(e);return!!(e&&e.capabilities&&e.capabilities.objects&&r.findFilterOutput(e.capabilities.objects))},i=a})(powerbi=powerbi||{}),(function(e){var t;function r(){this.visualIds={}}(e=(e=e.explore||(e.explore={})).services||(e.services={})).createVisualLifecycleService=function(){return new t},r.prototype.add=function(e){this.visualIds[e]=1},r.prototype.delete=function(e){delete this.visualIds[e]},r.prototype.has=function(e,t){void 0===t&&(t=!0);var r=1===this.visualIds[e];return r&&t&&this.delete(e),r},t=r,e.VisualLifecycleService=t})(powerbi=powerbi||{}),(function(n){var e,t,r,o,i;function a(e,t){this.plugins=e,this.featureSwitchService=t}e=n.explore||(n.explore={}),t=e.services||(e.services={}),r=n.data.DataViewObjectDescriptors,o=e.util.VisualContainerUtils,t.createVisualPluginOps=function(e,t){return new i(e,t)},a.prototype.canEdit=function(e,t){e=this.plugins.capabilities(e);switch(e&&e.advancedEditModeSupport){case 1:return!0;case 2:return t;default:return!1}},a.prototype.dataViewKinds=function(e,t){if(e){var r,i,a=this.plugins.capabilities(e);if(a)return a=a.dataViewMappings,i=n.DataViewMapping.targetDataViewKinds(a),t&&(r=o.createRoleKindByQueryRef(t),a=n.DataViewAnalysis.chooseDataViewMappings(t.projections,a,r,this.featureSwitchService.featureSwitches),i=n.DataViewMapping.targetDataViewKinds(a.supportedMappings),"map"===e)&&1&i&&n.visuals.MapPluginMethods.mightRequireMatrixForUnpivot(t.projections,a.supportedMappings)&&(i|=2),i||void 0}},a.prototype.targetedDataViewKinds=function(e,t){var r=31;return r=this.plugins.isCustomVisual(e)?r:this.dataViewKinds(e,t)||31},a.prototype.supportsFocusMode=function(e){e=this.plugins.capabilities(e);return e&&e.dataViewMappings&&!e.disableFocusMode},a.prototype.isSupportedVisual=function(e){e=o.getVisualType(e);return!!e&&!!this.plugins.getPlugin(e)},a.prototype.canConvertVisual=function(e){var t,r;return!!e&&!!(t=o.getVisualType(e))&&(r=this.plugins.capabilities(t),this.isQueryVisual(t)||!(!r||!r.isConvertible))&&!o.hasGroupByItemsInQuery(e)},a.prototype.canFormatVisual=function(e){return!!e&&!o.hasGroupByItemsInQuery(e)},a.prototype.canSummarizeVisual=function(e){e=this.plugins.getPlugin(e);return!!e&&(this.isAnalysisVisualPlugin(e)?!!e.getAnalysisVisualNarrativeSummaryConfiguration:!!e.getNarrativeSummaryBindings)},a.prototype.isAnalysisVisualPlugin=function(e){return this.isAnalysisVisual(e.name)},a.prototype.isQueryVisual=function(e){var t=this.plugins.capabilities(e);return!t||!this.isQueryDisabled(e,t)&&null!=t.dataViewMappings},a.prototype.isQueryDisabled=function(e,t){if(t&&n.ScriptResultUtil.findScriptResultMapping(t.dataViewMappings))return!this.plugins.isScriptVisualQueryable(e)},a.prototype.supportVisualSearch=function(e){var t=this.plugins.capabilities(e);return!(!t||!this.isQueryVisual(e)||!r.findSelfFilter(t.objects))},a.prototype.isAnalysisVisual=function(e){return e===n.visuals.plugins.keyDriversVisual.name},a.prototype.isQnaVisual=function(e){return e===n.visuals.plugins.qnaVisual.name},i=a})(powerbi=powerbi||{}),(function(e){var t,s,r,i,n,l,p,u,c,o,d,m,v,y,h,g;function a(e){var t;if(e)return t={},e.byName&&(t.nameIdentifiedMerges=_.mapValues(e.byName,f)),e.byExpr&&(t.exprIdentifiedMerges=_.map(e.byExpr,f)),e.byType&&(t.typeIdentifiedMerges=_.map(e.byType,f)),e.byTransientState&&(t.transientFilters=_.map(e.byTransientState,f)),t}function f(e){return{name:e.name,type:i.FilterType[e.type],filter:e.filter?v.deserializeFilter(e.filter):void 0,expression:e.expression?v.deserializeExpr(e.expression):void 0,restatement:e.restatement,howCreated:e.howCreated,precedence:e.precedence,isTransient:e.isTransient,cachedValueItems:p.deserializeFilterLabelIdPairs(e.cachedDisplayNames),filterExpressionMetadata:e.filterExpressionMetadata?m.deserializeFilterExpressionMetadata(e.filterExpressionMetadata):void 0}}function C(e){return{isHidden:e.isHidden,children:e.children&&_.mapValues(e.children,C)}}function x(e,t){var r,i,a,n,o;if(e)return r={visualType:e.visualType},null!=e.autoSelectVisualType&&(r.autoSelectVisualType=e.autoSelectVisualType),e.objects&&(r.objects=b(e.objects)),e.orderBy&&(r.orderBy=v.deserializeSortDefinitions(e.orderBy,null)),e.targetType&&(r.targetType=e.targetType),null!=e.targetAutoSelectVisualType&&(r.targetAutoSelectVisualType=e.targetAutoSelectVisualType),e.activeProjections&&(r.activeProjections=S(e.activeProjections)),_.isEmpty(e.parameters)||(r.parameters=(function(e){var t,r;for(r in e){var i=e[r];_.isEmpty(i)||((t=t||{})[r]=_.map(i,(function(e){return{expr:v.deserializeExpr(e.expr),index:e.index,length:e.length}})))}return t})(e.parameters)),e.projections&&(r.projections=S(e.projections)),e.display&&"hidden"===e.display.mode&&(r.hidden=!0),e.cachedFilterDisplayItems&&(r.cachedFilterDisplayItems=p.deserializeFilterLabelIdPairs(e.cachedFilterDisplayItems)),e.filterExpressionMetadata&&(r.filterExpressionMetadata=m.deserializeFilterExpressionMetadata(e.filterExpressionMetadata)),e.expansionStates&&(o=(n=t.capabilities(e.visualType))&&n.expandCollapse&&n.expandCollapse.supportsMerge,i=n&&n.expandCollapse&&n.expandCollapse.collapseParentAfterRemovingChildLevel,a=n&&n.noDefaultProjections,r.expansionStates=u.deserializeExpansionStates(e.expansionStates,{supportsMerge:o,canCollapseRoot:a,collapseParentAfterRemovingChildLevel:i})),e.mobileVcObjects&&(r.mobileVcObjects=l.deserializeObjects(e.mobileVcObjects,d.CommonObjectDescriptors)),e.mobileObjects&&(o=(n=t.capabilities(e.visualType))&&n.objects,r.mobileObjects=l.deserializeObjects(e.mobileObjects,o)),r}function S(e){var t,r;for(r in e){var i=e[r];_.isEmpty(i)||((t=t||{})[r]=_.map(i,(function(e){return null===e?null:v.deserializeExpr(e)})))}return t}function b(e){var t={};return e.merge&&(t.merge=l.deserializeObjects(e.merge,null)),e.remove&&(t.remove=_.map(e.remove,E)),t}function E(e){return{object:e.object,property:e.property,selector:l.deserializeSelector(e.selector)}}function N(e,t,r,i){return new g(r).serializeSingleVisual(e,t,i)}function V(e){this.featureSwitchService=e,this.version=c.v1_0}t=(t=(t=e.explore||(e.explore={})).services||(t.services={})).ExplorationState||(t.ExplorationState={}),s=e.explore.services.downgrade,r=e.explore,i=r.contracts,n=e.explore.services.upgrade.CurrentExplorationStateVersion,l=e.data.services.DataViewObjectSerializer,p=e.data.services.DisplayNameSerializer,u=e.data.services.ExpansionStateSerializer,c=r.services.upgrade.ExplorationStateVersions,o=r.services.upgrade.ExplorationStateFeatureVersions,d=r.contracts.VisualContainer,m=e.data.services.FilterExpressionMetadataSerializer,v=e.data.services.SemanticQuerySerializer,y=e.explore.services.upgrade,h=jsCommon.Version,t.clearUnusedReferences=function(e,t){for(var r,i,a={},n=0,o=t.sections;n<o.length;n++)for(var s,l=0,p=(s=o[n]).visualContainers;l<p.length;l++)a[p[l].name]=!0;for(r in e.sections)for(i in(s=e.sections[r]).visualContainers)a[i]||delete s.visualContainers[i]},t.cloneSingleVisual=function(e,t,r){return x(N(e,null,r,t),t)},t.deserialize=function(e,t,r,i){return null!=i&&i.runUpgraders&&(i=y.ExplorationStateVersionToExplorationVersion[e.version],e=y.createExplorationStateUpgrader(r).upgrade(e,i)),r={activeSection:e.activeSection,filters:a(e.filters),sections:_.mapValues(e.sections,(function(e){return r=t,{filters:a((e=e).filters),visualContainers:_.mapValues(e.visualContainers,(function(e){var t=r;return t=x(e.singleVisual,t),{filters:a(e.filters),singleVisual:t,visibility:e.singleVisual?(function(e){if(debug.assertAnyValue(e,"display"),e&&e.mode)switch(e.mode){case"maximize":switch(e.maximizedOptions&&e.maximizedOptions.dataTable){case"accessible":return 8;case"normal":return 2;default:return 1}case"spotlight":return 4}})(e.singleVisual.display):void 0,highlight:e.highlight?(function(e){return{selection:l.deserializeSelection(e.selection),filterExpressionMetadata:e.filterExpressionMetadata?m.deserializeFilterExpressionMetadata(e.filterExpressionMetadata):void 0}})(e.highlight):void 0}})),visualContainerGroups:e.visualContainerGroups&&_.mapValues(e.visualContainerGroups,C)};var r}))},e.objects&&(r.objects=b(e.objects)),e.dataSourceVariables&&(r.dataSourceVariables=e.dataSourceVariables),r},t.serialize=function(e,t,r,i,a){var n,o=new g(t),t={version:void 0,activeSection:e.activeSection,filters:o.serializeFilters(e.filters),sections:_.mapValues(e.sections,(function(e){return o.serializeSection(e,r)}))};return e.objects&&(t.objects=o.serializeObjects(e.objects),o.version=h.max(o.version,c.v1_3)),e.dataSourceVariables&&(t.dataSourceVariables=e.dataSourceVariables,o.version=h.max(o.version,c.v1_4)),null!=i&&i.runDowngraders&&o.version!==y.CurrentExplorationStateVersion&&(i=s.createExplorationStateDowngrader(a),n=y.ExplorationStateVersionToExplorationVersion[o.version],n=i.getFinalExplorationVersion(e,n),i.downgrade(t,n),t.version=_.findKey(y.ExplorationStateVersionToExplorationVersion,(function(e){return e===n}))),t.version=t.version||o.version,t},t.serializeFilterContainer=function(e,t){return new g(t).serializeFilterContainer(e)},t.serializeHighlightState=function(e,t){return new g(t).serializeHighlightState(e)},t.serializeSingleVisual=N,V.prototype.serializeFilters=function(e){var t,r=this;if(e)return t={},e.nameIdentifiedMerges&&(t.byName=_.mapValues(e.nameIdentifiedMerges,(function(e){return r.serializeFilterContainer(e)}))),e.exprIdentifiedMerges&&(t.byExpr=_.map(e.exprIdentifiedMerges,(function(e){return r.serializeFilterContainer(e)}))),e.typeIdentifiedMerges&&(t.byType=_.map(e.typeIdentifiedMerges,(function(e){return r.serializeFilterContainer(e)}))),e.transientFilters&&(t.byTransientState=_.map(e.transientFilters,(function(e){return r.serializeFilterContainer(e)}))),t},V.prototype.serializeFilterContainer=function(e){var t=e.filterExpressionMetadata?m.serializeFilterExpressionMetadata(e.filterExpressionMetadata,this.featureSwitchService&&this.featureSwitchService.featureSwitches.serializeSpaceOptimization):void 0;return{name:e.name,type:null!=e.type?i.FilterType[e.type]:void 0,filter:e.filter?v.serializeFilter(e.filter):void 0,expression:e.expression?v.serializeExpr(e.expression):void 0,restatement:e.restatement,howCreated:e.howCreated,isTransient:e.isTransient,cachedDisplayNames:p.serializeFilterLabelIdPairs(e.cachedValueItems),filterExpressionMetadata:t}},V.prototype.serializeSection=function(e,t){var r=this;return 1<_.chain(e.visualContainers).values().sumBy((function(e){return null==e.highlight?0:1})).value()&&(this.version=h.max(this.version,c.v1_2)),{filters:this.serializeFilters(e.filters),visualContainers:_.mapValues(e.visualContainers,(function(e){return r.serializeVisualContainer(e,t)})),visualContainerGroups:e.visualContainerGroups&&_.mapValues(e.visualContainerGroups,(function(e){return r.serializeVisualContainerGroup(e)}))}},V.prototype.serializeVisualContainer=function(e,t){return e.highlight&&(this.version=h.max(this.version,c.v1_1)),{filters:this.serializeFilters(e.filters),singleVisual:this.serializeSingleVisual(e.singleVisual,e.visibility,t),highlight:e.highlight?this.serializeHighlightState(e.highlight):void 0}},V.prototype.serializeVisualContainerGroup=function(e){var t=this;return{isHidden:e.isHidden,children:e.children&&_.mapValues(e.children,(function(e){return t.serializeVisualContainerGroup(e)}))}},V.prototype.serializeSingleVisual=function(e,t,r){var i;if(e)return i={visualType:e.visualType},null!=e.autoSelectVisualType&&(i.autoSelectVisualType=e.autoSelectVisualType,this.version=h.max(this.version,o.OnObject)),e.objects&&(i.objects=this.serializeObjects(e.objects)),e.orderBy&&(i.orderBy=v.serializeSortDefinitions(e.orderBy,!0)),e.activeProjections&&(i.activeProjections=this.serializeActiveProjections(e.activeProjections)),e.targetType&&(i.targetType=e.targetType,this.version=h.max(this.version,c.v1_6)),null!=e.targetAutoSelectVisualType&&(i.targetAutoSelectVisualType=e.targetAutoSelectVisualType,this.version=h.max(this.version,o.OnObject)),e.projections&&(i.projections=this.serializeActiveProjections(e.projections),this.version=h.max(this.version,c.v1_6)),_.isEmpty(e.parameters)||(i.parameters=this.serializeParameters(e.parameters),this.version=h.max(this.version,o.FieldParameters)),e.cachedFilterDisplayItems&&(i.cachedFilterDisplayItems=p.serializeFilterLabelIdPairs(e.cachedFilterDisplayItems)),e.filterExpressionMetadata&&(i.filterExpressionMetadata=m.serializeFilterExpressionMetadata(e.filterExpressionMetadata,this.featureSwitchService&&this.featureSwitchService.featureSwitches.serializeSpaceOptimization),this.version=h.max(this.version,c.v1_5)),e.mobileVcObjects&&(i.mobileVcObjects=this.serializeMobileObjects(e.mobileVcObjects,d.CommonObjectDescriptors,e.visualType)),e.mobileObjects&&r&&(r=(r=r.capabilities(e.visualType))&&r.objects,i.mobileObjects=this.serializeMobileObjects(e.mobileObjects,r,e.visualType)),_.isEmpty(e.expansionStates)||(i.expansionStates=u.serializeExpansionStates(e.expansionStates)),e.hidden?i.display={mode:"hidden"}:t&&(i.display=(function(e){switch(e){case 1:return{mode:"maximize"};case 2:return{mode:"maximize",maximizedOptions:{dataTable:"normal"}};case 8:return{mode:"maximize",maximizedOptions:{dataTable:"accessible"}};case 4:return{mode:"spotlight"}}})(t)),i},V.prototype.serializeMobileObjects=function(e,t,r){this.version=h.max(this.version,o.AllowMobileVisualFormatting);var i,a=l.serializeObjects(e,t,this.featureSwitchService.featureSwitches.serializeSpaceOptimization);return this.version!==n&&(i=y.ExplorationStateVersionToExplorationVersion[this.version],i=y.getVersionForObjectDefinitions(e,t,r,i,jsCommon.ArrayExtensions.createWithName()),this.version=h.max(this.version,_.findKey(y.ExplorationStateVersionToExplorationVersion,(function(e){return e===i}))),this.version),a},V.prototype.serializeActiveProjections=function(e){var t,r;for(r in e){var i=e[r];_.isEmpty(i)||((t=t||{})[r]=_.map(i,(function(e){return null===e?null:v.serializeExpr(e)})))}return t},V.prototype.serializeParameters=function(e){var t,r;for(r in e){var i=e[r];_.isEmpty(i)||((t=t||{})[r]=_.map(i,(function(e){return{expr:v.serializeExpr(e.expr),index:e.index,length:e.length}})))}return t},V.prototype.serializeObjects=function(e){var t=this,r={};return e.merge&&(r.merge=l.serializeObjects(e.merge,null,this.featureSwitchService&&this.featureSwitchService.featureSwitches.serializeSpaceOptimization)),e.remove&&(r.remove=_.map(e.remove,(function(e){return t.serializeObjectPropSelector(e)}))),r},V.prototype.serializeObjectPropSelector=function(e){return{object:e.object,property:e.property,selector:l.serializeSelector(e.selector)||null}},V.prototype.serializeHighlightState=function(e){return e.filterExpressionMetadata&&(this.version=h.max(this.version,c.v1_3)),{selection:l.serializeSelection(e.selection,this.featureSwitchService&&this.featureSwitchService.featureSwitches.serializeSpaceOptimization),filterExpressionMetadata:e.filterExpressionMetadata?m.serializeFilterExpressionMetadata(e.filterExpressionMetadata,this.featureSwitchService&&this.featureSwitchService.featureSwitches.serializeSpaceOptimization):void 0}},g=V})(powerbi=powerbi||{}),(function(e){var s;e=e.explore||(e.explore={}),(e=(s=e.services||(e.services={})).WebBookmark||(s.WebBookmark={})).deserialize=function(e,t,r,i){var a=[],n={objectId:e.objectId,name:e.objectId,type:e.type};e.creationTime&&(n.creationTime=new Date(Date.parse(e.creationTime))),e.expirationTime&&(n.expirationTime=new Date(Date.parse(e.expirationTime))),e.displayName&&(n.displayName=e.displayName),e.isDefault&&(n.isDefault=e.isDefault),null!=e.id&&(n.id=e.id);try{var o=void 0;!e.explorationState||(o=jsCommon.JsonExtensions.tryParseJSON(e.explorationState))||a.push({code:0}),o&&(n.explorationState=s.ExplorationState.deserialize(o,t,r,i))}catch(e){a.push({code:1,message:e.message,stack:e.stack})}return e={contract:n},_.isEmpty(a)||(e.errors=a),e},e.serialize=function(e,t,r,i,a){var n={objectId:e.objectId,type:e.type};return e.creationTime&&(n.creationTime=e.creationTime.toISOString()),e.expirationTime&&(n.expirationTime=e.expirationTime.toISOString()),e.displayName&&(n.displayName=e.displayName),e.isDefault&&(n.isDefault=e.isDefault),null!=e.id&&(n.id=e.id),e.explorationState&&(e=s.ExplorationState.serialize(e.explorationState,t,i,a,r),n.explorationState=JSON.stringify(e)),n}})(powerbi=powerbi||{}),(function(e){var t,c,r;function i(e){e=t.createExplorationDowngrader(e).downgraders;this.objectsDowngrader=t.createVisualObjectsDowngrader(e)}e=(e=e.explore||(e.explore={})).services||(e.services={}),t=e.downgrade||(e.downgrade={}),c=jsCommon.Version,t.createExplorationStateDowngrader=function(e){return new r(e)},i.prototype.getFinalExplorationVersion=function(e,t){var r=e&&e.sections;if(r){for(var i=0,a=Object.keys(r);i<a.length;i++)for(var n=r[a[i]],o=0,s=Object.keys(n.visualContainers);o<s.length;o++){var l,p=s[o],p=n.visualContainers[p],u=p.singleVisual;u&&(u=u.visualType,(l=null==(l=p.singleVisual)?void 0:l.mobileVcObjects)&&(t=c.max(t,this.objectsDowngrader.getFinalVisualObjectsVersion(2,l,t,u))),p=null==(l=p.singleVisual)?void 0:l.mobileObjects)&&(t=c.max(t,this.objectsDowngrader.getFinalVisualObjectsVersion(1,p,t,u)))}return t}},i.prototype.downgrade=function(e,t){var r=e&&e.sections;if(r)for(var i=0,a=Object.keys(r);i<a.length;i++)for(var n=r[a[i]],o=0,s=Object.keys(n.visualContainers);o<s.length;o++){var l,p,u=s[o],u=n.visualContainers[u].singleVisual;u&&(l=u.visualType,(p=u.mobileVcObjects)&&this.objectsDowngrader.downgrade(2,p,l,t),p=u.mobileObjects)&&this.objectsDowngrader.downgrade(1,p,l,t)}},r=i,t.ExplorationStateDowngrader=r})(powerbi=powerbi||{}),(function(e){var t,r;function i(e){this.objectsUpgrader=t.createVisualObjectsUpgrader(t.createExplorationUpgrader(e).getVersionUpgraders())}e=(e=e.explore||(e.explore={})).services||(e.services={}),(t=e.upgrade||(e.upgrade={})).createExplorationStateUpgrader=function(e){return new r(e)},i.prototype.upgrade=function(e,t){var r=e&&e.sections;if(r){for(var i=0,a=Object.keys(r);i<a.length;i++)for(var n=r[a[i]],o=0,s=Object.keys(n.visualContainers);o<s.length;o++){var l,p,u=s[o],u=n.visualContainers[u].singleVisual;u&&(l=u.visualType,(p=u.mobileVcObjects)&&this.objectsUpgrader.upgrade(2,p,l,t),p=u.mobileObjects)&&this.objectsUpgrader.upgrade(1,p,l,t)}return e}},r=i,t.ExplorationStateUpgrader=r})(powerbi=powerbi||{}),(function(e){var t,r,o,i,a;function n(){}t=(t=e.explore||(e.explore={})).services||(t.services={}),t=(r=t.upgrade||(t.upgrade={})).v3_12_1||(r.v3_12_1={}),o=e.data.DataViewObjectDefinitions,i=e.visuals.plugins,t.createVersionUpgrader=function(){return new a},n.prototype.upgrade=function(e){if(e&&e.sections)for(var t=0,r=e.sections;t<r.length;t++){var i=r[t];if(i.visualContainers)for(var a=0,n=i.visualContainers;a<n.length;a++){var o,s=n[a].config.singleVisual;s&&(o=s.visualType||s.visualConfig.visualType,s.objects=this.upgradeObjects(s.objects,o))}}},n.prototype.upgradeFilterCollection=function(e){},n.prototype.upgradeVisualObjects=function(e,t,r,i){},n.prototype.getVersion=function(){return r.ExplorationVersions.v3_12_1},n.prototype.upgradeObjects=function(e,t){return t===i.slicer.name?this.upgradeSlicerObjects(e):e},n.prototype.upgradeSlicerObjects=function(e){var t,r,i,a,n=o.getObjectDefinition(e=e||{},"general",null),n=n&&n.properties.filter,n=n&&n.filter;return n&&this.isAndFilter(n)&&(a=o.getObjectDefinition(e,"data",null))&&(t=a.properties.startDate,r=a.properties.endDate,i=a.properties.numericStart,a=a.properties.numericEnd,(t&&!r||i&&!a)&&this.BetweenToBeforeOrAfterFilter(n,1),r&&!t||a&&!i)&&this.BetweenToBeforeOrAfterFilter(n,0),e},n.prototype.isAndFilter=function(e){if(1===e.Where.length){e=e.Where[0].Condition;if(e&&e.And)return!0}return!1},n.prototype.BetweenToBeforeOrAfterFilter=function(e,t){var r=e.Where[0].Condition;return e.Where[0].Condition=0===t?r.And.Right:r.And.Left,e},a=n,t.VersionUpgrader=a})(powerbi=powerbi||{}),(function(c){var e,t,a,d,u,n,o,r;function i(e){this.featureSwitchService=e}function m(e,t,r){var i=h(r),t=t&&!_.isEmpty(t[i]);return"scatterChart"===r&&t&&null==a.getObjectDefinitionProperties(e,"fillPoint")&&((e=e||{}).fillPoint=[{properties:{show:{expr:n.serializeExpr(o.boolean(!0))}}}]),e}function h(e){switch(e){case"filledMap":return"Size";case"barChart":case"clusteredBarChart":case"clusteredColumnChart":case"columnChart":case"funnel":case"hundredPercentStackedBarChart":case"hundredPercentStackedColumnChart":case"map":case"treemap":case"scatterChart":return"Gradient"}}function g(e){switch(e){case"filledMap":case"barChart":case"clusteredBarChart":case"clusteredColumnChart":case"columnChart":case"funnel":case"hundredPercentStackedBarChart":case"hundredPercentStackedColumnChart":case"map":case"treemap":case"scatterChart":return"Tooltips"}}function f(e,t){return"filledMap"===e&&t&&!_.isEmpty(t.Series)&&!_.isEmpty(t.Size)}function v(e,t,r,i){var a,n=h(r);if(n){var o=t&&t[n];if(!_.isEmpty(o)){var s=o[0].queryRef;if(s){var l=_.cloneDeep(_.find(i&&i.Select,(function(e){return e.Name===s})));if(l){delete l.Name;var p=l.Aggregation||l.Measure;if(p){var u=p.Expression.Column&&p.Expression.Column.Expression.SourceRef||p.Expression.SourceRef;if(u){p=_.find(i.From,(function(e){return e.Name===u.Source}));if(p){u.Entity=p.Entity,delete u.Source;var c=e&&e.dataPoint;if(!_.isEmpty(c))for(var d=0,m=c;d<m.length;d++){var v,y=m[d];if(null==y.selector&&y.properties.fillRule){f(r,t)||(v=_.cloneDeep(y.properties.fillRule),c.push({selector:{data:[{dataViewWildcard:{matchingOption:1}}]},properties:((a={}).fill={solid:{color:{expr:{FillRule:{FillRule:(function(e){e.linearGradient2&&C(e.linearGradient2);e.linearGradient3&&C(e.linearGradient3);return e})(v),Input:l}}}}},a)})),c.splice(c.indexOf(y),1),delete t[n],!(function(t,e){for(var r in e){r=e[r];if(_.some(r,(function(e){return e.queryRef===t})))return 1}return})(s,t)&&(t[v=g(r)]||(t[v]=[]),(a=t[v]).push.apply(a,o||[]));break}}}}}}}}}}function s(e){e.color&&(e.color=e.color.expr);var t=e,t=(t.value&&(t.value=t.value.expr),e);t.strategy&&(t.strategy=t.strategy.expr)}function C(e){s(e.min),s(e.max),e.mid&&s(e.mid),e.nullColoringStrategy&&s(e.nullColoringStrategy)}e=(e=c.explore||(c.explore={})).services||(e.services={}),e=(t=e.upgrade||(e.upgrade={})).v3_20||(t.v3_20={}),a=c.data.services.wireContracts.DataViewObjectDefinitions,d=c.data.DataViewWildcard,u=jsCommon.JsonExtensions,n=c.data.services.SemanticQuerySerializer,o=c.data.SQExprBuilder,e.createVersionUpgrader=function(e){return new r(e)},i.prototype.upgrade=function(e){if(e)for(var t=0,r=e.sections;t<r.length;t++)for(var i=0,a=r[t].visualContainers;i<a.length;i++){var n,o,s,l=a[i],p=l.config.singleVisual;p&&(n=p.visualType,o=p.projections,this.featureSwitchService.featureSwitches.cartesianConditionalFormatting&&(p.objects=m(p.objects,o,n),v(p.objects,o,n,p.prototypeQuery)),s=u.tryParseJSON(l.dataTransforms))&&(this.featureSwitchService.featureSwitches.cartesianConditionalFormatting&&(s.objects=m(s.objects,o,n),v(s.objects,o,n,p.prototypeQuery)),l.dataTransforms=JSON.stringify(s))}},i.prototype.upgradeFilterCollection=function(){},i.prototype.upgradeVisualObjects=function(e,t,r,i){},i.prototype.getVersion=function(){return t.ExplorationFeatureVersions.CartesianConditionalFormatting},r=i,e.VersionUpgrader=r,e.getFillRuleInputRoleFromVisualType=h,e.upgradeGradientOnObjectDef=function(e,t,r){var i=h(r);if(i){var a=null==t?void 0:t.getQueryRef(i,{fieldIndex:0});if(a){t.defn;var n=t.defn.select().withName(a),o=e&&e.dataPoint;if(!_.isEmpty(o))for(var s=0,l=o;s<l.length;s++){var p=l[s],u=p.properties.fillRule;if(null==p.selector&&u){f(r,t.projections)||o.push({selector:{data:[d.create(1)]},properties:{fill:{solid:{color:c.data.SQExprBuilder.fillRule(n.expr,u)}}}}),o.splice(o.indexOf(p),1),1===t.getUsageCount(a)&&(u=t.tryGetExpr(i,0),p=g(r),t.add(u,p)),t.removeProjection(i,{fieldIndex:0});break}}}}},e.upgradeGradientOnWireContractObjectDef=v})(powerbi=powerbi||{}),(function(e){var t,l,p,r;function i(){this.podNamePrefix="Pod"}e=(e=e.explore||(e.explore={})).services||(e.services={}),e=(t=e.upgrade||(e.upgrade={})).v3_24||(t.v3_24={}),l=jsCommon.JsonExtensions,p=jsCommon.StringExtensions,e.createVersionUpgrader=function(){return new r},i.prototype.upgrade=function(e){if(e&&!_.isEmpty(e.sections)){for(var t=0,r=e.sections;t<r.length;t++){var i=r[t];this.upgradeSectionAcceptsAllFiltersWhenLinked(i)}for(var a=e.pods||[],n={},o=0,s=a;o<s.length;o++)n[s[o].name]=!0;for(var l=0,p=e.sections;l<p.length;l++){i=p[l];this.upgradeSection(i,a,n)}_.isEmpty(a)||(e.pods=a)}},i.prototype.upgradeFilterCollection=function(){},i.prototype.upgradeVisualObjects=function(e,t,r,i){},i.prototype.getVersion=function(){return t.ExplorationVersions.v3_24},i.prototype.upgradeSectionAcceptsAllFiltersWhenLinked=function(e){e.config||(e.config={}),null==e.config.acceptsAllFiltersWhenLinked&&(1===e.config.type?e.config.acceptsAllFiltersWhenLinked=!0:0===e.config.type||null==e.config.type?e.config.acceptsAllFiltersWhenLinked=!1:e.config.type)},i.prototype.upgradeSection=function(e,t,r){var i,a,n;e&&e.name&&(i=l.tryParseJSON(e.filters)||[],a=_.some(i,(function(e){return 5===e.howCreated})),(n=this.findPodForSectionName(t,e.name))?this.upgradeExistingPod(n,e.config,a):a&&(n=this.createPod(t,e.name,e.config,r)),e.config&&(e.config.acceptsAllFiltersWhenLinked=void 0),n)&&(this.upgradeFilters(n,i),e.filters=JSON.stringify(i))},i.prototype.upgradeFilters=function(e,t){var r=[];p.isNullOrUndefinedOrWhiteSpaceString(e.parameters)||(r=l.tryParseJSON(e.parameters));for(var i=0,a=t;i<a.length;i++){var n,o,s=a[i];s.name&&!s.isTransient&&(n=5===s.howCreated,(o=this.findParamForFilterName(r,s.name))?(o.fieldExpr=s.expression,o.asAggregation=s.isLinkedAsAggregation,n||(o.isLegacySingleSelection=!0)):n&&(o={name:"Param_"+s.name,boundFilter:s.name,fieldExpr:s.expression,asAggregation:s.isLinkedAsAggregation},r.push(o)),s.isLinkedAsAggregation=void 0)}e.parameters=JSON.stringify(r)},i.prototype.upgradeExistingPod=function(e,t,r){e.config=this.createPodConfig(t),e.referenceScope=0,e.type=r?this.determineType(t):0},i.prototype.findParamForFilterName=function(e,t){if(!_.isEmpty(e))return _.find(e,(function(e){return e.boundFilter===t}))},i.prototype.findPodForSectionName=function(e,t){if(!_.isEmpty(e))return _.find(e,(function(e){return e.boundSection===t}))},i.prototype.createPod=function(e,t,r,i){t={name:p.findUniqueName(i,this.podNamePrefix),boundSection:t,type:this.determineType(r),referenceScope:0,config:this.createPodConfig(r)};return e.push(t),i[t.name]=!0,t},i.prototype.createPodConfig=function(e){e=!e||e.acceptsAllFiltersWhenLinked?0:1;return JSON.stringify({acceptsFilterContext:e})},i.prototype.determineType=function(e){return e&&0!==e.type&&void 0!==e.type?e&&1===e.type?2:void 0:1},r=i,e.VersionUpgrader=r})(powerbi=powerbi||{}),(function(o){var e,t,a,n,r;function i(){this.keyDriverObjectName="keyDrivers",this.selectedNumericAnalysisPropertyName="selectedNumericAnalysis"}e=(e=o.explore||(o.explore={})).services||(e.services={}),e=(t=e.upgrade||(e.upgrade={})).v4_1||(t.v4_1={}),a=o.data.services.DataViewObjectSerializer,n=o.visuals.keyDriversNumericAnalysis,e.createVersionUpgrader=function(){return new r},i.prototype.upgrade=function(e){if(e&&!_.isEmpty(e.sections))for(var t=0,r=e.sections;t<r.length;t++)for(var i=0,a=r[t].visualContainers;i<a.length;i++){var n=a[i],n=n.config&&n.config.singleVisual;n&&n.visualType===o.visuals.plugins.keyDriversVisual.name&&(n.objects=this.upgradeKeyDriversVisualObjects(n.objects))}},i.prototype.upgradeFilterCollection=function(){},i.prototype.upgradeVisualObjects=function(e,t,r,i){},i.prototype.getVersion=function(){return t.ExplorationVersions.v4_1},i.prototype.upgradeKeyDriversVisualObjects=function(e){var t,r,i=(e=e||{})[this.keyDriverObjectName];return(i=i||(e[this.keyDriverObjectName]=[{properties:{}}]))[0].properties[this.selectedNumericAnalysisPropertyName]||(t={enumeration:n.type},r=o.data.SQExprBuilder.typedConstant(n.categorical,t),i[0].properties[this.selectedNumericAnalysisPropertyName]=a.serializeObjectProperty(r,{type:t})),e},r=i,e.VersionUpgrader=r})(powerbi=powerbi||{}),(function(t){var e,r,i;function a(){}e=(e=t.explore||(t.explore={})).services||(e.services={}),(e=(r=e.upgrade||(e.upgrade={})).v5_11||(r.v5_11={})).createVersionUpgrader=function(){return new i},a.prototype.upgrade=function(e){this.forAllSectionsAllContainers(e,[t.visuals.plugins.lineChart.name,t.visuals.plugins.areaChart.name,t.visuals.plugins.stackedAreaChart.name],this.upgradeLineChartDotProperties)},a.prototype.forAllSectionsAllContainers=function(e,r,i){if(e&&!_.isEmpty(e.sections))for(var t=0,a=e.sections;t<a.length;t++)for(var n=0,o=a[t].visualContainers;n<o.length;n++)!(function(e){var t,e=e.config&&e.config.singleVisual;!e||!e.objects||(t=e&&e.visualType,_.findIndex(r,(function(e){return e===t}))<0)||i(e.objects,e.projections)})(o[n])},a.prototype.upgradeLineChartDotProperties=function(e,t){var r=e.categoryAxis,i=e.dataPoint,e=e.lineStyles;if(r&&0!==r.length){r=r[0].properties;if(r&&r.axisType){r=r.axisType.expr.Literal.Value.replace(/['"]+/g,"");if(i&&"Categorical"===r&&t&&t.Category&&1===t.Category.length&&t.Category[0]){var a=t.Category[0].queryRef;if(a)for(var n,o=0;o<i.length;o++)!(function(e){var t=i[e].properties;if(!t||!t.fill||1<_.keys(t).length)return n=e;var r,t=i[e].selector;t&&t.data&&1===t.data.length&&t.data[0]&&(t=t.data[0]).scopeId&&t.scopeId.Comparison&&t.scopeId.Comparison.Left&&t.scopeId.Comparison.Left.Column&&(r=(t=t.scopeId.Comparison.Left.Column).Property)&&t.Expression&&t.Expression.SourceRef&&(t=t.Expression.SourceRef.Entity)&&"".concat(t,".").concat(r)===a&&(i.splice(e,1),e--),n=e})(o),o=n}if(e&&0<e.length&&"Scalar"===r)for(var s=0,l=e;s<l.length;s++){var p=l[s];p.selector||(p=p.properties)&&p.showMarker&&"true"===(p=p.showMarker).expr.Literal.Value&&(p.expr.Literal.Value="false")}}}},a.prototype.upgradeFilterCollection=function(){},a.prototype.upgradeVisualObjects=function(e,t,r,i){},a.prototype.getVersion=function(){return r.ExplorationVersions.v5_11},i=a,e.VersionUpgrader=i})(powerbi=powerbi||{}),(function(s){var e,t,l,p,a,r;function i(e){this.featureSwitchService=e}function n(e){return void 0!==e.children}e=(e=s.explore||(s.explore={})).services||(e.services={}),e=(t=e.upgrade||(e.upgrade={})).v5_16||(t.v5_16={}),l=s.data.services.DataViewObjectSerializer,p=s.data.services.FilterExpressionMetadataSerializer,a=jsCommon.JsonExtensions,e.createVersionUpgrader=function(e){return new r(e)},i.prototype.upgrade=function(e){if(this.featureSwitchService&&this.featureSwitchService.featureSwitches&&this.featureSwitchService.featureSwitches.serializeSpaceOptimization&&e&&!(_.isEmpty(e.config.bookmarks)&&_.isEmpty(e.filters)&&_.isEmpty(e.sections))){_.isEmpty(e.config.bookmarks)||this.upgradeBookmarks(e.config.bookmarks),e.filters&&(e.filters=this.upgradeFilterContainers(e.filters));for(var t=0,r=e.sections;t<r.length;t++)for(var i=0,a=r[t].visualContainers;i<a.length;i++){var n=a[i],o=n.config&&n.config.singleVisual,n=(o&&o.filterExpressionMetadata&&p.isFilterExpressionMetadata(o.filterExpressionMetadata)&&(o.filterExpressionMetadata=this.upgradeFilterExpressionMetadata(o.filterExpressionMetadata)),n.filters&&(n.filters=this.upgradeFilterContainers(n.filters)),o&&o.visualType);o&&o.objects&&n===s.visuals.plugins.textbox.name&&this.upgradeFilterContextProperties(o.objects)}}},i.prototype.upgradeFilterContextProperties=function(e){var t,r=this;for(t in e)for(var i=0,a=e[t];i<a.length;i++){var n,o=a[i];for(n in o.properties){var s=o.properties[n];l.isObjectPropertyWithContext(s)&&(s=(s=s.context)&&s.filterContext,_.isEmpty(s)||_.forEach(s,(function(e){e.metadata&&p.isFilterExpressionMetadata(e.metadata)&&(e.metadata=r.upgradeFilterExpressionMetadata(e.metadata))})))}}},i.prototype.upgradeBookmarks=function(e){for(var t=0,r=e;t<r.length;t++){var i,a=r[t];n(a)?this.upgradeBookmarks(a.children):(i=a.explorationState.sections,this.upgradeSectionState(i),(i=a.explorationState.filters)&&this.upgradeFilters(i))}},i.prototype.upgradeSectionState=function(e){var r=this;_.forEach(e,(function(e){_.forEach(e.visualContainers,(function(e){var t=e.highlight,t=(t&&t.selection&&l.isSelectorsByColumn(t.selection)&&(t.selection=r.upgradeSelectorsByColumn(t.selection)),t&&t.filterExpressionMetadata&&p.isFilterExpressionMetadata(t.filterExpressionMetadata)&&(t.filterExpressionMetadata=r.upgradeFilterExpressionMetadata(t.filterExpressionMetadata)),e.singleVisual);t.filterExpressionMetadata&&p.isFilterExpressionMetadata(t.filterExpressionMetadata)&&(t.filterExpressionMetadata=r.upgradeFilterExpressionMetadata(t.filterExpressionMetadata))})),e.filters&&r.upgradeFilters(e.filters)}))},i.prototype.upgradeFilters=function(e){var t=this;e.byName&&_.forEach(e.byName,(function(e){e.filterExpressionMetadata&&p.isFilterExpressionMetadata(e.filterExpressionMetadata)&&(e.filterExpressionMetadata=t.upgradeFilterExpressionMetadata(e.filterExpressionMetadata))})),e.byExpr&&this.upgradeFilterContainerState(e.byExpr),e.byTransientState&&this.upgradeFilterContainerState(e.byTransientState),e.byType&&this.upgradeFilterContainerState(e.byType)},i.prototype.upgradeFilterContainerState=function(e){var t=this;_.forEach(e,(function(e){e.filterExpressionMetadata&&p.isFilterExpressionMetadata(e.filterExpressionMetadata)&&(e.filterExpressionMetadata=t.upgradeFilterExpressionMetadata(e.filterExpressionMetadata))}))},i.prototype.upgradeSelectorsByColumn=function(e){e=_.map(e,(function(e){return l.deserializeSelectorsByColumn(e)})),e=s.data.DecomposedIdentities.decomposeSelectorsByColumn(e);return l.serializeDecomposedSelectors(e)},i.prototype.upgradeFilterExpressionMetadata=function(e){e=p.deserializeOldFilterExpressionMetadata(e),e=s.data.DecomposedIdentities.decomposeFilterExpressionMetadata(e);return l.serializeDecomposedFilterExpressionMetadata(e)},i.prototype.upgradeFilterCollection=function(e){e&&e.filters&&(e.filters=this.upgradeFilterContainers(e.filters))},i.prototype.upgradeVisualObjects=function(e,t,r,i){},i.prototype.upgradeFilterContainers=function(e){if(!_.isEmpty(e)){e=a.tryParseJSON(e);if(e)for(var t=0,r=e;t<r.length;t++){var i=r[t];this.upgradeFilterContainer(i)}return JSON.stringify(e)}},i.prototype.upgradeFilterContainer=function(e){e.filterExpressionMetadata&&p.isFilterExpressionMetadata(e.filterExpressionMetadata)&&(e.filterExpressionMetadata=this.upgradeFilterExpressionMetadata(e.filterExpressionMetadata))},i.prototype.getVersion=function(){return t.ExplorationVersions.v5_16},r=i,e.VersionUpgrader=r,e.isBookmarkGroup=n,e.isStateBookmark=function(e){return!n(e)}})(powerbi=powerbi||{}),(function(e){var t,r,i,a;function n(e){this.featureSwitchService=e}function C(e){return i.deserializeExpr(e.expr).value}t=(t=e.explore||(e.explore={})).services||(t.services={}),t=(r=t.upgrade||(t.upgrade={})).v5_25||(r.v5_25={}),i=e.data.services.SemanticQuerySerializer,t.createVersionUpgrader=function(e){return new a(e)},n.prototype.upgrade=function(e){if(this.featureSwitchService&&this.featureSwitchService.featureSwitches&&this.featureSwitchService.featureSwitches.buttonTileFormatting&&e&&e.sections)for(var t=0,r=e.sections;t<r.length;t++)for(var i=0,a=r[t].visualContainers;i<a.length;i++){var n=a[i],n=n.config&&n.config.singleVisual;if(n&&"actionButton"===n.visualType&&n.objects){var o=n.objects;if(o.text)for(var s,l,p=0,u=o.text;p<u.length;p++)(c=null==(g=u[p])?void 0:g.properties)&&(d=c.padding)&&(l=s=void 0,s=c.horizontalAlignment?C(c.horizontalAlignment):"right",l=c.verticalAlignment?C(c.verticalAlignment):"middle","left"===s?g.properties.leftMargin=d:"right"===s&&(g.properties.rightMargin=d),"top"===l?g.properties.topMargin=d:"bottom"===l&&(g.properties.bottomMargin=d),delete g.properties.padding);if(o.icon)for(var c,d,m=0,v=o.icon;m<v.length;m++)(c=null==(g=v[m])?void 0:g.properties)&&(d=c.padding)&&(g.properties.leftMargin=d,g.properties.rightMargin=d,g.properties.topMargin=d,g.properties.bottomMargin=d,delete g.properties.padding);if(o.outline)for(var y=0,h=o.outline;y<h.length;y++){var g,f=null==(g=h[y])?void 0:g.properties.roundEdge;f&&(o.shape=o.shape||[],o.shape.push({properties:{roundEdge:f},selector:g.selector}),delete g.properties.roundEdge)}}}},n.prototype.upgradeVisualObjects=function(e,t,r,i){},n.prototype.upgradeFilterCollection=function(){},n.prototype.getVersion=function(){return r.ExplorationVersions.v5_25},a=n,t.VersionUpgrader=a})(powerbi=powerbi||{}),(function(o){var e,n,s,l,t;function r(){}e=(e=o.explore||(o.explore={})).services||(e.services={}),e=(n=e.upgrade||(e.upgrade={})).v5_28||(n.v5_28={}),s=o.data.SQExprBuilder,l=o.data.services.SemanticQuerySerializer,e.createVersionUpgrader=function(){return new t},r.prototype.upgrade=function(e){if(e&&!_.isEmpty(e.sections))for(var t=0,r=e.sections;t<r.length;t++)for(var i=0,a=r[t].visualContainers;i<a.length;i++){var n=a[i],n=n.config&&n.config.singleVisual;n&&n.objects&&(n&&n.visualType)===o.visuals.plugins.azureMap.name&&this.upgradeAzureMapProperties(n.objects)}},r.prototype.upgradeVisualObjects=function(e,t,r,i){},r.prototype.upgradeAzureMapProperties=function(e){e=e.heatMapLayer;if(e&&0!==e.length)for(var t=0,r=e;t<r.length;t++){var i,a=r[t];a.selector||(a=a.properties)&&a.heatMapOpacity&&(i=a.heatMapOpacity,i=Number(l.deserializeExpr(i.expr).value),i=isNaN(i)?0:100-100*i,delete a.heatMapOpacity,a.mapTransparency=n.UpgradeUtils.toExpr(s.integer(i)))}},r.prototype.upgradeFilterCollection=function(){},r.prototype.getVersion=function(){return n.ExplorationVersions.v5_28},t=r,e.VersionUpgrader=t})(powerbi=powerbi||{}),(function(a){var e,c,n,o,s,l,t,d,p,u,m,v,y,r,h,g,f,C,x,S,b,E,N,V,i,w,P,T,F;function j(e){this.featureSwitchService=e}function D(e){return t.deserializeExpr(e.expr).value}e=(e=a.explore||(a.explore={})).services||(e.services={}),e=(c=e.upgrade||(e.upgrade={})).v5_31||(c.v5_31={}),n=a.visuals.cartesianChartProps,o=a.visuals.legendMarkerRendering,s=a.visuals.lineChartProps,l=a.visuals.plugins,t=a.data.services.SemanticQuerySerializer,d=a.data.SQExprBuilder,e.createVersionUpgrader=function(e){return new r(e)},p=[l.tableEx.name,l.pivotTable.name,l.slicer.name,l.filterSlicer.name,l.multiRowCard.name],u=[l.barChart.name,l.clusteredBarChart.name,l.clusteredColumnChart.name,l.columnChart.name,l.hundredPercentStackedBarChart.name,l.hundredPercentStackedColumnChart.name,l.ribbonChart.name],m=[l.areaChart.name,l.barChart.name,l.clusteredBarChart.name,l.clusteredColumnChart.name,l.columnChart.name,l.hundredPercentStackedBarChart.name,l.hundredPercentStackedColumnChart.name,l.lineChart.name,l.lineClusteredColumnComboChart.name,l.lineStackedColumnComboChart.name,l.ribbonChart.name,l.scatterChart.name,l.stackedAreaChart.name,l.waterfallChart.name],v=[l.comboChart.name,l.dataDotClusteredColumnComboChart.name,l.dataDotStackedColumnComboChart.name,l.lineClusteredColumnComboChart.name,l.lineStackedColumnComboChart.name],y=[l.lineChart.name,l.areaChart.name,l.stackedAreaChart.name,l.lineStackedColumnComboChart.name,l.lineClusteredColumnComboChart.name],j.prototype.upgrade=function(e){},j.prototype.upgradeVisualObjects=function(e,t,r,i){1===e&&(_.some(u,(function(e){return e===r}))&&(this.upgradeCartesianAxisScale(t,n.categoryAxis.logAxisScale.objectName),this.upgradeCartesianAxisPosition(t,n.categoryAxis.switchAxisPosition.objectName)),_.some(m,(function(e){return e===r}))&&(this.upgradeCartesianAxisScale(t,n.valueAxis.logAxisScale.objectName),this.upgradeCartesianAxisPosition(t,n.valueAxis.switchAxisPosition.objectName)),_.some(v,(function(e){return e===r}))&&this.upgradeCartesianSecAxisScale(t,n.valueAxis.secLogAxisScale.objectName),_.some(y,(function(e){return e===r}))&&(this.upgradeCartesianSecAxisScale(t,n.y2Axis.secLogAxisScale.objectName),this.upgradeDefaultToCircle(t,s.legend.legendMarkerRendering.objectName)),this.featureSwitchService.featureSwitches.outlineDropdownToCheckboxes&&_.some(p,(function(e){return e===r}))&&this.upgradeOutlineProperties(t,r),this.featureSwitchService.featureSwitches.splitSubTotals&&r===l.pivotTable.name&&this.upgradeSubTotalsProperties(t),this.featureSwitchService.featureSwitches.splitGrandTotals&&r===l.pivotTable.name&&this.upgradeTotalProperties(t),r===a.visuals.plugins.scatterChart.name)&&this.upgradeScatterChartFillPoint(t),2===e&&(this.featureSwitchService.featureSwitches.splitHelpTooltip&&this.upgradeVisualHeaderTooltip(t),this.featureSwitchService.featureSwitches.showDefaultTooltip)&&this.upgradeVisualLink(t)},j.prototype.upgradeCartesianAxisScale=function(e,t){var r=n.categoryAxis;this.upgradeAxisScale(e,t,r.axisScale.propertyName,r.logAxisScale.propertyName)},j.prototype.upgradeCartesianSecAxisScale=function(e,t){var r=n.valueAxis;this.upgradeAxisScale(e,t,r.secAxisScale.propertyName,r.secLogAxisScale.propertyName)},j.prototype.upgradeVisualHeaderTooltip=function(e){e=e[C];if(e&&0<e.length)for(var t=0,r=e;t<r.length;t++){var i,a=r[t].properties;a&&a[S]&&!a[x]&&(i=(i=a[S])&&D(i))&&i!==f&&(a[x]=c.UpgradeUtils.toExpr(d.text(g)))}},j.prototype.upgradeSubTotalsProperties=function(e){var t=e.subTotals;if(t&&0<t.length)for(var r=t.length,i=0;i<r;i++){var a=t[i],n=a.properties,o={properties:{}};if(n&&!a.selector){for(var s=0,l=h;s<l.length;s++){var p=l[s],u=n[p.propertyName];u&&(o.properties[p.propertyName]=u,delete n[p.propertyName])}_.isEmpty(o.properties)||(t.push(__assign(__assign({},o),{selector:{id:"Column"}})),t.push(__assign(__assign({},o),{selector:{id:"Row"}})))}}},j.prototype.upgradeVisualLink=function(e){if(this.featureSwitchService.featureSwitches.useModernFormatPane){e=e[b];if(e&&0<e.length)for(var t=0,r=e;t<r.length;t++){var i,a=r[t].properties;a&&a[E]&&(i=(i=a[E])&&D(i),i=c.UpgradeUtils.convertSuppressDefaultTooltip(i),a[N]=c.UpgradeUtils.toExpr(d.boolean(i)),delete a[E])}}},j.prototype.upgradeOutlineProperties=function(e,t){for(var r=0,i=this.getPropertiesToUpgrade(t);r<i.length;r++){var a=i[r],n=a.objectName,o=a.propertyName,a=e[n];if(a&&0!==a.length)for(var s=0,l=a;s<l.length;s++){var p,u=l[s].properties;u&&u[o]&&(p=D(u[o]),p=c.UpgradeUtils.convertOutlineValue(p),u[V]=c.UpgradeUtils.toExpr(d.integer(p)),delete u[o])}}},j.prototype.upgradeTotalProperties=function(e){var t=e.total;t&&0<t.length&&(e.rowTotal=_.cloneDeep(t),e.columnTotal=_.cloneDeep(t),delete e.total)},j.prototype.getPropertiesToUpgrade=function(e){switch(e){case l.tableEx.name:return i;case l.pivotTable.name:return w;case l.slicer.name:return P;case l.filterSlicer.name:return T;case l.multiRowCard.name:return F;default:return[]}},j.prototype.upgradeDefaultToCircle=function(e,t){var r,i,a;this.featureSwitchService&&this.featureSwitchService.featureSwitches&&this.featureSwitchService.featureSwitches.removeDefaultToCircleToggle&&(e=e[t],t=s.legend.defaultToCircle.propertyName,r=s.legend.legendMarkerRendering.propertyName,e)&&0<e.length&&(e=e[0].properties)&&e[t]&&(i=void 0,e[r]&&(i=D(e[r])),a=D(e[t]),i!==o.markerOnly&&i||a?i===o.markerOnly&&a&&(e[r]=c.UpgradeUtils.toExpr(d.text(o.markerCircleDefault))):e[r]=c.UpgradeUtils.toExpr(d.text(o.markerOnly)),delete e[t])},j.prototype.upgradeAxisScale=function(e,t,r,i){var e=e[t];e&&0<e.length&&(t=e[0].properties)&&t[r]&&(e=D(t[r]),e=c.UpgradeUtils.convertAxisScaleProperty(e),t[i]=c.UpgradeUtils.toExpr(d.boolean(e)),delete t[r])},j.prototype.upgradeCartesianAxisPosition=function(e,t){var r,e=e[t],t=n.categoryAxis.position.propertyName,i=n.categoryAxis.switchAxisPosition.propertyName;e&&0<e.length&&(e=e[0].properties)&&e[t]&&(r=D(e[t]),r=c.UpgradeUtils.convertAxisPositionProperty(r),e[i]=c.UpgradeUtils.toExpr(d.boolean(r)),delete e[t])},j.prototype.upgradeScatterChartFillPoint=function(e){if(this.featureSwitchService&&this.featureSwitchService.featureSwitches&&this.featureSwitchService.featureSwitches.fillPointStyle){e=e.fillPoint;if(e&&0<e.length)for(var t=0,r=e;t<r.length;t++){var i,a=r[t];a.selector||(a=a.properties)&&a.show&&(i=D(a.show),i=c.UpgradeUtils.convertScatterChartFillPoint(i),a.style=c.UpgradeUtils.toExpr(d.text(i)),delete a.show)}}},j.prototype.upgradeFilterCollection=function(){},j.prototype.getVersion=function(){return c.ExplorationVersions.v5_31},r=j,e.VersionUpgrader=r,h=[{objectName:"subTotals",propertyName:"fontColor"},{objectName:"subTotals",propertyName:"fontFamily"},{objectName:"subTotals",propertyName:"fontSize"},{objectName:"subTotals",propertyName:"bold"},{objectName:"subTotals",propertyName:"italic"},{objectName:"subTotals",propertyName:"underline"},{objectName:"subTotals",propertyName:"backColor"},{objectName:"subTotals",propertyName:"applyToHeaders"}],g="Canvas",f="none",C="visualHeaderTooltip",x="type",S="section",b="visualLink",E="suppressDefaultTooltip",N="showDefaultTooltip",V="outlineStyle",i=[{objectName:"grid",propertyName:"outline"},{objectName:"columnHeaders",propertyName:"outline"},{objectName:"values",propertyName:"outline"},{objectName:"total",propertyName:"outline"}],w=[{objectName:"grid",propertyName:"outline"},{objectName:"columnHeaders",propertyName:"outline"},{objectName:"values",propertyName:"outline"},{objectName:"rowHeaders",propertyName:"outline"}],P=[{objectName:"searchBox",propertyName:"outline"},{objectName:"items",propertyName:"outline"},{objectName:"header",propertyName:"outline"}],T=[{objectName:"searchBox",propertyName:"outline"},{objectName:"items",propertyName:"outline"},{objectName:"header",propertyName:"outline"}],F=[{objectName:"card",propertyName:"outline"}]})(powerbi=powerbi||{}),(function(e){var t,a,n,r,o,s,l,i;function p(e){this.featureSwitchService=e}t=(t=e.explore||(e.explore={})).services||(t.services={}),t=(a=t.upgrade||(t.upgrade={})).v5_33||(a.v5_33={}),n=e.visuals.cartesianChartProps,r=e.visuals.plugins,o=e.data.services.SemanticQuerySerializer,s=e.data.SQExprBuilder,t.createVersionUpgrader=function(e){return new i(e)},l=[r.areaChart.name,r.lineChart.name,r.lineClusteredColumnComboChart.name,r.lineStackedColumnComboChart.name,r.scatterChart.name,r.stackedAreaChart.name],p.prototype.upgrade=function(e){},p.prototype.upgradeVisualObjects=function(e,t,r,i){this.featureSwitchService&&this.featureSwitchService.featureSwitches&&this.featureSwitchService.featureSwitches.remainingCartesianCategoryLogAxisScale&&1===e&&_.some(l,(function(e){return e===r}))&&this.upgradeCartesianAxisScale(t,n.categoryAxis.logAxisScale.objectName)},p.prototype.upgradeCartesianAxisScale=function(e,t){var r=n.categoryAxis;this.upgradeAxisScale(e,t,r.axisScale.propertyName,r.logAxisScale.propertyName)},p.prototype.upgradeAxisScale=function(e,t,r,i){var e=e[t];e&&0<e.length&&(t=e[0].properties)&&(t[i]&&t[r]?delete t[r]:t[r]&&(e=t[r],e=o.deserializeExpr(e.expr).value,e=a.UpgradeUtils.convertAxisScaleProperty(e),t[i]=a.UpgradeUtils.toExpr(s.boolean(e)),delete t[r]))},p.prototype.upgradeFilterCollection=function(){},p.prototype.getVersion=function(){return a.ExplorationVersions.v5_33},i=p,t.VersionUpgrader=i})(powerbi=powerbi||{}),(function(e){var t,u,r;function i(e){this.featureSwitchService=e}e=(e=e.explore||(e.explore={})).services||(e.services={}),e=(t=e.upgrade||(e.upgrade={})).v5_38||(t.v5_38={}),u=jsCommon.JsonExtensions,e.createVersionUpgrader=function(e){return new r(e)},i.prototype.upgrade=function(e){this.featureSwitchService.featureSwitches.onObject&&this.upgradeDrillthroughTargetRegularSections(e)},i.prototype.upgradeVisualObjects=function(e,t,r,i){},i.prototype.upgradeFilterCollection=function(){},i.prototype.getVersion=function(){return t.ExplorationVersions.v5_38},i.prototype.upgradeDrillthroughTargetRegularSections=function(e){if(!_.isEmpty(null==e?void 0:e.sections)&&!_.isEmpty(e.pods)){for(var t={},r=0,i=e.pods;r<i.length;r++){var a=i[r],n=a.boundSection;_.isEmpty(n)||t[n]||1!==a.type||StringExtensions.isNullOrUndefinedOrWhiteSpaceString(a.parameters)||(n=u.tryParseJSON(a.parameters),_.some(n,(function(e){return!!e.fieldExpr}))&&(t[a.boundSection]=!0))}for(var o=0,s=e.sections;o<s.length;o++){var l=s[o],p=null==(p=l.config)?void 0:p.type;(null==p||0===p)&&t[l.name]&&(l.config||(l.config={}),l.config.type=2)}}},r=i,e.VersionUpgrader=r})(powerbi=powerbi||{}),(function(e){var t,n,o,r,s,l,i;function a(){}t=(t=e.explore||(e.explore={})).services||(t.services={}),t=(n=t.upgrade||(t.upgrade={})).v5_42||(n.v5_42={}),o=e.visuals.cartesianChartProps,r=e.visuals.plugins,s=e.data.SQExprBuilder,l=[r.barChart.name,r.clusteredBarChart.name,r.hundredPercentStackedBarChart.name],t.createVersionUpgrader=function(){return new i},a.prototype.upgrade=function(e){},a.prototype.upgradeVisualObjects=function(e,t,r,i){var a=o.categoryAxis;1===e&&_.some(l,(function(e){return e===r}))&&(e=t[a.concatenateLabels.objectName],_.isEmpty(e)&&(t[a.concatenateLabels.objectName]=[{properties:{}}],e=t[a.concatenateLabels.objectName]),(e=(t=e[0].properties)[a.concatenateLabels.propertyName])&&e.expr?e.expr.Literal.Value="true":t[a.concatenateLabels.propertyName]=n.UpgradeUtils.toExpr(s.boolean(!0)))},a.prototype.upgradeFilterCollection=function(){},a.prototype.getVersion=function(){return n.ExplorationVersions.v5_42},i=a,t.VersionUpgrader=i})(powerbi=powerbi||{}),(function(e){var t,r;function i(e){}e=(e=e.explore||(e.explore={})).services||(e.services={}),(e=(t=e.upgrade||(e.upgrade={})).v5_9||(t.v5_9={})).createVersionUpgrader=function(e){return new r(e)},i.prototype.upgrade=function(e){if(e&&!_.isEmpty(e.sections))for(var t=0,r=e.sections;t<r.length;t++)for(var i=0,a=r[t].visualContainers;i<a.length;i++){var n,o=a[i],o=o.config&&o.config.singleVisual;o&&o.objects&&("pivotTable"!==(n=o&&o.visualType)&&"tableEx"!==n||this.upgradeTablixProperties(o.objects,n))}},i.prototype.upgradeVisualObjects=function(e,t,r,i){},i.prototype.upgradeTablixProperties=function(e,t){e=e.values;if(e)for(var r=0,i=e;r<i.length;r++){var a=i[r];this.isValidRoleWildcard(a.selector,t)&&a.properties&&(a.properties.backColor||a.properties.fontColor)&&(a.selector.data=[{dataViewWildcard:{matchingOption:1}}])}},i.prototype.isValidRoleWildcard=function(e,t){return!(!e||_.isEmpty(e.data)||1!==e.data.length||_.isEmpty(e.data[0].roles))&&("tableEx"===t&&_.isEqual(e.data[0].roles,["Values"])||"pivotTable"===t&&_.isEqual(e.data[0].roles,["Rows","Columns"]))},i.prototype.upgradeFilterCollection=function(){},i.prototype.getVersion=function(){return t.ExplorationVersions.v5_9},r=i,e.VersionUpgrader=r})(powerbi=powerbi||{}),(function(e){var s,t;function r(e){this.downgraders=e}e=(e=(e=e.explore||(e.explore={})).services||(e.services={})).downgrade||(e.downgrade={}),s=jsCommon.Version,e.createVisualObjectsDowngrader=function(e){return new t(e)},r.prototype.getFinalVisualObjectsVersion=function(e,t,r,i){for(var a=0,n=this.downgraders;a<n.length;a++){var o=n[a];r=s.max(r,o.getMinDowngradeVersionForVisualObjects(e,t,i))}return r},r.prototype.downgrade=function(e,t,r,i){for(var a=0,n=this.downgraders;a<n.length;a++)n[a].downgradeVisualObjects(e,t,r,i)},t=r,e.VisualObjectsDowngrader=t})(powerbi=powerbi||{}),(function(e){var l,t;function r(e){this.upgraders=e}e=(e=(e=e.explore||(e.explore={})).services||(e.services={})).upgrade||(e.upgrade={}),l=jsCommon.Version,e.createVisualObjectsUpgrader=function(e){return new t(e)},r.prototype.upgrade=function(e,t,r,i){for(var a=0,n=this.upgraders;a<n.length;a++){var o=n[a],s=o.getVersion();l.gt(s,i)&&o.upgradeVisualObjects(e,t,r,i)}},t=r,e.VisualObjectsUpgrader=t})(powerbi=powerbi||{}),(function(s){var r=s.data||(s.data={}),e=s.formattingService,t=jsCommon.Lazy,l=jsCommon.StringExtensions;function i(e,t,r){this.op=e,this.onOperatorChanged(),this.isCalendarShown=!1,this.value=new w(t,r)}Object.defineProperty(i.prototype,"operator",{get:function(){return this.op},set:function(e){this.op!==e&&(this.op=e,this.onOperatorChanged())},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"valueRequired",{get:function(){return this.valRequired},enumerable:!1,configurable:!0}),i.prototype.accept=function(e){return e.visit(this)},i.empty=function(){return new i(0)},i.equals=function(e,t){return(e=e||null)===(t=t||null)||!e==!t&&e.operator===t.operator&&w.equals(e.value,t.value)},i.prototype.onOperatorChanged=function(){this.valRequired=a.getValueRequired(this.operator),this.valRequired?this.cachedValue&&(this.value=this.cachedValue,this.cachedValue=void 0):this.value&&(this.cachedValue=this.value,this.value=void 0)},r.Condition=i,Object.defineProperty(P.prototype,"isDate",{get:function(){return null!=this.dateValue},enumerable:!1,configurable:!0}),Object.defineProperty(P.prototype,"hasValue",{get:function(){return null!=this.dateValue||!jsCommon.StringExtensions.isNullOrUndefinedOrWhiteSpaceString(this.stringValue)},enumerable:!1,configurable:!0}),P.prototype.isValidDate=function(){return this.isDate&&(!_.isString(this.value)||null!==e.parseDate(this.value))},P.equals=function(e,t){return(e=e||null)===(t=t||null)||!e==!t&&P.compareDateTimeValue(e,t)&&e.stringValue===t.stringValue},P.compareDateTimeValue=function(e,t){return(e.dateValue?e.dateValue.valueOf():0)===(t.dateValue?t.dateValue.valueOf():0)};var a,n,o,p,u,c,d,m,v,y,h,g,f,C,x,S,b,E,N,V,w=P;function P(e,t){null!=e&&(e instanceof Date&&(this.dateValue=e),this.value=e,this.formatter=t,this.stringValue=this.formatter?this.formatter.format(this.value):this.value.toString()),this.dateValue?this.timeValue=new Date(this.dateValue.getTime()):(this.timeValue=new Date,this.timeValue.setHours(0,0,0,0))}function T(){var e=[];return e.push(o.getValue()),e}function F(e,t){var r;if(0<e.length){for(var i=[],a=0,n=e;a<n.length;a++){var o=n[a];i.push(D(o))}r=s.visuals.valueFormatter.formatListOr(i),r=t?l.format(s.common.getLocalize().get("FilterRestatement_NotEqual"),r):l.format(s.common.getLocalize().get("FilterRestatement_Equal"),r)}return r}function j(e,t){e=r.SQExprConverter.getFirstComparandValue(e);return t?t.format(e):e}function D(e){return null===e?null:_.isString(e)?e:e.displayName||("function"!=typeof e||"object"!=typeof e?e:void 0)}r.ConditionValue=w,n=a=r.OperatorHelper||(r.OperatorHelper={}),o=new t(function(){return{value:9,label:s.common.getLocalize().get("FilterOperator_Is"),tooltip:s.common.getLocalize().get("FilterOperator_IsTooltip")}}),p=new t(function(){return{value:10,label:s.common.getLocalize().get("FilterOperator_IsNot"),tooltip:s.common.getLocalize().get("FilterOperator_IsNotTooltip")}}),u=new t(function(){return{value:11,label:s.common.getLocalize().get("FilterOperator_IsBlank"),tooltip:s.common.getLocalize().get("FilterOperator_IsBlankTooltip")}}),c=new t(function(){return{value:12,label:s.common.getLocalize().get("FilterOperator_IsNotBlank"),tooltip:s.common.getLocalize().get("FilterOperator_IsNotBlankTooltip")}}),d=new t(function(){return{value:5,label:s.common.getLocalize().get("FilterOperator_Contains"),tooltip:s.common.getLocalize().get("FilterOperator_ContainsTooltip")}}),m=new t(function(){return{value:6,label:s.common.getLocalize().get("FilterOperator_DoesNotContain"),tooltip:s.common.getLocalize().get("FilterOperator_DoesNotContainTooltip")}}),v=new t(function(){return{value:7,label:s.common.getLocalize().get("FilterOperator_StartsWith"),tooltip:s.common.getLocalize().get("FilterOperator_StartsWithTooltip")}}),y=new t(function(){return{value:8,label:s.common.getLocalize().get("FilterOperator_DoesNotStartWith"),tooltip:s.common.getLocalize().get("FilterOperator_DoesNotStartWithTooltip")}}),h=new t(function(){return{value:13,label:s.common.getLocalize().get("FilterOperator_IsEmptyString"),tooltip:s.common.getLocalize().get("FilterOperator_IsEmptyStringTooltip")}}),g=new t(function(){return{value:14,label:s.common.getLocalize().get("FilterOperator_IsNotEmptyString"),tooltip:s.common.getLocalize().get("FilterOperator_IsNotEmptyStringTooltip")}}),f=new t(function(){return{value:3,label:s.common.getLocalize().get("FilterOperator_GreaterThan_DT"),tooltip:s.common.getLocalize().get("FilterOperator_GreaterThan_DT")}}),C=new t(function(){return{value:4,label:s.common.getLocalize().get("FilterOperator_GreaterThanOrEqual_DT"),tooltip:s.common.getLocalize().get("FilterOperator_GreaterThanOrEqual_DT")}}),x=new t(function(){return{value:1,label:s.common.getLocalize().get("FilterOperator_LessThan_DT"),tooltip:s.common.getLocalize().get("FilterOperator_LessThan_DT")}}),S=new t(function(){return{value:2,label:s.common.getLocalize().get("FilterOperator_LessThanOrEqual_DT"),tooltip:s.common.getLocalize().get("FilterOperator_LessThanOrEqual_DT")}}),b=new t(function(){return{value:3,label:s.common.getLocalize().get("FilterOperator_GreaterThan"),tooltip:s.common.getLocalize().get("FilterOperator_GreaterThan")}}),E=new t(function(){return{value:4,label:s.common.getLocalize().get("FilterOperator_GreaterThanOrEqual"),tooltip:s.common.getLocalize().get("FilterOperator_GreaterThanOrEqual")}}),N=new t(function(){return{value:1,label:s.common.getLocalize().get("FilterOperator_LessThan"),tooltip:s.common.getLocalize().get("FilterOperator_LessThan")}}),V=new t(function(){return{value:2,label:s.common.getLocalize().get("FilterOperator_LessThanOrEqual"),tooltip:s.common.getLocalize().get("FilterOperator_LessThanOrEqual")}}),n.getValueRequired=function(e){return 11!==e&&12!==e&&0!==e&&13!==e&&14!==e},n.tryGetExprFilterOperators=function(e,t,r,i){return _.isEmpty(e.validate(t,r))?(r=e.getMetadata(t),{hasError:!1,operators:n.getFilterOperators(r.type,i)}):{hasError:!0,operators:void 0}},n.getFilterOperators=function(e,t){return t?T():e.text?((t=[]).push(d.getValue()),t.push(m.getValue()),t.push(v.getValue()),t.push(y.getValue()),t.push(o.getValue()),t.push(p.getValue()),t.push(u.getValue()),t.push(c.getValue()),t.push(h.getValue()),t.push(g.getValue()),t):e.integer||e.numeric?((t=[]).push(N.getValue()),t.push(V.getValue()),t.push(b.getValue()),t.push(E.getValue()),t.push(o.getValue()),t.push(p.getValue()),t.push(u.getValue()),t.push(c.getValue()),t):e.dateTime?((t=[]).push(o.getValue()),t.push(p.getValue()),t.push(f.getValue()),t.push(C.getValue()),t.push(x.getValue()),t.push(S.getValue()),t.push(u.getValue()),t.push(c.getValue()),t):void 0},n.isOperatorForColumnMappedToMParameter=function(t){return T().some((function(e){return e.value===t}))},(t=r.RestatementHelper||(r.RestatementHelper={})).fromCondition=function(e,t,r,i){for(var a,n=new R(t,r,i),o=0,s=e;o<s.length;o++){var l=s[o];null!=l.operator&&0!==l.operator&&(a=l.accept(n))}return a},t.fromLabels=F,t.fromDataViewScopeIdentities=function(e,t,r){for(var i=[],a=0,n=e;a<n.length;a++){var o=n[a];i.push(j(o,r))}return F(i,t)},t.getLabelFromScopeId=j,t.fromDefault=function(e){if(null!=e)return l.format(s.common.getLocalize().get("FilterRestatement_IsDefault"),D(e))},A.prototype.visit=function(e){e=this.conditionToString(e);if(e)return _.isEmpty(this.result)?this.result=e:this.result=l.format(this.logicalOperatorResourceId,this.result,e),this.result},A.prototype.conditionToString=function(e){var t,r=e.value;if(!a.getValueRequired(e.operator)||r&&r.hasValue)switch(r&&(t=this.formatter?this.formatter.format(r.value||r.stringValue):r.stringValue),e.operator){case 9:return l.format(this.localizationService.get("FilterRestatement_Equal"),t);case 10:return l.format(this.localizationService.get("FilterRestatement_NotEqual"),t);case 3:return r.isDate?l.format(this.localizationService.get("FilterRestatement_GreaterThan_DT"),t):l.format(this.localizationService.get("FilterRestatement_GreaterThan"),t);case 4:return r.isDate?l.format(this.localizationService.get("FilterRestatement_GreaterThanOrEqual_DT"),t):l.format(this.localizationService.get("FilterRestatement_GreaterThanOrEqual"),t);case 1:return r.isDate?l.format(this.localizationService.get("FilterRestatement_LessThan_DT"),t):l.format(this.localizationService.get("FilterRestatement_LessThan"),t);case 2:return r.isDate?l.format(this.localizationService.get("FilterRestatement_LessThanOrEqual_DT"),t):l.format(this.localizationService.get("FilterRestatement_LessThanOrEqual"),t);case 5:return l.format(this.localizationService.get("FilterRestatement_Contains"),t);case 6:return l.format(this.localizationService.get("FilterRestatement_DoesNotContain"),t);case 7:return l.format(this.localizationService.get("FilterRestatement_StartWith"),t);case 8:return l.format(this.localizationService.get("FilterRestatement_DoesNotStartWith"),t);case 11:return this.localizationService.get("FilterOperator_IsBlank");case 12:return this.localizationService.get("FilterOperator_IsNotBlank");case 13:return this.localizationService.get("FilterOperator_IsEmptyString");case 14:return this.localizationService.get("FilterOperator_IsNotEmptyString");default:return""}};var R=A;function A(e,t,r){void 0===r&&(r=s.common.getLocalize()),this.localizationService=r,0===e?this.logicalOperatorResourceId=this.localizationService.get("FilterRestatement_CompoundAnd"):1===e&&(this.logicalOperatorResourceId=this.localizationService.get("Generic_Or")),this.formatter=t}})(powerbi=powerbi||{}),(function(e){var i;function a(e,t){var r=e.value,i=e.unit,a=e.isTimeUnit;switch(i){case"S":return 1===r?t.get("TimeUnit_Second"):t.get("TimeUnit_Seconds");case"M":return a?1===r?t.get("TimeUnit_Minute"):t.get("TimeUnit_Minutes"):1===r?t.get("TimeUnit_Month"):t.get("TimeUnit_Months");case"H":return 1===r?t.get("TimeUnit_Hour"):t.get("TimeUnit_Hours");case"D":return 1===r?t.get("TimeUnit_Day"):t.get("TimeUnit_Days");case"W":return 1===r?t.get("TimeUnit_Week"):t.get("TimeUnit_Weeks");case"Y":return 1===r?t.get("TimeUnit_Year"):t.get("TimeUnit_Years");default:return""}}function r(e){switch(e){case"S":case"M":case"H":return!0;default:return!1}}function n(e,t){e=[{value:e,unit:t,isTimeUnit:r(t)}],t=i.DurationParser.durationParseResultItemsToDurationParseResult(e);return i.DurationParser.durationParseResultAsMilliseconds(t)}function o(e,t){t=Math.pow(10,t||0);return Math.round(e*t)/t}e=e.explore||(e.explore={}),(e=(i=e.util||(e.util={})).DurationDisplayHelper||(i.DurationDisplayHelper={})).isBelowMinimumValue=function(e,t,r){return n(e,t)<(r&&""!==r?i.DurationParser.durationParseResultAsMilliseconds(i.DurationParser.parseISODurationdString(r)):-Number.MAX_VALUE)},e.isAboveMaximumValue=function(e,t,r){return e=n(e,t),(r&&""!==r?i.DurationParser.durationParseResultAsMilliseconds(i.DurationParser.parseISODurationdString(r)):Number.MAX_VALUE)<e},e.getFullUnitName=a,e.getReadableTimeString=function(e,t){var r,e=i.DurationParser.parseISODurationdString(e);return(e=i.DurationParser.durationParseResultToArray(e)).length<=0?"":(r=e[0].value,e=a(e[0],t),"".concat(r," ").concat(e))},e.isTimeUnit=r,e.convertSecondsToTimeString=function(e,t){return isNaN(e)?t.get("TwoDashes"):e<60?1===e?t.get("TimeUnit_One_second"):t.format("TimeUnit_seconds_with_value",[o(e,1)]):(e/=60)<60?1===e?t.get("TimeUnit_One_minute"):t.format("TimeUnit_minutes_with_value",[o(e,1)]):1===(e/=60)?t.get("SettingsDataset_ScheduleRefresh_RefreshFrequency_OneHour"):t.format("TimeUnit_hours_with_value",[o(e,1)])},e.getTimeString=function(e,t){var r=e.value,i=e.unit,a=e.isTimeUnit;switch(i){case"S":return 1===r?t.get("TimeUnit_One_second"):t.format("TimeUnit_seconds_with_value",r);case"M":return a?1===r?t.get("TimeUnit_One_minute"):t.format("CdsaAuthoring_Iframe_TheNumberOfHowManyMinutes",r):1===r?t.get("TimeUnit_One_month"):t.format("TimeUnit_months_with_value",r);case"H":return 1===r?t.get("SettingsDataset_ScheduleRefresh_RefreshFrequency_OneHour"):t.format("TimeUnit_hours_with_value",r);case"D":return 1===r?t.get("TimeUnit_One_day"):t.format("TimeUnit_days_with_value",r);case"W":return 1===r?t.get("TimeUnit_One_week"):t.format("TimeUnit_weeks_with_value",r);case"Y":return 1===r?t.get("TimeUnit_One_year"):t.format("TimeUnit_years_with_value",r);default:return""}}})(powerbi=powerbi||{}),(function(y){var e,a,h,g,f,n;function o(i,a){if(!i||!a)return i||a;for(var n={expressions:a.expressions.slice(),cachedValueItems:_.isEmpty(a.cachedValueItems)?[]:a.cachedValueItems.slice()},o={},e=0;e<i.expressions.length;e++)!(function(e){var t=i.expressions[e],r=_.findIndex(n.expressions,(function(e){return e===t||f.equals(e,t)}));-1===r&&(r=a.expressions.length,n.expressions.push(t)),o[e]=r})(e);if(!_.isEmpty(i.cachedValueItems))for(var t=0,r=i.cachedValueItems;t<r.length;t++){var s,l=r[t],p={};for(s in l.valueMap)p[o[s]]=l.valueMap[s];n.cachedValueItems.push({identities:l.identities,valueMap:p})}return n}function s(e,t){if(!_.isEmpty(e)){for(var r={expressions:[],cachedValueItems:[]},i=0,a=e;i<a.length;i++){var n,o=a[i],s={identities:[],valueMap:{}};o.valueDetails||(n=h.getDataViewKind(t),o.valueDetails=h.query([t],o,n,[],!0));for(var l=0,p=o.valueDetails;l<p.length;l++){var u,c=p[l];c.expr&&(f.isColumn(c.expr)||f.isHierarchyLevel(c.expr))&&((u=_.indexOf(r.expressions,c.expr))<0&&(r.expressions.push(c.expr),u=r.expressions.length-1),s.valueMap[u]=c.formattedValue)}if(!_.isEmpty(s.valueMap)){for(var d in o.dataMap)for(var m=0,v=jsCommon.ArrayExtensions.ensureArray(o.dataMap[d]);m<v.length;m++){var y=v[m];1===y.kind&&s.identities.push(y)}r.cachedValueItems.push(s)}}return r}}function l(e,t){if(!_.isEmpty(e))return r(_.map(e,(function(e){return g.convertSelectorsByColumnToSelector(e)})),t)}function r(e,t){if(!_.isEmpty(e)&&t&&t.query)for(var r=t.query.defn.select(),i=0,a=e;i<a.length;i++){var n=a[i],n=g.toScopeIdentities(n);if(_.isEmpty(n))return;for(var o=0,s=n;o<s.length;o++)for(var l=s[o].expr,l=y.data.ScopeIdentityExtractor.getKeys(l),p=0,u=l;p<u.length;p++)for(var c=u[p],d=0,m=r;d<m.length;d++){var v=m[d];if(!f.equals(c,v.expr))return!0}}}e=y.explore||(y.explore={}),a=e.FilterExpressionMetadataUtils||(e.FilterExpressionMetadataUtils={}),h=y.data.DataViewQueryEngine,g=y.data.Selector,f=y.data.SQExpr,n=y.data.SQExprBuilder,a.getSelectorsByColumnMetadata=function(e,t,r,i){if(void 0===i&&(i=!1),!_.isEmpty(e)&&l(e,t))return _.some(e,(function(e){return e.valueDetails}))&&i?s(e,r):(t=h.getDataPointsDescription(r,e),a.convertToFilterExpressionMetadata(t))},a.mergeFilterExpressionMetadata=o,a.mergeFilterExpressionMetadataArray=function(e){for(var t=null,r=0,i=e;r<i.length;r++)t=o(i[r],t);return t},a.convertCacheToFilterExpressionMetadata=function(e,t){if(!_.isEmpty(t)&&e){for(var r=[],i=0,a=t;i<a.length;i++){var n=a[i],o={identities:[n.identity],valueMap:{}};o.valueMap[0]=n.displayName,r.push(o)}return{expressions:[e],cachedValueItems:r}}},a.hydrateSelectorsByColumnWithValueDetails=function(m,v){if(m.length&&v.cachedValueItems&&v.cachedValueItems.length)for(var e=0;e<m.length;e++)!(function(e){var t=m[e],o=t.dataMap,r=e,i=v.cachedValueItems[r].identities,a=!0,n=0;for(u in o)for(var s=0,l=jsCommon.ArrayExtensions.ensureArray(o[u]);s<l.length;s++){var p=l[s];if(!i[n]||!y.DataViewScopeIdentity.equals(p,i[n])){a=!1;break}n++}if((r=a?r:_.findIndex(v.cachedValueItems,(function(e){var t,r=0;for(t in o)for(var i=0,a=jsCommon.ArrayExtensions.ensureArray(o[t]);i<a.length;i++){var n=a[i];if(!e.identities[r]||!y.DataViewScopeIdentity.equals(n,e.identities[r]))return!1;r++}return!0})))<0)return;var u,c=[],d=v.cachedValueItems[r].valueMap;for(u in d)c.push({identity:v.cachedValueItems[r].identities[0],expr:v.expressions[u],formattedValue:d[u],value:d[u]});t.valueDetails=c})(e)},a.buildFilterExpressionMetadataFromSelectors=s,a.convertToFilterExpressionMetadata=function(e){if(!_.isEmpty(e)){for(var t={expressions:[],cachedValueItems:[]},r=0,i=e;r<i.length;r++){for(var a=i[r],n={identities:[],valueMap:{}},o=0,s=a.selector.data;o<s.length;o++){var l=s[o];1===l.kind&&n.identities.push(l)}for(var p=0,u=a.values;p<u.length;p++){var c,d=u[p];(d.expr instanceof y.data.SQColumnRefExpr||f.isHierarchyLevel(d.expr))&&((c=_.indexOf(t.expressions,d.expr))<0&&(t.expressions.push(d.expr),c=t.expressions.length-1),n.valueMap[c]=d.formattedValue)}_.isEmpty(n.valueMap)||t.cachedValueItems.push(n)}return t}},a.tryGetDisplayNameIdentityPairs=function(e){if(e&&!(_.isEmpty(e.expressions)||1<e.expressions.length)){for(var t=[],r=0,i=e.cachedValueItems;r<i.length;r++){var a=i[r];if(_.isEmpty(a.identities)||1<a.identities.length)return;a.valueMap[0];a={identity:a.identities[0],displayName:a.valueMap[0]};t.push(a)}return t}},a.hasGroupOnKeysByColumn=l,a.hasGroupOnKeys=r,a.isDecomposedFilterExpressionMetadata=function(e){return!!e.decomposedIdentities},a.isFilterExpressionMetadata=function(e){return!!e.cachedValueItems},a.makeIdentity=function(e,t){if(!e)return null;for(var r=0;r<e.length;r++)var i=n.equal(e[r],t[r]),a=a?n.and(a,i):i;return y.data.createDataViewScopeIdentity(a)}})(powerbi=powerbi||{}),(function(e){var r;function i(e,t){e=e&&parseFloat(e.replace(",","."));return(isNaN(e)?0:e)*t}e=(e=(e=e.explore||(e.explore={})).util||(e.util={})).DurationParser||(e.DurationParser={}),r=/^(-|\+)?P(?:([-+]?[0-9,.]*)Y)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)W)?(?:([-+]?[0-9,.]*)D)?(?:T(?:([-+]?[0-9,.]*)H)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)S)?)?$/,e.parseISODurationdString=function(e){return e=e,e=r.exec(e)||new Array(9),t="-"===e[1]?-1:1,{years:i(e[2],t),months:i(e[3],t),weeks:i(e[4],t),days:i(e[5],t),hours:i(e[6],t),minutes:i(e[7],t),seconds:i(e[8],t)};var t},e.durationParseResultAsMilliseconds=function(e){return 31536e6*e.years+2592e6*e.months+6048e5*e.weeks+864e5*e.days+36e5*e.hours+6e4*e.minutes+1e3*e.seconds},e.durationParseResultItemsToDurationParseResult=function(e){for(var t={years:0,months:0,weeks:0,days:0,hours:0,minutes:0,seconds:0},r=0,i=e;r<i.length;r++){var a=i[r],n=a.value;a.isTimeUnit&&"S"===a.unit?t.seconds=n:a.isTimeUnit&&"M"===a.unit?t.minutes=n:a.isTimeUnit&&"H"===a.unit?t.hours=n:"D"===a.unit?t.days=n:"W"===a.unit?t.weeks=n:"M"===a.unit?t.months=n:"Y"===a.unit&&(t.years=n)}return t},e.durationParseResultToISODurationString=function(e){var t="P";return 0<e.years&&(t+="".concat(e.years)+"Y"),0<e.months&&(t+="".concat(e.months)+"M"),0<e.weeks&&(t+="".concat(e.weeks)+"W"),0<e.days&&(t+="".concat(e.days)+"D"),0===e.hours&&0===e.minutes&&0===e.seconds||(t+="T",0<e.hours&&(t+="".concat(e.hours)+"H"),0<e.minutes&&(t+="".concat(e.minutes)+"M"),0<e.seconds&&(t+="".concat(e.seconds)+"S")),t},e.durationParseResultToArray=function(e){var t=[];return e.seconds&&t.push({value:e.seconds,unit:"S",isTimeUnit:!0}),e.minutes&&t.push({value:e.minutes,unit:"M",isTimeUnit:!0}),e.hours&&t.push({value:e.hours,unit:"H",isTimeUnit:!0}),e.days&&t.push({value:e.days,unit:"D",isTimeUnit:!1}),e.weeks&&t.push({value:e.weeks,unit:"W",isTimeUnit:!1}),e.months&&t.push({value:e.months,unit:"M",isTimeUnit:!1}),e.years&&t.push({value:e.years,unit:"Y",isTimeUnit:!1}),t}})(powerbi=powerbi||{}),(function(e){var i,t,a;function r(e){return!(null==(e=e.dynamicConfig)||!e.quickExplore)}i=e.explore||(e.explore={}),t=i.SectionUtils||(i.SectionUtils={}),a=e.explore.util.VisualContainerUtils,t.isQuickExploreSection=r,t.areAnySectionQuickExplore=function(e){return _.some(e,r)},t.getQuickExploreLayoutTelemetry=function(e){if(e=null==(e=null==(e=null==e?void 0:e.dynamicConfig)?void 0:e.quickExplore)?void 0:e.layout)return e.combination?"Combination.".concat(e.combination.version):e.related?"Related.".concat(e.related.version):void 0},t.setUniqueNewSectionCanvasItemNames=function(e,t){var r=_.flatMap(t,(function(e){return e.visualContainerGroups}));_.isEmpty(r)||i.contracts.traverseVisualContainerGroups(e.visualContainerGroups,(function(e){var t=a.uniqueName(r);e.name=t,r.push(e)}))}})(powerbi=powerbi||{});;
"use strict";var powerbi,__extends=this&&this.__extends||(function(){var n=function(e,t){return(n=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(e,t){e.__proto__=t}:function(e,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])}))(e,t)};return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function i(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}})(),__assign=this&&this.__assign||function(){return(__assign=Object.assign||function(e){for(var t,i=1,n=arguments.length;i<n;i++)for(var r in t=arguments[i])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e}).apply(this,arguments)},__awaiter=this&&this.__awaiter||function(e,o,s,l){return new(s=s||Promise)(function(i,t){function n(e){try{a(l.next(e))}catch(e){t(e)}}function r(e){try{a(l.throw(e))}catch(e){t(e)}}function a(e){var t;e.done?i(e.value):((t=e.value)instanceof s?t:new s(function(e){e(t)})).then(n,r)}a((l=l.apply(e,o||[])).next())})},__generator=this&&this.__generator||function(n,r){var a,o,s,l={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]},e={next:t(0),throw:t(1),return:t(2)};return"function"==typeof Symbol&&(e[Symbol.iterator]=function(){return this}),e;function t(i){return function(e){var t=[i,e];if(a)throw new TypeError("Generator is already executing.");for(;l;)try{if(a=1,o&&(s=2&t[0]?o.return:t[0]?o.throw||((s=o.return)&&s.call(o),0):o.next)&&!(s=s.call(o,t[1])).done)return s;switch(o=0,(t=s?[2&t[0],s.value]:t)[0]){case 0:case 1:s=t;break;case 4:return l.label++,{value:t[1],done:!1};case 5:l.label++,o=t[1],t=[0];continue;case 7:t=l.ops.pop(),l.trys.pop();continue;default:if(!(s=0<(s=l.trys).length&&s[s.length-1])&&(6===t[0]||2===t[0])){l=0;continue}if(3===t[0]&&(!s||t[1]>s[0]&&t[1]<s[3]))l.label=t[1];else if(6===t[0]&&l.label<s[1])l.label=s[1],s=t;else{if(!(s&&l.label<s[2])){s[2]&&l.ops.pop(),l.trys.pop();continue}l.label=s[2],l.ops.push(t)}}t=r.call(n,l)}catch(e){t=[6,e],o=0}finally{a=s=0}if(5&t[0])throw t[1];return{value:t[0]?t[1]:void 0,done:!0}}}},__spreadArray=this&&this.__spreadArray||function(e,t,i){if(i||2===arguments.length)for(var n,r=0,a=t.length;r<a;r++)!n&&r in t||((n=n||Array.prototype.slice.call(t,0,r))[r]=t[r]);return e.concat(n||Array.prototype.slice.call(t))};!(function(t){var i;(i=t.telemetry||(t.telemetry={})).EXNewExplorationEventName="PBI.EX.NewExploration",i.EXNewExploration=window.updatedTelemetryFunction?t.generateTelemetryEvent(i.EXNewExplorationEventName):i.EventFactories[i.EXNewExplorationEventName]=function(e){return t.telemetryEventFactory({name:i.EXNewExplorationEventName,info:e})},i.EXRefreshReportEventName="PBI.EX.RefreshReport",i.EXRefreshReport=window.updatedTelemetryFunction?t.generateTelemetryEvent(i.EXRefreshReportEventName):i.EventFactories[i.EXRefreshReportEventName]=function(e){return t.telemetryEventFactory({name:i.EXRefreshReportEventName,info:e})},i.EXSaveExplorationEventName="PBI.EX.SaveExploration",i.EXSaveExploration=window.updatedTelemetryFunction?t.generateTelemetryEvent(i.EXSaveExplorationEventName):i.EventFactories[i.EXSaveExplorationEventName]=function(e){return t.telemetryEventFactory({name:i.EXSaveExplorationEventName,info:e})},i.EXInteractionVisualConversionEventName="PBI.EX.InteractionVisualConversion",i.EXInteractionVisualConversion=window.updatedTelemetryFunction?t.generateTelemetryEvent(i.EXInteractionVisualConversionEventName):i.EventFactories[i.EXInteractionVisualConversionEventName]=function(e){return t.telemetryEventFactory({name:i.EXInteractionVisualConversionEventName,info:e})},i.EXInteractionExpandEventName="PBI.EX.InteractionExpand",i.EXInteractionExpand=window.updatedTelemetryFunction?t.generateTelemetryEvent(i.EXInteractionExpandEventName,{logExpAssignment:!0}):i.EventFactories[i.EXInteractionExpandEventName]=function(e){return t.telemetryEventFactory({name:i.EXInteractionExpandEventName,info:e,logExpAssignment:!0})},i.EXInteractionDrillEventName="PBI.EX.InteractionDrill",i.EXInteractionDrill=window.updatedTelemetryFunction?t.generateTelemetryEvent(i.EXInteractionDrillEventName,{logExpAssignment:!0}):i.EventFactories[i.EXInteractionDrillEventName]=function(e){return t.telemetryEventFactory({name:i.EXInteractionDrillEventName,info:e,logExpAssignment:!0})},i.EXDrillToDetailsEventName="PBI.EX.DrillToDetails",i.EXDrillToDetails=window.updatedTelemetryFunction?t.generateTelemetryEvent(i.EXDrillToDetailsEventName,{logExpAssignment:!0}):i.EventFactories[i.EXDrillToDetailsEventName]=function(e){return t.telemetryEventFactory({name:i.EXDrillToDetailsEventName,info:e,logExpAssignment:!0})},i.EXAddFilterEventName="PBI.EX.AddFilter",i.EXAddFilter=window.updatedTelemetryFunction?t.generateTelemetryEvent(i.EXAddFilterEventName):i.EventFactories[i.EXAddFilterEventName]=function(e){return t.telemetryEventFactory({name:i.EXAddFilterEventName,info:e})},i.EXClearFilterEventName="PBI.EX.ClearFilter",i.EXClearFilter=window.updatedTelemetryFunction?t.generateTelemetryEvent(i.EXClearFilterEventName,{logExpAssignment:!0}):i.EventFactories[i.EXClearFilterEventName]=function(e){return t.telemetryEventFactory({name:i.EXClearFilterEventName,info:e,logExpAssignment:!0})},i.EXRemoveFilterEventName="PBI.EX.RemoveFilter",i.EXRemoveFilter=window.updatedTelemetryFunction?t.generateTelemetryEvent(i.EXRemoveFilterEventName):i.EventFactories[i.EXRemoveFilterEventName]=function(e){return t.telemetryEventFactory({name:i.EXRemoveFilterEventName,info:e})},i.EXHideFilterEventName="PBI.EX.HideFilter",i.EXHideFilter=window.updatedTelemetryFunction?t.generateTelemetryEvent(i.EXHideFilterEventName):i.EventFactories[i.EXHideFilterEventName]=function(e){return t.telemetryEventFactory({name:i.EXHideFilterEventName,info:e})},i.EXLockFilterEventName="PBI.EX.LockFilter",i.EXLockFilter=window.updatedTelemetryFunction?t.generateTelemetryEvent(i.EXLockFilterEventName):i.EventFactories[i.EXLockFilterEventName]=function(e){return t.telemetryEventFactory({name:i.EXLockFilterEventName,info:e})},i.EXTogglePaneExpandedEventName="PBI.EX.TogglePaneExpanded",i.EXTogglePaneExpanded=window.updatedTelemetryFunction?t.generateTelemetryEvent(i.EXTogglePaneExpandedEventName):i.EventFactories[i.EXTogglePaneExpandedEventName]=function(e){return t.telemetryEventFactory({name:i.EXTogglePaneExpandedEventName,info:e})},i.EXToggleFilterCardExpandedEventName="PBI.EX.ToggleFilterCardExpanded",i.EXToggleFilterCardExpanded=window.updatedTelemetryFunction?t.generateTelemetryEvent(i.EXToggleFilterCardExpandedEventName):i.EventFactories[i.EXToggleFilterCardExpandedEventName]=function(e){return t.telemetryEventFactory({name:i.EXToggleFilterCardExpandedEventName,info:e})},i.EXToggleFilterCardSortEventName="PBI.EX.ToggleFilterCardSort",i.EXToggleFilterCardSort=window.updatedTelemetryFunction?t.generateTelemetryEvent(i.EXToggleFilterCardSortEventName):i.EventFactories[i.EXToggleFilterCardSortEventName]=function(e){return t.telemetryEventFactory({name:i.EXToggleFilterCardSortEventName,info:e})},i.EXFilterPaneAdvancedFilterAppliedEventName="PBI.EX.FilterPaneAdvancedFilterApplied",i.EXFilterPaneAdvancedFilterApplied=window.updatedTelemetryFunction?t.generateTelemetryEvent(i.EXFilterPaneAdvancedFilterAppliedEventName):i.EventFactories[i.EXFilterPaneAdvancedFilterAppliedEventName]=function(e){return t.telemetryEventFactory({name:i.EXFilterPaneAdvancedFilterAppliedEventName,info:e})},i.EXFilterPaneTopNFilterAppliedEventName="PBI.EX.FilterPaneTopNFilterApplied",i.EXFilterPaneTopNFilterApplied=window.updatedTelemetryFunction?t.generateTelemetryEvent(i.EXFilterPaneTopNFilterAppliedEventName):i.EventFactories[i.EXFilterPaneTopNFilterAppliedEventName]=function(e){return t.telemetryEventFactory({name:i.EXFilterPaneTopNFilterAppliedEventName,info:e})},i.EXFilterPaneRelativeDateFilterAppliedEventName="PBI.EX.FilterPaneRelativeDateFilterApplied",i.EXFilterPaneRelativeDateFilterApplied=window.updatedTelemetryFunction?t.generateTelemetryEvent(i.EXFilterPaneRelativeDateFilterAppliedEventName):i.EventFactories[i.EXFilterPaneRelativeDateFilterAppliedEventName]=function(e){return t.telemetryEventFactory({name:i.EXFilterPaneRelativeDateFilterAppliedEventName,info:e})},i.EXFilterPaneRelativeTimeFilterAppliedEventName="PBI.EX.FilterPaneRelativeTimeFilterApplied",i.EXFilterPaneRelativeTimeFilterApplied=window.updatedTelemetryFunction?t.generateTelemetryEvent(i.EXFilterPaneRelativeTimeFilterAppliedEventName):i.EventFactories[i.EXFilterPaneRelativeTimeFilterAppliedEventName]=function(e){return t.telemetryEventFactory({name:i.EXFilterPaneRelativeTimeFilterAppliedEventName,info:e})},i.EXFilterPaneBasicFilterChangedEventName="PBI.EX.FilterPaneBasicFilterChanged",i.EXFilterPaneBasicFilterChanged=window.updatedTelemetryFunction?t.generateTelemetryEvent(i.EXFilterPaneBasicFilterChangedEventName,{logExpAssignment:!0}):i.EventFactories[i.EXFilterPaneBasicFilterChangedEventName]=function(e){return t.telemetryEventFactory({name:i.EXFilterPaneBasicFilterChangedEventName,info:e,logExpAssignment:!0})},i.EXFilterPaneFilterDefaultRestoredEventName="PBI.EX.FilterPaneFilterDefaultRestored",i.EXFilterPaneFilterDefaultRestored=window.updatedTelemetryFunction?t.generateTelemetryEvent(i.EXFilterPaneFilterDefaultRestoredEventName):i.EventFactories[i.EXFilterPaneFilterDefaultRestoredEventName]=function(e){return t.telemetryEventFactory({name:i.EXFilterPaneFilterDefaultRestoredEventName,info:e})},i.EXFilterPaneFilterClearedEventName="PBI.EX.FilterPaneFilterCleared",i.EXFilterPaneFilterCleared=window.updatedTelemetryFunction?t.generateTelemetryEvent(i.EXFilterPaneFilterClearedEventName,{logExpAssignment:!0}):i.EventFactories[i.EXFilterPaneFilterClearedEventName]=function(e){return t.telemetryEventFactory({name:i.EXFilterPaneFilterClearedEventName,info:e,logExpAssignment:!0})},i.EXFilterPaneFilterDeletedEventName="PBI.EX.FilterPaneFilterDeleted",i.EXFilterPaneFilterDeleted=window.updatedTelemetryFunction?t.generateTelemetryEvent(i.EXFilterPaneFilterDeletedEventName):i.EventFactories[i.EXFilterPaneFilterDeletedEventName]=function(e){return t.telemetryEventFactory({name:i.EXFilterPaneFilterDeletedEventName,info:e})},i.EXFilterPaneInteractionEventName="PBI.EX.FilterPaneInteraction",i.EXFilterPaneInteraction=window.updatedTelemetryFunction?t.generateTelemetryEvent(i.EXFilterPaneInteractionEventName,{logExpAssignment:!0}):i.EventFactories[i.EXFilterPaneInteractionEventName]=function(e){return t.telemetryEventFactory({name:i.EXFilterPaneInteractionEventName,info:e,logExpAssignment:!0})},i.EXImprovedFilterExperienceToggleOutspacePaneExpansionEventName="PBI.EX.ImprovedFilterExperience.ToggleOutspacePaneExpansion",i.EXImprovedFilterExperienceToggleOutspacePaneExpansion=window.updatedTelemetryFunction?t.generateTelemetryEvent(i.EXImprovedFilterExperienceToggleOutspacePaneExpansionEventName,{logExpAssignment:!0}):i.EventFactories[i.EXImprovedFilterExperienceToggleOutspacePaneExpansionEventName]=function(e){return t.telemetryEventFactory({name:i.EXImprovedFilterExperienceToggleOutspacePaneExpansionEventName,info:e,logExpAssignment:!0})},i.EXImprovedFilterExperienceToggleOutspacePaneVisibilityEventName="PBI.EX.ImprovedFilterExperience.ToggleOutspacePaneVisibility",i.EXImprovedFilterExperienceToggleOutspacePaneVisibility=window.updatedTelemetryFunction?t.generateTelemetryEvent(i.EXImprovedFilterExperienceToggleOutspacePaneVisibilityEventName):i.EventFactories[i.EXImprovedFilterExperienceToggleOutspacePaneVisibilityEventName]=function(e){return t.telemetryEventFactory({name:i.EXImprovedFilterExperienceToggleOutspacePaneVisibilityEventName,info:e})},i.EXImprovedFilterExperienceShowRestatementEventName="PBI.EX.ImprovedFilterExperience.ShowRestatement",i.EXImprovedFilterExperienceShowRestatement=window.updatedTelemetryFunction?t.generateTelemetryEvent(i.EXImprovedFilterExperienceShowRestatementEventName,{logExpAssignment:!0}):i.EventFactories[i.EXImprovedFilterExperienceShowRestatementEventName]=function(e){return t.telemetryEventFactory({name:i.EXImprovedFilterExperienceShowRestatementEventName,info:e,logExpAssignment:!0})},i.EXLoadFilterErrorEventName="PBI.EX.LoadFilterError",i.EXLoadFilterError=window.updatedTelemetryFunction?t.generateTelemetryEvent(i.EXLoadFilterErrorEventName):i.EventFactories[i.EXLoadFilterErrorEventName]=function(e){return t.telemetryEventFactory({name:i.EXLoadFilterErrorEventName,info:e})},i.EXCreateVisualEventName="PBI.EX.CreateVisual",i.EXCreateVisual=window.updatedTelemetryFunction?t.generateTelemetryEvent(i.EXCreateVisualEventName,{logExpAssignment:!0}):i.EventFactories[i.EXCreateVisualEventName]=function(e){return t.telemetryEventFactory({name:i.EXCreateVisualEventName,info:e,logExpAssignment:!0})},i.EXAddFieldEventName="PBI.EX.AddField",i.EXAddField=window.updatedTelemetryFunction?t.generateTelemetryEvent(i.EXAddFieldEventName):i.EventFactories[i.EXAddFieldEventName]=function(e){return t.telemetryEventFactory({name:i.EXAddFieldEventName,info:e})},i.EXResolveParametersEventName="PBI.EX.ResolveParameters",i.EXResolveParameters=window.updatedTelemetryFunction?t.generateTelemetryEvent(i.EXResolveParametersEventName,{logRatio:.001}):i.EventFactories[i.EXResolveParametersEventName]=function(e){return t.telemetryEventFactory({name:i.EXResolveParametersEventName,info:e,logRatio:.001})},i.EXSwitchQueryParameterEventName="PBI.EX.SwitchQueryParameter",i.EXSwitchQueryParameter=window.updatedTelemetryFunction?t.generateTelemetryEvent(i.EXSwitchQueryParameterEventName):i.EventFactories[i.EXSwitchQueryParameterEventName]=function(e){return t.telemetryEventFactory({name:i.EXSwitchQueryParameterEventName,info:e})},i.EXChangeQuickCalcEventName="PBI.EX.ChangeQuickCalc",i.EXChangeQuickCalc=window.updatedTelemetryFunction?t.generateTelemetryEvent(i.EXChangeQuickCalcEventName):i.EventFactories[i.EXChangeQuickCalcEventName]=function(e){return t.telemetryEventFactory({name:i.EXChangeQuickCalcEventName,info:e})},i.EXSetConditionalFormattingEventName="PBI.EX.SetConditionalFormatting",i.EXSetConditionalFormatting=window.updatedTelemetryFunction?t.generateTelemetryEvent(i.EXSetConditionalFormattingEventName):i.EventFactories[i.EXSetConditionalFormattingEventName]=function(e){return t.telemetryEventFactory({name:i.EXSetConditionalFormattingEventName,info:e})},i.EXSetDataBarsEventName="PBI.EX.SetDataBars",i.EXSetDataBars=window.updatedTelemetryFunction?t.generateTelemetryEvent(i.EXSetDataBarsEventName):i.EventFactories[i.EXSetDataBarsEventName]=function(e){return t.telemetryEventFactory({name:i.EXSetDataBarsEventName,info:e})},i.EXExplorationRefreshEventName="PBI.EX.ExplorationRefresh",i.EXExplorationRefresh=window.updatedTelemetryFunction?t.generateTelemetryEvent(i.EXExplorationRefreshEventName):i.EventFactories[i.EXExplorationRefreshEventName]=function(e){return t.telemetryEventFactory({name:i.EXExplorationRefreshEventName,info:e})},i.EXSnapshotEmbedCreateEventName="PBI.EX.SnapshotEmbedCreate",i.EXSnapshotEmbedCreate=window.updatedTelemetryFunction?t.generateTelemetryEvent(i.EXSnapshotEmbedCreateEventName):i.EventFactories[i.EXSnapshotEmbedCreateEventName]=function(e){return t.telemetryEventFactory({name:i.EXSnapshotEmbedCreateEventName,info:e})},i.EXPublicEmbedCreateEventName="PBI.EX.PublicEmbedCreate",i.EXPublicEmbedCreate=window.updatedTelemetryFunction?t.generateTelemetryEvent(i.EXPublicEmbedCreateEventName):i.EventFactories[i.EXPublicEmbedCreateEventName]=function(e){return t.telemetryEventFactory({name:i.EXPublicEmbedCreateEventName,info:e})},i.EXSnapshotEmbedDeleteEventName="PBI.EX.SnapshotEmbedDelete",i.EXSnapshotEmbedDelete=window.updatedTelemetryFunction?t.generateTelemetryEvent(i.EXSnapshotEmbedDeleteEventName):i.EventFactories[i.EXSnapshotEmbedDeleteEventName]=function(e){return t.telemetryEventFactory({name:i.EXSnapshotEmbedDeleteEventName,info:e})},i.EXSnapshotEmbedUpdateEventName="PBI.EX.SnapshotEmbedUpdate",i.EXSnapshotEmbedUpdate=window.updatedTelemetryFunction?t.generateTelemetryEvent(i.EXSnapshotEmbedUpdateEventName):i.EventFactories[i.EXSnapshotEmbedUpdateEventName]=function(e){return t.telemetryEventFactory({name:i.EXSnapshotEmbedUpdateEventName,info:e})},i.EXImportCustomVizEventName="PBI.EX.ImportCustomViz",i.EXImportCustomViz=window.updatedTelemetryFunction?t.generateTelemetryEvent(i.EXImportCustomVizEventName):i.EventFactories[i.EXImportCustomVizEventName]=function(e){return t.telemetryEventFactory({name:i.EXImportCustomVizEventName,info:e})},i.EXCdnVisualOverrideEventName="PBI.EX.CdnVisualOverride",i.EXCdnVisualOverride=window.updatedTelemetryFunction?t.generateTelemetryEvent(i.EXCdnVisualOverrideEventName):i.EventFactories[i.EXCdnVisualOverrideEventName]=function(e){return t.telemetryEventFactory({name:i.EXCdnVisualOverrideEventName,info:e})},i.EXDeleteCustomVizEventName="PBI.EX.DeleteCustomViz",i.EXDeleteCustomViz=window.updatedTelemetryFunction?t.generateTelemetryEvent(i.EXDeleteCustomVizEventName):i.EventFactories[i.EXDeleteCustomVizEventName]=function(e){return t.telemetryEventFactory({name:i.EXDeleteCustomVizEventName,info:e})},i.EXEnableCustomVizEventName="PBI.EX.EnableCustomViz",i.EXEnableCustomViz=window.updatedTelemetryFunction?t.generateTelemetryEvent(i.EXEnableCustomVizEventName):i.EventFactories[i.EXEnableCustomVizEventName]=function(e){return t.telemetryEventFactory({name:i.EXEnableCustomVizEventName,info:e})},i.EXVisualRelationshipOverrideEventName="PBI.EX.VisualRelationshipOverride",i.EXVisualRelationshipOverride=window.updatedTelemetryFunction?t.generateTelemetryEvent(i.EXVisualRelationshipOverrideEventName):i.EventFactories[i.EXVisualRelationshipOverrideEventName]=function(e){return t.telemetryEventFactory({name:i.EXVisualRelationshipOverrideEventName,info:e})},i.EXCodePaneUserRunScriptEventName="PBI.EX.CodePaneUserRunScript",i.EXCodePaneUserRunScript=window.updatedTelemetryFunction?t.generateTelemetryEvent(i.EXCodePaneUserRunScriptEventName):i.EventFactories[i.EXCodePaneUserRunScriptEventName]=function(e){return t.telemetryEventFactory({name:i.EXCodePaneUserRunScriptEventName,info:e})},i.EXCodePaneUserEditScriptWithExternalIDEEventName="PBI.EX.CodePaneUserEditScriptWithExternalIDE",i.EXCodePaneUserEditScriptWithExternalIDE=window.updatedTelemetryFunction?t.generateTelemetryEvent(i.EXCodePaneUserEditScriptWithExternalIDEEventName):i.EventFactories[i.EXCodePaneUserEditScriptWithExternalIDEEventName]=function(e){return t.telemetryEventFactory({name:i.EXCodePaneUserEditScriptWithExternalIDEEventName,info:e})},i.EXCodePaneUserOpenOptionsDialogEventName="PBI.EX.CodePaneUserOpenOptionsDialog",i.EXCodePaneUserOpenOptionsDialog=window.updatedTelemetryFunction?t.generateTelemetryEvent(i.EXCodePaneUserOpenOptionsDialogEventName):i.EventFactories[i.EXCodePaneUserOpenOptionsDialogEventName]=function(e){return t.telemetryEventFactory({name:i.EXCodePaneUserOpenOptionsDialogEventName,info:e})},i.EXCodePaneLaunchExternalIDEFailedEventName="PBI.EX.CodePaneLaunchExternalIDEFailed",i.EXCodePaneLaunchExternalIDEFailed=window.updatedTelemetryFunction?t.generateTelemetryEvent(i.EXCodePaneLaunchExternalIDEFailedEventName):i.EventFactories[i.EXCodePaneLaunchExternalIDEFailedEventName]=function(e){return t.telemetryEventFactory({name:i.EXCodePaneLaunchExternalIDEFailedEventName,info:e})},i.EXCodePaneLaunchExternalIDESucceededEventName="PBI.EX.CodePaneLaunchExternalIDESucceeded",i.EXCodePaneLaunchExternalIDESucceeded=window.updatedTelemetryFunction?t.generateTelemetryEvent(i.EXCodePaneLaunchExternalIDESucceededEventName):i.EventFactories[i.EXCodePaneLaunchExternalIDESucceededEventName]=function(e){return t.telemetryEventFactory({name:i.EXCodePaneLaunchExternalIDESucceededEventName,info:e})},i.EXCodePaneShowWarningEventName="PBI.EX.CodePaneShowWarning",i.EXCodePaneShowWarning=window.updatedTelemetryFunction?t.generateTelemetryEvent(i.EXCodePaneShowWarningEventName):i.EventFactories[i.EXCodePaneShowWarningEventName]=function(e){return t.telemetryEventFactory({name:i.EXCodePaneShowWarningEventName,info:e})},i.EXExportVisualDataEventName="PBI.EX.ExportVisualData",i.EXExportVisualData=window.updatedTelemetryFunction?t.generateTelemetryEvent(i.EXExportVisualDataEventName,{logExpAssignment:!0}):i.EventFactories[i.EXExportVisualDataEventName]=function(e){return t.telemetryEventFactory({name:i.EXExportVisualDataEventName,info:e,logExpAssignment:!0})},i.EXLoadReportWithScriptVisEventName="PBI.EX.LoadReportWithScriptVis",i.EXLoadReportWithScriptVis=window.updatedTelemetryFunction?t.generateTelemetryEvent(i.EXLoadReportWithScriptVisEventName):i.EventFactories[i.EXLoadReportWithScriptVisEventName]=function(e){return t.telemetryEventFactory({name:i.EXLoadReportWithScriptVisEventName,info:e})},i.ExploreHostChangeReportPageEventName="PBI.ExploreHost.ChangeReportPage",i.ExploreHostChangeReportPage=window.updatedTelemetryFunction?t.generateTelemetryEvent(i.ExploreHostChangeReportPageEventName):i.EventFactories[i.ExploreHostChangeReportPageEventName]=function(e){return t.telemetryEventFactory({name:i.ExploreHostChangeReportPageEventName,info:e})},i.EXRemoveMobileCanvasVisualsEventName="PBI.EX.RemoveMobileCanvasVisuals",i.EXRemoveMobileCanvasVisuals=window.updatedTelemetryFunction?t.generateTelemetryEvent(i.EXRemoveMobileCanvasVisualsEventName):i.EventFactories[i.EXRemoveMobileCanvasVisualsEventName]=function(e){return t.telemetryEventFactory({name:i.EXRemoveMobileCanvasVisualsEventName,info:e})},i.EXLoadReportContainerEventName="PBI.EX.LoadReportContainer",i.EXLoadReportContainer=window.updatedTelemetryFunction?t.generateTelemetryEvent(i.EXLoadReportContainerEventName):i.EventFactories[i.EXLoadReportContainerEventName]=function(e){return t.telemetryEventFactory({name:i.EXLoadReportContainerEventName,info:e})},i.EXLoadReportContainerDatasetMissingEventName="PBI.EX.LoadReportContainerDatasetMissing",i.EXLoadReportContainerDatasetMissing=window.updatedTelemetryFunction?t.generateTelemetryEvent(i.EXLoadReportContainerDatasetMissingEventName):i.EventFactories[i.EXLoadReportContainerDatasetMissingEventName]=function(e){return t.telemetryEventFactory({name:i.EXLoadReportContainerDatasetMissingEventName,info:e})},i.EXInitExplorationEventName="PBI.EX.InitExploration",i.EXInitExploration=window.updatedTelemetryFunction?t.generateTelemetryEvent(i.EXInitExplorationEventName):i.EventFactories[i.EXInitExplorationEventName]=function(e){return t.telemetryEventFactory({name:i.EXInitExplorationEventName,info:e})},i.EXLoadExplorationVisualsEventName="PBI.EX.LoadExplorationVisuals",i.EXLoadExplorationVisuals=window.updatedTelemetryFunction?t.generateTelemetryEvent(i.EXLoadExplorationVisualsEventName,{defaultTimeoutSec:60,logExpAssignment:!0}):i.EventFactories[i.EXLoadExplorationVisualsEventName]=function(e){return t.telemetryEventFactory({name:i.EXLoadExplorationVisualsEventName,info:e,defaultTimeoutSec:60,logExpAssignment:!0})},i.EXVisualContainerChangedEventName="PBI.EX.VisualContainerChanged",i.EXVisualContainerChanged=window.updatedTelemetryFunction?t.generateTelemetryEvent(i.EXVisualContainerChangedEventName,{logRatio:0}):i.EventFactories[i.EXVisualContainerChangedEventName]=function(e){return t.telemetryEventFactory({name:i.EXVisualContainerChangedEventName,info:e,logRatio:0})},i.EXRenderExplorationVisualEventName="PBI.EX.RenderExplorationVisual",i.EXRenderExplorationVisual=window.updatedTelemetryFunction?t.generateTelemetryEvent(i.EXRenderExplorationVisualEventName,{logRatio:.01}):i.EventFactories[i.EXRenderExplorationVisualEventName]=function(e){return t.telemetryEventFactory({name:i.EXRenderExplorationVisualEventName,info:e,logRatio:.01})},i.EXFetchExplorationEventName="PBI.EX.FetchExploration",i.EXFetchExploration=window.updatedTelemetryFunction?t.generateTelemetryEvent(i.EXFetchExplorationEventName):i.EventFactories[i.EXFetchExplorationEventName]=function(e){return t.telemetryEventFactory({name:i.EXFetchExplorationEventName,info:e})},i.EXChangeCanvasLayoutEventName="PBI.EX.ChangeCanvasLayout",i.EXChangeCanvasLayout=window.updatedTelemetryFunction?t.generateTelemetryEvent(i.EXChangeCanvasLayoutEventName):i.EventFactories[i.EXChangeCanvasLayoutEventName]=function(e){return t.telemetryEventFactory({name:i.EXChangeCanvasLayoutEventName,info:e})},i.EXClusteringAddClusteringEventName="PBI.EX.Clustering.AddClustering",i.EXClusteringAddClustering=window.updatedTelemetryFunction?t.generateTelemetryEvent(i.EXClusteringAddClusteringEventName):i.EventFactories[i.EXClusteringAddClusteringEventName]=function(e){return t.telemetryEventFactory({name:i.EXClusteringAddClusteringEventName,info:e})},i.EXClusteringEditClusteringEventName="PBI.EX.Clustering.EditClustering",i.EXClusteringEditClustering=window.updatedTelemetryFunction?t.generateTelemetryEvent(i.EXClusteringEditClusteringEventName):i.EventFactories[i.EXClusteringEditClusteringEventName]=function(e){return t.telemetryEventFactory({name:i.EXClusteringEditClusteringEventName,info:e})},i.EXQuickMeasuresOpenDialogEventName="PBI.EX.QuickMeasures.OpenDialog",i.EXQuickMeasuresOpenDialog=window.updatedTelemetryFunction?t.generateTelemetryEvent(i.EXQuickMeasuresOpenDialogEventName):i.EventFactories[i.EXQuickMeasuresOpenDialogEventName]=function(e){return t.telemetryEventFactory({name:i.EXQuickMeasuresOpenDialogEventName,info:e})},i.EXQuickMeasuresDialogResultEventName="PBI.EX.QuickMeasures.DialogResult",i.EXQuickMeasuresDialogResult=window.updatedTelemetryFunction?t.generateTelemetryEvent(i.EXQuickMeasuresDialogResultEventName):i.EventFactories[i.EXQuickMeasuresDialogResultEventName]=function(e){return t.telemetryEventFactory({name:i.EXQuickMeasuresDialogResultEventName,info:e})},i.EXQuickMeasuresOnMeasureChangeEventName="PBI.EX.QuickMeasures.OnMeasureChange",i.EXQuickMeasuresOnMeasureChange=window.updatedTelemetryFunction?t.generateTelemetryEvent(i.EXQuickMeasuresOnMeasureChangeEventName):i.EventFactories[i.EXQuickMeasuresOnMeasureChangeEventName]=function(e){return t.telemetryEventFactory({name:i.EXQuickMeasuresOnMeasureChangeEventName,info:e})},i.EXDrillthroughGotoTargetEventName="PBI.EX.Drillthrough.GotoTarget",i.EXDrillthroughGotoTarget=window.updatedTelemetryFunction?t.generateTelemetryEvent(i.EXDrillthroughGotoTargetEventName,{logExpAssignment:!0}):i.EventFactories[i.EXDrillthroughGotoTargetEventName]=function(e){return t.telemetryEventFactory({name:i.EXDrillthroughGotoTargetEventName,info:e,logExpAssignment:!0})},i.EXDrillthroughFilterUpdateEventName="PBI.EX.Drillthrough.FilterUpdate",i.EXDrillthroughFilterUpdate=window.updatedTelemetryFunction?t.generateTelemetryEvent(i.EXDrillthroughFilterUpdateEventName):i.EventFactories[i.EXDrillthroughFilterUpdateEventName]=function(e){return t.telemetryEventFactory({name:i.EXDrillthroughFilterUpdateEventName,info:e})},i.EXRefreshHostDataEventName="PBI.EX.RefreshHostData",i.EXRefreshHostData=window.updatedTelemetryFunction?t.generateTelemetryEvent(i.EXRefreshHostDataEventName):i.EventFactories[i.EXRefreshHostDataEventName]=function(e){return t.telemetryEventFactory({name:i.EXRefreshHostDataEventName,info:e})},i.EXBookmarkAddEventName="PBI.EX.BookmarkAdd",i.EXBookmarkAdd=window.updatedTelemetryFunction?t.generateTelemetryEvent(i.EXBookmarkAddEventName):i.EventFactories[i.EXBookmarkAddEventName]=function(e){return t.telemetryEventFactory({name:i.EXBookmarkAddEventName,info:e})},i.EXBookmarkUpdateEventName="PBI.EX.BookmarkUpdate",i.EXBookmarkUpdate=window.updatedTelemetryFunction?t.generateTelemetryEvent(i.EXBookmarkUpdateEventName):i.EventFactories[i.EXBookmarkUpdateEventName]=function(e){return t.telemetryEventFactory({name:i.EXBookmarkUpdateEventName,info:e})},i.EXBookmarkDeleteEventName="PBI.EX.BookmarkDelete",i.EXBookmarkDelete=window.updatedTelemetryFunction?t.generateTelemetryEvent(i.EXBookmarkDeleteEventName):i.EventFactories[i.EXBookmarkDeleteEventName]=function(e){return t.telemetryEventFactory({name:i.EXBookmarkDeleteEventName,info:e})},i.EXBookmarkPlayEventName="PBI.EX.BookmarkPlay",i.EXBookmarkPlay=window.updatedTelemetryFunction?t.generateTelemetryEvent(i.EXBookmarkPlayEventName):i.EventFactories[i.EXBookmarkPlayEventName]=function(e){return t.telemetryEventFactory({name:i.EXBookmarkPlayEventName,info:e})},i.EXBookmarkApplyEventName="PBI.EX.BookmarkApply",i.EXBookmarkApply=window.updatedTelemetryFunction?t.generateTelemetryEvent(i.EXBookmarkApplyEventName):i.EventFactories[i.EXBookmarkApplyEventName]=function(e){return t.telemetryEventFactory({name:i.EXBookmarkApplyEventName,info:e})},i.EXBookmarkLoadErrorEventName="PBI.EX.Bookmark.LoadError",i.EXBookmarkLoadError=window.updatedTelemetryFunction?t.generateTelemetryEvent(i.EXBookmarkLoadErrorEventName):i.EventFactories[i.EXBookmarkLoadErrorEventName]=function(e){return t.telemetryEventFactory({name:i.EXBookmarkLoadErrorEventName,info:e})},i.EXCopyPasteSyncGroupEventName="PBI.EX.CopyPasteSyncGroup",i.EXCopyPasteSyncGroup=window.updatedTelemetryFunction?t.generateTelemetryEvent(i.EXCopyPasteSyncGroupEventName):i.EventFactories[i.EXCopyPasteSyncGroupEventName]=function(e){return t.telemetryEventFactory({name:i.EXCopyPasteSyncGroupEventName,info:e})},i.EXCustomDateTableOpenDialogEventName="PBI.EX.CustomDateTableOpenDialog",i.EXCustomDateTableOpenDialog=window.updatedTelemetryFunction?t.generateTelemetryEvent(i.EXCustomDateTableOpenDialogEventName):i.EventFactories[i.EXCustomDateTableOpenDialogEventName]=function(e){return t.telemetryEventFactory({name:i.EXCustomDateTableOpenDialogEventName,info:e})},i.EXCustomDateTableCommitEventName="PBI.EX.CustomDateTableCommit",i.EXCustomDateTableCommit=window.updatedTelemetryFunction?t.generateTelemetryEvent(i.EXCustomDateTableCommitEventName):i.EventFactories[i.EXCustomDateTableCommitEventName]=function(e){return t.telemetryEventFactory({name:i.EXCustomDateTableCommitEventName,info:e})},i.EXCustomDateTableValidationResultEventName="PBI.EX.CustomDateTableValidationResult",i.EXCustomDateTableValidationResult=window.updatedTelemetryFunction?t.generateTelemetryEvent(i.EXCustomDateTableValidationResultEventName):i.EventFactories[i.EXCustomDateTableValidationResultEventName]=function(e){return t.telemetryEventFactory({name:i.EXCustomDateTableValidationResultEventName,info:e})},i.EXUpdateActiveSectionEventName="PBI.EX.UpdateActiveSection",i.EXUpdateActiveSection=window.updatedTelemetryFunction?t.generateTelemetryEvent(i.EXUpdateActiveSectionEventName,{defaultTimeoutSec:10}):i.EventFactories[i.EXUpdateActiveSectionEventName]=function(e){return t.telemetryEventFactory({name:i.EXUpdateActiveSectionEventName,info:e,defaultTimeoutSec:10})},i.EXVisualContainerApplyUpdateEventName="PBI.EX.VisualContainerApplyUpdate",i.EXVisualContainerApplyUpdate=window.updatedTelemetryFunction?t.generateTelemetryEvent(i.EXVisualContainerApplyUpdateEventName,{logRatio:0}):i.EventFactories[i.EXVisualContainerApplyUpdateEventName]=function(e){return t.telemetryEventFactory({name:i.EXVisualContainerApplyUpdateEventName,info:e,logRatio:0})},i.EXVisualDataChangedEventName="PBI.EX.VisualDataChanged",i.EXVisualDataChanged=window.updatedTelemetryFunction?t.generateTelemetryEvent(i.EXVisualDataChangedEventName,{logRatio:0}):i.EventFactories[i.EXVisualDataChangedEventName]=function(e){return t.telemetryEventFactory({name:i.EXVisualDataChangedEventName,info:e,logRatio:0})},i.EXApplySlicerEventName="PBI.EX.ApplySlicer",i.EXApplySlicer=window.updatedTelemetryFunction?t.generateTelemetryEvent(i.EXApplySlicerEventName,{logExpAssignment:!0}):i.EventFactories[i.EXApplySlicerEventName]=function(e){return t.telemetryEventFactory({name:i.EXApplySlicerEventName,info:e,logExpAssignment:!0})},i.EXApplyAllClickedEventName="PBI.EX.ApplyAllClicked",i.EXApplyAllClicked=window.updatedTelemetryFunction?t.generateTelemetryEvent(i.EXApplyAllClickedEventName):i.EventFactories[i.EXApplyAllClickedEventName]=function(e){return t.telemetryEventFactory({name:i.EXApplyAllClickedEventName,info:e})},i.EXSelectDataPointEventName="PBI.EX.SelectDataPoint",i.EXSelectDataPoint=window.updatedTelemetryFunction?t.generateTelemetryEvent(i.EXSelectDataPointEventName,{logExpAssignment:!0}):i.EventFactories[i.EXSelectDataPointEventName]=function(e){return t.telemetryEventFactory({name:i.EXSelectDataPointEventName,info:e,logExpAssignment:!0})},i.EXRefreshSingleVisualEventName="PBI.EX.RefreshSingleVisual",i.EXRefreshSingleVisual=window.updatedTelemetryFunction?t.generateTelemetryEvent(i.EXRefreshSingleVisualEventName):i.EventFactories[i.EXRefreshSingleVisualEventName]=function(e){return t.telemetryEventFactory({name:i.EXRefreshSingleVisualEventName,info:e})},i.EXPerformanceAnalyzerRefreshReportEventName="PBI.EX.PerformanceAnalyzerRefreshReport",i.EXPerformanceAnalyzerRefreshReport=window.updatedTelemetryFunction?t.generateTelemetryEvent(i.EXPerformanceAnalyzerRefreshReportEventName):i.EventFactories[i.EXPerformanceAnalyzerRefreshReportEventName]=function(e){return t.telemetryEventFactory({name:i.EXPerformanceAnalyzerRefreshReportEventName,info:e})},i.EXPerformanceAnalyzerExportLogsEventName="PBI.EX.PerformanceAnalyzerExportLogs",i.EXPerformanceAnalyzerExportLogs=window.updatedTelemetryFunction?t.generateTelemetryEvent(i.EXPerformanceAnalyzerExportLogsEventName):i.EventFactories[i.EXPerformanceAnalyzerExportLogsEventName]=function(e){return t.telemetryEventFactory({name:i.EXPerformanceAnalyzerExportLogsEventName,info:e})},i.EXPerformanceAnalyzerCopyQueriesEventName="PBI.EX.PerformanceAnalyzerCopyQueries",i.EXPerformanceAnalyzerCopyQueries=window.updatedTelemetryFunction?t.generateTelemetryEvent(i.EXPerformanceAnalyzerCopyQueriesEventName):i.EventFactories[i.EXPerformanceAnalyzerCopyQueriesEventName]=function(e){return t.telemetryEventFactory({name:i.EXPerformanceAnalyzerCopyQueriesEventName,info:e})},i.EXPerformanceAnalyzerStopRecordingEventName="PBI.EX.PerformanceAnalyzerStopRecording",i.EXPerformanceAnalyzerStopRecording=window.updatedTelemetryFunction?t.generateTelemetryEvent(i.EXPerformanceAnalyzerStopRecordingEventName):i.EventFactories[i.EXPerformanceAnalyzerStopRecordingEventName]=function(e){return t.telemetryEventFactory({name:i.EXPerformanceAnalyzerStopRecordingEventName,info:e})},i.EXThemeDialogClosedEventName="PBI.EX.ThemeDialogClosed",i.EXThemeDialogClosed=window.updatedTelemetryFunction?t.generateTelemetryEvent(i.EXThemeDialogClosedEventName):i.EventFactories[i.EXThemeDialogClosedEventName]=function(e){return t.telemetryEventFactory({name:i.EXThemeDialogClosedEventName,info:e})},i.SettingsFavoriteResourcePackagesEventName="PBI.Settings.FavoriteResourcePackages",i.SettingsFavoriteResourcePackages=window.updatedTelemetryFunction?t.generateTelemetryEvent(i.SettingsFavoriteResourcePackagesEventName):i.EventFactories[i.SettingsFavoriteResourcePackagesEventName]=function(e){return t.telemetryEventFactory({name:i.SettingsFavoriteResourcePackagesEventName,info:e})},i.SettingsVisualPaneEventName="PBI.Settings.VisualPane",i.SettingsVisualPane=window.updatedTelemetryFunction?t.generateTelemetryEvent(i.SettingsVisualPaneEventName):i.EventFactories[i.SettingsVisualPaneEventName]=function(e){return t.telemetryEventFactory({name:i.SettingsVisualPaneEventName,info:e})},i.SettingsOutOfBoxVisualsEventName="PBI.Settings.OutOfBoxVisuals",i.SettingsOutOfBoxVisuals=window.updatedTelemetryFunction?t.generateTelemetryEvent(i.SettingsOutOfBoxVisualsEventName):i.EventFactories[i.SettingsOutOfBoxVisualsEventName]=function(e){return t.telemetryEventFactory({name:i.SettingsOutOfBoxVisualsEventName,info:e})},i.EXDrillthroughButtonClickedEventName="PBI.EX.DrillthroughButtonClicked",i.EXDrillthroughButtonClicked=window.updatedTelemetryFunction?t.generateTelemetryEvent(i.EXDrillthroughButtonClickedEventName):i.EventFactories[i.EXDrillthroughButtonClickedEventName]=function(e){return t.telemetryEventFactory({name:i.EXDrillthroughButtonClickedEventName,info:e})},i.EXSmallMultiplesFirstFieldEventName="PBI.EX.SmallMultiplesFirstField",i.EXSmallMultiplesFirstField=window.updatedTelemetryFunction?t.generateTelemetryEvent(i.EXSmallMultiplesFirstFieldEventName):i.EventFactories[i.EXSmallMultiplesFirstFieldEventName]=function(e){return t.telemetryEventFactory({name:i.EXSmallMultiplesFirstFieldEventName,info:e})},i.EXAnalyticsLoadSchemaErrorEventName="PBI.EX.AnalyticsLoadSchemaError",i.EXAnalyticsLoadSchemaError=window.updatedTelemetryFunction?t.generateTelemetryEvent(i.EXAnalyticsLoadSchemaErrorEventName):i.EventFactories[i.EXAnalyticsLoadSchemaErrorEventName]=function(e){return t.telemetryEventFactory({name:i.EXAnalyticsLoadSchemaErrorEventName,info:e})},i.EXExecuteActionCommandsEventName="PBI.EX.ExecuteActionCommands",i.EXExecuteActionCommands=window.updatedTelemetryFunction?t.generateTelemetryEvent(i.EXExecuteActionCommandsEventName):i.EventFactories[i.EXExecuteActionCommandsEventName]=function(e){return t.telemetryEventFactory({name:i.EXExecuteActionCommandsEventName,info:e})},i.EXUndefinedTooltipStyleInActionBarEventName="PBI.EX.UndefinedTooltipStyleInActionBar",i.EXUndefinedTooltipStyleInActionBar=window.updatedTelemetryFunction?t.generateTelemetryEvent(i.EXUndefinedTooltipStyleInActionBarEventName):i.EventFactories[i.EXUndefinedTooltipStyleInActionBarEventName]=function(e){return t.telemetryEventFactory({name:i.EXUndefinedTooltipStyleInActionBarEventName,info:e})},i.EXActionBarShownEventName="PBI.EX.ActionBarShown",i.EXActionBarShown=window.updatedTelemetryFunction?t.generateTelemetryEvent(i.EXActionBarShownEventName):i.EventFactories[i.EXActionBarShownEventName]=function(e){return t.telemetryEventFactory({name:i.EXActionBarShownEventName,info:e})},i.EXScanModeKeyPressedEventName="PBI.EX.ScanModeKeyPressed",i.EXScanModeKeyPressed=window.updatedTelemetryFunction?t.generateTelemetryEvent(i.EXScanModeKeyPressedEventName):i.EventFactories[i.EXScanModeKeyPressedEventName]=function(e){return t.telemetryEventFactory({name:i.EXScanModeKeyPressedEventName,info:e})},i.EXGetInsightsMenuCommandEventName="PBI.EX.GetInsightsMenuCommand",i.EXGetInsightsMenuCommand=window.updatedTelemetryFunction?t.generateTelemetryEvent(i.EXGetInsightsMenuCommandEventName):i.EventFactories[i.EXGetInsightsMenuCommandEventName]=function(e){return t.telemetryEventFactory({name:i.EXGetInsightsMenuCommandEventName,info:e})},i.SparklinesDeleteEventName="PBI.Sparklines.Delete",i.SparklinesDelete=window.updatedTelemetryFunction?t.generateTelemetryEvent(i.SparklinesDeleteEventName):i.EventFactories[i.SparklinesDeleteEventName]=function(e){return t.telemetryEventFactory({name:i.SparklinesDeleteEventName,info:e})},i.CopyVisualImageEntryPointEventName="PBI.CopyVisualImage.EntryPoint",i.CopyVisualImageEntryPoint=window.updatedTelemetryFunction?t.generateTelemetryEvent(i.CopyVisualImageEntryPointEventName):i.EventFactories[i.CopyVisualImageEntryPointEventName]=function(e){return t.telemetryEventFactory({name:i.CopyVisualImageEntryPointEventName,info:e})},i.EXFontsReadyVisualUpdateTriggeredEventName="PBI.EX.FontsReadyVisualUpdateTriggered",i.EXFontsReadyVisualUpdateTriggered=window.updatedTelemetryFunction?t.generateTelemetryEvent(i.EXFontsReadyVisualUpdateTriggeredEventName,{logRatio:.01}):i.EventFactories[i.EXFontsReadyVisualUpdateTriggeredEventName]=function(e){return t.telemetryEventFactory({name:i.EXFontsReadyVisualUpdateTriggeredEventName,info:e,logRatio:.01})}})(powerbi=powerbi||{}),(function(e){var t,n,a,o,i,r;function s(e){this.field=e,this.conditions=[],this.operators=[],this.logicalOperator=2,this.logicalAndOperator=0,this.logicalOrOperator=1}t=e.explore||(e.explore={}),n=t.viewModels||(t.viewModels={}),a=e.data.Condition,o=e.data.OperatorHelper,i=e.data.RestatementHelper,r=e.data.SQExprUtils,s.prototype.toSQExpr=function(e){var t=this.field,i=t.getMetadata(e);if(i)return i=i.type,e=r.hasMappedMParameter(t,e),n.FilterCardConverter.toSQExpr(t,i,this.conditions,this.logicalOperator,e)},s.prototype.getRestatement=function(e){return i.fromCondition(this.conditions,this.logicalOperator,e)},s.prototype.areConditionsValid=function(e,t){var i=this.conditions;if(_.isEmpty(i))return!1;for(var n=0,r=i.length;n<r;n++){var a=i[n];if(null==a.operator||0===a.operator){if(n<r-1)return!1}else if(!e||a.value&&a.value.hasValue){if(o.getValueRequired(a.operator)&&a.value&&!a.value.hasValue)return!1;if(t&&!this.isConditionValid(t,a))return!1}}return!0},s.prototype.loadOperators=function(e,t,i){e=o.tryGetExprFilterOperators(this.field,e,t,i);e.hasError||(this.operators=e.operators)},s.prototype.ensureConditions=function(e,t){var i=this.operators,n=0,r=(this.conditions||(this.conditions=[]),_.isEmpty(this.conditions)&&!_.isEmpty(i)&&this.conditions.push(new a(i[0].value)),2);for(e&&(n=t?1:2,r=t?2:1,i=!o.isOperatorForColumnMappedToMParameter(this.conditions[0].operator),e=1<this.conditions.length&&!t,0===this.logicalOperator||i||e)&&(this.conditions=[new a(9)],this.logicalOperator=n);this.conditions.length<r;)this.conditions.push(a.empty()),this.logicalOperator=n},s.prototype.isConditionValid=function(e,t){return n.FilterCardConverter.isConditionValid(this.field,e,t)},n.AdvFilterCard=s})(powerbi=powerbi||{}),(function(r){var n,t,e,a,o,i,s,l,u,c,p,h,d,v,m,g,y,f,C,S,E;function b(e,t){var i=a.call(this)||this;return i.supportsCategorical=!0,i.context={isNegative:!1,allowNot:!0,logicalOperator:2},i.formatter=e,i.field=t,i}function w(e,t,i,n){void 0===n&&(n=!1),this.propertyExpr=e,this.dataType=t,this.logicalOperator=i,this.isMappedToMParameter=n}n=r.explore||(r.explore={}),t=n.viewModels||(n.viewModels={}),o=r.data.Condition,i=r.data.ConditionValue,s=r.data.SQAndExpr,l=r.data.SQBetweenExpr,u=r.data.SQCompareExpr,c=r.data.SQConstantExpr,p=r.data.SQContainsExpr,h=r.data.SQDateSpanExpr,d=r.data.SQExpr,v=r.data.SQExprBuilder,m=r.data.SQInExpr,g=r.data.SQNotExpr,y=r.data.SQOrExpr,f=r.data.SQStartsWithExpr,C=/[0-9]*\.?[0-9]+%/,(e=t.FilterCardConverter||(t.FilterCardConverter={})).createAdvFilter=function(e,t,i){return e.accept(new S(t,i))},e.toSQExpr=function(e,t,i,n,r){for(var a,o=new E(e,t,n=void 0===n?0:n,r=void 0===r?!1:r),s=0,l=i;s<l.length;s++){var u=l[s];null!=u.operator&&0!==u.operator&&(a=u.accept(o))}return a},e.isConditionValid=function(e,t,i){return!!t&&!!(t=n.FilterUtils.getValueType(e,t))&&(e=new E(e,t,void 0),null!=i.accept(e))},a=r.data.DefaultSQExprVisitor,__extends(b,a),b.prototype.visitColumnRef=function(e){if(null==this.field||d.equals(this.field,e))return this.createFilterCard(e)},b.prototype.visitGroupRef=function(e){if(null==this.field||d.equals(this.field,e))return this.createFilterCard(e)},b.prototype.visitMeasureRef=function(e){return this.createFilterCard(e)},b.prototype.visitAggr=function(e){return this.createFilterCard(e)},b.prototype.visitArithmetic=function(e){return this.createFilterCard(e)},b.prototype.visitHierarchyLevel=function(e){return this.supportsCategorical=!1,this.createFilterCard(e)},b.prototype.visitEntity=function(e){return this.createFilterCard(e)},b.prototype.visitIn=function(e){if(!e.table&&e.args&&1===e.args.length){e.args[0].accept(this);var t=this.filter;if(null==t&&null!=this.field)return this.createFilterCard(this.field);for(var i=this.context,n=0,r=e.values;n<r.length;n++){var a=r[n];i.condition=new o(i.isNegative?10:9),a[0].accept(this),t.conditions.push(i.condition)}return 2===t.logicalOperator?(e=i.isNegative?0:1,t.logicalOperator=e,t):void 0}},b.prototype.visitBetween=function(e){this.supportsCategorical=!1,e.arg.accept(this);var t=this.filter,i=this.context;if(i.condition=new o(i.isNegative?1:4),e.lower.accept(this)&&(t.conditions.push(i.condition),i.condition=new o(i.isNegative?3:2),e.upper.accept(this))&&(t.conditions.push(i.condition),2===t.logicalOperator))return t.logicalOperator=0,t},b.prototype.visitAnd=function(e){this.supportsCategorical=!1;var t=this.context,i=t.isNegative?1:0;if(2===t.logicalOperator)t.logicalOperator=i;else if(t.logicalOperator!==i)return;if(e.left.accept(this)&&e.right.accept(this))return this.filter},b.prototype.visitOr=function(e){var t=this.context,i=t.isNegative?0:1;if(2===t.logicalOperator)t.logicalOperator=i;else if(t.logicalOperator!==i)return;if(e.left.accept(this)&&e.right.accept(this))return this.filter},b.prototype.visitCompare=function(e){var t=this.context,i=this.getFilterOperator(e,t.isNegative);if(void 0!==i&&0!==i){t.condition=new o(this.getFilterOperator(e,t.isNegative));i=t.allowNot;if(t.allowNot=!1,e.left.accept(this)&&e.right.accept(this))if(e.right instanceof c||e.right instanceof h)return(e=this.filter).conditions.push(this.context.condition),1<e.conditions.length&&2===e.logicalOperator&&(e.logicalOperator=0),t.allowNot=i,t.condition=null,e}},b.prototype.visitNot=function(e){var t=this.context,i=e.arg;if((i instanceof u||i instanceof m||i instanceof l||t.allowNot&&(i instanceof s||i instanceof y||i instanceof p||i instanceof f||i instanceof g))&&(t.isNegative=!t.isNegative,e.arg.accept(this)))return t.isNegative=!t.isNegative,this.filter},b.prototype.visitConstant=function(e){var t;if(this.context.condition)return t=this.context.condition,0!==e.type.primitiveType&&(t.value=new i(e.value,this.formatter)),this.filter},b.prototype.visitDateSpan=function(e){var t,i;if(this.supportsCategorical=!1,5===e.unit)return i=(t=this.context).allowNot,t.allowNot=!1,e=e.arg.accept(this),t.allowNot=i,e},b.prototype.visitContains=function(e){this.supportsCategorical=!1;var t=this.context,i=(t.condition=new o(t.isNegative?6:5),t.allowNot);if(t.allowNot=!1,e.left.accept(this)&&e.right.accept(this))return(e=this.filter).conditions.push(this.context.condition),t.allowNot=i,e},b.prototype.visitStartsWith=function(e){this.supportsCategorical=!1;var t=this.context,i=(t.condition=new o(t.isNegative?8:7),t.allowNot);if(t.allowNot=!1,e.left.accept(this)&&e.right.accept(this))return(e=this.filter).conditions.push(this.context.condition),t.allowNot=i,e},b.prototype.getFilterOperator=function(e,t){switch(this.supportsCategorical=this.supportsCategorical&&0===e.comparison,e.comparison){case 3:return t?4:1;case 4:return t?3:2;case 1:return t?2:3;case 2:return t?1:4;case 0:return r.data.SQExpr.isConstantNull(e.right)?t?12:11:r.data.SQExpr.isConstantText(e.right)&&""===e.right.value?t?14:13:t?10:9}},b.prototype.createFilterCard=function(e){return this.filter||(this.filter=new t.AdvFilterCard(e),this.filter.supportsCategorical=this.supportsCategorical,this.filter.logicalOperator=this.context.logicalOperator),this.filter},S=b,w.prototype.visit=function(e){e=this.expandExpr(e);return e&&(this.result?0===this.logicalOperator?this.result=v.and(this.result,e):1===this.logicalOperator&&(this.result=v.or(this.result,e)):this.result=e),this.result},w.prototype.expandExpr=function(e){var t,i=11!==e.operator&&12!==e.operator&&13!==e.operator&&14!==e.operator;if((t=i?this.getValueExpr(e):t)||!i)switch(e.operator){case 9:return v.compare(0,this.propertyExpr,t);case 10:return v.not(v.compare(0,this.propertyExpr,t));case 11:return v.compare(0,this.propertyExpr,v.nullConstant());case 12:return v.not(v.compare(0,this.propertyExpr,v.nullConstant()));case 5:return v.contains(this.propertyExpr,t);case 6:return v.not(v.contains(this.propertyExpr,t));case 7:return v.startsWith(this.propertyExpr,t);case 8:return v.not(v.startsWith(this.propertyExpr,t));case 3:return v.compare(1,this.propertyExpr,t);case 4:return v.compare(2,this.propertyExpr,t);case 1:return v.compare(3,this.propertyExpr,t);case 2:return v.compare(4,this.propertyExpr,t);case 13:return v.compare(0,this.propertyExpr,v.text(""));case 14:return v.not(v.compare(0,this.propertyExpr,v.text("")))}},w.prototype.getValueExpr=function(e){var t=this.dataType;if(e.value){var i=e.value.stringValue;if((t.integer||t.numeric)&&i)return n=r.formattingService.parseFloat(i),isNaN(n)?void 0:(i.match(C)&&(n/=100),2===t.primitiveType?v.decimal(n):_.isInteger(n)?v.integer(n):v.double(n));if(t.text&&i)return v.text(i);if(t.dateTime){var n=e.value.dateValue;if(n)return this.isMappedToMParameter?v.dateTime(n):v.dateSpan(5,v.dateTime(n))}}},E=w})(powerbi=powerbi||{}),(function(e){function t(e,t){this._contract=e,this._state=t}e=(e=e.explore||(e.explore={})).viewModels||(e.viewModels={}),Object.defineProperty(t.prototype,"contract",{get:function(){return this._contract},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"readOnlyState",{get:function(){return this._state},enumerable:!1,configurable:!0}),t.prototype.updateViewState=function(){this.updateViewStateCore(this._state)},t.prototype.updateViewStateCore=function(e){},e.ViewModel=t})(powerbi=powerbi||{}),(function(w){var e,o,h,x,t,g,V,F,u,s,y,l;function n(){}e=(e=w.explore||(w.explore={})).util||(e.util={}),o=w.explore.constants.ExploreCanvasConstants.CanvasGutterSize,h=w.visuals.ColorHelper,x=w.common.utils.ColorUtility,t=jsCommon.CssConstants.createClassAndSelector,g=jsCommon.CssConstants,V=w.data.DataViewObjectDefinitions,F=w.explore.constants.ExploreCanvasConstants,u=w.explore.services,s=w.explore.constants.ExploreCanvasConstants.MobileFooterHeight,y=w.visualHost.ResourcePackageReferenceResolver,l=w.explore.contracts.SectionAlignmentOption,n.setScrollWidth=function(e){this.scrollWidth=e},n.fitToWidth=function(e,t,i,n,r,a,o){void 0===a&&(a=!1),null!=e.canvasOptions.overrideSectionAlignment&&(o=e.canvasOptions.overrideSectionAlignment);var s=t.get(0).getBoundingClientRect(),l=this.findParentElement(t,this.ExploreCanvasSelector).get(0).getBoundingClientRect(),u=t.find(".displayAreaViewport").get(0).getBoundingClientRect(),c=(s.width>u.width&&(c=s.width-u.width,null!=this.scrollWidth&&.01<Math.abs(this.scrollWidth-c)&&jsCommon.Trace.error("Multiple scroll bar widths detected, ".concat(this.scrollWidth," -> ").concat(c)),this.scrollWidth=c),r.getConfig()),r=2*F.CanvasGutterSize,p=s.width-r,h=s.height-r,d=this.getFitToWidthScaledSize(e,p,n),v=t.find(this.DisplayAreaNameSelector.selector),m=1===e.viewModel.canvasLayout,h=(d.height<=h&&!m?(e.canvasViewStyle=2,t.css(g.overflowXProperty,g.hiddenValue).css(g.overflowYProperty,g.hiddenValue),this.positionElement(v,u,d,o,!0,c.displayOptions.forceCenteredVerticalAlignment)):(r=c.displayOptions.scaleBackgroundImageToWidth?F.CanvasGutterSize/2+(this.scrollWidth||0):3*F.CanvasGutterSize/2+(this.scrollWidth||8),p=s.width-r,d=this.getFitToWidthScaledSize(e,p,n,m?F.MobileFooterHeight+F.MobileFooterPadding:0),e.canvasViewStyle=1,t.css(g.overflowXProperty,g.hiddenValue).css(g.overflowYProperty,g.scrollValue),this.clearElementPosition(v)),p/e.viewModel.width),u=this.getWallpaperScale(l,e.viewModel.width,e.viewModel.height,e.canvasOptions.scrollbarOffset,0);i.setDisplayAreaScaleFactor(h),i.setWallpaperScaleFactor(u),this.updateCanvasSize(e,d.width,d.height),v.attr("class",this.DisplayAreaNameSelector.class+" "+this.convertDisplayOptionToStyle(e)),this.setElementSize(v,d),a||c.displayOptions.preserveScrollPositionOnResize||(o=!1,(s=e.fitToWidthScrollPosition)&&((r=e.viewModel&&e.viewModel.contract)&&r.name===s.sectionName&&r.size&&r.size.width===s.sectionSize.width&&r.size.height===s.sectionSize.height&&(o=!0,t.scrollTop(s.relativeScroll*h)),o||(e.fitToWidthScrollPosition=void 0)),o||t.scrollTop(0),t.scrollLeft(0))},n.getWallpaperScale=function(e,t,i,n,r,a,o){return 0===r?(e.width-n)/t:(r=i,(r=a&&o?a.getConfig().displayOptions.hideTileMenu?e.height:e.height-o:r)/i)},n.getFitToWidthScaledSize=function(e,t,i,n){void 0===n&&(n=0);var r=t/e.viewModel.width,a=e.viewModel.height*r+i;return!e.adjustScaleForLayout||(e=e.adjustScaleForLayout({x:r,y:r})).x===r&&e.y===r||(t*=e=Math.min(e.x,e.y)/r,a=(a-i)*e+i,0),0<n&&(a+=n),{width:t,height:a}},n.fitToPage=function(e,t,i,n,r,a){var o=n.getConfig();null!=e.canvasOptions.overrideSectionAlignment&&(a=e.canvasOptions.overrideSectionAlignment);var s=this.findParentElement(t,this.ExploreCanvasSelector).get(0).getBoundingClientRect(),l=e.outerViewport.width/e.viewModel.width,u=this.getFitToPageScaleY(e,n,r),u=Math.min(l,u),s=this.getWallpaperScale(s,e.viewModel.width,e.viewModel.height,e.canvasOptions.scrollbarOffset,u===l?0:1,n,r),n=(!e.adjustScaleForLayout||(l=e.adjustScaleForLayout({x:u,y:u})).x===u&&l.y===u||(u=Math.min(l.x,l.y)),i.setDisplayAreaScaleFactor(u),i.setWallpaperScaleFactor(s),o.displayOptions.preserveScrollPositionOnResize||t.scrollTop(0).scrollLeft(0),e.viewModel.width*u),l=e.viewModel.height*u+r,i=(e.canvasViewStyle=0,e.canvasViewStyle|=4,t.css(g.overflowXProperty,g.hiddenValue).css(g.overflowYProperty,g.hiddenValue),this.updateCanvasSize(e,n,l),t.find(this.DisplayAreaNameSelector.selector)),s=(i.attr("class",this.DisplayAreaNameSelector.class+" "+this.convertDisplayOptionToStyle(e)),{width:n,height:l});this.setElementSize(i,s),this.positionElement(i,e.outerViewport,s,a,!1)},n.getFitToPageScaleY=function(e,t,i){i=t.getConfig().displayOptions.hideTileMenu?e.outerViewport.height:e.outerViewport.height-i;return(i-=this.getCanvasOutlineSize(e,t))/e.viewModel.height},n.findParentElement=function(e,t){if(e)return e.hasClass(t.class)?e:this.findParentElement(e.parent(),t)},n.getVerticalAlignmentSetting=function(e,t,i){var e=e.viewModel&&e.viewModel.contract&&e.viewModel.contract.evaluatedObjects&&e.viewModel.contract.evaluatedObjects.displayArea&&e.viewModel.contract.evaluatedObjects.displayArea.verticalAlignment&&e.viewModel.contract.evaluatedObjects.displayArea.verticalAlignment.toString();return e?l[e]:(i=(e=i.getCurrentExploration())&&e.evaluatedObjects&&e.evaluatedObjects.section&&e.evaluatedObjects.section.verticalAlignment&&e.evaluatedObjects.section.verticalAlignment.toString())?l[i]:void 0},n.positionElement=function(e,t,i,n,r,a){a=null!=t.height&&null!=i.height?(t.height-(a?s:0)-i.height)/2:void 0,t=null!=t.width&&null!=i.width?(t.width-i.width)/2:void 0,i={position:"absolute",left:null!=t?"".concat(t,"px"):""};n===l.Top?_.extend(i,{top:null!=a?"".concat(r?o:0,"px"):""}):(l.Middle,_.extend(i,{top:null!=a?"".concat(a,"px"):""})),e.css(i)},n.setElementSize=function(e,t){e.css({height:"".concat(t.height,"px"),width:"".concat(t.width,"px")})},n.clearElementPosition=function(e){e.css({position:"",top:"",left:""})},n.clearElementSize=function(e){e.css({height:"",width:""})},n.fitToScreen=function(e,t,i,n){var r=t.find(this.DisplayAreaNameSelector.selector);this.clearElementPosition(r),this.clearElementSize(r),e.canvasViewStyle=8,i.setDisplayAreaScaleFactor(1),i.setWallpaperScaleFactor(1),this.updateCanvasSize(e,e.outerViewport.width,e.outerViewport.height),t.css(g.overflowXProperty,g.hiddenValue).css(g.overflowYProperty,g.hiddenValue),r.attr("class",this.DisplayAreaNameSelector.class+" "+this.convertDisplayOptionToStyle(e))},n.getCanvasActualSize=function(e,t,i){t=n.getAutoLayoutVisualVCHeader(t,i),i=e.size;return{height:i.height+t,width:i.width}},n.displayInActualSize=function(e,t,i,n,r,a,o){void 0===o&&(o=1),null!=e.canvasOptions.overrideSectionAlignment&&(a=e.canvasOptions.overrideSectionAlignment);var s=t.find(this.DisplayAreaNameSelector.selector),l=e.isCanvasBackdropVisible(),u=(e.canvasViewStyle=0,e.viewModel.width*o),r=e.viewModel.height*o+r,c={width:l?F.PhoneAuthoringViewportWidth:u,height:l?F.PhoneAuthoringViewportHeight:r},t=(c.width>e.outerViewport.width?(e.canvasViewStyle|=512,t.css(g.overflowXProperty,g.autoValue)):(e.canvasViewStyle|=256,t.css(g.overflowXProperty,g.hiddenValue)),c.height>e.outerViewport.height?(e.canvasViewStyle|=128,t.css(g.overflowYProperty,g.autoValue)):(e.canvasViewStyle|=64,t.css(g.overflowYProperty,g.hiddenValue)),e.canvasViewStyle),a=(this.positionElement(s,e.outerViewport,{width:256&t?c.width:void 0,height:64&t?c.height:void 0},a,!0),e.canvasViewStyle|=256&t&&64&t?32:16,this.setElementSize(s,c),n.setDisplayAreaScaleFactor(o),n.setWallpaperScaleFactor(o),this.updateCanvasSize(e,u,r),this.convertDisplayOptionToStyle(e));s.attr("class",this.DisplayAreaNameSelector.class+" "+a),l&&i.attr("class",this.CanvasBackdropSelector.class+" "+a)},n.displayInActualSizeTopLeft=function(e,t,i,n){var r=t.find(this.DisplayAreaNameSelector.selector),t=(e.canvasViewStyle=0,e.canvasViewStyle|=512,e.canvasViewStyle|=128,e.canvasViewStyle|=16,e.viewModel.width>=e.outerViewport.width?t.css(g.overflowXProperty,g.autoValue):t.css(g.overflowXProperty,g.hiddenValue),e.viewModel.height>=e.outerViewport.height?t.css(g.overflowYProperty,g.autoValue):t.css(g.overflowYProperty,g.hiddenValue),i.setDisplayAreaScaleFactor(1),i.setWallpaperScaleFactor(1),e.viewModel.width),i=e.viewModel.height+n;r.css({width:t+"px",height:i+"px"}),this.updateCanvasSize(e,t,i),r.attr("class",this.DisplayAreaNameSelector.class+" "+this.convertDisplayOptionToStyle(e))},n.updateCanvasSize=function(e,t,i){t={width:t,height:i};0<t.width&&0<t.height&&(e.size=t)},n.updateAndApplyBackground=function(e,t,i,n,r,a,o,s,l,u,c,p,h){var d,v,m,g,y,f,C,S=u.getConfig(),E=S.displayOptions.hideOutspaceFormatting,b=1===u.getMode()&&!t.isCanvasBackdropVisible(),h=!!h.get();switch(e){case 1:m=t.outspace=t.outspace||{},v="outspace",d=t.outspaceBackground,g=F.getDefaultCanvasOutspace(),y=l.getCurrentLayoutCapabilities().canShowCanvasOutspace();break;case 2:m=t.background=t.background||{},v="background",d=t.canvasBackground,g=F.getDefaultCanvasBackground(),y=l.getCurrentLayoutCapabilities().canShowCanvasBackground()}y?(n=n&&n[v],f=m.image,h?(m.color=F.DefaultCanvasBackgroundColor,m.transparency=0,m.image=null):n?(m.color=w.DataViewObject.getFillColorByPropertyName(n,"color",F.DefaultCanvasBackgroundColor),m.transparency=w.DataViewObject.getValue(n,"transparency",F.DefaultCanvasBackgroundTransparency),m.image=n.image):this.setDefaultBackgroundProperties(m,g),(null==(n=m.image)?void 0:n.name)!==(null==f?void 0:f.name)&&null!=(f=t.backgroundImageChanging)&&f.call(t,e),f=t.viewModel.contract.objects,(C=(f=V.getObjectDefinition(f,v,null))&&f.properties.image)&&w.data.SQExpr.isResourcePackageItem(C.url)?this.setImageFromPackage(t,d,m,n,C.url,f,a,o,s,p,b,c,E,e,h):this.setImage(d,m,n,n?n.url:"",h,p,b,c,E,e,t)):(this.setDefaultBackgroundProperties(m,g),this.setImage(d,g,null,"",h,p,b,c,E,e,t)),2===e&&(u&&S.displayOptions.extendBackgroundToWholeCanvas?i.css({"background-color":x.hexToRGBString(m.color,(100-m.transparency)/100)}):i.css({"background-color":""}))},n.setDefaultBackgroundProperties=function(e,t){e.color=t.color,e.image=t.image,e.transparency=t.transparency},n.setImage=function(e,t,i,n,r,a,o,s,l,u,c){var p=i&&i.scaling,r=r?1:(100-t.transparency)/100,i=i&&n;i!==e.imageSource&&(e.imageSource=i,null!=(n=c.backgroundImageChanged))&&n.call(c,u),e.imageFitClass=p,e.imageStyle=p===w.visuals.imageScalingType.normal?{transform:"scale("+a.getWallpaperScaleFactor()+")"}:{},e.backgroundStyle||(e.backgroundStyle={}),e.backgroundStyle.opacity=r,e.backgroundStyle["background-color"]=l&&1===u?"transparent":x.hexToRGBString(t.color),2===u&&(i=h.getThemeColor(s,"foregroundNeutralSecondary"),e.displayAreaStyle||(e.displayAreaStyle={}),e.displayAreaStyle["box-shadow"]=l?"0 0 0":"0 0 10px rgba(200,200,200,".concat(r,")"),e.displayAreaStyle.outline=o&&r<=.5?"2px dotted ".concat(i):"none",e.imageStyle=p===w.visuals.imageScalingType.normal?{transform:"scale("+a.getDisplayAreaScaleFactor()+")"}:{})},n.setImageFromPackage=function(i,n,r,a,o,s,e,t,l,u,c,p,h,d,v){var m,g=this,t=(void 0===h&&(h=!1),t.getCurrentExploration());t&&(m=i.viewModel.contract,y.loadAndResolveFromSQExpr(o,t.resourcePackages,e,l).then((function(e){var t=s.properties.image;m===i.viewModel.contract&&t&&w.data.SQExpr.equals(t.url,o)&&g.setImage(n,r,a,e.value||"",v,u,c,p,h,d,i)})))},n.setDisplayAreaBackground=function(e,t,i){t&&t.outspace?e.canvasBackground.displayAreaStyle&&delete e.canvasBackground.displayAreaStyle["background-color"]:(e.canvasBackground.displayAreaStyle||(e.canvasBackground.displayAreaStyle={}),t=h.getThemeColor(i,"background"),e.canvasBackground.displayAreaStyle["background-color"]=t)},n.convertDisplayOptionToStyle=function(e){var t="";return e.useResponsiveLayout&&(t+=" responsive"),e.disableAnimations&&(t+=" disableAnimations"),8==(8&e.canvasViewStyle)&&(t+=" fitToScreen"),4==(4&e.canvasViewStyle)&&(t+=" fitToPage"),1==(1&e.canvasViewStyle)&&(t+=" fitToWidthOrigin"),2==(2&e.canvasViewStyle)&&(t+=" fitToWidthCentered"),256==(256&e.canvasViewStyle)&&(t+=" actualSizeAlignCenter"),512==(512&e.canvasViewStyle)&&(t+=" actualSizeAlignLeft"),64==(64&e.canvasViewStyle)&&(t+=" actualSizeAlignMiddle"),128==(128&e.canvasViewStyle)&&(t+=" actualSizeAlignTop"),32==(32&e.canvasViewStyle)&&(t+=" actualSizeCentered"),16==(16&e.canvasViewStyle)&&(t+=" actualSizeOrigin"),t.trim()},n.getAutoLayoutVisualVCHeader=function(e,t){return t&&t.getCapabilities().visualContainerOptions.useStylableHeader||e&&e.getCurrentLayoutCapabilities().canShowVisualContainerHeaderInset()?0:F.AutoLayoutVisualVCHeader},n.getCanvasOutlineSize=function(e,t){if(1===t.getMode()){t=e.background&&e.background.transparency;if(t&&t>=F.DisplayAreaTransparencyOutlineThreshold)return F.DisplayAreaOutlineSize}return 0},n.applyFitOption=function(e,t,i,n,r,a){if(e.viewModel&&e.viewModel.contract){var o=t.find(this.DisplayAreaContainerNameSelector.selector),s=this.findParentElement(t,this.ExploreCanvasSelector).find(this.CanvasBackdropSelector.selector),t=i.canvasScale.getDisplayOption(),l=(2!==t&&(e.fitToWidthScrollPosition=void 0),this.getAutoLayoutVisualVCHeader(i.formFactor,i.explorationCapabilities));switch(t){case 2:this.fitToWidth(e,o,i.canvasScale,l,i.viewModeState,a,n);break;case 1:this.fitToPage(e,o,i.canvasScale,i.viewModeState,l,n);break;case 3:this.displayInActualSize(e,o,s,i.canvasScale,l,n,r);break;case 4:this.displayInActualSizeTopLeft(e,o,i.canvasScale,l);break;default:this.fitToScreen(e,o,i.canvasScale,l)}i.eventBridge.publishToChannel(u.events.CanvasResized)}},n.storeOverflowValuesAndChange=function(e,t){this.currentOverflowXCSSValue=e.css(g.overflowXProperty),this.currentOverflowYCSSValue=e.css(g.overflowYProperty),e.css(g.overflowXProperty,t),e.css(g.overflowYProperty,t)},n.restoreOverflowValues=function(e){e.css(g.overflowXProperty,this.currentOverflowXCSSValue),e.css(g.overflowYProperty,this.currentOverflowYCSSValue)},n.visualPositionToRect=function(e){return{left:e.x,top:e.y,width:e.width,height:e.height}},n.rectToVisualPosition=function(e){return{x:e.left,y:e.top,width:e.width,height:e.height}},n.isCortanaPageSize=function(e){return!1},n.DisplayAreaNameSelector=t("displayArea"),n.DisplayAreaContainerNameSelector=t("displayAreaContainer"),n.VisualContainerHostSelector=t("visualContainerHost"),n.OutspaceContainerSelector=t("outspaceContainer"),n.OutspaceImageSelector=t("outspaceImage"),n.VisualBackgroundContainerSelector=t("visualBackgroundContainer"),n.VisualBackgroundImageSelector=t("visualBackgroundImage"),n.DefaultVisualPosition={x:100,y:100,width:300,height:300},n.CanvasBackdropSelector=t("canvasBackdrop"),n.ExploreCanvasSelector=t("exploreCanvas"),n.currentOverflowXCSSValue="",n.currentOverflowYCSSValue="",e.CanvasDisplayUtility=n})(powerbi=powerbi||{}),(function(T){var A,l,i,D,s,u,t,r,o,a,c,M;function n(e,i){for(var t={},n=0,r=i;n<r.length;n++){var a=r[n];t[a.name]=!0}function o(t){return _.findIndex(i,(function(e){return e.name===t.name}))}var s=[];A.viewModels.traverseVisualContainerGroups(e,(function(e){t[e.name]&&s.push(e)}));return s.sort((function(e,t){return o(e)-o(t)})),s}function p(e,t){void 0===t&&(t=!1);for(var i=e.parentGroup,n=e;i;){if(i.isSelected||i.isChildSelected){t&&i.isSelected&&(n=i);break}i=(n=i).parentGroup}return n}function h(e,t){var i=e.filter;if((e.type===r.Include||e.type===r.Exclude)&&i){var n=i.rewrite(t);if(n!==i)return T.Prototype.inherit(e,(function(e){return e.filter=n}))}return e}function d(e,t,i){if(!_.isEmpty(e)){for(var n=t&&[],r=0,a=e;r<a.length;r++){var o=a[r].canvasItem;o&&(t&&A.contracts.isVisualContainerGroup(o)?n.push(o):i(o))}t&&!_.isEmpty(n)&&A.contracts.traverseVisualContainerGroups(n,(function(e){return i(e)}))}}function v(e,a,o,t,i,n,r,s,l,u){if(e){var c={},p=!!r,h=o.size,d=u?o.visualContainerGroups:o.visualContainers,v=_.flatMap(a.sections,(function(e){return u?e.visualContainerGroups:e.visualContainers})),m=[],g=i.getCurrentLayout(),i=(A.contracts.traverseVisualContainerGroups(d,(function(e){null==e.parentGroup&&(e=e.layouts.withId(g).position,m.push(e))})),A.contracts.traverseVisualContainerGroups(v,(function(e){c[e.name]=!0})),t.deserializeCanvasItems(e,!0,u,(function(){var e=M.nextUniqueName(c);return c[e]=!0,e})));if(i){var v=i.visualContainerGroups,t=i.visualContainers,y=I(d,g,e,u),f=N(o.visualContainers,g,e),C=D.createWithId(),S=[],E=function(e){var t=e.layouts,i=e.parentGroup,n=e.prevName,i=null!=i,t=t.withId(g),r=t.position;if(i&&u||(n&&!_.isNil(y[n])&&(r.z=y[n]),S.push(e)),n&&!_.isNil(f[n])&&null!=r.tabOrder&&A.contracts.isVisualContainer(e)&&(r.tabOrder=f[n]),!i){for(;2!==(function(e,t){var i=t.width||0,t=t.height||0,n=0;e.x+e.width>i&&(e.x=Math.max(i-e.width,0),n++);e.y+e.height>t&&(e.y=Math.max(t-e.height,0),n++);return n})(r,h)&&(function(t,e){return _.some(e,(function(e){return t.x===e.x&&t.y===e.y}))})(r,m);)r.x+=10,r.y+=10;m.push(r)}e.layouts=D.extendWithId([t]),p&&A.contracts.isVisualContainer(e)&&(n=A.viewModels.ViewModelFactory.convertVisualContainer(a,o,e,g),C.push(n))};if(u)A.contracts.traverseVisualContainerGroups(v,E);else for(var b=0,w=t;b<w.length;b++){var x=w[b];E(x)}if((i=o.visualContainers).push.apply(i,t||[]),p&&(d=r.visualContainers).push.apply(d,C||[]),u?(o.visualContainerGroups=T.ItemGroupingManager.add.apply(T.ItemGroupingManager,__spreadArray([o.visualContainerGroups],v||[],!1)),p&&(e=A.viewModels.ViewModelFactory.convertVisualContainerGroups(v,C,g),r.visualContainerGroups=T.ItemGroupingManager.add.apply(T.ItemGroupingManager,__spreadArray([r.visualContainerGroups],e||[],!1)))):(o.visualContainerGroups=T.ItemGroupingManager.add.apply(T.ItemGroupingManager,__spreadArray([o.visualContainerGroups],t||[],!1)),p&&(r.visualContainerGroups=T.ItemGroupingManager.add.apply(T.ItemGroupingManager,__spreadArray([r.visualContainerGroups],C||[],!1)))),n.publishVisualContainerAddedEvent(),s&&A.services.selectionUtils.selectCanvasItems(S,s,!0),l)for(var V=0,F=S;V<F.length;V++){var P=F[V];A.contracts.isVisualContainer(P)&&l.applyFilterOutput(P)}return S}}}function m(e,t){return _.isEmpty(e)?0:_.chain(e).map((function(e){e=e.layouts.withId(t),e=e&&e.position;return e&&e.z||0})).max().value()+1}function I(e,t,i,n){var r=m(e,t);return _.orderBy(i,(function(e){return e.config.layouts[t].position.z}),["asc"]).reduce((function(e,t){var t=t.config,i=t.name,t=!!t.parentGroupName;return __assign(__assign({},e),((e={})[i]=t&&n?null:r++,e))}),{})}function g(e,t){var i=0,n=0;if(_.isEmpty(e))return{pos:i,neg:n};for(var r=0,a=e;r<a.length;r++){var o=a[r].layouts.withId(t),o=o&&o.position,o=o&&null!=o.tabOrder?o.tabOrder:void 0;null!=o&&(i=Math.max(i,o),n=Math.min(n,o))}return{pos:i+1,neg:n-1}}function N(e,r,t){var a=g(e,r);return _.orderBy(t,(function(e){return e.config.layouts[r].position.tabOrder}),["asc"]).reduce((function(e,t){var t=t.config,i=t.name,t=t.layouts[r].position,n=0<=t.tabOrder;return __assign(__assign({},e),((e={})[i]=null!=t.tabOrder?n?a.pos++:a.neg--:null,e))}),{})}function y(e,t){e=e.layouts.withId(t);return e&&e.position}A=T.explore||(T.explore={}),l=A.util||(A.util={}),D=jsCommon.ArrayExtensions,s=T.data.DataViewObjectDefinitions,u=T.data.DataViewTransform,t=T.explore.constants.ExploreCanvasConstants,r=T.explore.contracts.FilterType,o=T.explore.services.selectionUtils,a=T.data.SQExpr,c=T.explore.services.StaticResourceReferences,M=T.explore.util.VisualContainerUtils,(i=l.CanvasVisualsUtility||(l.CanvasVisualsUtility={})).objectIsHidden=function(e,t,i){var i=i&&i[e],n=T.explore.viewModels.PropertySliceNames.Show;return i?i.hasOwnProperty(n)&&!i[n]:void 0!==(i=s.getValue(t,{objectName:e,propertyName:n},null))&&a.isConstant(i)&&!i.value},i.getSelectedCanvasItemViewModels=function(e,t){return t=o.getSelectedCanvasItems(t),n(e.visualContainerGroups,t)},i.findVisualContainerViewModel=function(e,t){for(var i=0,n=e;i<n.length;i++){var r=n[i];if(r.contract===t)return r}},i.findCanvasItemViewModels=n,i.syncCanvasItemViewModelsWithContracts=function i(e,n){for(var t=0,r=e;t<r.length;t++)!(function(e){var t=T.ItemGroupingManager.find(e.name,n);t&&A.viewModels.isVisualContainerGroup(e)&&A.contracts.isVisualContainerGroup(t)&&(e.contract!==t&&(e.contract=t),i(e.children,t.children))})(r[t])},i.addOffsetFromGroup=function(e,t){if(t.parentGroup)for(var i=t.parentGroup;i;){var n=i.position;e.left+=n.x,e.top+=n.y,i=i.parentGroup}return e},i.getContainerGroupDepth=function(e){var t=0;if(_.isEmpty(e))return t;if(e[0].parentGroup)for(var i=e[0].parentGroup;i;)t++,i=i.parentGroup;return (function e(t,i){i++;var n=i;for(var r=0,a=t;r<a.length;r++){var o=a[r];A.contracts.isVisualContainerGroup(o)&&(n=Math.max(e(o.children,i),n))}return n})(e,t)},i.toggleSelectContainer=function(e,t,i,n,r){n.hideAllDropdowns(),l.EventBubblingUtility.markAsHandled(e);var n=jsCommon.BrowserUtils.isCtrlOrMeta(e),a=o.isCanvasItemSelected(t.contract,i);n&&a&&1<o.getSelectedCanvasItems(i).length?o.unselectCanvasItem(t.contract,i):r?o.selectCanvasItem(t.contract,i,jsCommon.SelectionUtility.getMultiSelectMode(e)):((n=p(t)).parentGroup&&n.parentGroup.isSelected&&o.unselectCanvasItem(n.parentGroup.contract,i),o.selectCanvasItem(n.contract,i,jsCommon.SelectionUtility.getMultiSelectMode(e)),null!==(a=e.currentTarget,r=n.contract.name,t=$(a).parents('[name="'.concat(r,'"]:first'))[0])&&void 0!==t&&t.focus())},i.setHoverForParentGroup=function(e,t,i){if(e.parentGroup)if(t){var n=p(e);n!==e&&M.notifyContainerHoverEvent(t,n.name,i)}else for(var r=e.parentGroup;r;)M.notifyContainerHoverEvent(t,r.name,i),r=r.parentGroup},i.getContainerToSelect=p,i.selectIfNotSelected=function(e,t){o.isCanvasItemSelected(e,t)||o.selectCanvasItem(e,t)},i.serializeSelection=function(a,e,o,t){void 0===t&&(t=!0);var s=[];return d(e.getSelectedElements(),t,(function(e){var t,i,n,r;A.contracts.isVisualContainerGroup(e)?s.push(a.serializeVisualContainerGroup(e)):(t=o,t=(e=e).filters?(t=new l.VariationToHierarchyRewriter(t),i=e,n=t,(r=D.rewriteArray(i.filters,(function(e){return h(e,n)})))===i.filters?i:T.Prototype.inherit(i,(function(e){return e.filters=r}))):e,s.push(a.serializeVisualContainer(t)))})),s},i.evaluateObjects=function(e,t,i,n,r,a){var o=e.objects,i=((i=r.getVisualObjects(n,i,void 0,t))&&(o=s.clone(o||{}),s.extend(o,i)),r.getVisualStyle(n)),r=u.evaluateMetadataOnceDataViewObjectDefinitions(o,t,i,a.featureSwitches);e.evaluatedObjects=r.dataViewObjects},i.evaluateSectionObject=function(e,t,i,n,r,a,o){if(e=s.clone(e.objects||{}),n=r.getVisualObjects(n,T.explore.constants.SectionComponentType,void 0,((r={})[t]=i,r)),s.extend(e,n),e&&e[t]){r=s.getObjectDefinition(e,t,o);if(r)return n=T.data.createEmptyEvalContext(),T.data.createDataViewObjectEvaluator(a.featureSwitches,T.visuals.visualStyles.create()).run(t,n,i,r.properties)}},i.rewriteFilterContainer=h,i.getSelectionResources=function(e,t,i){void 0===i&&(i=!0);var n={};return d(e=e.getSelectedElements(),i,(function(e){e=e,A.contracts.isVisualContainer(e)&&(e=e.config.singleVisual.objects,c.addObjectsReferences(e,void 0,t,n))})),n},i.checkBoundaryForCharts=function(e,t,i){return 0<(t=(e=Math.max(0,e-t/2))+t-i)&&(e-=t),e},i.duplicateCanvasItem=function(e,t,i,n,r,a,o,s,l,u){return _.first(v([e],t,i,n,r,a,o,s,l,u))},i.duplicateCanvasItems=v,i.addVisualContainerToCanvas=function(i,n,r,a,o,s){var l;return __awaiter(this,void 0,T.Promise,(function(){var t;return __generator(this,(function(e){switch(e.label){case 0:return i.expr?[3,1]:(t=o.addEmptyVisualContainer(n,r,i.visualType,i.position,i.shouldSummarize),[3,3]);case 1:return[4,o.addVisualContainer({expr:i.expr,visualType:i.visualType,targetRole:i.targetRole,dataSources:a,allowAggregate:null==(l=i.allowAggregate)||l,shouldSummarize:i.shouldSummarize},n,r)];case 2:t=e.sent(),e.label=3;case 3:return s.logEvent(T.telemetry.EXCreateVisual,{source:(function(e){switch(e){case 0:return"CheckboxTickedInFieldList";case 3:return"DraggedToFieldWell";case 1:return"DraggedToCanvas";case 2:return"VisualTypeIconClicked";case 4:return"InsertVisualButton";case 5:return"WhatIfParameterControl";case 8:return"QnaAppBar";case 6:return"QnaDoubleClick";case 7:return"QnaKeyboardShortcut";case 9:return"FieldParameterControl";case 10:return"CanvasBackgroundContextMenu";case 11:return"AssistedCreation"}})(i.telemetrySource),visualType:M.getVisualType(t),visualName:t.name}),[2,t]}}))}))},i.convertToScaledPosition=function(e,t,i){var n,r,a,t={x:e.x*t.x,y:e.y*t.y,z:e.z,width:e.width*t.x,height:e.height*t.y,angle:e.angle,tabOrder:e.tabOrder};return!0===i&&(i=Math.round(t.x),n=Math.round(t.y),r=Math.round(t.x+t.width),a=Math.round(t.y+t.height),t={x:i,y:n,z:t.z,width:r-i,height:a-n,angle:e.angle,tabOrder:e.tabOrder}),t},i.convertFromScaledPosition=function(e,t){return{x:e.x/t.x,y:e.y/t.y,z:e.z,width:e.width/t.x,height:e.height/t.y,angle:e.angle,tabOrder:e.tabOrder}},i.convertToScaledRect=function(e,t){return{left:e.left*t.x,top:e.top*t.y,width:e.width*t.x,height:e.height*t.y}},i.convertFromScaledRect=function(e,t){return{left:e.left/t.x,top:e.top/t.y,width:e.width/t.x,height:e.height/t.y}},i.getZIndexForNewCanvasItem=m,i.getZIndexLookupForNewCanvasItems=I,i.getNextTabOrders=g,i.getTabOrdersLookupForNewCanvasItems=N,i.getTabOrderForNewVisual=function(e,t,i){var n;return!e||_.isEmpty(e.visualContainers)?0:(n=t?T.explore.services.CanvasListOrderingConstants.posMinOrder:T.explore.services.CanvasListOrderingConstants.negMinOrder,_.forEach(e.visualContainers,(function(e){var e=e.layouts.withId(i),e=e&&e.position;e&&e.tabOrder&&(e=e.tabOrder,n=t?Math.max(n,e):Math.min(n,e))})),n+(t?1:-1))},i.getDragRestrictElementRect=function(e,t,i){for(var n=0,r=0,a=0,o=0,s=null,l=0,u=0,c=i.length;u<c;u++){l=u;if((d=i[u])===e){v=(v=d.parentGroup)&&v.layouts.withId(t)?v:void 0,s=M.getAbsoluteVisualContainerPosition(y(d,t),t,v);break}}if(s){i.splice(l,1);for(var p=0,h=i;p<h.length;p++){v=(v=(d=h[p]).parentGroup)&&v.layouts.withId(t)?v:void 0;var d,v,m=M.getAbsoluteVisualContainerPosition(y(d,t),t,v),g=s.x-m.x,n=n<g?g:n,r=r<(g=m.y+m.height-(s.y+s.height))?g:r,a=a<(g=s.y-m.y)?g:a,o=o<(g=m.x+m.width-(s.x+s.width))?g:o}return{top:0-(0<a?a/s.height:0),left:0-(0<n?n/s.width:0),bottom:1+(0<r?r/s.height:0),right:1+(0<o?o/s.width:0)}}},i.getPosition=y,i.getCanvasItemsByLevel=function(e){for(var t={},i=0,n=o.getSelectedCanvasItems(e);i<n.length;i++){var r=n[i],a=r.parentGroup?r.parentGroup.name:"root";t[a]=t[a]||[],t[a].push(r)}return t},i.filterContractsByTabOrderSign=function(e,t){return _.filter(e,(function(e){e=i.getPosition(e,0).tabOrder;return t?void 0===e||0<=e:e&&e<0}))},i.getOutspacePaneWidth=function(e){return(e=e.getCurrentSection())&&e.evaluatedObjects&&e.evaluatedObjects.outspacePane&&e.evaluatedObjects.outspacePane.width||t.DefaultOutspacePaneWidth}})(powerbi=powerbi||{}),(function(r){var e,a,o;function s(e){e=e.solid.color;return jsCommon.Color.isHexString(e.value)?{solid:{color:e.value}}:null}function t(e,t){var i,n;return{minValue:i=void 0!==e.minValue?u(e.minValue,t):i,maxValue:n=void 0!==e.maxValue?u(e.maxValue,t):n,positiveColor:r.fillDefinitionHelpers.createSolidFillDefinition(e.positiveColor&&e.positiveColor.solid.color,"maxColor"),negativeColor:r.fillDefinitionHelpers.createSolidFillDefinition(e.negativeColor&&e.negativeColor.solid.color,"minColor"),axisColor:r.fillDefinitionHelpers.createSolidFillDefinition(e.axisColor&&e.axisColor.solid.color,"foreground"),reverseDirection:o.boolean(e.reverseDirection),hideText:o.boolean(e.hideText)}}function l(e,t){return r.VisualObjectRepetition.getDefinition(e,t)}function u(e,t){var i;return t.integer?(i=Math.round(e),o.integer(i)):2===t.primitiveType?o.decimal(e):o.double(e)}e=(e=r.explore||(r.explore={})).util||(e.util={}),o=r.data.SQExprBuilder,(a=e.DataBarsUtil||(e.DataBarsUtil={})).DefaultDataBarsSettings={reverseDirection:!1,hideText:!1},a.getDataBarsSettings=function(e,t){var i,n;return(e=l(e.objects,t))?{minValue:i=(t=e.minValue)?t.value:i,maxValue:n=(t=e.maxValue)?t.value:n,positiveColor:s(e.positiveColor),negativeColor:s(e.negativeColor),axisColor:s(e.axisColor),reverseDirection:e.reverseDirection.value,hideText:e.hideText.value}:a.DefaultDataBarsSettings},a.createDefaultDataBarsDefinition=function(){return t(a.DefaultDataBarsSettings,r.ValueType.fromPrimitiveTypeAndCategory(12))},a.createDataBarsDefinition=t,a.getDefinition=l,a.isDataBarsApplied=function(e,t){return void 0!==l(e,t)}})(powerbi=powerbi||{}),(function(e){var t;function i(e){return e in t?t[e]:0}e=(e=(e=e.explore||(e.explore={})).util||(e.util={})).ErrorDetailsUtility||(e.ErrorDetailsUtility={}),t={BlockedCustomVisual:1,ScriptVisualsNotEnabled:1,UnapprovedCustomVisual:1,CvApiVersionNotSupported:1,AzureMapUserNotSignedIn:1},e.hasAdditionalErrorInfo=function(e){return!(!e||(e=e.displayableErrorInfo,_.isEmpty(e))||_.isEmpty(e[0].errorInfoKey)||_.isEmpty(e[0].errorInfoValue))},e.getErrorOverlayType=i,e.shouldHideSeeDetails=function(e){return 1===i(e)}})(powerbi=powerbi||{}),(function(e){(e=(e=(e=e.explore||(e.explore={})).util||(e.util={})).EventBubblingUtility||(e.EventBubblingUtility={})).handled=function(e){var t;if(e)return void 0!==(t=(null!=(t=e.originalEvent)?t:e).handled)&&!0===t},e.markAsHandled=function(e){var t;e&&((null!=(t=e.originalEvent)?t:e).handled=!0)}})(powerbi=powerbi||{}),(function(e){(e=(e=(e=e.explore||(e.explore={})).util||(e.util={})).ExplorationTrustedVisualUtil||(e.ExplorationTrustedVisualUtil={})).explorationContainsTrustedVisual=function(t,e,i){return!!i.isTrustedVisual(t)&&_.some(e.sections,(function(e){return _.some(e.visualContainers,(function(e){return e.config.singleVisual.visualType===t}))}))},e.acquireTrustedVisuals=function(e,t){for(var i=[],n=0,r=e.sections;n<r.length;n++)for(var a=0,o=r[n].visualContainers;a<o.length;a++){var s=o[a].config.singleVisual.visualType;s&&t.isTrustedVisual(s)&&i.push(s)}return t.getConsentAndLoadVisuals(i)}})(powerbi=powerbi||{}),(function(A){var D,M,I,n,N,O,B;D=A.explore||(A.explore={}),M=D.util||(D.util={}),I=A.explore.contracts.FilterType,n=A.explore.services.FormatPainter,N=jsCommon.JsonExtensions,O=A.data.services.SemanticQuerySerializer,B=A.explore.util.VisualContainerUtils,(M.ExploreClipboardHandlerUtility||(M.ExploreClipboardHandlerUtility={})).createClipboardHandler=function(v,m,g,y,f,C,S,E,c,b,w,x,e,u,t,V){var i=this;function F(e){for(var t=0,i=e;t<i.length;t++)i[t].config.singleVisual.syncGroup=null}function P(e,t,i){var n,r,a=[],o=(n=v.exploration.contract.sections,r=e,_.find(n,(function(e){return e.name===r})));if(o)for(var s=0;s<i.length;s++){var l,u=i[s];D.contracts.isVisualContainer(u)&&(l=c.capabilities(u.config.singleVisual.visualType))&&l.supportsSynchronizingFilterState&&u.config.singleVisual.query&&!u.config.singleVisual.syncGroup&&(l=(function(e,t){return _.find(e,(function(e){return e.name===t}))})(o.visualContainers,m.deserializeCanvasItem(t[s]).name))&&a.push({sourceVisual:l,newVisual:u})}return a}function T(l){return __awaiter(this,void 0,A.Promise,(function(){var t,i,n,r,a,o,s;return __generator(this,(function(e){switch(e.label){case 0:return[4,f.get(C.get())];case 1:for(t=e.sent(),i=(function(){for(var e={},t=0,i=v.exploration.contract.sections;t<i.length;t++)for(var n=0,r=i[t].visualContainers;n<r.length;n++){var a=r[n].config.singleVisual.syncGroup;a&&(e[a.groupName]=!0)}return e})(),n=0,r=l;n<r.length;n++)a=r[n],o=a.sourceVisual.config.singleVisual,(s=o.syncGroup)?a.newVisual.config.singleVisual.syncGroup=__assign({},s):(s=u.generateUniqueGroupName(t,o,i),o.syncGroup={groupName:s,fieldChanges:!0,filterChanges:!0},a.newVisual.config.singleVisual.syncGroup={groupName:s,fieldChanges:!0,filterChanges:!0},i[s]=!0);return[2]}}))}))}return{deleteSelection:function(){v.exploration&&v.exploration.exploreCanvas&&E.deleteSelectedVisuals(v.exploration.exploreCanvas)},deserializeAndDuplicateData:function(c,p,h,d){return __awaiter(i,void 0,void 0,(function(){var t,i,n,r,a,o,s,l,u;return __generator(this,(function(e){switch(e.label){case 0:return v.exploration&&v.exploration.exploreCanvas&&h.length?d?[3,2]:[4,f.get(C.get())]:[2];case 1:for(t=e.sent(),i=0,n=h;i<n.length;i++)!(function(e,i){if(e.filters){for(var t=N.tryParseJSON(e.filters),n=function(e){var t;return e.type===I[I.Categorical]&&null!=e.filter&&(t=(function(e,t){var i,e=e&&e.HierarchyLevel,e=e&&e.Expression&&e.Expression.Hierarchy,e=e&&e.Expression&&e.Expression.PropertyVariationSource;if(e){i=O.deserializeExpr(e.Expression).getTargetEntity(),i=i&&i.entity;for(var n=i,r=e.Property,a=e.Name,o=0,s=t.schemas;o<s.length;o++)for(var l=s[o],u=0,c=l.entities;u<c.length;u++){var p=c[u];if(p.name===n)for(var h=0,d=p.properties;h<d.length;h++){var v=d[h];if(v.name===r){v=v.column;if(v&&v.variations)for(var m=0,g=v.variations;m<g.length;m++){var y=g[m];if(y.name===a)return y.navigationProperty.targetEntity.name}}}}}})(e.expression,i))?void(e.filter.From[0].Entity=t):"continue"},r=0,a=t;r<a.length;r++){var o=a[r];n(o)}e.filters=JSON.stringify(t)}})(n[i],t);e.label=2;case 2:return(o=v.exploration,r=o.contract,u=o.exploreCanvas,a=r&&r.settings&&r.settings.useStylableVisualContainerHeader,o=M.CanvasVisualsUtility.duplicateCanvasItems(h,o.contract,u.contract,m,w,E,u,S,b,a))?(!d&&V&&B.hasVisualColumnRename(o)&&V.syncVisualColumnRenames(r),1===c?[2]:(s=_.filter(o,(function(e){return D.contracts.isVisualContainer(e)&&e.config.singleVisual.syncGroup})),p===v.exploration.exploreCanvas.contract.name?(F(s),[2]):(l=P(p,h,o),_.isEmpty(s)&&_.isEmpty(l)?[2]:[4,y.promptHostSimpleDialog("syncVisuals",{title:g.get("SyncVisualsDialog_Title"),message:g.get("SyncVisualsDialog_Message"),okButtonText:g.get("SyncVisualsDialog_Sync"),cancelButtonText:g.get("SyncVisualsDialog_DoNotSync")})]))):[2];case 3:return(u=1===e.sent(),x.logEvent(A.telemetry.EXCopyPasteSyncGroup,{keepSynced:u,visualGroupCount:l.length}),u)?[4,T(l)]:[3,5];case 4:return e.sent(),[3,6];case 5:F(s),e.label=6;case 6:return[2]}}))}))},serializeSelection:function(){return __awaiter(i,void 0,void 0,(function(){var t,i,n;return __generator(this,(function(e){switch(e.label){case 0:return i=(t=M.CanvasVisualsUtility).serializeSelection,n=[m,S],[4,f.get(C.get())];case 1:return[2,i.apply(t,n.concat([e.sent()]))]}}))}))},getSelectionResources:function(){return M.CanvasVisualsUtility.getSelectionResources(S,v.exploration.contract.resourcePackages)},getSelectionSectionName:function(){return v.exploration.exploreCanvas.contract.name},deserializeVisualContainer:function(e){return m.deserializeCanvasItem(e,!0)},copyCanvasItemFormat:function(){return n.copyFormatCanvasItem(S,c,v.exploration.contract.themeCollection,t)},pasteCanvasItemFormat:function(e){e=n.pasteFormatCanvasItem(S,c,e);e&&E.raiseCanvasItemChanged(e)},isReady:function(){return null!=v.exploration}}}})(powerbi=powerbi||{}),(function(r){var e,t;e=(e=r.explore||(r.explore={})).util||(e.util={}),t=r.explore.contracts.FilterType,e.logDrillthroughFilterUpdateTelemetry=function(e,t,i,n){i=_.filter(i.filters,(function(e){return 5===e.howCreated})),e.logChildEvent(n&&n.event,r.telemetry.EXDrillthroughFilterUpdate,{type:t,countOfCurrentPageDrillthroughFilters:i.length})},e.getTelemetryFieldKind=function(e){var t;switch(t=e?e.kind:t){case 0:return"Entity";case 2:return"ColumnRef";case 3:return"MeasureRef";case 4:return"Aggregation";case 5:return"PropertyVariationSource";case 6:return"Hierarchy";case 7:return"HierarchyLevel";case 46:return"Sparkline";case 47:return"VisualCalculation";default:return"Other"}},e.getTelemetryFilterType=function(e){switch(e){case t.Advanced:return"Advanced";case t.Categorical:return"Categorical";case t.Passthrough:return"Passthrough";case t.Range:return"Range";case t.Visual:return"Visual"}},e.getTelemetryFilterScopeType=function(e){switch(e){case 2:return"Exploration";case 1:return"Section";case 0:return"Visual"}},e.getTelemetryViewMode=function(e){switch(e){case 0:return"View";case 1:return"Edit"}},e.getTelemetryFilterCardSortType=function(e){switch(e){case 1:return"Ascending";case 2:return"Descending";case 3:return"Custom"}}})(powerbi=powerbi||{}),(function(t){var e;function i(){}e=(e=t.explore||(t.explore={})).util||(e.util={}),i.getDefaultVisualPlugin=function(e){return e&&e.featureSwitches&&e.featureSwitches.pivotTableVisualEnabled?t.visuals.plugins.tableEx:t.visuals.plugins.table},e.FieldWellUtility=i})(powerbi=powerbi||{}),(function(a){var n,e,t,r,o,s;function i(e,t,i){return 0===e.displayOption?s.Dynamic:e.width===n.constants.ExploreCanvasConstants.DefaultCanvasWidth&&e.height===o.DefaultCanvasHeight?s.Standard:e.width===n.constants.ExploreCanvasConstants.DefaultWidescreenWidth&&e.height===o.DefaultWidescreenHeight?s.Widescreen:r.isCortanaPageSize(e)?-1!==(i=n.PodUtils.findPodIndexForSectionName(t,i.name))&&t.pods[i].cortanaEnabled?s.Cortana:s.Custom:e.width===n.constants.ExploreCanvasConstants.DefaultLetterWidth&&e.height===o.DefaultLetterHeight?s.Letter:(t=e).width===n.constants.ExploreCanvasConstants.DefaultTooltipWidth&&t.height===n.constants.ExploreCanvasConstants.DefaultTooltipHeight?s.Tooltip:s.Custom}n=a.explore||(a.explore={}),e=n.util||(n.util={}),r=a.explore.util.CanvasDisplayUtility,o=n.constants.ExploreCanvasConstants,s=a.explore.contracts.SectionPageSizeTypes.PageSizeTypes,(t=e.PropertyPaneUtils||(e.PropertyPaneUtils={})).PageSizeTypesToSectionSize=((e={})[s.Dynamic]={displayOption:0,width:n.constants.ExploreCanvasConstants.DefaultCanvasWidth,height:n.constants.ExploreCanvasConstants.DefaultCanvasHeight},e[s.Standard]={displayOption:1,width:n.constants.ExploreCanvasConstants.DefaultCanvasWidth,height:n.constants.ExploreCanvasConstants.DefaultCanvasHeight},e[s.Widescreen]={displayOption:1,width:n.constants.ExploreCanvasConstants.DefaultWidescreenWidth,height:n.constants.ExploreCanvasConstants.DefaultWidescreenHeight},e[s.Cortana]={displayOption:3,width:n.constants.ExploreCanvasConstants.DefaultCortanaWidth,height:n.constants.ExploreCanvasConstants.DefaultCortanaHeight},e[s.Letter]={displayOption:1,width:n.constants.ExploreCanvasConstants.DefaultLetterWidth,height:n.constants.ExploreCanvasConstants.DefaultLetterHeight},e[s.Tooltip]={displayOption:1,width:n.constants.ExploreCanvasConstants.DefaultTooltipWidth,height:n.constants.ExploreCanvasConstants.DefaultTooltipHeight},e[s.Custom]={displayOption:3,width:n.constants.ExploreCanvasConstants.DefaultCanvasWidth,height:n.constants.ExploreCanvasConstants.DefaultCanvasHeight},e),t.getDisplayNames=function(e){for(var t=[],i=0,n=e;i<n.length;i++){var r=n[i];t.push(__assign(__assign({},r),{value:"".concat(r.value),displayName:a.explore.viewModels.ViewModelFactory.getDisplayName(r.displayName)}))}return t},t.getDisplayUnits=function(e){for(var t=[],i=0,n=a.visuals.valueFormatter.getDisplayUnits(e=void 0===e?!1:e);i<n.length;i++){var r=n[i];t.push({displayName:r.title,value:r.value.toString()})}return t},t.getPageSizeType=function(e,t){return i(e,t.getCurrentExploration(),t.getCurrentSection())},t.getPageSizeTypeBySection=i,t.getDefaultSectionSize=function(e){return t.PageSizeTypesToSectionSize[e]}})(powerbi=powerbi||{}),(function(e){(e=(e=e.explore||(e.explore={})).ScopeUtils||(e.ScopeUtils={})).getSchemaPromise=function(e,t,i){return e?i.get(e):t.reject()},e.defineDataSourcesOnScopeLegacy=function(e,t){Object.defineProperty(e,"dataSources",{get:function(){return t.get()},set:function(e){return t.set(e)}})}})(powerbi=powerbi||{}),(function(e){var t,l,n;t=(t=e.explore||(e.explore={})).util||(t.util={}),l=e.data.SQExpr,n=e.explore.util.VisualContainerUtils,(t=t.SparklinesUtil||(t.SparklinesUtil={})).containsSparklineData=function(e){return _.some(n.getSelectExprs(e),(function(e){return l.isSparklineData(e.expr)}))},t.replaceSparklineDataWithMeasure=function(r,a,o){var e=n.getSelectExprs(a);if(!_.isEmpty(e))for(var s=n.getVisualQuery(a),t=0,i=e;t<i.length;t++)!(function(e){var t,i,n=e.expr;l.isSparklineData(n)&&(t=n.measure,i=s.getRoleNameForExpr(n),e=_.chain(s.tryGetExprs(i)).map((function(e,t){return{expr:e,index:t}})).filter((function(e){return l.equals(e.expr,n)})).map((function(e){return e.index})).value(),_.forEach(e,(function(e){return o.replaceField(r,t,i,e,a)})))})(i[t])},t.getFieldCharacteristics=function(e,t){(t=null==(t=e.grouping[0].getMetadata(t))?void 0:t.type)&&(i=t.dateTime||t.temporal?"Date":t.numeric?"Numeric":"Categorical");var i,t=l.isAggregation(e.measure)?"Aggregate":"Measure";return{groupingType:i,measureType:t}}})(powerbi=powerbi||{}),(function(p){var r,e,c,h;function d(e,t,i,n,r,a){var o;e&&t&&(o=e.getAdapter())&&n&&o.update({viewport:t,suppressAnimations:!0,dataViews:e.getDataViews(),type:i,resizeMode:a,viewMode:n.getViewMode(),editMode:r})}function v(e){var t=e.warnings,i=e.dataBoundObjectWarnings,n=t?_.cloneDeep(t):{};if(!_.isEmpty(i))for(var r in n.visualObjectWarnings||(n.visualObjectWarnings={}),i){var a=n.visualObjectWarnings[r];a?a.push.apply(a,i[r]||[]):n.visualObjectWarnings[r]=i[r]}return n}function m(e,t,i,n){if(_.isArray(t)){var r=_.filter(t,(function(e){return!(e instanceof h)}));if(_.isEmpty(r)){e.dataBoundObjectWarnings||(e.dataBoundObjectWarnings={});for(var a=0,o=_.filter(t,(function(e){return e instanceof h}));a<o.length;a++){var s,l=o[a],u=l.propertyId.objectName;i&&c.objectIsHidden(u,i,n)||(l={selector:l.selector,warnings:[l]},(s=e.dataBoundObjectWarnings[u])?s.push(l):e.dataBoundObjectWarnings[u]=[l])}}else e.warnings={warnings:r}}else e.warnings=t}r=p.explore||(p.explore={}),e=(e=r.util||(r.util={})).VisualContainerUtils||(e.VisualContainerUtils={}),c=p.explore.util.CanvasVisualsUtility,h=p.data.DataBoundExprWarning,e.updateVisual=d,e.wrapRunningVisual=function(a,i,n,e,t,r,o,s,l,u){var c={getType:function(){return a.type},setType:function(e){return a.type=e},getViewport:function(){return a.viewport},setViewport:function(e,t){a.viewport=e,t&&d(c,e,p.VisualUpdateType.Resize,i,n)},getData:function(){return a.data},getAdapter:function(){return a.visual},getDataViews:function(){return a.dataViews},setDataViews:function(e){return a.dataViews=e},getDataTransforms:function(){return a.dataTransforms},setThemeCollection:function(e){return a.themeCollection=e},getIsInFocus:function(){return a.isInFocus},setIsInFocus:function(e){return a.isInFocus=e},setData:function(e,t,i){a.data=e,a.dataAppliedEvent&&(a.dataAppliedEvent.reject(),a.dataAppliedEvent=void 0),a.performanceActivity&&(a.performanceActivity.cancel(!0),a.performanceActivity=void 0),a.dataAppliedEvent=t,a.performanceActivity=i},setDataTransforms:function(e){return a.dataTransforms=e},setPendingSelection:function(e){return a.pendingSelection=e},hasPendingSelection:function(){return!!a.pendingSelection},setAdditionalObjectUpdates:function(e){return a.additionalObjectUpdates=e},setIsDisabled:function(e){return a.isDisabled=e},getIsDisabled:function(){return a.isDisabled},setIsDisabledIfUncertified:function(e){return a.isDisabledIfUncertified=e},getIsDisabledIfUncertified:function(){return a.isDisabledIfUncertified},setReportId:function(e){return a.reportId=e},getErrorInfo:function(){return a.errorInfo},setErrorInfo:function(e){return a.errorInfo=e},getWarnings:function(){return v(a)},getWarnings$:function(){return i.getWarnings$()},setWarnings:function(e,t,i){return m(a,e,t,i)},getDataBoundObjectWarnings:function(){return a.dataBoundObjectWarnings},resetWarnings:function(e){(e=void 0===e?!1:e)&&(a.dataBoundObjectWarnings={}),a.warnings=void 0},getHasPendingChanges:function(){return a.hasPendingChanges},setHasPendingChanges:function(e){return a.hasPendingChanges=e},getHasUnappliedFilterChanges:function(){return a.hasUnappliedFilterChanges},setHasUnappliedFilterChanges:function(e){return a.hasUnappliedFilterChanges=e},getSelectedDatapoints:function(){return a.selectedDatapoints},setSelectedDatapoints:function(e,t){var i=a,n=o,r=i.visual;t&&(r&&r.visualHasMethod&&r.visualHasMethod("onRestoreSelection")?r.onRestoreSelection({selection:e}):(m(i,[new p.visuals.OnRestoreSelectionNotSupportedWarning]),n&&n(v(i)))),i.selectedDatapoints=e},clearSelectedDatapoints:function(){a.selectedDatapoints=void 0;var e=a.visual;e&&e.onClearSelection&&e.onClearSelection(),t.selectDataPoint(r,[],void 0,void 0,1)},getSubSelectionStyles:function(e){if(l){var t=l.getSubSelectionStyles(e);if(t)return t}return a.visual&&a.visual.getSubSelectionStyles&&a.visual.getSubSelectionStyles(e)},getSubSelectionShortcuts:function(e,t){if(l&&!t){var i=l.getSubSelectionShortcuts(e,t);if(i)return i}return a.visual&&a.visual.getSubSelectionShortcuts&&a.visual.getSubSelectionShortcuts(e,t)},getSubSelectables:function(e){var t,i=[],n=null==(n=null==(t=null==a?void 0:a.visual)?void 0:t.getSubSelectables)?void 0:n.call(t,e);return n&&i.push.apply(i,n),l&&(t=l.getSubSelectables(e))&&i.push.apply(i,t),0!==i.length?i:void 0},onDataViewObjectChanged:function(e,t,i){if(i){if(!a.visual||!a.visual.visualHasMethod("onDataViewObjectChanged"))return e;i=a.visual.onDataViewObjectChanged(e,t);if(i)return i}else if(u){i=u.onDataViewObjectChanged(e,t);if(i)return i}return[]}};return s&&(c.sortServices=s),c},e.isQueryVisualEmpty=function(e,t,i){var n;return!(r.contracts.isVisualContainerGroup(i)||(i=null==i?void 0:i.config.singleVisual)&&(n=i.visualType,e=e.capabilities(n),i.query||!t.isQueryVisual(n)||"debugVisual"===n||e&&e.supportsLandingPage))}})(powerbi=powerbi||{}),(function(e){((e=(e=e.explore||(e.explore={})).util||(e.util={})).VisualHostServicesUtil||(e.VisualHostServicesUtil={})).createQueryVisualHostServices=function(){return{getFilters:function(){return{dataFilter:null,dataFiltersUnmerged:null}},getDataSourceVariables:function(){},getVisualRelationshipFilterAction:function(){return 0},selectDataPoint:_.noop,setVisualRelationshipFilterAction:_.noop}}})(powerbi=powerbi||{}),(function(u){var e,c,p,t,l,h,d,v,m,g,y,f,C,S,E;function b(e,t){return void 0===e?t:e}function w(e){if(e)return null===e.solid?null:e.solid?e.solid.color:void 0}function x(e,t,i,n,r,a,o){var s={size:"fontSize",family:"fontFamily",bold:u.DataViewObject.getValue(e,"bold")?"bold":void 0,italic:u.DataViewObject.getValue(e,"italic")?"italic":void 0,underline:u.DataViewObject.getValue(e,"underline")?"underline":void 0},t=t?l.createFromObjectOrStyle(e,s,void 0,n,void 0,"label",r):l.createFromDataViewObject(e,s,void 0,void 0,r),n=l.inherit(t,{color:a});return i&&(n=l.inherit(n,{size:h.createFromPt(o?d:v)})),l.flatten(n)}e=(e=(e=u.explore||(u.explore={})).util||(e.util={})).VisualTooltipStyleUtils||(e.VisualTooltipStyleUtils={}),c=u.visuals.ColorHelper,p=u.visuals.DefaultDataItemTooltipStyle,t=u.visuals.Font,l=u.visuals.FontProperties,h=u.visuals.Units.FontSize,d=11,v=9,m={size:p.titleFontProperties.size,family:p.titleFontProperties.family},g={size:p.valueFontProperties.size,family:p.valueFontProperties.family},y={size:p.titleFontProperties.size,family:t.Family.regular.css},f=p.titleFontProperties.color,C=p.valueFontProperties.color,S=p.background.solid.color,E=p.actionFontProperties.color,t="#252423",e.DefaultDataItemEnhancedTooltipStyle={titleFontProperties:{color:t,family:m.family,size:m.size,weight:p.titleFontProperties.weight},valueFontProperties:{color:t,family:g.family,size:g.size,weight:p.valueFontProperties.weight},actionFontProperties:{color:t,family:y.family,size:y.size},hoverColor:"#C8C6C4",dividerColor:"#C8C6C4",background:{solid:{color:"#FFFFFF"}},transparency:0},e.getVisualTooltipStyles=function(e,t,i,n,r){void 0===r&&(r=!1);var a=(l=(function(e,t,i){var n,r,a,o,s=!(!e||!(e.titleFontColor||e.valueFontColor||e.background));t&&!s?(n=b(w(e&&e.themedTitleFontColor),c.getThemeColor(i,u.visuals.ForegroundColorName)),r=b(w(e&&e.themedValueFontColor),c.getThemeColor(i,u.visuals.ForegroundColorName)),a=b(w(e&&e.themedBackground),c.getThemeColor(i,u.visuals.BackgroundColorName)),o=b(w(e&&e.actionFontColor),c.getThemeColor(i,u.visuals.ForegroundColorName))):t&&s?(n=b(b(w(e&&e.themedTitleFontColor),w(e&&e.titleFontColor)),f),r=b(b(w(e&&e.themedValueFontColor),w(e&&e.valueFontColor)),C),a=b(b(w(e&&e.themedBackground),w(e&&e.background)),S),o=b(w(e&&e.actionFontColor),n)):(n=b(w(e&&e.titleFontColor),f),r=b(w(e&&e.valueFontColor),C),a=b(w(e&&e.background),S));return{actionFontColor:o,backgroundColor:a,titleFontColor:n,valueFontColor:r}})(n,t,e)).actionFontColor,o=l.backgroundColor,s=l.titleFontColor,l=l.valueFontColor,a=void 0!==(a=void 0===a&&i?t?E:s:a)?x(n,t,i,e,y,a,r):void 0;return{titleFontProperties:x(n,t,i,e,m,s,r),valueFontProperties:x(n,t,i,e,g,l,r),actionFontProperties:a,discoverabilityFontProperties:t?_.clone(a):void 0,background:{solid:{color:o}},transparency:null!=(s=null==n?void 0:n.transparency)?s:t?0:p.transparency,hoverColor:c.getThemeColor(e,u.visuals.BackgroundNeutralName),dividerColor:c.getThemeColor(e,u.visuals.BackgroundNeutralName)}}})(powerbi=powerbi||{}),(function(e){(e=(e=e.explore||(e.explore={})).constants||(e.constants={})).scrollCarouselToEndEventName="scrollCarouselToEnd",e.pinVisualContainerEventName="pinVisualContainer",e.trustedVisualConsentStateChangedEventName="trustedVisualConsentStateChanged",e.invalidVisualContainerId=-1,e.updateNavButtonEvent="updateNavButtonEvent",e.ConnectionSetupLimit=4,e.smallFontSizeInPoint=9,e.MaxGroupingDepth=20,(e=e.ExploreCanvasConstants||(e.ExploreCanvasConstants={})).AutoLayoutVisualPadding=10,e.AutoLayoutVisualVCHeader=20,e.AutoLayoutVisualSkittlesRightPadding=30,e.AutoLayoutMaxSpaceHeight=300,e.AutoLayoutMaxSpaceWidth=300,e.AutoLayoutMinSpaceHeight=150,e.AutoLayoutMinSpaceWidth=150,e.ResponsiveLayoutMaxWidthBreakpoint=500,e.ScrollbarOffset=15,e.DefaultCanvasUiScale={x:1,y:1},e.DisplayAreaHeightAdditionMinimumScale=.9,e.DisplayAreaHeightScaleAddtion=.02,e.DisplayAreaOverflowEpsilonPx=8,e.DisplayAreaOutlineSize=8,e.DisplayAreaTransparencyOutlineThreshold=50,e.FieldListShimmeringBarHeight=24,e.PhoneAuthoringViewportHeight=558,e.PhoneAuthoringViewportWidth=324,e.PhonePortraitColumnCount=18,e.PhonePortraitRowCount=180,e.PhonePortraitCanvasHeight=3600})(powerbi=powerbi||{}),(function(e){((e=e.explore||(e.explore={})).modules||(e.modules={})).ExploreUIShellModule={name:"powerbi.exploreUIShell",dependency:{javascript:"ExploreUIShell/module"}}})(powerbi=powerbi||{}),(function(p){var e,i,t,h,s;function n(e,t){var i,n,r,a,o={color:h.color(t.minColor,"minColor")},s=t.minValue,s=(null!=s&&(i=h.double(s)),t.diverging&&(r={color:h.color(t.midColor,"midColor")},null!=(s=t.midValue))&&(n=h.double(s)),{color:h.color(t.maxColor,"maxColor")}),l=t.maxValue,l=(null!=l&&(a=h.double(l)),t.nullStrategy),u=t.nullColor,c={},t=t.diverging?c.linearGradient3={min:o,mid:r,max:s}:c.linearGradient2={min:o,max:s};return i&&(t.min.value=i),n&&(t.mid.value=n),a&&(t.max.value=a),l&&(t.nullColoringStrategy={strategy:h.text(l)},l===p.NullStrategy.specificColor)&&(t.nullColoringStrategy.color=h.color(u,"nullColor")),h.fillRule(e,c)}function r(e,t,i,n,r){var a,o;return 0<t&&(a=h.compare(2,e,s.overRangeOf(e,t/100))),i<100&&(o=h.compare(n?4:3,e,s.overRangeOf(e,i/100))),{condition:a&&o?h.and(a,o):a||o,value:r}}function a(e,t){return{condition:h.compare(0,e,h.text("")),value:t}}e=(e=p.explore||(p.explore={})).util||(e.util={}),t=p.visuals.GradientUtils,h=p.data.SQExprBuilder,s=p.data.SQRangePercentExpr,(i=e.ConditionalFormattingUtil||(e.ConditionalFormattingUtil={})).createDefaultGradientFillDefinition=function(e){return{solid:{color:n(e,t.getDefaultGradientSettings())}}},i.createFillExpression=n,i.createDefaultConditionalFillDefinition=function(e,t,i){var n;switch(i){case"number":n={condition:h.compare(3,e,h.double(0)),value:h.text(t)};break;case"text":n={condition:h.compare(0,e,h.text("")),value:h.text(t)}}return{solid:{color:h.conditional([n])}}},i.DefaultIconId="CircleHigh",i.DefaultIconLayout="Before",i.DefaultIconVerticalAlignment="Top",i.createDefaultIconDefinition=function(e,t){switch(t=void 0===t?"number":t){case"number":return{kind:"Icon",value:h.conditional([r(e,67,100,!0,h.text("CircleHigh")),r(e,33,67,!1,h.text("SignMedium")),r(e,0,33,!1,h.text("SignLow"))]),layout:h.text(i.DefaultIconLayout),verticalAlignment:h.text(i.DefaultIconVerticalAlignment)};case"text":return{kind:"Icon",value:h.conditional([a(e,h.text("CircleHigh")),a(e,h.text("SignMedium")),a(e,h.text("SignLow"))]),layout:h.text(i.DefaultIconLayout),verticalAlignment:h.text(i.DefaultIconVerticalAlignment)}}},i.createIconPercentCase=r,i.createIconTextCase=a,i.createIconNumberCase=function(e,t,i,n,r){var a,o;return null!==t&&(a=h.compare(2,e,h.double(t))),null!==i&&(o=h.compare(n?4:3,e,h.double(i))),{condition:a&&o?h.and(a,o):a||o,value:r}}})(powerbi=powerbi||{}),(function(e){((e=e.explore||(e.explore={})).htmlTemplate||(e.htmlTemplate={})).put=function(e){e.put("components/dateTimePicker/dateTimePicker.html",'<div class="datetimePicker" pbi-lazy-load-contents="$ctrl.moduleConfig"> <input type="text" aria-labelledby="{{ $ctrl.labelId }}" class="inputFieldInSlice" ng-blur="$ctrl.dateTextUpdated()" ng-model="$ctrl.textVal" ng-class="{\'ng-invalid\': $ctrl.inputInvalid}" placeholder="{{::$ctrl.placeholder}}"/> <button class="calendar" type="button" ng-attr-title="{{$ctrl.calendarButtonText}}" dropdown-overlay-invoke="{{$ctrl.id}}"><svg-use-symbol sheet="filterPaneIcons" symbol-id="fieldListEntity"></svg-use-symbol></button><dropdown-overlay class="calendarDropDown" dropdown-overlay-name="{{$ctrl.id}}"><datepicker class="calendar" ng-model="$ctrl.dateVal" ng-change="$ctrl.dateSelected()" onclick="event.stopPropagation()" show-weeks="false" min-date="$ctrl.validators.min" max-date="$ctrl.validators.max"></datepicker></dropdown-overlay></div>'),e.put("views/canvasVisualHeaderIcon.html",'<button tooltip tooltip-config="$ctrl.tooltipConfigManager.getTooltipConfig()" ng-disabled="!$ctrl.isClickable()" ng-switch="$ctrl.iconType"><i class="infoIcon glyphicon {{$ctrl.useStylableHeader() ? \'pbi-glyph-info-nocircle\' : \'pbi-glyph-info\'}}" ng-switch-when="info"></i><i class="warningIcon pbi-glyph-warning glyphicon" ng-switch-when="warning"></i><i class="errorIcon pbi-glyph-error glyphicon" ng-switch-when="error"></i></button>')}})(powerbi=powerbi||{}),(function(i){var e,t,n;function r(){n||(i.common.initializeAngularModule(),i.visualHost.initializeAngularModule(),angular.module("powerbi.explore.controllers",[]),angular.module("powerbi.explore.directives",[]),angular.module("powerbi.explore.components",[]),angular.module("powerbi.explore",["powerbi.common","powerbi.explore.controllers","powerbi.explore.directives","powerbi.explore.components","powerbi.visualHost"]).run(["lazyScopedFactories",function(e){}]).run(["$templateCache",t]),n=!0)}e=i.explore||(i.explore={}),t=i.explore.htmlTemplate.put,e.initializeAngularModule=r,n=!1,r(),e.registerBuildingBlocksForHost=function(e){var t=[{name:"DateTimePicker",blockType:2,consumerHostFlags:8203,factory:i.explore.components.DateTimePicker}];i.common.registerBuildingBlocksForHost(e,t,{componentsTarget:"powerbi.explore.components",directivesTarget:"powerbi.explore.directives"})}})(powerbi=powerbi||{}),(function(e){var t;function i(e,t){void 0===t&&(t=!1),this.localizationService=e,this.showIcons=t,this.allCommands=[]}t=(t=e.explore||(e.explore={})).components||(t.components={}),i.prototype.getItems=function(){return this.menuItems},i.prototype.getCommandByIndex=function(e){return this.allCommands[e]},i.prototype.createItems=function(n){return __awaiter(this,void 0,e.Promise,(function(){var t,i;return __generator(this,(function(e){switch(e.label){case 0:return t=[],[4,this.createMenuItemsFromCommands(n,t)];case 1:return(i=e.sent(),_.isEmpty(i))?[2,this.createNoAvailableActionsMenu()]:(this.allCommands=t,[2,{items:i}])}}))}))},i.prototype.createNoAvailableActionsMenu=function(){var e=[],t=this.localizationService.get("VisualContainer_ContextMenu_NoAvailableActions"),t=this.createMenuItem(null,t,null);return t.disabled=!0,e.push(t),{items:e}},i.prototype.createMenuItemsFromCommands=function(p,h){return void 0===h&&(h=[]),__awaiter(this,void 0,e.Promise,(function(){var t,i,n,r,a,o,s,l,u,c;return __generator(this,(function(e){switch(e.label){case 0:if(_.isEmpty(p))return[2];t=[],i=0,n=p,e.label=1;case 1:return i<n.length?[4,(r=n[i]).isVisible()]:[3,11];case 2:return e.sent()?(1===r.separatorPosition&&(c=this.createItemSeparator(),t.push(c)),o=a=void 0,r.getToolTip?[4,r.getToolTip(this.localizationService)]:[3,4]):[3,10];case 3:o=e.sent(),e.label=4;case 4:return(l=r.isDisabled)?[4,r.isDisabled()]:[3,6];case 5:l=e.sent(),e.label=6;case 6:return(s=l)?[3,9]:[4,r.getChildren()];case 7:return u=e.sent(),[4,this.createMenuItemsFromCommands(u,h)];case 8:a=e.sent(),e.label=9;case 9:h.push(r),u=this.createMenuItem(h.length-1,r.title(this.localizationService),s,a,r.glyph,r.selected,r.customIcon,o),t.push(u),2===r.separatorPosition&&(c=this.createItemSeparator(),t.push(c)),e.label=10;case 10:return i++,[3,1];case 11:return[2,t]}}))}))},i.prototype.createMenuItem=function(e,t,i,n,r,a,o,s){return{type:0,key:e,text:t,children:n,icon:r,selected:a,customIcon:o,showIcon:this.showIcons,disabled:i,tooltip:s}},i.prototype.createItemSeparator=function(){return{type:1,checked:!1}},t.VisualContainerContextMenu=i})(powerbi=powerbi||{}),(function(e){var C,S,M;function t(e,t,i,n,r,a,o,s,l,u,c,p,h,d,v,m,g,y,f,C,S,E,b,w,x,V,F,P,_,T,A,D){this.conceptualSchemaProxy=e,this.contextActivityService=t,this.clipboard=i,this.dataSources=n,this.drill=r,this.expandCollapse=a,this.eventBridge=o,this.explorationCapabilities=s,this.explorationNavigation=l,this.explorationExtensibility=u,this.featureSwitchService=c,this.filterGenerator=p,this.groupAuthoring=h,this.includeExcludeService=d,this.lazyScoped=v,this.drillToDetails=m,this.panesVisibilityService=g,this.pluginOps=y,this.promiseFactory=f,this.telemetryService=C,this.viewModeState=S,this.visibility=E,this.visualAuthoring=b,this.overlayService=w,this.undoRedo=x,this.visualPlugin=V,this.selection=F,this.layoutAuthoring=P,this.runningVisualService=_,this.copyVisualImageService=T,this.visualCalcEagerService=A,this.visualContainerCopyService=D}C=e.explore||(e.explore={}),(S=C.services||(C.services={})).createVisualContainerMenuFactoryService=function(e,t,i,n,r,a,o,s,l,u,c,p,h,d,v,m,g,y,f,C,S,E,b,w,x,V,F,P,_,T,A,D){return new M(e,t,i,n,r,a,l,u,c,o,p,C,h,d,v,s,E,b,g,S,f,m,y,w,x,V,F,P,_,T,A,D)},t.prototype.createDrillthroughCommands=function(e,t,i){var n=this.explorationExtensibility.getCommandsDisplayOptions(e.name);return new S.DrillthroughCommandCollection(e,t,"ModeOn",this.drill,this.explorationNavigation,this.lazyScoped,this.pluginOps,i,this.telemetryService,this.contextActivityService,"ContextMenu",void 0,n)},t.prototype.createOptionsCommands=function(e,t,i){var n=this.explorationNavigation.getCurrentExploration().settings,r=this.explorationExtensibility.getCommandsDisplayOptions(e.contract.name),n=__spreadArray(__spreadArray(__spreadArray(__spreadArray(__spreadArray(__spreadArray(__spreadArray([],this.featureSwitchService.featureSwitches.visualSharingEntryPointOptions?[new S.VisualContainerShareCommandsCollection(this.eventBridge,this.explorationCapabilities,this.viewModeState,this.visibility,t,this.contextActivityService,"VisualHeader",e,this.featureSwitchService,r)]:[],!0),[new S.AddCommentVisualCommand(e,this.eventBridge,t,this.contextActivityService,"VisualHeader",r)],!1),this.featureSwitchService.featureSwitches.reflexPBI?[new S.ReflexTriggerCommand(e,this.selection,this.panesVisibilityService,this.featureSwitchService,this.explorationCapabilities,this.contextActivityService,"VisualHeader",r)]:[],!0),this.featureSwitchService.featureSwitches.visualSharingEntryPointOptions?[]:[new S.ShareToTeamsVisualCommand(e,this.visibility,this.eventBridge,t,this.contextActivityService,"VisualHeader",r)],!0),[new S.ToggleSearchCommand(e,this.filterGenerator,this.overlayService,this.undoRedo,this.visualAuthoring,this.visualPlugin,t,this.contextActivityService,"VisualHeader",r),new S.EnterAdvancedEditModeCommand(e,this.eventBridge,this.overlayService,t,this.contextActivityService,"VisualHeader",r),new S.ExportVisualDataCommand(e,this.conceptualSchemaProxy,this.dataSources,this.eventBridge,this.featureSwitchService,this.filterGenerator,this.overlayService,t,n,this.contextActivityService,"VisualHeader",r),new S.SeeDataCommand(e.contract,this.explorationCapabilities,this.drill,this.visibility,this.pluginOps,this.contextActivityService,"VisualHeader",!0,this.viewModeState,r),new S.DeleteVisualContainerCommand(e,this.eventBridge,this.undoRedo,t,this.contextActivityService,"VisualHeader",r),new S.GetClustersCommand(e,this.eventBridge,t,this.contextActivityService,"VisualHeader",r),new S.ToggleSpotlightCommand(e,this.visibility,t,this.contextActivityService,"VisualHeader",r),new S.GetInsightsCommand(e,t,this.lazyScoped,this.telemetryService,this.contextActivityService,"VisualHeader",r)],!1),this.getSortCommands(e,t,r),!0),[new S.TurnOnFormatModeCommand(this.featureSwitchService,this.panesVisibilityService,this.viewModeState,e.contract,this.selection,this.visualPlugin,this.pluginOps,this.visibility,r)],!1);return this.getCustomCommands(n,1,e.contract,i,void 0,r)},t.prototype.getSortCommands=function(e,t,i){if(_.isEmpty(t.sortSetting.sortGroups))return[];var n,r=t.sortSetting.sortGroups;if(1===r.length&&r[0].isDefaultGroup)return n=r[0],[new S.SortDescendingCommand(e,this.eventBridge,this.overlayService,t,n,this.contextActivityService,"VisualHeader",i),new S.SortAscendingCommand(e,this.eventBridge,this.overlayService,t,n,this.contextActivityService,"VisualHeader",i),new S.SortByCommandCollection(e,this.eventBridge,this.overlayService,t,this.contextActivityService,"VisualHeader",i)];for(var a=[],o=0,s=r;o<s.length;o++){var l=s[o],l=new S.GroupedSortByCommandCollection(e,this.eventBridge,this.overlayService,t,l,this.contextActivityService,"VisualHeader",i);a.push(l)}return a},t.prototype.createNonQueryCommands=function(e,t){var i=this.explorationExtensibility.getCommandsDisplayOptions(e.name),n=this.explorationNavigation.getCurrentExploration().settings,t=__spreadArray(__spreadArray([],C.contracts.isVisualContainerGroup(e.contract)?[]:[new S.VisualContainerShareCommandsCollection(this.eventBridge,this.explorationCapabilities,this.viewModeState,this.visibility,__assign(__assign({},t),{canShareVisual:!0}),this.contextActivityService,"ContextMenu",e,this.featureSwitchService,i)],!0),[new S.VisualContainerGroupingCommandsCollection(e.contract,this.selection,this.layoutAuthoring,this.viewModeState,n,i)],!1);return this.featureSwitchService.featureSwitches.daxTransformEnabled&&t.push(new S.SummarizeVisualContainerCommand(e.contract,this.explorationNavigation,this.pluginOps,this.selection,this.visualAuthoring,this.viewModeState,i,this.runningVisualService,this.contextActivityService,"ContextMenu")),this.featureSwitchService.featureSwitches.onObject&&t.push(new S.TurnOnFormatModeCommand(this.featureSwitchService,this.panesVisibilityService,this.viewModeState,e.contract,this.selection,this.visualPlugin,this.pluginOps,this.visibility,i)),t},t.prototype.createCommands=function(p,h,d,v,m,g,y,f){return __awaiter(this,void 0,e.Promise,(function(){var t,i,n,r,a,o,s,l,u,c;return __generator(this,(function(e){switch(e.label){case 0:return!m||C.contracts.isVisualContainerGroup(p.contract)?[2,this.createNonQueryCommands(p,g)]:(t=p,i=this.runningVisualService.getVisual(p.contract),n=h.data,r=h.dataRoles,a=h.nodeIndex,o=h.position,s=[],l=this.explorationExtensibility.getCommandsDisplayOptions(t.name),u=this.explorationNavigation.getCurrentExploration().settings,s.push(new S.VisualContainerShareCommandsCollection(this.eventBridge,this.explorationCapabilities,this.viewModeState,this.visibility,__assign(__assign({},g),{canShareVisual:!0}),this.contextActivityService,"ContextMenu",t,this.featureSwitchService,l)),[4,this.conceptualSchemaProxy.get(this.dataSources.get())]);case 1:return c=e.sent().schema(void 0),this.expandCollapse.isSupported(c&&c.capabilities,p.contract,r)&&this.expandCollapse.isEnabled(p.contract,r)&&(c=this.expandCollapse.getAllowedActions(p.contract,r,n))&&(s.push(new S.ExpandCollapseCommandsCollection(t.contract,c,!1,n,r,a,v,this.contextActivityService,"ContextMenu",l)),s.push(new S.ExpandCollapseCommandsCollection(t.contract,c,!0,n,r,a,v,this.contextActivityService,"ContextMenu",l))),s.push(new S.DrillDownCommand(p.contract,n,r,this.dataSources,this.drill,this.visualAuthoring,i,this.contextActivityService,"ContextMenu",void 0,l),new S.DrillToDetailsCommand(p.contract,this.explorationCapabilities,n,this.drill,this.dataSources,this.drillToDetails,i,this.contextActivityService,"ContextMenu",l),new S.SeeDataCommand(p.contract,this.explorationCapabilities,this.drill,this.visibility,this.pluginOps,this.contextActivityService,"ContextMenu",void 0,this.viewModeState,l),new S.CreateVisualCalculationCommand(p.contract,this.contextActivityService,"ContextMenu",this.visualCalcEagerService,l),new S.DrillDownLevelWithoutCurrentGroupCommand(p.contract,r,this.visualAuthoring,this.drill,i,this.contextActivityService,"ContextMenu",l),new S.DrillDownLevelWithCurrentGroupCommand(p.contract,r,this.visualAuthoring,this.drill,i,this.contextActivityService,"ContextMenu",l),new S.DrillUpCommand(p.contract,n,r,this.drill,this.visualAuthoring,i,this.contextActivityService,"ContextMenu",void 0,l),new S.CreateGroupCommand(p.contract,n,this.conceptualSchemaProxy,this.dataSources,this.featureSwitchService,this.groupAuthoring,this.promiseFactory,l),new S.IncludeCommand(p.contract,n,this.conceptualSchemaProxy,this.dataSources,this.featureSwitchService,this.includeExcludeService,this.promiseFactory,this.contextActivityService,"ContextMenu",f,l),new S.ExcludeCommand(p.contract,n,this.conceptualSchemaProxy,this.dataSources,this.featureSwitchService,this.includeExcludeService,this.promiseFactory,this.contextActivityService,"ContextMenu",f,l),new S.DrillthroughCommandCollection(p.contract,n,"ContextMenu",this.drill,this.explorationNavigation,this.lazyScoped,this.pluginOps,d,this.telemetryService,this.contextActivityService,"ContextMenu",void 0,l),new S.InsightsAnalysisCommandsCollection(p.contract,n,o,this.conceptualSchemaProxy,this.dataSources,this.eventBridge,this.explorationCapabilities,this.explorationNavigation,this.lazyScoped,this.viewModeState,d,void 0,this.contextActivityService,"ContextMenu",l),new S.VisualContainerGroupingCommandsCollection(p.contract,this.selection,this.layoutAuthoring,this.viewModeState,u,l),new S.ClearSelectionCommand(t.contract,i,this.contextActivityService,"ContextMenu",l)),this.featureSwitchService.featureSwitches.daxTransformEnabled&&s.push(new S.SummarizeVisualContainerCommand(t.contract,this.explorationNavigation,this.pluginOps,this.selection,this.visualAuthoring,this.viewModeState,l,this.runningVisualService,this.contextActivityService,"ContextMenu")),0<(c=new S.CopyCommandsCollection(t,this.clipboard,this.featureSwitchService,this.copyVisualImageService,this.telemetryService,this.visualContainerCopyService,this.explorationCapabilities,this.explorationNavigation,this.visibility,this.viewModeState,h,this.eventBridge,this.contextActivityService,"ContextMenu",l)).commandsCount&&(this.featureSwitchService.featureSwitches.copyPasteMenuImage||this.featureSwitchService.featureSwitches.copyPasteMenuMetadata?s.unshift(c):s.push(c)),this.featureSwitchService.featureSwitches.onObject&&s.push(new S.TurnOnFormatModeCommand(this.featureSwitchService,this.panesVisibilityService,this.viewModeState,p.contract,this.selection,this.visualPlugin,this.pluginOps,this.visibility,l)),[2,this.getCustomCommands(s,0,t.contract,n,y,l)]}}))}))},t.prototype.getCustomCommands=function(n,r,a,o,s,l){var e,u=this,c={};return null!=(e=this.explorationExtensibility.getGroups())&&e.forEach((function(e){c[e.name]=new S.ExtensionCommandsGroup(e.title,l,e.menuLocation)})),this.getCommandExtensions(a,r).forEach((function(e){var t=u.getCommandMenuExtension(e,r),e=new S.ExtensionCommand(a,o,e.name,t.title||e.title,u.eventBridge,u.explorationExtensibility,u.featureSwitchService,u.contextActivityService,"ContextMenu",t.icon||e.icon,s,l),i=t.groupName&&c[t.groupName];i?(i.isEmpty&&(1===i.menuLocation?n.unshift(i):n.push(i)),i.addChild(e)):1===t.menuLocation?n.unshift(e):n.push(e)})),n},t.prototype.getCommandMenuExtension=function(e,t){var i=e&&e.extend;switch(t){case 0:return i&&i.visualContextMenu;case 1:return i&&i.visualOptionsMenu}},t.prototype.getCommandExtensions=function(t,e){var i=this,n=this.explorationExtensibility.getCommandExtensions()||[];switch(t&&(n=n.filter((function(e){return i.visualMenuShouldHaveCommand(t,e)}))),e){case 0:return n.filter((function(e){return e.extend&&e.extend.visualContextMenu}));case 1:return n.filter((function(e){return e.extend&&e.extend.visualOptionsMenu}))}},t.prototype.visualMenuShouldHaveCommand=function(t,e){return!e.visuals||e.visuals.some((function(e){return e===t.name}))},M=t})(powerbi=powerbi||{}),(function(e){var t;function i(e,t,i,n,r,a,o){this.defaultTitleKey=e,this.selectors=t,this.glyph=i,this.commandDisplayOption=n,this.selected=r,this.customIcon=a,this.separatorPosition=o,this.selectors=_.compact(t)}t=(t=e.explore||(e.explore={})).services||(t.services={}),i.prototype.title=function(e){return e&&this.defaultTitleKey?e.get(this.defaultTitleKey):this.defaultTitleKey},i.prototype.execute=function(){return __awaiter(this,void 0,e.Promise,(function(){return __generator(this,(function(e){return[2]}))}))},i.prototype.isVisible=function(){return __awaiter(this,void 0,e.Promise,(function(){return __generator(this,(function(e){return[2,2!==this.commandDisplayOption]}))}))},i.prototype.isDisabled=function(){return __awaiter(this,void 0,e.Promise,(function(){return __generator(this,(function(e){return[2,1===this.commandDisplayOption]}))}))},i.prototype.getChildren=function(){return __awaiter(this,void 0,e.Promise,(function(){return __generator(this,(function(e){return[2,null]}))}))},i.prototype.getTelemetryInfo=function(){return this.defaultTitleKey},i.prototype.announceSelectionState=function(e,t){e&&(t=e.getLocalizedString(this.getSelectionStateStringKey(t)),e.alertScreenReader(t))},i.prototype.getSelectionStateStringKey=function(e){return e?"FieldListProperty_Selected":"FieldListProperty_Unselected"},t.VisualContainerMenuCommand=i})(powerbi=powerbi||{}),(function(m){var l,c,p,u,k,X,L,d,R,a,h,g=m.explore||(m.explore={}),v=g.services||(g.services={}),r=jsCommon.EnumExtensions,H=m.data.Selector,z=m.explore.util.VisualContainerUtils,e=(h=v.VisualContainerMenuCommand,__extends(t,h),t.prototype.execute=function(){return __awaiter(this,void 0,m.Promise,(function(){var t;return __generator(this,(function(e){switch(e.label){case 0:return(t=O(this.visualContainer.name,this.contextActivityService,"DrillDown",this.source),_.isEmpty(this.selectors))?(t.reject(),[2]):(this.dataSources,this.visualAuthoring,[4,this.visualAuthoring.drillDown(this.selectors,this.visualContainer,this.dataSources.get(),_.head(this.roles))]);case 1:return e.sent()?t.resolve():t.reject(),[2]}}))}))},t.prototype.isVisible=function(){return __awaiter(this,void 0,m.Promise,(function(){var t,i,n;return __generator(this,(function(e){switch(e.label){case 0:return(t=_.isEmpty(this.selectors))?[3,2]:[4,h.prototype.isVisible.call(this)];case 1:t=!e.sent(),e.label=2;case 2:return t?[2,!1]:(n=this.drill.getSupportedDrillDirections(this.visualContainer,_.head(this.roles)),i=r.hasFlag(n,4),n=r.hasFlag(n,2),[2,i||n])}}))}))},t.prototype.isDisabled=function(){var i;return __awaiter(this,void 0,m.Promise,(function(){var t;return __generator(this,(function(e){switch(e.label){case 0:return t=!(null==(i=this.runningVisual)||!i.getErrorInfo()),(t=t)?[3,2]:[4,h.prototype.isDisabled.call(this)];case 1:t=e.sent(),e.label=2;case 2:return[2,t]}}))}))},t);function t(e,t,i,n,r,a,o,s,l,u,c){u=h.call(this,u||"DrillDown",t,"pbi-glyph-drilldowndisabled",c&&c.drill)||this;return u.visualContainer=e,u.roles=i,u.dataSources=n,u.drill=r,u.visualAuthoring=a,u.runningVisual=o,u.contextActivityService=s,u.source=l,u}v.DrillDownCommand=e,y=v.VisualContainerMenuCommand,__extends(i,y),i.prototype.execute=function(){return __awaiter(this,void 0,m.Promise,(function(){var t;return __generator(this,(function(e){return this.visualAuthoring,t=O(this.visualContainer.name,this.contextActivityService,"DrillUp",this.source),this.visualAuthoring.drillUp(_.head(this.roles),this.visualContainer),t.resolve(),[2]}))}))},i.prototype.isVisible=function(){return __awaiter(this,void 0,m.Promise,(function(){var t;return __generator(this,(function(e){switch(e.label){case 0:return[4,y.prototype.isVisible.call(this)];case 1:return e.sent()?(t=this.drill.getSupportedDrillDirections(this.visualContainer,_.head(this.roles)),[2,r.hasFlag(t,1)]):[2,!1]}}))}))},i.prototype.isDisabled=function(){var i;return __awaiter(this,void 0,m.Promise,(function(){var t;return __generator(this,(function(e){switch(e.label){case 0:return t=!(null==(i=this.runningVisual)||!i.getErrorInfo()),(t=t)?[3,2]:[4,y.prototype.isDisabled.call(this)];case 1:t=e.sent(),e.label=2;case 2:return[2,t]}}))}))};var y,e=i;function i(e,t,i,n,r,a,o,s,l,u){l=y.call(this,l||"DrillUp",void 0,"pbi-glyph-drillup",u&&u.drill)||this;return l.visualContainer=e,l.roles=i,l.drill=n,l.visualAuthoring=r,l.runningVisual=a,l.contextActivityService=o,l.source=s,l}v.DrillUpCommand=i,f=v.VisualContainerMenuCommand,__extends(n,f),n.prototype.execute=function(){return __awaiter(this,void 0,m.Promise,(function(){var t;return __generator(this,(function(e){return this.visualAuthoring,t=O(this.visualContainer.name,this.contextActivityService,"DrillDownLevel"===this.defaultTitleKey?"DrillDownLevelUngrouped":"DrillDownLevelGrouped",this.source),this.visualAuthoring.drillDownLevel(_.head(this.roles),this.visualContainer,this.drillDirection),t.resolve(),[2]}))}))},n.prototype.isDisabled=function(){var i;return __awaiter(this,void 0,m.Promise,(function(){var t;return __generator(this,(function(e){switch(e.label){case 0:return t=!(null==(i=this.runningVisual)||!i.getErrorInfo()),(t=t)?[3,2]:[4,f.prototype.isDisabled.call(this)];case 1:t=e.sent(),e.label=2;case 2:return[2,t]}}))}))};var f,C,e=n;function n(e,t,i,n,r,a,o,s,l){e=f.call(this,e,void 0,void 0,l&&l.drill)||this;return e.visualContainer=t,e.roles=i,e.drillDirection=n,e.visualAuthoring=r,e.runningVisual=a,e.contextActivityService=o,e.source=s,e}function o(e,t,i,n,r,a,o,s){e=C.call(this,"DrillDownLevel",e,t,3,i,r,a,o,s)||this;return e.drill=n,e.runningVisual=r,e}function s(e,t,i,n,r,a,o,s){e=l.call(this,"DrillDownLevelGrouped",e,t,2,i,r,a,o,s)||this;return e.drill=n,e.runningVisual=r,e}v.DrillDownLevelCommand=e,__extends(o,C=e),o.prototype.isVisible=function(){return __awaiter(this,void 0,m.Promise,(function(){var t;return __generator(this,(function(e){switch(e.label){case 0:return[4,C.prototype.isVisible.call(this)];case 1:return e.sent()?(t=this.drill.getSupportedDrillDirections(this.visualContainer,_.head(this.roles)),[2,r.hasFlag(t,4)]):[2,!1]}}))}))},o.prototype.isDisabled=function(){var i;return __awaiter(this,void 0,m.Promise,(function(){var t;return __generator(this,(function(e){switch(e.label){case 0:return t=!(null==(i=this.runningVisual)||!i.getErrorInfo()),(t=t)?[3,2]:[4,C.prototype.isDisabled.call(this)];case 1:t=e.sent(),e.label=2;case 2:return[2,t]}}))}))},v.DrillDownLevelWithoutCurrentGroupCommand=o,__extends(s,l=e),s.prototype.isVisible=function(){return __awaiter(this,void 0,m.Promise,(function(){var t;return __generator(this,(function(e){switch(e.label){case 0:return[4,l.prototype.isVisible.call(this)];case 1:return e.sent()?(t=this.drill.getSupportedDrillDirections(this.visualContainer,_.head(this.roles)),[2,r.hasFlag(t,2)]):[2,!1]}}))}))},s.prototype.isDisabled=function(){var i;return __awaiter(this,void 0,m.Promise,(function(){var t;return __generator(this,(function(e){switch(e.label){case 0:return t=!(null==(i=this.runningVisual)||!i.getErrorInfo()),(t=t)?[3,2]:[4,l.prototype.isDisabled.call(this)];case 1:t=e.sent(),e.label=2;case 2:return[2,t]}}))}))},v.DrillDownLevelWithCurrentGroupCommand=s,S=v.VisualContainerMenuCommand,__extends(E,S),E.prototype.execute=function(){return __awaiter(this,void 0,m.Promise,(function(){var t,i;return __generator(this,(function(e){return t=O(this.visualContainer.name,this.contextActivityService,"DrillToDetails",this.source),_.isEmpty(this.selectors)?t.reject():(this.dataSources,this.drillToDetails,i=this.dataSources.get(),this.drillToDetails.drillToDetails(this.selectors,this.visualContainer,i),t.resolve()),[2]}))}))},E.prototype.isVisible=function(){return __awaiter(this,void 0,m.Promise,(function(){var t;return __generator(this,(function(e){switch(e.label){case 0:return(t=_.isEmpty(this.selectors))?[3,2]:[4,S.prototype.isVisible.call(this)];case 1:t=!e.sent(),e.label=2;case 2:return t?[2,!1]:this.explorationCapabilities.getCapabilities().disallowDrillToDetails?[2,!1]:[2,this.drill.canDrillToDetails(this.visualContainer,this.selectors)]}}))}))},E.prototype.isDisabled=function(){var i;return __awaiter(this,void 0,m.Promise,(function(){var t;return __generator(this,(function(e){switch(e.label){case 0:return t=!(null==(i=this.runningVisual)||!i.getErrorInfo()),(t=t)?[3,2]:[4,S.prototype.isDisabled.call(this)];case 1:t=e.sent(),e.label=2;case 2:return[2,t]}}))}))};var S,e=E;function E(e,t,i,n,r,a,o,s,l,u){i=S.call(this,"DataPointTable_Show",i,void 0,u&&u.drill)||this;return i.visualContainer=e,i.explorationCapabilities=t,i.drill=n,i.dataSources=r,i.drillToDetails=a,i.runningVisual=o,i.contextActivityService=s,i.source=l,i}function U(e,t,i,n,r,a,o,s,l,u){n=c.call(this,i?"Collapse":"Expand",n,void 0,u&&u.expandCollapse)||this;return n.allowedActions=t,n.isCollapse=i,n.roles=r,n.nodeIndex=a,n.childCommands=[new W(e,n.isCollapse,n.allowedActions,n.selectors,n.roles,n.nodeIndex,o,s,l,u),new K(e,n.isCollapse,n.allowedActions,n.selectors,n.roles,n.nodeIndex,o,s,l,u),new Z(e,n.isCollapse,n.allowedActions,n.selectors,n.roles,n.nodeIndex,o,s,l,u)],n}v.DrillToDetailsCommand=E,c=v.VisualContainerMenuCommand,__extends(U,c),U.prototype.isDisabled=function(){return __awaiter(this,void 0,m.Promise,(function(){return __generator(this,(function(e){switch(e.label){case 0:return this.isCollapse?[4,c.prototype.isDisabled.call(this)]:[3,2];case 1:return[2,e.sent()||!(this.allowedActions.collapseHierarchy||this.allowedActions.collapseLevel||this.allowedActions.collapseNode)];case 2:return[4,c.prototype.isDisabled.call(this)];case 3:return[2,e.sent()||!(this.allowedActions.expandHierarchy||this.allowedActions.expandLevel||this.allowedActions.expandNode)]}}))}))},U.prototype.getChildren=function(){return __awaiter(this,void 0,m.Promise,(function(){return __generator(this,(function(e){return[2,this.childCommands]}))}))},v.ExpandCollapseCommandsCollection=U,j=v.VisualContainerMenuCommand,__extends(G,j),G.prototype.execute=function(){return __awaiter(this,void 0,m.Promise,(function(){var t;return __generator(this,(function(e){return this.roles,this.selectors,this.handlers&&this.handlers.onSetNodeExpansionState,t=O(this.visualContainer.name,this.contextActivityService,"ExpandCollapseNode",this.source),this.handlers.onSetNodeExpansionState({data:this.selectors[0],dataRoles:this.roles,isCollapse:this.isCollapse,nodeIndex:this.nodeIndex}),t.resolve(),[2]}))}))},G.prototype.isDisabled=function(){return __awaiter(this,void 0,m.Promise,(function(){return __generator(this,(function(e){switch(e.label){case 0:return[4,j.prototype.isDisabled.call(this)];case 1:return[2,e.sent()||(this.isCollapse?!this.allowedActions.collapseNode:!this.allowedActions.expandNode)]}}))}))};var j,W=G;function G(e,t,i,n,r,a,o,s,l,u){n=j.call(this,"ExpandCollapseNode",n,void 0,u&&u.expandCollapse)||this;return n.visualContainer=e,n.isCollapse=t,n.allowedActions=i,n.roles=r,n.nodeIndex=a,n.handlers=o,n.contextActivityService=s,n.source=l,n}v.ExpandCollapseNodeCommand=W,Q=v.VisualContainerMenuCommand,__extends(q,Q),q.prototype.execute=function(){return __awaiter(this,void 0,m.Promise,(function(){var t;return __generator(this,(function(e){return this.roles,this.selectors,this.handlers&&this.handlers.onSetLevelExpansionState,t=O(this.visualContainer.name,this.contextActivityService,"ExpandCollapseLevel",this.source),this.handlers.onSetLevelExpansionState({data:this.selectors[0],dataRoles:this.roles,isCollapse:this.isCollapse,nodeIndex:this.nodeIndex}),t.resolve(),[2]}))}))},q.prototype.isDisabled=function(){return __awaiter(this,void 0,m.Promise,(function(){return __generator(this,(function(e){switch(e.label){case 0:return[4,Q.prototype.isDisabled.call(this)];case 1:return[2,e.sent()||this.isCollapse?!this.allowedActions.collapseLevel:!this.allowedActions.expandLevel]}}))}))};var Q,K=q;function q(e,t,i,n,r,a,o,s,l,u){n=Q.call(this,"ExpandCollapseLevel",n,void 0,u&&u.expandCollapse)||this;return n.visualContainer=e,n.isCollapse=t,n.allowedActions=i,n.roles=r,n.nodeIndex=a,n.handlers=o,n.contextActivityService=s,n.source=l,n}v.ExpandCollapseLevelCommand=K,$=v.VisualContainerMenuCommand,__extends(Y,$),Y.prototype.execute=function(){return __awaiter(this,void 0,m.Promise,(function(){var t;return __generator(this,(function(e){return this.roles,this.selectors,this.handlers&&this.handlers.onSetHierarchyExpansionState,t=O(this.visualContainer.name,this.contextActivityService,"ExpandCollapseHierarchy",this.source),this.handlers.onSetHierarchyExpansionState({data:this.selectors[0],dataRoles:this.roles,isCollapse:this.isCollapse,nodeIndex:this.nodeIndex}),t.resolve(),[2]}))}))},Y.prototype.isDisabled=function(){return __awaiter(this,void 0,m.Promise,(function(){return __generator(this,(function(e){switch(e.label){case 0:return[4,$.prototype.isDisabled.call(this)];case 1:return[2,e.sent()||this.isCollapse?!this.allowedActions.collapseHierarchy:!this.allowedActions.expandHierarchy]}}))}))};var $,Z=Y;function Y(e,t,i,n,r,a,o,s,l,u){n=$.call(this,"All",n,void 0,u&&u.expandCollapse)||this;return n.visualContainer=e,n.isCollapse=t,n.allowedActions=i,n.roles=r,n.nodeIndex=a,n.handlers=o,n.contextActivityService=s,n.source=l,n}v.ExpandCollapseHierarchyCommand=Z,b=v.VisualContainerMenuCommand,__extends(w,b),w.prototype.isVisible=function(){return __awaiter(this,void 0,m.Promise,(function(){var t;return __generator(this,(function(e){switch(e.label){case 0:return(t=!(this.explorationSettings&&this.explorationSettings.useStylableVisualContainerHeader))?[3,2]:[4,b.prototype.isVisible.call(this)];case 1:t=!e.sent(),e.label=2;case 2:return t?[2,!1]:[2,1===this.viewModeState.getMode()]}}))}))},w.prototype.isDisabled=function(){return __awaiter(this,void 0,m.Promise,(function(){var t;return __generator(this,(function(e){switch(e.label){case 0:return t=g.contracts.isVisualContainerGroup(this.container)||!!this.container.parentGroup,(t=!v.selectionUtils.hasMultipleVisualContainerSelection(this.selection)&&!t)?[3,2]:[4,b.prototype.isDisabled.call(this)];case 1:t=e.sent(),e.label=2;case 2:return[2,t]}}))}))},w.prototype.getChildren=function(){return __awaiter(this,void 0,m.Promise,(function(){return __generator(this,(function(e){return[2,this.childCommands]}))}))};var b,e=w;function w(e,t,i,n,r,a){var o=b.call(this,"Group_Action",void 0,void 0,a&&a.groupVisualContainers)||this;return o.container=e,o.selection=t,o.viewModeState=n,o.explorationSettings=r,o.childCommands=[new ee(o.selection,i,a),new oe(o.container,i,a),new ne(o.selection,i,a)],o}v.VisualContainerGroupingCommandsCollection=w,J=v.VisualContainerMenuCommand,__extends(te,J),te.prototype.execute=function(){return __awaiter(this,void 0,m.Promise,(function(){return __generator(this,(function(e){return this.layoutAuthoring.groupCanvasItems(v.selectionUtils.getSelectedCanvasItems(this.selection)),[2]}))}))},te.prototype.isDisabled=function(){return __awaiter(this,void 0,m.Promise,(function(){var t,i,n;return __generator(this,(function(e){switch(e.label){case 0:return t=!1,1<(n=v.selectionUtils.getSelectedCanvasItems(this.selection)).length&&(i=n[0].parentGroup,t=_.every(n,(function(e){return e.parentGroup===i})),n=g.util.CanvasVisualsUtility.getContainerGroupDepth(n),t=t&&n<g.constants.MaxGroupingDepth),(n=!t)?[3,2]:[4,J.prototype.isDisabled.call(this)];case 1:n=e.sent(),e.label=2;case 2:return[2,n]}}))}))};var J,ee=te;function te(e,t,i){i=J.call(this,"Group_Action",void 0,void 0,i&&i.groupVisualContainers)||this;return i.selection=e,i.layoutAuthoring=t,i}v.GroupVisualContainerCommand=ee,ie=v.VisualContainerMenuCommand,__extends(re,ie),re.prototype.execute=function(){return __awaiter(this,void 0,m.Promise,(function(){return __generator(this,(function(e){return this.layoutAuthoring.mergeCanvasItemContainers(v.selectionUtils.getSelectedCanvasItems(this.selection)),[2]}))}))},re.prototype.isDisabled=function(){return __awaiter(this,void 0,m.Promise,(function(){var t;return __generator(this,(function(e){switch(e.label){case 0:return t=this.layoutAuthoring.canMergeCanvasItems(),(t=!t)?[3,2]:[4,ie.prototype.isDisabled.call(this)];case 1:t=e.sent(),e.label=2;case 2:return[2,t]}}))}))};var ie,ne=re;function re(e,t,i){i=ie.call(this,"Merge",void 0,void 0,i&&i.groupVisualContainers)||this;return i.selection=e,i.layoutAuthoring=t,i}v.MergeVisualContainerGroupCommand=ne,ae=v.VisualContainerMenuCommand,__extends(se,ae),se.prototype.execute=function(){return __awaiter(this,void 0,m.Promise,(function(){var t;return __generator(this,(function(e){return(t=g.contracts.isVisualContainerGroup(this.container)?this.container:this.container.parentGroup)&&this.layoutAuthoring.ungroupCanvasItems(t),[2]}))}))},se.prototype.isDisabled=function(){return __awaiter(this,void 0,m.Promise,(function(){var t;return __generator(this,(function(e){switch(e.label){case 0:return t=g.contracts.isVisualContainerGroup(this.container)||!!this.container.parentGroup,[4,ae.prototype.isDisabled.call(this)];case 1:return[2,e.sent()||!t]}}))}))};var ae,oe=se;function se(e,t,i){i=ae.call(this,"Ungroup",void 0,void 0,i&&i.groupVisualContainers)||this;return i.container=e,i.layoutAuthoring=t,i}function x(e,t,i,n,r,a,o,s,l,u){o=p.call(this,"Summarize",void 0,void 0,o&&o.summarize)||this;return o.itemContainer=e,o.explorationNavigation=t,o.pluginOps=i,o.selection=n,o.visualAuthoring=r,o.viewModeState=a,o.runningVisualService=s,o.contextActivityService=l,o.source=u,o}v.UngroupVisualContainerCommand=oe,p=v.VisualContainerMenuCommand,__extends(x,p),x.prototype.execute=function(){return __awaiter(this,void 0,m.Promise,(function(){var t,i,n,r;return __generator(this,(function(e){return g.contracts.isVisualContainer(this.itemContainer)&&(t=O(this.itemContainer.name,this.contextActivityService,"SummarizeVisualContainer",this.source)),i=this.getSelectedSummarizableVisuals(),n=this.explorationNavigation.getCurrentExploreCanvas(),r=this.explorationNavigation.getAllSections(),this.visualAuthoring.addVisualContainerTextbox(r,n,void 0,!0,i),null!=t&&t.resolve(),[2]}))}))},x.prototype.isDisabled=function(){return __awaiter(this,void 0,m.Promise,(function(){return __generator(this,(function(e){return[2,_.isEmpty(this.getSelectedSummarizableVisuals())]}))}))},x.prototype.isVisible=function(){return __awaiter(this,void 0,m.Promise,(function(){return __generator(this,(function(e){switch(e.label){case 0:return[4,p.prototype.isVisible.call(this)];case 1:return[2,e.sent()&&1===this.viewModeState.getMode()]}}))}))},x.prototype.getSelectedSummarizableVisuals=function(){var i=this,e=v.selectionUtils.getSelectedVisualContainers(this.selection);return _.filter(e,(function(e){var t=i.runningVisualService.getVisual(e);return!(!_.isEmpty(t&&t.getErrorInfo())||(null==t?void 0:t.getHasPendingChanges()))&&i.pluginOps.canSummarizeVisual(g.util.VisualContainerUtils.getVisualType(e))&&!z.isSmallMultiplesVisual(e.config.singleVisual)}))},v.SummarizeVisualContainerCommand=x,le=v.VisualContainerMenuCommand,__extends(V,le),V.prototype.execute=function(){return __awaiter(this,void 0,m.Promise,(function(){var t,i;return __generator(this,(function(e){return this.visibility,t=O(this.visualContainer.name,this.contextActivityService,"SeeData",this.source),i=2,this.viewModeState&&this.viewModeState.getConfig().displayOptions.showVisualAccessibleData&&(i=8),this.visibility.set(this.visualContainer,i),t.resolve(),[2]}))}))},V.prototype.isVisible=function(){return __awaiter(this,void 0,m.Promise,(function(){return __generator(this,(function(e){switch(e.label){case 0:return[4,le.prototype.isVisible.call(this)];case 1:return e.sent()?this.explorationCapabilities.getCapabilities().disallowSeeData?[2,!1]:[2,this.visualContainer&&2!==this.visualContainer.visibility&&this.drill.canSeeData(this.visualContainer)&&!this.pluginOps.isAnalysisVisual(g.util.VisualContainerUtils.getVisualType(this.visualContainer))]:[2,!1]}}))}))};var le,e=V;function V(e,t,i,n,r,a,o,s,l,u){s=le.call(this,"VisualTable_Show",void 0,(s=void 0===s?!1:s)?"itemIcon glyphicon pbi-glyph-seedata glyph-small":void 0,u&&u.seeData)||this;return s.visualContainer=e,s.explorationCapabilities=t,s.drill=i,s.visibility=n,s.pluginOps=r,s.contextActivityService=a,s.source=o,s.viewModeState=l,s}function ue(e,t,i,n,r,a,o,s){t=u.call(this,"Group_Data_Action",t,void 0,s&&s.createGroup)||this;return t.visualContainer=e,t.conceptualSchemaProxy=i,t.dataSources=n,t.featureSwitchService=r,t.groupAuthoring=a,t.promiseFactory=o,t}v.SeeDataCommand=V,u=v.VisualContainerMenuCommand,__extends(ue,u),ue.prototype.execute=function(){return __awaiter(this,void 0,m.Promise,(function(){var t,i;return __generator(this,(function(e){switch(e.label){case 0:if(this.pendingGroupOperation)return[2];this.pendingGroupOperation=!0,this.dataSources,this.conceptualSchemaProxy,t=this.dataSources.get(),e.label=1;case 1:return e.trys.push([1,,4,5]),[4,this.conceptualSchemaProxy.get(t)];case 2:return i=e.sent(),this.groupAuthoring,[4,this.groupAuthoring.visual.group(this.visualContainer,this.selectors,!0,t,i)];case 3:return e.sent(),[3,5];case 4:return this.pendingGroupOperation=!1,[7];case 5:return[2]}}))}))},ue.prototype.isVisible=function(){return __awaiter(this,void 0,m.Promise,(function(){var t,i,n;return __generator(this,(function(e){switch(e.label){case 0:return(t=!this.featureSwitchService.featureSwitches.enableGroupAuthoring)?[3,2]:[4,u.prototype.isVisible.call(this)];case 1:t=!e.sent(),e.label=2;case 2:return t?[2,!1]:(i=this.dataSources.get())?[4,this.conceptualSchemaProxy.get(i)]:[2,!1];case 3:return i=e.sent(),n=i.schema(void 0),n=!1!==(n&&n.capabilities&&n.capabilities.supportsGrouping),n=n&&this.groupAuthoring.visual.canGroup(this.visualContainer,this.selectors,i),[2,this.promiseFactory.resolve(n)]}}))}))},v.CreateGroupCommand=ue,ce=v.VisualContainerMenuCommand,__extends(pe,ce),pe.prototype.execute=function(){return __awaiter(this,void 0,m.Promise,(function(){var t;return __generator(this,(function(e){return this.includeExcludeService,t=O(this.visualContainer.name,this.contextActivityService,3===this.filterCreationKind?"Include":"Exclude",this.source),this.includeExcludeService.setFilter(this.filterCreationKind,this.selectors,this.visualContainer,this.dataView),t.resolve(),[2]}))}))},pe.prototype.isVisible=function(){return __awaiter(this,void 0,m.Promise,(function(){var t,i;return __generator(this,(function(e){switch(e.label){case 0:return[4,ce.prototype.isVisible.call(this)];case 1:return e.sent()?H.hasIdentities(this.selectors)&&(t=this.dataSources.get())?[4,this.conceptualSchemaProxy.get(t)]:[2,this.promiseFactory.resolve(!1)]:[2,this.promiseFactory.resolve(!1)];case 2:return t=e.sent(),null!=this.selectors[0].dataMap?(i=this.includeExcludeService.isIncludeExcludeSupported(this.visualContainer,t,this.selectors),[2,this.promiseFactory.resolve(i)]):[2,this.promiseFactory.resolve(!1)]}}))}))};var ce,e=pe;function pe(e,t,i,n,r,a,o,s,l,u,c,p){e=ce.call(this,e,i,void 0,p&&p.includeExclude)||this;return e.visualContainer=t,e.filterCreationKind=n,e.conceptualSchemaProxy=r,e.dataSources=a,e.includeExcludeService=o,e.promiseFactory=s,e.dataView=l,e.contextActivityService=u,e.source=c,e}function he(e,t,i,n,r,a,o,s,l,u,c){return k.call(this,"VisualContainer_ContextMenu_Include",e,t,3,i,n,a,o,u,s,l,c)||this}function de(e,t,i,n,r,a,o,s,l,u,c){return X.call(this,"VisualContainer_ContextMenu_Exclude",e,t,4,i,n,a,o,u,s,l,c)||this}v.IncludeExcludeCommand=e,__extends(he,k=e),v.IncludeCommand=he,__extends(de,X=e),de.prototype.isDisabled=function(){var a,o;return __awaiter(this,void 0,m.Promise,(function(){var t,i,n,r;return __generator(this,(function(e){switch(e.label){case 0:if(t=null==(a=null==(a=this.dataView)?void 0:a.metadata)?void 0:a.columns)for(i=0,n=t;i<n.length;i++)if(r=n[i],1===(null==(o=null==r?void 0:r.parameter)?void 0:o.kind))return[2,this.promiseFactory.resolve(!0)];return[4,X.prototype.isDisabled.call(this)];case 1:return[2,e.sent()]}}))}))},de.prototype.getToolTip=function(t){return __awaiter(this,void 0,m.Promise,(function(){return __generator(this,(function(e){switch(e.label){case 0:return[4,this.isDisabled()];case 1:return e.sent()?[2,this.promiseFactory.resolve(t.get("DQP_Disabled_Operator"))]:[2,this.promiseFactory.resolve(t.get("VisualContainer_ContextMenu_Exclude"))]}}))}))},v.ExcludeCommand=de,ve=v.VisualContainerMenuCommand,__extends(F,ve),F.prototype.isVisible=function(){var i;return __awaiter(this,void 0,m.Promise,(function(){var t;return __generator(this,(function(e){switch(e.label){case 0:return[4,ve.prototype.isVisible.call(this)];case 1:return e.sent()?null!=(i=this.runningVisual)&&i.getSelectedDatapoints&&(t=null==(i=this.runningVisual)?void 0:i.getSelectedDatapoints())?[2,!_.isEmpty(t)]:[2,!1]:[2,!1]}}))}))},F.prototype.execute=function(){return __awaiter(this,void 0,m.Promise,(function(){var t;return __generator(this,(function(e){return t=O(this.visualContainer.name,this.contextActivityService,"ClearSelection",this.source),this.runningVisual.clearSelectedDatapoints(),t.resolve(),[2]}))}))};var ve,e=F;function F(e,t,i,n,r){r=ve.call(this,"Slicer_Clear",void 0,void 0,r&&r.clearSelection)||this;return r.visualContainer=e,r.runningVisual=t,r.contextActivityService=i,r.source=n,r}v.ClearSelectionCommand=F,me=v.VisualContainerMenuCommand,__extends(ye,me),ye.prototype.execute=function(){return __awaiter(this,void 0,m.Promise,(function(){return __generator(this,(function(e){return this.telemetryService.logEvent(m.telemetry.CopyVisualImageEntryPoint,{visualType:this.viewModel.name,hasMetadata:this.hasMetadata,entryPoint:"ContextMenu"}),this.eventBridge.publishToChannel(m.explore.services.events.copyVisualAsImage,{visual:this.viewModel,hasMetadata:this.hasMetadata,useModernClipboard:this.useModernClipboard}),[2]}))}))};var me,ge=ye;function ye(e,t,i,n,r,a,o){e=me.call(this,e,void 0,void 0,o&&o.copy)||this;return e.viewModel=t,e.eventBridge=i,e.hasMetadata=n,e.useModernClipboard=r,e.telemetryService=a,e}function fe(e,t,i,n,r,a,o,s,l,u,c,p,h,d,v){v=L.call(this,"Copy",void 0,void 0,v&&v.copy)||this;return v.visualContainer=e,v.clipboard=t,v.featureSwitchService=i,v.copyVisualImageService=n,v.telemetryService=r,v.visualContainerCopyService=a,v.explorationCapabilities=o,v.explorationNavigation=s,v.visibility=l,v.viewModeState=u,v.args=c,v.eventBridge=p,v.contextActivityService=h,v.source=d,v.childCommands=[],v.copyPasteService=m.CopyPasteService.create(),c.copyArgs&&(c.copyArgs.singleValue||c.copyArgs.grid)&&(v.childCommands.push(new Se("Visual_CopyValue",v.visualContainer.contract,v.copyPasteService,v.telemetryService,v.args.copyArgs.singleValue,v.contextActivityService,v.source)),v.childCommands.push(new we("Visual_CopySelection",v.visualContainer.contract,v.copyPasteService,v.telemetryService,v.args.copyArgs.grid,v.contextActivityService,v.source))),v.visibility.get()||0!==v.viewModeState.getMode()&&v.childCommands.push(new Fe(v.visualContainer.contract,"Visual_CopyVisual",v.clipboard,v.contextActivityService,v.source)),(v.featureSwitchService.featureSwitches.copyPasteMenuImage||v.featureSwitchService.featureSwitches.copyPasteMenuMetadata)&&null!=v.explorationNavigation.getCurrentExploration().reportId&&(t=g.util.VisualContainerUtils.getVisualType(e.contract),v.copyVisualImageService.canCopy(t))&&v.visualContainerCopyService.showCopyVisualImageOption(e,v.visualContainerCopyService.getActiveSection(),"ContextMenu")&&(v.featureSwitchService.featureSwitches.copyPasteMenuImage&&v.childCommands.push(new ge("Image",v.visualContainer,v.eventBridge,!1,v.explorationCapabilities.getCapabilities().useModernClipboard,v.telemetryService)),v.featureSwitchService.featureSwitches.copyPasteMenuMetadata)&&v.childCommands.push(new ge("Image_WithCaption",v.visualContainer,v.eventBridge,!0,v.explorationCapabilities.getCapabilities().useModernClipboard,v.telemetryService)),v}v.CopyImageCommand=ge,L=v.VisualContainerMenuCommand,__extends(fe,L),Object.defineProperty(fe.prototype,"commandsCount",{get:function(){return this.childCommands.length},enumerable:!1,configurable:!0}),fe.prototype.getChildren=function(){return __awaiter(this,void 0,m.Promise,(function(){return __generator(this,(function(e){return[2,this.childCommands]}))}))},v.CopyCommandsCollection=fe,Ce=v.VisualContainerMenuCommand,__extends(Ee,Ce),Ee.prototype.isDisabled=function(){return __awaiter(this,void 0,m.Promise,(function(){return __generator(this,(function(e){switch(e.label){case 0:return[4,Ce.prototype.isDisabled.call(this)];case 1:return[2,e.sent()||null===this.valueCallback||!("string"==typeof this.valueCallback||"function"==typeof this.valueCallback)]}}))}))},Ee.prototype.execute=function(){return __awaiter(this,void 0,m.Promise,(function(){var t,i;return __generator(this,(function(e){return t=O(this.visualContainer.name,this.contextActivityService,"CopyValue",this.source),i=g.util.VisualContainerUtils.getVisualType(this.visualContainer),this.copyPasteService.copyText(this.valueCallback,this.telemetryService,i),t.resolve(),[2]}))}))};var Ce,Se=Ee;function Ee(e,t,i,n,r,a,o,s){e=Ce.call(this,e,void 0,void 0,s&&s.copy)||this;return e.visualContainer=t,e.copyPasteService=i,e.telemetryService=n,e.valueCallback=r,e.contextActivityService=a,e.source=o,e}v.CopyValueCommand=Se,be=v.VisualContainerMenuCommand,__extends(xe,be),xe.prototype.isDisabled=function(){return __awaiter(this,void 0,m.Promise,(function(){return __generator(this,(function(e){switch(e.label){case 0:return[4,be.prototype.isDisabled.call(this)];case 1:return[2,e.sent()||null===this.valueCallback||"function"!=typeof this.valueCallback]}}))}))},xe.prototype.execute=function(){return __awaiter(this,void 0,m.Promise,(function(){var t,i;return __generator(this,(function(e){return t=O(this.visualContainer.name,this.contextActivityService,"CopySelection",this.source),i=g.util.VisualContainerUtils.getVisualType(this.visualContainer),this.copyPasteService.copyGrid(this.valueCallback,this.telemetryService,i),t.resolve(),[2]}))}))};var be,we=xe;function xe(e,t,i,n,r,a,o,s){e=be.call(this,e,void 0,void 0,s&&s.copy)||this;return e.visualContainer=t,e.copyPasteService=i,e.telemetryService=n,e.valueCallback=r,e.contextActivityService=a,e.source=o,e}v.CopySelectionCommand=we,Ve=v.VisualContainerMenuCommand,__extends(Pe,Ve),Pe.prototype.execute=function(){return __awaiter(this,void 0,m.Promise,(function(){var t;return __generator(this,(function(e){return t=O(this.visualContainer.name,this.contextActivityService,"CopyVisual",this.source),this.clipboard.copy(),t.resolve(),[2]}))}))};var Ve,Fe=Pe;function Pe(e,t,i,n,r,a){t=Ve.call(this,t,void 0,void 0,a&&a.copy)||this;return t.visualContainer=e,t.clipboard=i,t.contextActivityService=n,t.source=r,t}v.CopyVisualCommand=Fe,P=v.VisualContainerMenuCommand,__extends(T,P),T.prototype.execute=function(){return __awaiter(this,void 0,m.Promise,(function(){return __generator(this,(function(e){return[2]}))}))},T.prototype.isVisible=function(){return __awaiter(this,void 0,m.Promise,(function(){var t,i,n;return __generator(this,(function(e){switch(e.label){case 0:return[4,P.prototype.isVisible.call(this)];case 1:return e.sent()?(t=this.dataSources.get())&&(i=this.explorationCapabilities.getCapabilities())&&i.insights?[4,this.lazyScoped("userEmulationService")]:[2,!1]:[2,!1];case 2:return e.sent().getState()?[2,!1]:[4,this.conceptualSchemaProxy.get(t)];case 3:return i=e.sent(),[4,this.getAnalysisOptions(i)];case 4:return n=e.sent(),[2,!_.isEmpty(n)]}}))}))},T.prototype.isDisabled=function(){return __awaiter(this,void 0,m.Promise,(function(){return __generator(this,(function(e){return z.isSmallMultiplesVisual(this.visualContainer.config.singleVisual)?[2,!0]:[2,P.prototype.isDisabled.call(this)]}))}))},T.prototype.getChildren=function(){return __awaiter(this,void 0,m.Promise,(function(){var t,i,n,r,a,o;return __generator(this,(function(e){switch(e.label){case 0:return(t=this.dataSources.get())?[4,this.conceptualSchemaProxy.get(t)]:[2,void 0];case 1:return t=e.sent(),[4,this.getAnalysisOptions(t)];case 2:if(i=e.sent(),_.isEmpty(i))return[2,null];for(n=[],r=0,a=i;r<a.length;r++)o=a[r],o=new Te(this.selectors,this.visualContainer,this.position,o,this.dataSources,this.eventBridge,this.explorationNavigation,this.viewModeState,this.lazyScoped,this.contextActivityService,this.source,this.displayOverride),n.push(o);return[2,n]}}))}))},T.prototype.getAnalysisOptions=function(n){return __awaiter(this,void 0,m.Promise,(function(){var t,i;return __generator(this,(function(e){switch(e.label){case 0:return[4,this.lazyScoped("insightsAnalysisModern")];case 1:return t=e.sent(),[4,this.queryHandler.getCachedQueryOrGenerate({contract:this.visualContainer})];case 2:return null==(i=e.sent())?[2]:[2,t.getOptions(this.visualContainer,i.filterContext,this.selectors,n,this.analysisType)]}}))}))};var P,e=T;function T(e,t,i,n,r,a,o,s,l,u,c,p,h,d,v){t=P.call(this,"VisualContainer_ContextMenu_Analyze",t,void 0,null==v?void 0:v.insightsAnalysis)||this;return t.visualContainer=e,t.position=i,t.conceptualSchemaProxy=n,t.dataSources=r,t.eventBridge=a,t.explorationCapabilities=o,t.explorationNavigation=s,t.lazyScoped=l,t.viewModeState=u,t.queryHandler=c,t.analysisType=p,t.contextActivityService=h,t.source=d,t.displayOverride=v,t}v.InsightsAnalysisCommandsCollection=T,_e=v.VisualContainerMenuCommand,__extends(A,_e),A.prototype.execute=function(){return __awaiter(this,void 0,m.Promise,(function(){var t,i;return __generator(this,(function(e){switch(e.label){case 0:return this.insightsAnalysisData,this.explorationNavigation,this.dataSources,this.viewModeState,this.eventBridge,t=O(this.visualContainer.name,this.contextActivityService,"Analyze",this.source),[4,this.lazyScoped("insightsLauncher")];case 1:return(i=e.sent(),this.insightsAnalysisData.useInsightsPane)?[4,i.showInsightsFor(this.insightsAnalysisData)]:[3,3];case 2:return e.sent(),[3,5];case 3:return[4,i.launch(this.insightsAnalysisData,this.position)];case 4:e.sent(),e.label=5;case 5:return t.resolve(),[2]}}))}))},A.prototype.title=function(e){return e&&this.defaultTitleKey?e.get(this.defaultTitleKey):this.insightsAnalysisData.question},A.prototype.getChildren=function(){return __awaiter(this,void 0,m.Promise,(function(){return __generator(this,(function(e){return[2,null]}))}))};var _e,Te=A;function A(e,t,i,n,r,a,o,s,l,u,c,p){e=_e.call(this,null,e,void 0,p&&p.insightsAnalysis)||this;return e.visualContainer=t,e.position=i,e.insightsAnalysisData=n,e.dataSources=r,e.eventBridge=a,e.explorationNavigation=o,e.viewModeState=s,e.lazyScoped=l,e.contextActivityService=u,e.source=c,e}function D(e,t,i,n,r,a,o,s,l,u,c,p,h){p=d.call(this,p||"Drillthrough",t,"pbi-glyph-drillthrough",h&&h.drillthrough)||this;return p.visualContainer=e,p.drillthroughEntryPoint=i,p.drill=n,p.explorationNavigation=r,p.lazyScoped=a,p.pluginOps=o,p.queryHandler=s,p.telemetryService=l,p.contextActivityService=u,p.source=c,p.displayOverride=h,p}v.InsightsAnalysisCommand=Te,d=v.VisualContainerMenuCommand,__extends(D,d),D.prototype.execute=function(){return __awaiter(this,void 0,m.Promise,(function(){return __generator(this,(function(e){return[2]}))}))},D.prototype.isVisible=function(){return __awaiter(this,void 0,m.Promise,(function(){var t,i;return __generator(this,(function(e){switch(e.label){case 0:return(t=_.isEmpty(this.selectors))?[3,2]:[4,d.prototype.isVisible.call(this)];case 1:t=!e.sent(),e.label=2;case 2:return t?[2,!1]:this.drill.canDrillthrough(this.visualContainer)?[4,(i=this).getChildren()]:[3,4];case 3:return i.children=e.sent(),[2,!_.isEmpty(this.children)];case 4:return[2,!1]}}))}))},D.prototype.getChildren=function(){return __awaiter(this,void 0,m.Promise,(function(){var t,i,n,r,a=this;return __generator(this,(function(e){switch(e.label){case 0:return void 0!==this.children?[2,this.children]:(t=this.drillthroughEntryPoint,i=this.explorationNavigation.getCurrentSection(),r=g.util.VisualContainerUtils.getVisualType(this.visualContainer),_.isEmpty(this.selectors)||_.isEmpty(i.name)||!this.pluginOps.isQueryVisual(r)?[2,[]]:[4,this.queryHandler.getCachedQueryOrGenerate({contract:this.visualContainer})]);case 1:return null==(n=e.sent())?[2]:[4,this.lazyScoped("drillthrough")];case 2:return[4,e.sent().getDrillthroughActions(i.name,this.visualContainer,this.selectors,n.filterContext)];case 3:return r=e.sent(),[2,_.map(r,(function(e){return new De(a.visualContainer,e,t,a.lazyScoped,a.telemetryService,a.contextActivityService,a.source,a.displayOverride)}))]}}))}))},v.DrillthroughCommandCollection=D,Ae=v.VisualContainerMenuCommand,__extends(Me,Ae),Me.prototype.execute=function(){return __awaiter(this,void 0,m.Promise,(function(){var t;return __generator(this,(function(e){switch(e.label){case 0:return this.drillthroughActionData,this.drillthroughEntryPoint,this.lazyScoped,this.telemetryService,t=O(this.visualContainer.name,this.contextActivityService,"DrillThrough",this.source),[4,this.lazyScoped("drillthrough")];case 1:return e.sent().applyDrillthroughState(this.drillthroughActionData,!0),t.resolve(),this.telemetryService.logEvent(m.telemetry.EXDrillthroughGotoTarget,{entryPoint:this.drillthroughEntryPoint,toExternalReport:!!this.drillthroughActionData.targetReportGuid}),[2]}}))}))},Me.prototype.title=function(e){return this.drillthroughActionData.reportDisplayName?this.drillthroughActionData.sectionDisplayName+" ["+this.drillthroughActionData.reportDisplayName+"]":this.drillthroughActionData.sectionDisplayName};var Ae,De=Me;function Me(e,t,i,n,r,a,o,s){s=Ae.call(this,"Drillthrough",void 0,void 0,s&&s.drillthrough)||this;return s.visualContainer=e,s.drillthroughActionData=t,s.drillthroughEntryPoint=i,s.lazyScoped=n,s.telemetryService=r,s.contextActivityService=a,s.source=o,s}v.DrillthroughCommand=De,Ie=v.VisualContainerMenuCommand,__extends(M,Ie),M.prototype.title=function(e){return this.groupTitle},M.prototype.getChildren=function(){return __awaiter(this,void 0,m.Promise,(function(){return __generator(this,(function(e){return[2,this.children]}))}))},M.prototype.addChild=function(e){this.children.push(e)},Object.defineProperty(M.prototype,"isEmpty",{get:function(){return 0===this.children.length},enumerable:!1,configurable:!0}),M.prototype.isVisible=function(){return __awaiter(this,void 0,m.Promise,(function(){return __generator(this,(function(e){return[2,Ie.prototype.isVisible&&!this.isEmpty]}))}))};var Ie,e=M;function M(e,t,i){t=Ie.call(this,null,void 0,void 0,t&&t.extensions)||this;return t.groupTitle=e,t.menuLocation=i,t.children=[],t}function I(e,t,i,n,r,a,o,s,l,u,c,p){t=R.call(this,null,t,void 0,p&&p.extensions,void 0,u)||this;return t.visualContainer=e,t.commandName=i,t.commandTitle=n,t.eventBridge=r,t.explorationExtensibilityService=a,t.featureSwitchService=o,t.contextActivityService=s,t.source=l,t.visualContainerDataSelectionService=c,t}v.ExtensionCommandsGroup=M,R=v.VisualContainerMenuCommand,__extends(I,R),I.prototype.title=function(e){return this.commandTitle},I.prototype.execute=function(){return __awaiter(this,void 0,m.Promise,(function(){var t,i;return __generator(this,(function(e){return t=O(this.visualContainer.name,this.contextActivityService,"ExtensionCommand",this.source),i=this.getDataPointsDescriptions(),this.explorationExtensibilityService.executeCustomCommand(this.eventBridge,this.visualContainer,this.commandName,i),t.resolve(),[2]}))}))},I.prototype.getDataPointsDescriptions=function(){var e=[];if(this.visualContainerDataSelectionService&&!_.isEmpty(this.selectors))for(var t=0,i=this.selectors;t<i.length;t++){var n=i[t],r=this.visualContainerDataSelectionService.getSelectedValues(n,this.featureSwitchService.featureSwitches.dataPointLassoSelect);e.push({selector:n,values:r})}return e},v.ExtensionCommand=I,Ne=v.VisualContainerMenuCommand,__extends(N,Ne),N.prototype.isVisible=function(){return __awaiter(this,void 0,m.Promise,(function(){return __generator(this,(function(e){switch(e.label){case 0:return[4,Ne.prototype.isVisible.call(this)];case 1:return[2,e.sent()&&this.featureSwitchService.featureSwitches.onObject&&1===this.viewModeState.getMode()]}}))}))},N.prototype.execute=function(){return __awaiter(this,void 0,m.Promise,(function(){var t,i=this;return __generator(this,(function(e){return t=v.selectionUtils.getSelectedVisualContainers(this.selectionService),_.find(t,(function(e){return e.name===i.container.name}))||this.selectionService.selectElement({id:this.container.id,canvasItem:this.container},0),this.viewModeState.setFormatMode(!0,"Context Menu"),this.panesVisibilityService.isPaneVisible(3)||this.panesVisibilityService.togglePaneVisibility(3),[2]}))}))},N.prototype.isDisabled=function(){return __awaiter(this,void 0,m.Promise,(function(){return __generator(this,(function(e){return[2,z.isQueryVisualEmpty(this.visualPlugin,this.visualPluginOps,this.container)||!!this.visibility.get(16)]}))}))};var Ne,e=N;function N(e,t,i,n,r,a,o,s,l){l=Ne.call(this,"Format",void 0,void 0,l&&l.turnOnFormatMode)||this;return l.featureSwitchService=e,l.panesVisibilityService=t,l.viewModeState=i,l.container=n,l.selectionService=r,l.visualPlugin=a,l.visualPluginOps=o,l.visibility=s,l}function Oe(e,t,i,n,r){r=a.call(this,"NewVisualCalc",void 0,void 0,r&&r.seeData)||this;return r.visualContainer=e,r.contextActivityService=t,r.source=i,r.visualCalcEagerService=n,r}function O(e,t,i,n){return t.createActivity({name:"VisualAction",visualName:e,data:{action:i,source:n}})}v.TurnOnFormatModeCommand=N,a=v.VisualContainerMenuCommand,__extends(Oe,a),Oe.prototype.execute=function(){return __awaiter(this,void 0,m.Promise,(function(){var t;return __generator(this,(function(e){switch(e.label){case 0:return t=O(this.visualContainer.name,this.contextActivityService,"CreateVisualCalculation",this.source),[4,this.visualCalcEagerService.enterVisualCalcMode(this.visualContainer,void 0)];case 1:return e.sent(),t.resolve(),[2]}}))}))},Oe.prototype.isVisible=function(){return __awaiter(this,void 0,m.Promise,(function(){return __generator(this,(function(e){switch(e.label){case 0:return[4,a.prototype.isVisible.call(this)];case 1:return e.sent()?[4,this.visualCalcEagerService.canSupportVisualCalc(this.visualContainer)]:[2,!1];case 2:return[2,e.sent()]}}))}))},v.CreateVisualCalculationCommand=Oe,Be=v.VisualContainerMenuCommand,__extends(Xe,Be),Xe.prototype.execute=function(){return __awaiter(this,void 0,m.Promise,(function(){return __generator(this,(function(e){return this.eventBridge.publishToChannel(v.events.shareVisual,{visual:this.visualContainer,source:this.source}),[2]}))}))},Xe.prototype.isVisible=function(){return __awaiter(this,void 0,m.Promise,(function(){var t;return __generator(this,(function(e){switch(e.label){case 0:return(t=this.explorationCapabilities.getCapabilities().allowShareVisual&&0===this.viewModeState.getMode())?[4,Be.prototype.isVisible.call(this)]:[3,2];case 1:t=e.sent(),e.label=2;case 2:return[2,t&&this.menuOptions.canShareVisual]}}))}))};var Be,ke=Xe;function Xe(e,t,i,n,r,a,o){o=Be.call(this,"Sharing_Visual_LinkToVisual",void 0,"pbi-glyph-link",o&&o.shareVisual)||this;return o.eventBridge=e,o.explorationCapabilities=t,o.menuOptions=i,o.source=n,o.viewModeState=r,o.visualContainer=a,o}v.VisualContainerShareVisualCommand=ke,Le=v.VisualContainerMenuCommand,__extends(He,Le),He.prototype.execute=function(){return __awaiter(this,void 0,m.Promise,(function(){return __generator(this,(function(e){return this.eventBridge.publishToChannel(v.events.shareVisualToPPT,{visual:this.visualContainer,source:this.source}),[2]}))}))},He.prototype.isVisible=function(){return __awaiter(this,void 0,m.Promise,(function(){var t;return __generator(this,(function(e){switch(e.label){case 0:return(t=this.explorationCapabilities.getCapabilities().allowShareVisual&&0===this.viewModeState.getMode())?[4,Le.prototype.isVisible.call(this)]:[3,2];case 1:t=e.sent(),e.label=2;case 2:return[2,t&&this.featureSwitchService.featureSwitches.storytellingSingleVisual&&this.featureSwitchService.featureSwitches.storytellingShareSingleVisual&&this.featureSwitchService.featureSwitches.storytellingTenantEnabled&&commonGlobals.exportToPPTLiveEnabled&&this.menuOptions.canShareVisual]}}))}))};var Le,Re=He;function He(e,t,i,n,r,a,o,s){s=Le.call(this,"Storytelling_Export_Open_In_PowerPoint",void 0,"pbi-glyph-powerpoint",s&&s.shareVisual)||this;return s.eventBridge=e,s.explorationCapabilities=t,s.menuOptions=i,s.source=n,s.viewModeState=r,s.visualContainer=a,s.featureSwitchService=o,s}v.ExportToStorytellingVisualCommand=Re,ze=v.VisualContainerMenuCommand,__extends(B,ze),B.prototype.isVisible=function(){return __awaiter(this,void 0,m.Promise,(function(){var t;return __generator(this,(function(e){switch(e.label){case 0:return[4,ze.prototype.isVisible.call(this)];case 1:return(t=e.sent())?[4,window.Promise.all(this.childCommands.map((function(e){return e.isVisible()})))]:[3,3];case 2:t=e.sent().some((function(e){return e})),e.label=3;case 3:return[2,t]}}))}))},B.prototype.getChildren=function(){return __awaiter(this,void 0,m.Promise,(function(){return __generator(this,(function(e){return[2,this.childCommands]}))}))};var ze,e=B;function B(e,t,i,n,r,a,o,s,l,u){var c=ze.call(this,"Share",void 0,"VisualHeader"===o?"pbi-glyph-share":void 0,u&&u.shareVisual)||this;return c.childCommands=[new ke(e,t,r,o,i,s.contract,u),new v.ShareToTeamsVisualCommand(s,n,e,r,a,o,u),new Re(e,t,r,o,i,s.contract,l,u)],c}v.VisualContainerShareCommandsCollection=B})(powerbi=powerbi||{}),(function(e){var t,i;function n(e,t){this.moduleConfig={name:"ui.bootstrap",dependency:{javascript:"angular-ui-datetimepicker"}},this.services=t,this.id=i.generateId(),this.calendarButtonText=this.services.localizationService.get("GroupNavigationPaneContextMenuItem_Calendar")}t=(t=e.explore||(e.explore={})).controllers||(t.controllers={}),i=e.common.utils.IdUtility,n.createOptions=function(){return{additionalServices:["overlayService","localizationService"]}},n.prototype.$onInit=function(){var t=this;this.ngModel.$render=function(){var e;_.isNumber(t.ngModel.$viewValue)?"Invalid Date"!==(e=new Date(t.ngModel.$viewValue)).toString()?t.ngModel.$setViewValue(e):t.ngModel.$setViewValue(void 0):void 0!==t.ngModel.$viewValue&&t.ngModel.$viewValue instanceof Date?t.inputInvalid||(t.dateVal=t.ngModel.$viewValue,t.textVal=t.ngModel.$viewValue.toLocaleDateString()+" "+t.ngModel.$viewValue.toLocaleTimeString()):(t.textVal=void 0,t.dateVal=void 0,t.inputInvalid=!1)}},n.prototype.$onChanges=function(e){e&&e.validators&&void 0!==this.textVal&&this.validateTextInput()},n.prototype.dateSelected=function(){this.inputInvalid=!1,this.textVal=this.dateVal.toLocaleDateString()+" "+this.dateVal.toLocaleTimeString(),this.ngModel.$setViewValue(this.dateVal),this.services.overlayService.hideAllDropdowns()},n.prototype.dateTextUpdated=function(){this.validateTextInput(),this.inputInvalid||this.ngModel.$setViewValue(this.dateVal)},n.prototype.validateTextInput=function(){var e;this.textVal?(e=new Date(this.textVal),this.inputInvalid="Invalid Date"===e.toString(),this.validators&&(this.inputInvalid=this.inputInvalid||e<this.validators.min||e>this.validators.max),this.inputInvalid||(this.dateVal=e)):(this.textVal=void 0,this.dateVal=void 0,this.inputInvalid=!1)},t.DateTimePickerController=n})(powerbi=powerbi||{}),(function(e){var t;((t=e.explore||(e.explore={})).components||(t.components={})).DateTimePicker={templateUrl:"components/dateTimePicker/dateTimePicker.html",bindings:{placeholder:"<",validators:"<",labelId:"<"},require:{ngModel:"ngModel"},controller:e.common.createController(t.controllers.DateTimePickerController)}})(powerbi=powerbi||{}),(function(e){(e=(e=(e=e.explore||(e.explore={})).viewModels||(e.viewModels={})).FilterEvents||(e.FilterEvents={})).filterChanged={name:"filterChanged"},e.topNFilterOrderByUpdate={type:2,name:"topNFilterOrderByUpdate"}})(powerbi=powerbi||{}),(function(r){var a,e,n,o,s,l;function u(e,t){var i=n.call(this,e,{expanded:!1,canToggleSingleSelect:!1,availableTypes:[],type:e.type})||this;return i.isInvalidForMappedColumn=!1,i.id=u.counter++,i.restatement="",i.displayName="",i.containerScope=t,i.howCreated=0,i.isLinkedAsAggregation=!1,i.filterCapabilities=a.FilterUtils.getFilterCapabilities(e),i}function c(e,t){return e&&!e.bool&&!t}a=r.explore||(r.explore={}),e=a.viewModels||(a.viewModels={}),o=a.contracts.FilterType,s=r.data.SQExprUtils,l=r.explore.util.VisualContainerUtils,n=e.ViewModel,__extends(u,n),u.prototype.setServices=function(e,t,i){this.visualHostServices=e,this.visualPlugin=t,this.viewModeState=i},u.prototype.isInvalid=function(){return this.invalid},u.prototype.clearDQPWarning=function(){this.isInvalidForMappedColumn&&(this.invalid=!1,this.readOnlyState.invalid=!1,this.isInvalidForMappedColumn=!1)},u.prototype.isInvalidCardType=function(){return this.cardType&&this.cardType.invalid},Object.defineProperty(u.prototype,"isVisualFilter",{get:function(){return this.containerScope&&0===this.containerScope.scopeType},enumerable:!1,configurable:!0}),Object.defineProperty(u.prototype,"hasDefaultValue",{get:function(){return this.defaultValue&&(1===this.howCreated||5===this.howCreated)},enumerable:!1,configurable:!0}),Object.defineProperty(u.prototype,"isLinkField",{get:function(){return 5===this.howCreated&&!this.contract.isTransient},enumerable:!1,configurable:!0}),Object.defineProperty(u.prototype,"canToggleLinkAsAggregation",{get:function(){return this.isLinkField&&!this.isMeasure},enumerable:!1,configurable:!0}),Object.defineProperty(u.prototype,"canDeleteManually",{get:function(){return this.filterCapabilities.canDelete||!!this.readOnlyState.invalid},enumerable:!1,configurable:!0}),Object.defineProperty(u.prototype,"canClearManually",{get:function(){return this.filterCapabilities.canClear},enumerable:!1,configurable:!0}),Object.defineProperty(u.prototype,"hasRestatement",{get:function(){return""!==this.restatement&&null!=this.restatement},enumerable:!1,configurable:!0}),Object.defineProperty(u.prototype,"canHideManually",{get:function(){return this.filterCapabilities.canHide},enumerable:!1,configurable:!0}),Object.defineProperty(u.prototype,"canLockManually",{get:function(){return this.filterCapabilities.canLock},enumerable:!1,configurable:!0}),Object.defineProperty(u.prototype,"canRenameManually",{get:function(){return this.filterCapabilities.canRename},enumerable:!1,configurable:!0}),Object.defineProperty(u.prototype,"canSortManually",{get:function(){return this.filterCapabilities.canSort},enumerable:!1,configurable:!0}),Object.defineProperty(u.prototype,"canExpandManually",{get:function(){return this.filterCapabilities.canEdit&&a.FilterUtils.canExpandManually(this.contract.howCreated,this.contract.isTransient,this.contract.expression,!this.invalid,this.contract.type)},enumerable:!1,configurable:!0}),u.prototype.getFilterContainerScope=function(){return this.containerScope},u.prototype.setRestatement=function(e){this.contract.type===this.readOnlyState.type&&(this.restatement=e)},u.prototype.clearRestatement=function(){this.restatement=""},u.prototype.getRestatement=function(){return this.restatement},u.prototype.updateFilterCardStyle=function(e,t){t&&(e=e&&e.evaluatedObjects,this.style=a.FilterUtils.getFilterCardStyle(e,!!this.contract.filter,t,this.filterCardStyleArguments))},Object.defineProperty(u.prototype,"checkboxAndApplyColor",{get:function(){return this.style&&this.style.checkboxAndApplyColor},enumerable:!1,configurable:!0}),Object.defineProperty(u.prototype,"borderColor",{get:function(){return this.style&&this.style.borderColor},enumerable:!1,configurable:!0}),Object.defineProperty(u.prototype,"backgroundColor",{get:function(){return this.style&&this.style.backgroundColor},enumerable:!1,configurable:!0}),Object.defineProperty(u.prototype,"foregroundColor",{get:function(){return this.style&&this.style.foregroundColor},enumerable:!1,configurable:!0}),Object.defineProperty(u.prototype,"inputBoxBorderColor",{get:function(){return this.style&&this.style.inputBoxBorderColor},enumerable:!1,configurable:!0}),Object.defineProperty(u.prototype,"inputBoxBackgroundColor",{get:function(){return this.style&&this.style.inputBoxBackgroundColor},enumerable:!1,configurable:!0}),Object.defineProperty(u.prototype,"inputBoxForegroundColor",{get:function(){return this.style&&this.style.inputBoxForegroundColor},enumerable:!1,configurable:!0}),Object.defineProperty(u.prototype,"fontSize",{get:function(){return this.style&&this.style.fontSize},enumerable:!1,configurable:!0}),Object.defineProperty(u.prototype,"fontFamily",{get:function(){return this.style&&this.style.fontFamily},enumerable:!1,configurable:!0}),Object.defineProperty(u.prototype,"visualContainer",{get:function(){if(this.isVisualFilter)return this.containerScope.container},enumerable:!1,configurable:!0}),u.prototype.isFilterLocked=function(){return this.contract.isLockedInViewMode},u.prototype.isFilterHidden=function(){return this.contract.isHiddenInViewMode},u.prototype.isFilterExpanded=function(){return this.readOnlyState.expanded},u.prototype.updateFilterProperties=function(e,t,i){this.contract.expression&&(n=this.contract.expression,this.isMeasure=s.isMeasure(n),this.discourageAggregation=s.discourageAggregation(n,e),this.valueType=a.FilterUtils.getValueType(n,e),this.formatter=a.FilterUtils.getFormatter(n,e),this.defaultValue=s.getDefaultValue(n,e),this.parameterMetadata=s.getConceptualParameterMetadata(n,e),5===this.howCreated&&!this.contract.isTransient||this.isMappedToMParameter()&&!this.supportsMultipleValues()?(this.isSingleSelectionRequired=!0,this.disableSelectionModeToggle=!0):this.contract.isTransient&&(this.isSingleSelectionRequired=!1,this.disableSelectionModeToggle=!0)),this.contract.objects&&(n=r.data.DataViewObjectDefinitions.getValue(this.contract.objects,{objectName:"general",propertyName:"isInvertedSelectionMode"},void 0),this.isInvertedSelectionMode=n&&n.value);var n=this.containerScope.container;this.hasGroupingScope=n&&l.hasGrouping(n,e),this.invalid=!_.isEmpty(a.FilterUtils.validate(this.contract,e,i)),this.invalid?this.isInvalidForMappedColumn=!1:(this.isInvalidForMappedColumn=this.hasInvalidFiltersForMParameters(this.contract,e),this.invalid=this.isInvalidForMappedColumn),this.disabled=a.FilterUtils.shouldDisableFilter(this.contract,e,n,i,t)},u.prototype.hasInvalidFiltersForMParameters=function(e,t){e=null==(e=null==e?void 0:e.filter)?void 0:e.conditions();if(e)for(var i=0,n=e;i<n.length;i++){var r=n[i];if(!s.checkExprForValidMParameters(r,t))return!0}return!1},u.prototype.switchType=function(e){this.readOnlyState.type=e},u.prototype.canVisualize=function(){var e=this.contract;return e.expression&&e.type!==o.Passthrough&&!this.isMeasure},u.prototype.updateViewStateCore=function(e){var t=this.contract,i=(e.type,!this.invalid),t=(e.disabled=this.disabled,e.expanded=!0===t.expanded&&i,e.invalid=!i,_.some(this.availableTypes,(function(e){return e.type===o.Categorical}))&&!e.visual&&t.config&&(i=t.config.singleVisual)&&this.visualHostServices&&this.visualPlugin&&(e.visual={viewport:u.DefaultVisualViewPort,type:r.visuals.plugins.filterSlicer.name,dataTransforms:{objects:i.objects},hostServices:this.visualHostServices,interactivityOptions:{dragDataPoint:!1,selection:!0},allowInvalidDataView:!0,visualPlugin:this.visualPlugin,themeCollection:{}}),5===this.howCreated&&!this.contract.isTransient);e.canToggleSingleSelect=!t&&!this.contract.isTransient&&!(e.disabled||!e.expanded||!e.visual||!e.visual.data)},u.prototype.updateAvailableTypes=function(e,t){void 0===t&&(t=r.common.getLocalize());var i,n=this.readOnlyState.type;n===o.Passthrough?this.availableTypes=[]:(i=[],c(this.valueType,this.isLinkField)&&i.push({type:o.Advanced,label:t.get("FilterPane_Advanced")}),this.isMeasure||(i.push({type:o.Categorical,label:t.get("FilterPane_Basic")}),this.valueType&&this.valueType.dateTime&&!this.isMappedToMParameter()&&(i.push({type:o.RelativeDate,label:t.get("FilterPane_RelativeDate")}),i.push({type:o.RelativeTime,label:t.get("FilterPane_RelativeTime")})),this.isVisualFilter&&!this.isMappedToMParameter()&&i.push({type:o.TopN,label:t.get("FilterPane_TopN")})),this.availableTypes=i,this.hiddenTypes=[],this.updateCardType(n,t))},u.prototype.updateCardType=function(t,e){void 0===e&&(e=r.common.getLocalize());var i=this.availableTypes;this.readOnlyState.type=t,this.cardType=_.find(i,(function(e){return e.type===t})),!this.cardType&&this.hiddenTypes&&0<this.hiddenTypes.length?(this.cardType=_.find(this.hiddenTypes,(function(e){return e.type===t})),this.availableTypes.push(this.cardType)):!this.cardType&&this.isMappedToMParameter()&&(this.cardType={type:o.Categorical,label:e.get("FilterPane_Basic")})},u.prototype.isSingleSelectDisabled=function(){return this.disableSelectionModeToggle||!this.viewModeState||0===this.viewModeState.getMode()},u.prototype.getDisplayName=function(){return this.contract.displayName||this.displayName},u.prototype.updateIsLinkedAsAggregation=function(e){this.isLinkedAsAggregation=e},u.prototype.getInputPlaceholder=function(){return this.viewModeState&&this.viewModeState.getConfig().displayOptions.enableMobileFilters?r.common.getLocalize().get("TypeHere"):""},u.prototype.isMappedToMParameter=function(){return this.parameterMetadata&&1===this.parameterMetadata.kind},u.prototype.supportsMultipleValues=function(){var e;return!(null==(e=this.parameterMetadata)||!e.supportsMultipleValues)},u.prototype.supportsSelectAll=function(){var e;return!(null==(e=this.parameterMetadata)||!e.supportsSelectAll)},u.DefaultVisualViewPort={width:146,height:180,scale:1},u.counter=0,e.FilterViewModel=u,e.supportsAdvancedFilter=c})(powerbi=powerbi||{}),(function(y){var p,f,e,l,C,u,S,E,c;function h(e){var t,i;return t=!(t=e.filter&&(i=e.filter.conditions()[0])?f.FilterCardConverter.createAdvFilter(i,null,e.expression):t)&&e.expression?new f.AdvFilterCard(e.expression):t}function d(e,t,i,n,r,a,o){var s=u.asFieldPattern(e);return i.getDisplayName(e,t,n,r,0===o?a:void 0,{includeVariationSource:!0})||(s?l.getFieldExprName(s):void 0)}function v(e,t,i,n,r,a,o){i=i.getQualifiedDisplayName(e,t,r);return 5===o||6===o||2===o?i=n.format("FilterCard_Transient_Drill",[i]):7===o?i=n.format("FilterCard_Transient_URL",[i]):a&&(i=n.format("FilterCard_Transient",[i])),i}function m(e,t,i,n,r){i=new p.services.IncludeExcludeSQExprVisitor(i,n);return e.filter?(n=e.filter.conditions(),!(_.isEmpty(n)||1<n.length)&&(n[0].accept(i),0<i.dataPoints.length)?(e.type=i.isExclude?C.Exclude:C.Include,(n=new f.FilterViewModel(e,t)).displayName=p.FilterUtils.getDisplayNameForIncludeExcludeFilters(r,e.type,i.dataPoints.length),n):void 0):e.type?new f.FilterViewModel(e,t):void 0}function g(e,i,t,n,r,a,o){e.type,null==e.type&&(e.type=C.Passthrough);var s,l,u,c,p,h,d,v,m,t=new f.FilterViewModel(e,t),g=e.restatement;return g&&""!==g||!e.filter||(g=r.getFilterRestatement(e.filter,n,i,s={includeFieldNamesInFilter:!0}),t.tooltip=r.getQualifiedFilterRestatement(e.filter,n,i,s),_.isEmpty(g)&&(e=y.data.PassthroughFilterPattern.extractParametersFromFilter(e.filter),_.isEmpty(e)||(c=o.get("ListJoin_Separator"),d=m=v=void 0,a&&(l=a.columnProperties),u=e.fieldsBeingFiltered.map((function(e){var t=a&&a.query&&a.query.defn.selectNameOf(e);return r.getDisplayName(e,n,i,t,l)})).join(c),c=e.fieldsBeingFiltered.map((function(e){return r.getQualifiedDisplayName(e,n,i,s)})).join(c),e.isSubquery&&e.itemCount?(p=E.format(e.itemCount),e.orderByField&&(h=a&&a.query&&a.query.defn.selectNameOf(e.orderByField),h=r.getDisplayName(e.orderByField,n,i,h,l),d=e.isTop?"FilterRestatement_TopNBy_Drillthrough":"FilterRestatement_BottomNBy_Drillthrough",v=[p,u,h],m=[p,c,h])):(v=[u],m=[c],d=e.isSubquery?"FilterRestatement_Subquery":"FilterRestatement_Columns"),g=S.format.apply(S,__spreadArray([o.get(d)],v||[],!1)),t.tooltip=S.format.apply(S,__spreadArray([o.get(d)],m||[],!1))))),t.setRestatement(g),t}function b(e,t,i,n,r,a,o){var s,l,u,c=h(e);if(c)return e.expression||(e.expression=c.field),e.type,null==e.type&&(e.filter?e.type=p.FilterUtils.getFilterType(c.field,c.supportsCategorical):e.type=p.FilterUtils.getDefaultFilterType(e.expression,n,e.howCreated)),null==e.type&&(e.type=C.Categorical),c=e.expression,s=new f.FilterViewModel(e,i),o&&(l=o.query&&o.query.defn.selectNameOf(c),u=o.columnProperties),s.displayName=d(c,n,r,t,l,u,i.scopeType),s.tooltip=v(c,n,r,a,t,e.isTransient,e.howCreated),s}function w(e,t,i,n,r,a,o){var s;if(0===i.scopeType&&5!==e.howCreated)return(s=y.data.TopNFilterPattern.extractParametersFromFilter(e.filter))&&V(e,C.TopN,s.fieldBeingFiltered),F(e,C.TopN,i,n,r,a,t,o)}function x(e,t,i,n,r,a,o,s,l){var u=f.RelativeFilterViewModelUtil.relativeFilterTypeToFilterType(e),e=y.data.RelativeDateFilterPattern.extractParametersFromSemanticFilter(t.filter,e);if(e){if(e.options&&e.options.anchorDate&&l)return;V(t,u,e.field)}return F(t,u,n,r,a,o,i,s)}function V(e,t,i){e.type,e.type=t,e.expression=i}function F(e,t,i,n,r,a,o,s){var l;if(e.type===t&&e.expression)return t=new f.FilterViewModel(e,i),l=s&&s.query?s.query.defn.selectNameOf(e.expression):void 0,s=s?s.columnProperties:void 0,t.displayName=d(e.expression,n,r,o,l,s,i.scopeType),t.tooltip=v(e.expression,n,r,a,o,e.isTransient,e.howCreated),t}p=y.explore||(y.explore={}),f=p.viewModels||(p.viewModels={}),l=y.data.FieldExprPattern,C=p.contracts.FilterType,u=y.data.SQExprConverter,S=jsCommon.StringExtensions,E=y.visuals.valueFormatter,c=y.data.RelativeFilterType,(e=f.FilterViewModelFactory||(f.FilterViewModelFactory={})).convertFilterContainer=function(e,t,i,n,r,a,o,s,l){var u;switch(e.expression||e.filter||e.type===C.Include||(e.type,C.Exclude),e.type){case C.TopN:u=w(e,s,n,t,i,o,l);break;case C.Advanced:case C.Categorical:u=b(e,s,n,t,i,o,l);break;case C.RelativeTime:u=x(c.Time,e,s,n,t,i,o,l,!1);break;case C.RelativeDate:u=x(c.Date,e,s,n,t,i,o,l,!1);break;case C.Passthrough:u=g(e,s,n,t,i,l,o);break;case C.Include:case C.Exclude:u=m(e,n,t,i,o);break;default:u=w(e,s,n,t,i,o,l)||x(c.Time,e,s,n,t,i,o,l,!0)||x(c.Date,e,s,n,t,i,o,l,!0)||b(e,s,n,t,i,o,l)||m(e,n,t,i,o)||g(e,s,n,t,i,l,o)}return e.type,u.howCreated=e.howCreated,u.updateFilterProperties(t,r,a),u},e.extractAdvFilterCard=h})(powerbi=powerbi||{}),(function(e){var t;e=(e=e.explore||(e.explore={})).viewModels||(e.viewModels={}),(t=e.PropertyCardNames||(e.PropertyCardNames={})).Background="background",t.Border="border",t.CalloutValue="calloutValue",t.CategoryAxis="categoryAxis",t.CategoryLabels="categoryLabels",t.ConditionalFormatting="conditionalFormatting",t.DataBars="dataBars",t.DataPoint="dataPoint",t.DropShadow="dropShadow",t.General="general",t.Gradient="gradient",t.Labels="labels",t.Legend="legend",t.LockAspect="lockAspect",t.PersonalizeVisual="personalizeVisual",t.StylePreset="stylePreset",t.SubTitle="subTitle",t.Title="title",t.Totals="totals",t.ValueAxis="valueAxis",t.VisualHeader="visualHeader",t.VisualHeaderTooltip="visualHeaderTooltip",t.VisualLink="visualLink",t.VisualTooltip="visualTooltip",t.Zoom="zoom",(t=e.PropertySliceNames||(e.PropertySliceNames={})).ApplyToAllPages="applyToAllPages",t.Color="color",t.DynamicLabelValue="dynamicLabelValue",t.FlagsSelection="flagsSelection",t.InnerPadding="innerPadding",t.NumericSelection="numericSelection",t.Position="position",t.RevertToDefault="revertToDefault",t.SecPosition="secPosition",t.SecShow="secShow",t.SecShowAxisTitle="secShowAxisTitle",t.Selection="selection",t.Show="show",t.ShowAxisTitle="showAxisTitle",t.ShowDynamicLabels="showDynamicLabels",t.ShowGradientLegend="showGradientLegend",t.Slider="slider",t.SwitchAxisPosition="switchAxisPosition",t.TextArea="textarea",t.Transparency="transparency",(t=e.GeneralPropertyNames||(e.GeneralPropertyNames={})).X="x",t.Y="y",t.Width="width",t.Height="height",t.AltText="altText",t.AllowBinnedLineSample="allowBinnedLineSample",t.AllowOverlappingPointsSample="allowOverlappingPointsSample",t.KeepLayerOrder="keepLayerOrder"})(powerbi=powerbi||{}),(function(e){var s,t,i,l;function n(e,t){if(e&&e.sections)return e=e.sections,-1!==(e=_.findIndex(e,(function(e){return e.name===t})))?e:void 0}function a(e,t){for(var i=1,n=t.format("Explore_Section_Page",[i.toFixed()]);0<=_.findLastIndex(e,(function(e){return e.displayName===n}));)n=t.format("Explore_Section_Page",[(++i).toFixed()]);return n}function r(e){return!!(1&e.visibility)}s=e.explore||(e.explore={}),t=s.SectionUtils||(s.SectionUtils={}),i=jsCommon.ArrayExtensions,l=e.explore.contracts.Section,t.synchronizeSectionsIds=function(e,t){for(var i=l.filterTransient(t),n=l.filterTransient(e),r=i.length-1;0<=r;r--){var a=i[r],o=n[r];a.id=o.id,a.objectId=o.objectId,!(function i(n,r){var e=function(e){var t=n[e],e=r[e];t.id=e.id,s.contracts.isVisualContainerGroup(t)&&s.contracts.isVisualContainerGroup(e)&&i(t.children,e.children)};for(var t=n.length-1;0<=t;t--)e(t)})(a.visualContainerGroups,o.visualContainerGroups)}},t.findSectionIndexForSectionName=n,t.getActiveSectionIndex=function(e,t){var i;return i=null!=(i=null==(i=t?n(e,t):i)&&_.isNumber(e.activeSectionIndex)?e.activeSectionIndex:i)&&_.inRange(i,0,e.sections.length)?i:0},t.findSectionIndexForSection=function(e,t){return e&&e.sections?(e=e.sections,_.findIndex(e,(function(e){return e===t}))):-1},t.findSectionById=function(e,t){return e&&e.sections?i.findWithId(e.sections,t):null},t.findSectionIndexForSectionId=function(e,t){return e&&e.sections?(e=e.sections,_.findIndex(e,(function(e){return e.id===t}))):-1},t.getNextSectionDisplayNameWithIndex=a,t.fillDefaultSectionDisplayNames=function(e,t){for(var i=0,n=e.sections;i<n.length;i++){var r=n[i];r.displayName||(r.displayName=a(e.sections,t))}},t.getVisibleSections=function(e){return _.filter(e,(function(e){return!r(e)}))},t.isSectionHidden=r,t.isSectionTooltip=function(e){return!!(1&e.type)}})(powerbi=powerbi||{}),(function(e){var t,r;t=(t=e.explore||(e.explore={})).util||(t.util={}),r=e.explore.SectionUtils,(t=t.ExplorationUtil||(t.ExplorationUtil={})).isIntermediateState=function(e){return!e||!e.exploration},t.isReportAnnotationsEnabled=function(e){return!e||!e.isReportAnnotationsDisabled},t.removeQuickExploreConfig=function(e){for(var t=0,i=e.sections;t<i.length;t++){var n=i[t];r.isQuickExploreSection(n)&&(n.dynamicConfig=void 0)}}})(powerbi=powerbi||{}),(function(e){var t,a;t=(t=e.explore||(e.explore={})).viewModels||(t.viewModels={}),a=e.explore.util.DetailVisualUtils,(t.DetailVisualViewModelUtils||(t.DetailVisualViewModelUtils={})).convertDetailVisual=function(e,t,i,n,r){return{parentContract:e,visual:{viewport:a.adjustViewport(e.detailVisualLayout,i,n),themeCollection:t,allowInvalidDataView:!0,hostServices:null,visualName:e.name+"-detail"},hasData:!1}},(t.DetailVisualEvents||(t.DetailVisualEvents={})).spinnerAction={name:"spinnerAction"}})(powerbi=powerbi||{}),(function(e){var t,i;function n(e,t){void 0===t&&(t=0),this.selectedVisualOriginalPosition=-1,this.contract=e,this.canvasLayout=t}t=e.explore||(e.explore={}),i=t.viewModels||(t.viewModels={}),t=e.explore.constants.ExploreCanvasConstants,i.FixedPhoneCanvasSettings={phoneWidth:t.PhoneAuthoringViewportWidth,phoneHeight:t.PhonePortraitCanvasHeight,phoneGridLayout:{columnCount:t.PhonePortraitColumnCount,rowCount:t.PhonePortraitRowCount,newVisualCellCount:{width:6,height:6}}},Object.defineProperty(n.prototype,"width",{get:function(){return 0===this.canvasLayout?this.contract.size&&this.contract.size.width:i.FixedPhoneCanvasSettings.phoneWidth},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"height",{get:function(){return 0===this.canvasLayout?this.contract.size&&this.contract.size.height:i.FixedPhoneCanvasSettings.phoneHeight},enumerable:!1,configurable:!0}),t=n,i.ExploreCanvas=t})(powerbi=powerbi||{}),(function(n){var e;function t(e,t,i){return{key:t,text:(i=void 0===i?n.common.getLocalize():i).get(e),type:0}}((e=(e=(e=n.explore||(n.explore={})).viewModels||(e.viewModels={})).ExplorationContainerViewModelFactory||(e.ExplorationContainerViewModelFactory={})).MenuItemFactory||(e.MenuItemFactory={})).createNavigationMenuItems=function(e){return{items:[t("Duplicate_page",0,e),t("Rename_page",1,e),t("Delete_page",2,e),t("Hide_page",3,e)]}}})(powerbi=powerbi||{}),(function(e){var t;e=(e=e.explore||(e.explore={})).viewModels||(e.viewModels={}),(t=e.ExplorationContainerViewModelFactory||(e.ExplorationContainerViewModelFactory={})).createNavigationMenuItems=function(e){return t.MenuItemFactory.createNavigationMenuItems(e)}})(powerbi=powerbi||{}),(function(e){var n,s,r,l,t=e.explore||(e.explore={}),i=t.viewModels||(t.viewModels={}),a=jsCommon.EnumExtensions,P=e.data.SQExpr,T=e.data.SQExprConverter,A=e.data.FieldExprPattern,o=(i.getIconClassName=function(e,t,i){var t=t?"_paneColorRefresh":"",n=e.fieldType;if(1===n)return"fieldListFolder"+t;if(5===n)return"none";if(2===n)return"fieldListHierarchy"+t;if(6===n)return"fieldListMeasure"+t;if(1===e.contract.queryable)return"fieldListError"+t;if(1===e.kind)return e.contract.measure&&e.contract.measure.kpi&&4===e.fieldType?"fieldListKpi"+t:e.contract.measure&&e.contract.measure.changeDetectionMetadata?"fieldListChangeDetection"+t:"fieldListMeasure"+t;if(void 0!==e.contract.type&&void 0!==e.contract.type.geography)return"fieldListGeoData"+t;if(0===e.kind){n=e.contract.column;if(n){if(n.parameterMetadata)return"fieldListParameter"+t;if(n.groupingMetadata)return"fieldListGroup"+t;if(n.calculated)return e.type&&e.type.numeric?"fieldListNumericCalculatedColumn"+t:"fieldListCalculatedColumn"+t;if(!_.isEmpty(n.variations)&&e.type.dateTime)return"fieldListCalendar"+t}if(e.idOnEntityKey)return"fieldListIdentity"+t}return e.type&&e.type.numeric&&1!==e.defaultAggregate&&i?"fieldListNumeric"+t:"none"},Object.defineProperty(u.prototype,"name",{get:function(){return this.contract.name},enumerable:!1,configurable:!0}),Object.defineProperty(u.prototype,"canEdit",{get:function(){return this.contract.capabilities.canEdit&&!this.disableEditing},enumerable:!1,configurable:!0}),Object.defineProperty(u.prototype,"canCreateColumn",{get:function(){return this.canEdit&&!1!==this.contract.capabilities.supportsCalculatedColumns},enumerable:!1,configurable:!0}),u.prototype.findEntity=function(t){return _.find(this.entities,(function(e){return e.name===t}))},u.prototype.findFields=function(e,t,i){e=this.findEntity(e);if(e)return e.findFields(t,i)},u.prototype.findHierarchies=function(e,t,i){e=this.findEntity(e);if(e)return e.findHierarchies(t,i)},u.prototype.findKpis=function(e,t,i){e=this.findEntity(e);if(e)return e.findKpis(t,i)},u.prototype.findKpiMeasures=function(e,t,i){e=this.findEntity(e);if(e)return e.findKpiMeasures(t,i)},u.prototype.findItems=function(e){var t=[];if(!P.isTransformOutputRoleRef(e)&&!P.isSparklineData(e)){var i=T.asFieldPattern(e),n=A.toFieldExprEntityItemPatterns(i);if(i){var r=i.hierarchyLevel||i.hierarchyLevelAggr;if(r){e=this.findHierarchies(n[0].entity,r.name,r.schema);if(e)for(var a=0,o=e;a<o.length;a++){var s=o[a];t.push(s);for(var l=0,u=s.hierarchyLevels;l<u.length;l++)(f=u[l]).name===r.level&&t.push(f)}}else if(i.columnHierarchyLevelVariation){var c=i.columnHierarchyLevelVariation.source.name;if(!(w=this.findFields(n[0].entity,c,n[0].schema)))return t;for(var p=0,h=w;p<h.length;p++){var d=h[p],v=(t.push(d),d.properties);if(v)for(var m=0,g=v;m<g.length;m++){var y=g[m];if(y instanceof D&&y.name===i.columnHierarchyLevelVariation.level.name){t.push(y);for(var f,C=0,S=y.hierarchyLevels;C<S.length;C++)(f=S[C]).name===i.columnHierarchyLevelVariation.level.level&&t.push(f)}}}}else for(var E=A.getPropertyNames(i),b=0;b<n.length;b++){var w,x=n[b],c=null==E?void 0:E[b];if(w=this.findFields(x.entity,c,x.schema)||this.findKpiMeasures(x.entity,c,x.schema))for(var V=0,F=w;V<F.length;V++){d=F[V];t.push(d)}}}}return t},u.getUniqueId=function(){return u._uid++},u._uid=0,u);function u(e){this.contract=e,this.showCheckboxes=!0,this.entities=[]}function c(e,t,i){this.hasCheckedProperties=!1,this.contract=e,this.contractSchema=t,this.schema=i,this.properties=[],this.columnsAndMeasures=[],this.hierarchies=[],this.displayFolders=[]}function p(e,t,i){this.hasCheckedChildren=!1,this.contract=e,this.schema=t,this.entity=i,this.id=o.getUniqueId()}i.FieldListConceptualModel=o,Object.defineProperty(c.prototype,"name",{get:function(){return this.contract.name},enumerable:!1,configurable:!0}),Object.defineProperty(c.prototype,"displayName",{get:function(){return this.displayNameOverride||this.contract.displayName},enumerable:!1,configurable:!0}),Object.defineProperty(c.prototype,"description",{get:function(){return this.contract.description},enumerable:!1,configurable:!0}),Object.defineProperty(c.prototype,"errorMessage",{get:function(){return this.contract.errorMessage},enumerable:!1,configurable:!0}),Object.defineProperty(c.prototype,"calculated",{get:function(){return this.contract.calculated},enumerable:!1,configurable:!0}),Object.defineProperty(c.prototype,"iconClassName",{get:function(){return 1===this.contract.queryable?"fieldListError":this.calculated?"fieldListEntityCalculated":this.isMeasureGroup?"fieldListMeasureGroup":void 0},enumerable:!1,configurable:!0}),Object.defineProperty(c.prototype,"hidden",{get:function(){return a.hasFlag(this.contract.visibility,1)&&_.every(this.properties,(function(e){return!e.isExtension||e.hidden}))},set:function(e){this.contract.visibility=e?a.setFlag(this.contract.visibility,1):a.resetFlag(this.contract.visibility,1)},enumerable:!1,configurable:!0}),Object.defineProperty(c.prototype,"canEdit",{get:function(){return this.contractSchema.capabilities.canEdit&&!this.schema.disableEditing&&!i.FieldListViewModelUtils.isAbandoned(this.contract)},enumerable:!1,configurable:!0}),Object.defineProperty(c.prototype,"private",{get:function(){return a.hasFlag(this.contract.visibility,4)},enumerable:!1,configurable:!0}),Object.defineProperty(c.prototype,"showAsVariationsOnly",{get:function(){return a.hasFlag(this.contract.visibility,2)},enumerable:!1,configurable:!0}),Object.defineProperty(c.prototype,"showHidden",{get:function(){return this.schema.showHidden},enumerable:!1,configurable:!0}),Object.defineProperty(c.prototype,"canRefresh",{get:function(){return this.canEdit&&this.contract.capabilities.canRefresh},enumerable:!1,configurable:!0}),Object.defineProperty(c.prototype,"canHaveMeasures",{get:function(){return this.contract.capabilities.canHaveMeasures},enumerable:!1,configurable:!0}),Object.defineProperty(c.prototype,"canEditEntity",{get:function(){return this.canEdit&&!this.calculated&&this.contract.capabilities.canEditSource},enumerable:!1,configurable:!0}),Object.defineProperty(c.prototype,"canDelete",{get:function(){return this.canEdit&&this.contract.capabilities.canDelete},enumerable:!1,configurable:!0}),Object.defineProperty(c.prototype,"canRename",{get:function(){return this.canEdit&&this.contract.capabilities.canRename},enumerable:!1,configurable:!0}),c.prototype.findFields=function(e,t){return this.findFieldsByType(e,t,0)},c.prototype.findKpis=function(e,t){return this.findFieldsByType(e,t,4)},c.prototype.findKpiMeasures=function(e,t){return this.findFieldsByType(e,t,5)},c.prototype.findHierarchies=function(e,t){return this.findFieldsByType(e,t,2)},c.prototype.findFieldsByType=function(t,i,n){var e=[];2===n?e.push.apply(e,_.filter(this.hierarchies,(function(e){return e.name===t&&e.schema.name===i}))):e.push.apply(e,_.filter(this.properties,(function(e){return e.name===t&&e.fieldType===n&&e.schemaName===i})));for(var r=0,a=this.displayFolders;r<a.length;r++)for(var o=a[r],s=0,l=_.filter(o.getAllChildren(),(function(e){return e.name===t&&e.fieldType===n}));s<l.length;s++){var u=l[s];e.indexOf(u)<0&&e.push(u)}if(!_.isEmpty(e))return e},Object.defineProperty(c.prototype,"userEntity",{get:function(){return!(this.private||this.showAsVariationsOnly)},enumerable:!1,configurable:!0}),t=c,i.FieldListConceptualEntity=t,Object.defineProperty(p.prototype,"children",{get:function(){return this._children},set:function(e){this._children=e},enumerable:!1,configurable:!0}),Object.defineProperty(p.prototype,"name",{get:function(){return this.contract.name},enumerable:!1,configurable:!0}),Object.defineProperty(p.prototype,"schemaName",{get:function(){return this.schema.name},enumerable:!1,configurable:!0}),Object.defineProperty(p.prototype,"displayName",{get:function(){return this.displayNameOverride||this.contract.displayName},enumerable:!1,configurable:!0}),Object.defineProperty(p.prototype,"description",{get:function(){return this.contract.description},enumerable:!1,configurable:!0}),Object.defineProperty(p.prototype,"errorMessage",{get:function(){return null},enumerable:!1,configurable:!0}),Object.defineProperty(p.prototype,"visible",{get:function(){return!this.parent||this.parent.expanded&&this.parent.visible},enumerable:!1,configurable:!0}),Object.defineProperty(p.prototype,"hidden",{get:function(){return this.contract.hidden},set:function(e){this.contract.hidden=e},enumerable:!1,configurable:!0}),Object.defineProperty(p.prototype,"showHidden",{get:function(){return this.entity.showHidden},enumerable:!1,configurable:!0}),Object.defineProperty(p.prototype,"canEdit",{get:function(){return!this.variation&&this.schema.capabilities.canEdit&&!this.entity.schema.disableEditing},enumerable:!1,configurable:!0}),Object.defineProperty(p.prototype,"disableDragging",{get:function(){return this.entity.schema.disableDragging},enumerable:!1,configurable:!0}),Object.defineProperty(p.prototype,"disableSelectionOnFocus",{get:function(){return this.entity.schema.disableSelectionOnFocus},enumerable:!1,configurable:!0}),Object.defineProperty(p.prototype,"showCheckboxes",{get:function(){return this.entity.schema.showCheckboxes},enumerable:!1,configurable:!0}),Object.defineProperty(p.prototype,"isExtension",{get:function(){return!1},enumerable:!1,configurable:!0}),t=p,i.FieldListConceptualItem=t,__extends(v,h=t),Object.defineProperty(v.prototype,"kind",{get:function(){return this.contract.kind},enumerable:!1,configurable:!0}),Object.defineProperty(v.prototype,"defaultAggregate",{get:function(){return this.contract.column?this.contract.column.defaultAggregate:null},enumerable:!1,configurable:!0}),Object.defineProperty(v.prototype,"type",{get:function(){return this.contract.type},enumerable:!1,configurable:!0}),Object.defineProperty(v.prototype,"idOnEntityKey",{get:function(){return!!this.contract.column&&this.contract.column.idOnEntityKey},enumerable:!1,configurable:!0}),Object.defineProperty(v.prototype,"errorMessage",{get:function(){return this.contract.errorMessage},enumerable:!1,configurable:!0}),Object.defineProperty(v.prototype,"canDelete",{get:function(){return this.canEdit&&!1!==this.contract.canDelete},enumerable:!1,configurable:!0}),Object.defineProperty(v.prototype,"canAddToFilter",{get:function(){return!this.contract.measure||!this.schema.capabilities.limitMultiColumnFiltersToQueryGroupColumns},enumerable:!1,configurable:!0}),Object.defineProperty(v.prototype,"properties",{get:function(){return this.children},enumerable:!1,configurable:!0}),v.prototype.clone=function(){return new v(this.contract,this.schema,this.entity)};var h,d,e=v;function v(e,t,i,n,r){e=h.call(this,e,t,i)||this;return e.children=[],e.originalEntity=n,e.variation=r,e.expanded=!1,e.draggable=!e.disableDragging,e.fieldType=0,e}function m(e,t,i){var n=this;return(n=d.call(this,e,t,i)||this).fieldType=6,n}function g(e,t,i){return n.call(this,e,t,i)||this}function y(e,t,i,n,r,a){var o=this;return(o=s.call(this,e.column,t,n)||this).originalEntity=r,o.variation=a,o.hierarchyLevelContract=e,o.parent=i,o.fieldType=3,o}i.FieldListConceptualProperty=e,__extends(m,d=t),Object.defineProperty(m.prototype,"defaultAggregate",{get:function(){return 3},enumerable:!1,configurable:!0}),Object.defineProperty(m.prototype,"isExtension",{get:function(){return!1},enumerable:!1,configurable:!0}),m.prototype.clone=function(){return new m(this.contract,this.schema,this.entity)},i.FieldListConceptualRowCount=m,__extends(g,n=e),Object.defineProperty(g.prototype,"defaultAggregate",{get:function(){return 2},enumerable:!1,configurable:!0}),Object.defineProperty(g.prototype,"idOnEntityKey",{get:function(){return!1},enumerable:!1,configurable:!0}),Object.defineProperty(g.prototype,"isExtension",{get:function(){return!0},enumerable:!1,configurable:!0}),g.prototype.clone=function(){return new g(this.contract,this.schema,this.entity)},i.FieldListConceptualExtensionMeasure=g,__extends(y,s=e),Object.defineProperty(y.prototype,"hidden",{get:function(){return this.parent.hidden},enumerable:!1,configurable:!0}),Object.defineProperty(y.prototype,"name",{get:function(){return this.hierarchyLevelContract.name},enumerable:!1,configurable:!0}),Object.defineProperty(y.prototype,"displayName",{get:function(){return this.displayNameOverride||this.hierarchyLevelContract.displayName},enumerable:!1,configurable:!0}),Object.defineProperty(y.prototype,"description",{get:function(){return this.hierarchyLevelContract.description},enumerable:!1,configurable:!0}),Object.defineProperty(y.prototype,"canDelete",{get:function(){return!this.variation&&this.canEdit&&!1!==this.hierarchyLevelContract.canDelete},enumerable:!1,configurable:!0}),y.prototype.clone=function(e){e=e||this.parent;return new y(this.hierarchyLevelContract,this.schema,e,this.entity)},i.FieldListConceptualHierarchyLevel=y,__extends(C,f=t),Object.defineProperty(C.prototype,"properties",{get:function(){return this.hierarchyLevels},enumerable:!1,configurable:!0}),Object.defineProperty(C.prototype,"children",{get:function(){return this.hierarchyLevels},enumerable:!1,configurable:!0}),Object.defineProperty(C.prototype,"canDelete",{get:function(){return!this.variation&&this.canEdit&&!1!==this.contract.canDelete},enumerable:!1,configurable:!0}),C.prototype.findLevel=function(t,e){return _.find(this.hierarchyLevels,(function(e){return e.name===t}))},C.prototype.clone=function(){var t=new C(this.contract,this.schema,this.entity);return t.hierarchyLevels=_.map(this.hierarchyLevels,(function(e){return e.clone(t)})),t};var f,D=C;function C(e,t,i,n,r){e=f.call(this,e,t,i)||this;return e.expanded=!1,e.hierarchyLevels=[],e.originalEntity=n,e.variation=r,e.draggable=!e.disableDragging,e.fieldType=2,e}function S(e,t,i){e=r.call(this,e,t,i)||this;return e.expanded=!1,e.kpiMeasures=[],e.fieldType=4,e}function E(e,t,i,n,r,a){var o=this;return(o=l.call(this,e,t,r)||this).kpiType=i,o.parent=n,o.locOptions=a,o.draggable=!o.disableDragging,o.fieldType=5,o}i.FieldListConceptualHierarchy=D,__extends(S,r=t),Object.defineProperty(S.prototype,"kind",{get:function(){return this.contract.kind},enumerable:!1,configurable:!0}),Object.defineProperty(S.prototype,"properties",{get:function(){return this.kpiMeasures},enumerable:!1,configurable:!0}),Object.defineProperty(S.prototype,"children",{get:function(){return this.kpiMeasures},enumerable:!1,configurable:!0}),S.prototype.clone=function(){var t=new S(this.contract,this.schema,this.entity);return t.kpiMeasures=_.map(this.kpiMeasures,(function(e){return e.clone(t)})),t},i.FieldListConceptualKpi=S,__extends(E,l=e),Object.defineProperty(E.prototype,"displayName",{get:function(){var e;switch(this.kpiType){case 2:e=this.locOptions.KpiValueDisplayName;break;case 1:e=this.locOptions.KpiGoalDisplayName;break;case 0:e=this.locOptions.KpiStatusDisplayName;break;case 3:e=this.locOptions.KpiTrendDisplayName}return this.displayNameOverride||e||this.contract.displayName},enumerable:!1,configurable:!0}),E.prototype.clone=function(e){e=e||this.parent;return new E(this.contract,this.schema,this.kpiType,e,this.entity,this.locOptions)},i.FieldListConceptualKpiMeasure=E,__extends(w,b=t),Object.defineProperty(w.prototype,"hidden",{get:function(){return!_.some(this.children,(function(e){return!e.hidden}))},set:function(e){},enumerable:!1,configurable:!0}),w.prototype.clone=function(){},w.prototype.getAllChildren=function(){for(var e=[],t=0,i=this.children;t<i.length;t++){var n=i[t];e.push(n),1===n.fieldType&&e.push.apply(e,n.getAllChildren()||[])}return e};var b,e=w;function w(e,t,i,n,r){var a=b.call(this,e,n,r)||this;a.expanded=!1,a.parent=i,a.children=t,a.fieldType=1;for(var o=0,s=t;o<s.length;o++)s[o].parent=a;return a}i.FieldListConceptualDisplayFolder=w})(powerbi=powerbi||{}),(function(e){var S,n;function t(e,t,i){void 0===i&&(i=!1),this.withRowCounts=!1,this.localizationService=e,this.withRowCounts=i}e=e.explore||(e.explore={}),(S=e.viewModels||(e.viewModels={})).createFieldListViewModelFactory=function(e,t,i){return new n(e,t,i=void 0===i?!1:i)},t.prototype.createModel=function(e,t,i,n){for(var e=e.schemas,r=S.FieldListViewModelUtils.getExtensions(e),a=0,o=S.FieldListViewModelUtils.sortExtensionSchemasAtEnd(e);a<o.length;a++)var s=o[a],l=this.convertConceptualSchema(s,l,r,t,i,n);return l},t.prototype.convertConceptualSchema=function(t,i,n,e,r,a){var o,s=this,r=((i=i||new S.FieldListConceptualModel(t)).disableDragging=r,_.filter(t.entities,(function(e){return!S.FieldListViewModelUtils.isExtension(e)||S.FieldListViewModelUtils.isAbandoned(e)}))),r=_.map(r,(function(e){return s.convertConceptualEntity(e,t,i,n)}));return(o=i.entities).push.apply(o,r||[]),i.disableEditing=e,i.disableSelectionOnFocus=a,i},t.prototype.convertConceptualEntity=function(e,t,i,n){var r=this,a=new S.FieldListConceptualEntity(e,t,i);if(a.properties=[],e.properties&&!S.FieldListViewModelUtils.isExtension(e))for(var o,s=0,l=e.properties;s<l.length;s++)(f=l[s]).measure&&f.measure.kpi?(o=this.convertConceptualKpi(f,t,a),a.columnsAndMeasures.push(o),a.properties.push(o)):f.kpiValue||(o=this.convertConceptualProperty(f,t,a),a.columnsAndMeasures.push(o),a.properties.push(o));if(a.isMeasureGroup=S.FieldListViewModelUtils.isMeasureGroup(e.properties),a.expanded=!1,e.hierarchies&&0<e.hierarchies.length){a.hierarchies=_.map(e.hierarchies,(function(e){return r.convertConceptualHierarchy(e,t,a)}));for(var u=0,c=a.hierarchies;u<c.length;u++){var p=c[u];a.properties.push(p)}}if(n){var h,i=S.FieldListViewModelUtils.getExtensionKey(t.name,e.name);if(h=n.entities[i])for(var d=0,v=h;d<v.length;d++)for(var m=v[d],g=0,y=m.entity.properties;g<y.length;g++){var f=y[g],C=this.convertConceptualExtensionMeasure(f,m.schema,a);a.properties.push(C)}}return S.FieldListViewModelDisplayFolderMerger.mergeDisplayFolders(a,e.displayFolders,h,this),S.FieldListViewModelUtils.sortProperties(a.properties),S.FieldListViewModelUtils.removeDuplicateProperties(a.properties,a.displayFolders),S.FieldListViewModelUtils.flattenFolders(a),S.FieldListViewModelUtils.updatePropertiesWithChildren(a),this.withRowCounts&&0===e.visibility&&!t.capabilities.discourageQueryAggregateUsage&&(n=this.createConceptualRowCount(t,a),a.properties.unshift(n)),a},t.prototype.convertConceptualDisplayFolder=function(e,t,i,n){for(var r={},a={},o=0,s=n.properties;o<s.length;o++){var l=s[o];3===l.fieldType||2===l.fieldType?a[l.name]=l:r[l.name]=l}return this.convertConceptualDisplayFolderCore(e,t,i,r,a,n)},t.prototype.convertConceptualDisplayFolderCore=function(e,t,i,n,r,a){for(var o=[],s=0,l=e.properties;s<l.length;s++){var u=l[s];u&&(h=n[u.name])&&o.push(h.clone())}for(var c=0,p=e.hierarchies;c<p.length;c++){var h,d=p[c];d&&(h=r[d.name])&&o.push(h.clone())}for(var v=new S.FieldListConceptualDisplayFolder(e,o,i,t,a),m=0,g=e.displayFolders;m<g.length;m++){var y=g[m];v.children.push(this.convertConceptualDisplayFolderCore(y,t,v,n,r,a))}return S.FieldListViewModelUtils.sortProperties(v.children),v},t.prototype.convertConceptualHierarchy=function(e,t,i,n,r){var a=new S.FieldListConceptualHierarchy(e,t,i,n,r);a.hierarchyLevels=[];for(var o=0,s=e.levels;o<s.length;o++){var l=s[o];a.hierarchyLevels.push(this.convertConceptualHierarchyLevel(l,t,a))}return a},t.prototype.convertConceptualHierarchyLevel=function(e,t,i){return new S.FieldListConceptualHierarchyLevel(e,t,i,i.entity,i.originalEntity,i.variation)},t.prototype.convertConceptualProperty=function(e,t,i){for(var n=new S.FieldListConceptualProperty(e,t,i),r=0,a=S.FieldListViewModelUtils.getPropertyVariations(e);r<a.length;r++){var o=a[r];n.children.push(this.convertConceptualVariationHierarchy(o,t,n))}return n},t.prototype.convertConceptualVariationHierarchy=function(e,t,i){t=this.convertConceptualHierarchy(e.defaultHierarchy,t,i.entity,e.navigationProperty.targetEntity,e.name);return t.parent=i,t},t.prototype.convertConceptualExtensionMeasure=function(e,t,i){return new S.FieldListConceptualExtensionMeasure(e,t,i)},t.prototype.convertConceptualKpi=function(e,t,i){var n=new S.FieldListConceptualKpi(e,t,i),r={},a=(r.KpiValueDisplayName=this.localizationService.get("KpiValueFieldListDisplayName"),r.KpiStatusDisplayName=this.localizationService.get("KpiStatusFieldListDisplayName"),r.KpiGoalDisplayName=this.localizationService.get("KpiGoalFieldListDisplayName"),r.KpiTrendDisplayName=this.localizationService.get("KpiTrendFieldListDisplayName"),e.measure.kpi),o=a.goal,s=a.status,a=a.trend;return n.kpiMeasures=[],n.kpiMeasures.push(this.convertConceptualKpiMeasure(e,t,2,n,i,r)),o&&n.kpiMeasures.push(this.convertConceptualKpiMeasure(o,t,1,n,i,r)),s&&n.kpiMeasures.push(this.convertConceptualKpiMeasure(s,t,0,n,i,r)),a&&n.kpiMeasures.push(this.convertConceptualKpiMeasure(a,t,3,n,i,r)),n},t.prototype.convertConceptualKpiMeasure=function(e,t,i,n,r,a){return new S.FieldListConceptualKpiMeasure(e,t,i,n,r,a)},t.prototype.createConceptualRowCount=function(e,t){var i={name:t.name,displayName:this.localizationService.get("QuickExplore_RowCount"),canDelete:!1,hidden:!1};return new S.FieldListConceptualRowCount(i,e,t)},n=t})(powerbi=powerbi||{}),(function(e){var o;function p(e,t){return JSON.stringify({e:t})}function h(e){return e.hasOwnProperty("extends")}function i(e,t){return e=(e||"").toLocaleUpperCase(),t=(t||"").toLocaleUpperCase(),e.localeCompare(t)}e=e.explore||(e.explore={}),(e=(o=e.viewModels||(e.viewModels={})).FieldListViewModelUtils||(o.FieldListViewModelUtils={})).isMeasureGroup=function(e){return _.find(e,(function(e){return!e.hidden}))&&!_.find(e,(function(e){return!e.hidden&&1!==e.kind&&2!==e.kind}))},e.getExtensions=function(e){for(var t={entities:{}},i=0,n=e;i<n.length;i++){var r=n[i];if(h(r))for(var a=r.extends,o=0,s=r.entities;o<s.length;o++){var l,u,c=s[o];h(c)&&(l={schema:r,entity:c},c=p(0,c.name),(u=t.entities[c])?u.push(l):t.entities[c]=u=[l])}}return t},e.sortExtensionSchemasAtEnd=function(e){var t=_.filter(e,(function(e){return!h(e)})),e=_.filter(e,h);return _.union(t,e)},e.getExtensionKey=p,e.isExtension=h,e.isAbandoned=function(e){return e.isAbandoned},e.updatePropertiesWithChildren=function(e){for(var t=[],i=0,n=e.properties;i<n.length;i++)!(function e(t,i){t.push(i);if(!(i instanceof o.FieldListConceptualKpi||i instanceof o.FieldListConceptualHierarchy||i instanceof o.FieldListConceptualProperty))return;if(_.isEmpty(i.properties))return;for(var n=0,r=i.properties;n<r.length;n++){var a=r[n];e(t,a)}})(t,n[i]);e.properties=t},e.sortProperties=function(e){e&&e.sort((function(e,t){return i(e.displayName,t.displayName)}))},e.compareAlphabeticallyIgnoreCase=i,e.removeDuplicateProperties=function(e,t){var i;_.isEmpty(e)||(function e(t,i){if(_.isEmpty(t))return;var n=[];for(var r=0,a=t;r<a.length;r++)for(var o=a[r],s=0,l=o.children;s<l.length;s++){var u=l[s];1===u.fieldType?n.push(u):i[u.name]=u}e(n,i)}(t,i={}),_.remove(e,(function(e){return 1!==e.fieldType&&i[e.name]})))},e.flattenFolders=function(e){var t=[];!(function e(t,i){for(var n=0,r=t;n<r.length;n++){var a=r[n];i.push(a),1===a.fieldType&&e(a.children,i)}})(e.properties,t),e.properties=t},e.findTargetEntityViewModel=function(e,t){return _.find(e.entities,(function(e){return e.contract===t}))},e.getHierarchyLevelDictionary=function(e){var t={};if(!_.isEmpty(e))for(var i=0,n=e;i<n.length;i++){var r=n[i],a={};t[r.name]=a;for(var o=0,s=r.levels;o<s.length;o++){var l=s[o];a[l.column.name]=l}}return t},e.getPropertyVariations=function(e){var t=[];if(e.column&&e.column.variations)for(var i=0,n=e.column.variations;i<n.length;i++){var r=n[i],a=r.navigationProperty.targetEntity,o=r.defaultHierarchy;a&&a.hierarchies&&o&&!o.hidden&&t.push(r)}return t}})(powerbi=powerbi||{}),(function(C){var n,e,v,r,t,S,l,u,i,m,c,g;function a(e,t,i,n,r,a,o,s,l){r=new c(e,r,a,t,i,n,o,s,l);return v.visit(e,r)}function o(e,t,i,n,r,a,o,s,l){this.sqExpr=e,this.dataRoleKind=t,this.requiredTypes=i,this.schema=n,this.aggrOps=r,this.hasHierarchyLevels=a,this.localizationService=o,this.property=s,this.forceAggregateItems=l}function s(e,t,i,n,r,a,o,s,l,u,c,p,h,d){this.property=e,this.bucket=t,this.buckets=i,this.dataRole=n,this.forceAggregateItems=r,this.schema=a,this.aggrOps=o,this.visual=s,this.featureSwitchService=l,this.groupingDesignStateService=u,this.showValueAsService=c,this.localizationService=p,this.visualContainer=h,this.visualCalcEagerService=d,this.supportedOperations=null!=(e=this.property.supportedOperations)?e:67108863,this.menuItems=[],1==(1&this.supportedOperations)&&this.menuItems.push(this.createDeleteMenuItem()),this.property.interactivityOptions.isEditableField&&32768==(32768&this.supportedOperations)&&this.menuItems.push(this.createRenameMenuItem()),524288==(524288&this.supportedOperations)&&(!m.isVisualTypeAutoSelect(this.visualContainer)&&1<this.bucket.properties.length&&this.menuItems.push(this.createMoveGroupMenuItem()),1<this.buckets.length)&&this.menuItems.push(this.createMoveToGroupMenuItem()),this.createConditionalFormattingOptions()}function p(){return{type:0}}n=C.explore||(C.explore={}),e=n.viewModels||(n.viewModels={}),v=C.data.FieldExprPattern,r=C.explore.utils.GroupUtils,t=C.data.SQExpr,S=C.data.SQExprBuilder,l=C.data.SQExprConverter,u=C.data.SQExprUtils,i=C.data.SQHierarchyExprUtils,m=C.explore.util.VisualContainerUtils,(e=e.MenuItemFactory||(e.MenuItemFactory={})).createAggregateMenuItems=a,o.prototype.visitEntity=function(e){return this.createMenuItems(this.sqExpr)},o.prototype.visitColumn=function(e){return this.createMenuItems(this.sqExpr)},o.prototype.visitColumnAggr=function(e){return this.createMenuItems(this.sqExpr)},o.prototype.visitGroupingColumn=function(e){return this.createMenuItems(this.sqExpr)},o.prototype.visitGroupingColumnAggr=function(e){return this.createMenuItems(this.sqExpr)},o.prototype.visitColumnHierarchyVariation=function(e){return this.createMenuItems(this.sqExpr)},o.prototype.visitColumnHierarchyLevelVariation=function(e){return this.createMenuItems(this.sqExpr)},o.prototype.visitColumnSubquery=function(e){return[]},o.prototype.visitColumnAggrSubquery=function(e){return[]},o.prototype.visitColumnTransformRef=function(e){return[]},o.prototype.visitEntityAggr=function(e){return this.createMenuItems(this.sqExpr)},o.prototype.visitHierarchy=function(e){return this.createMenuItems(this.sqExpr)},o.prototype.visitHierarchyLevel=function(e){return this.createMenuItems(this.sqExpr)},o.prototype.visitHierarchyLevelAggr=function(e){return this.createMenuItems(this.sqExpr)},o.prototype.visitMeasure=function(e){return[]},o.prototype.visitPercentOfGrandTotal=function(e){e=S.fieldExpr(e.baseExpr);return this.createMenuItemsForPercentOfTotal(e)},o.prototype.visitPercentOfRoleTotal=function(e){e=S.fieldExpr(e.baseExpr);return this.createMenuItemsForPercentOfTotal(e)},o.prototype.visitPercentile=function(e){return[]},o.prototype.visitSelectRef=function(e){return[]},o.prototype.visitFilteredEval=function(e){e=S.fieldExpr(e.baseExpr);return this.createMenuItems(e)},o.prototype.visitArithmetic=function(e){return[]},o.prototype.visitConstant=function(e){return[]},o.prototype.visitSparklineData=function(e){return[]},o.prototype.visitNativeVisualCalc=function(e){return[]},o.prototype.createMenuItemsForPercentOfTotal=function(e){var t=S.removeAggregate(e,this.schema).getMetadata(this.schema);return t?(t=(t=t.type).text||t.dateTime||t.duration?[3,4]:[],this.createMenuItems(e,t)):[]},o.prototype.createMenuItems=function(e,t){void 0===t&&(t=[]);var i=[];if(!this.hasHierarchyLevels&&_.isEmpty(e.validate(this.schema,this.aggrOps))&&!u.discourageAggregation(e,this.schema)){var n=this.dataRoleKind===C.VisualDataRoleKind.Grouping,r=this.dataRoleKind===C.VisualDataRoleKind.GroupingOrMeasure,n=n&&!this.forceAggregateItems?[]:this.aggrOps.getSupportedAggregates(e,this.schema,this.requiredTypes),n=_.difference(n,t);(r&&!(function(e,t){e=e.getConceptualProperty(t);return e&&1===e.kind})(e,this.schema)&&!(function(e,t){e=l.asFieldPattern(e,t);return e&&e.entityAggr})(e,this.schema)||this.forceAggregateItems&&!_.isEmpty(n))&&i.push(this.createRemoveAggregateMenuItem());for(var a=0,o=n;a<o.length;a++){var s=o[a];i.push(this.createAggregateMenuItem(s))}}return i},o.prototype.createAggregateMenuItem=function(e){var t=p(this.property),i=(t.key={action:4,aggregate:e},S.removeAggregate(this.sqExpr,this.schema).getMetadata(this.schema)),e=n.services.getAggregateKey(e,i);return t.text=this.localizationService.get("Aggregate_"+e),t},o.prototype.createRemoveAggregateMenuItem=function(){var e=p(this.property);return e.key={action:2},e.text=this.localizationService.get("FieldWell_RemoveAggregate"),e},o.prototype.visitTransformOutputRoleRef=function(e){return[]},c=o,s.prototype.createConditionalFormattingOptions=function(){var t=this;!_.isEmpty(this.property.conditionalFormattingRepetitions)&&this.visual&&(this.conditionalFormattingOptions=this.property.conditionalFormattingRepetitions.map((function(e){return{repetition:e,propertyDefinition:C.VisualObjectRepetition.getDefinition(t.visual.objects,e)}})))},s.prototype.visitEntity=function(e){return this.menuItems},s.prototype.visitColumn=function(e){var t=this.property.expr;return 4096==(4096&this.supportedOperations)&&this.addConditionalFormattingMenuItems(t),4==(4&this.supportedOperations)&&this.addAggregateMenuItems(),16==(16&this.supportedOperations)&&this.addShowValueAsMenuItem(e.schema),64==(64&this.supportedOperations)&&this.addQuickCalcMenuItem(e.schema),8==(8&this.supportedOperations)&&this.addShowAllMenuItem(t),2048==(2048&this.supportedOperations)&&this.addHierarchiesMenuItems(this.property.hierarchyLevels),128==(128&this.supportedOperations)&&this.addVariationsMenuItems(e),256==(256&this.supportedOperations)&&this.addGroupsMenuItems(e),this.isFieldParameterOperations()&&this.addFieldParameterMenuItems(),this.menuItems},s.prototype.visitColumnAggr=function(e){var t=this.property.expr;return 2097152==(2097152&this.supportedOperations)&&this.addSparklineMenuItem(e.schema),4096==(4096&this.supportedOperations)&&this.addConditionalFormattingMenuItems(t),4==(4&this.supportedOperations)&&this.addAggregateMenuItems(),16==(16&this.supportedOperations)&&this.addShowValueAsMenuItem(e.schema),64==(64&this.supportedOperations)&&this.addQuickCalcMenuItem(e.schema),8==(8&this.supportedOperations)&&this.addShowAllMenuItem(t),2048==(2048&this.supportedOperations)&&this.addHierarchiesMenuItems(this.property.hierarchyLevels),128==(128&this.supportedOperations)&&this.addVariationsMenuItems(e),this.isFieldParameterOperations()&&this.addFieldParameterMenuItems(),this.menuItems},s.prototype.visitGroupingColumn=function(e){var t=this.property.expr;return this.addConditionalFormattingMenuItems(t),this.addAggregateMenuItems(),this.addShowValueAsMenuItem(e.schema),this.addQuickCalcMenuItem(e.schema),this.addShowAllMenuItem(t),this.addHierarchiesMenuItems(this.property.hierarchyLevels),this.addVariationsMenuItems(e),this.addGroupsMenuItems(e),this.menuItems},s.prototype.visitGroupingColumnAggr=function(e){var t=this.property.expr;return this.addSparklineMenuItem(e.schema),this.addConditionalFormattingMenuItems(t),this.addAggregateMenuItems(),this.addShowValueAsMenuItem(e.schema),this.addQuickCalcMenuItem(e.schema),this.addShowAllMenuItem(t),this.addHierarchiesMenuItems(this.property.hierarchyLevels),this.addVariationsMenuItems(e),this.menuItems},s.prototype.visitColumnHierarchyVariation=function(e){return this.menuItems},s.prototype.visitColumnHierarchyLevelVariation=function(e){var t=this.property.expr;return this.addAggregateMenuItems(),this.addShowValueAsMenuItem(e.source.schema),this.addQuickCalcMenuItem(e.source.schema),this.addShowAllMenuItem(t),this.addHierarchiesMenuItems(this.property.hierarchyLevels),this.menuItems},s.prototype.visitColumnSubquery=function(e){return this.menuItems},s.prototype.visitColumnAggrSubquery=function(e){return this.menuItems},s.prototype.visitColumnTransformRef=function(e){return this.menuItems},s.prototype.visitEntityAggr=function(e){var t=this.property.expr;return this.addAggregateMenuItems(),this.addShowValueAsMenuItem(e.schema),this.addQuickCalcMenuItem(e.schema),this.addShowAllMenuItem(t),this.menuItems},s.prototype.visitHierarchy=function(e){return this.addAggregateMenuItems(),this.addShowValueAsMenuItem(e.schema),this.addShowAllMenuItem(_.head(this.property.hierarchyLevels).expr),this.addHierarchiesMenuItems(this.property.hierarchyLevels),this.menuItems},s.prototype.visitHierarchyLevel=function(e){var t=this.property.expr;return this.addAggregateMenuItems(),this.addShowValueAsMenuItem(e.schema),this.addQuickCalcMenuItem(e.schema),this.addShowAllMenuItem(t),this.addHierarchiesMenuItems(this.property.hierarchyLevels),this.menuItems},s.prototype.visitHierarchyLevelAggr=function(e){var t=this.property.expr;return this.addSparklineMenuItem(e.schema),this.addConditionalFormattingMenuItems(t),this.addAggregateMenuItems(),this.addShowValueAsMenuItem(e.schema),this.addQuickCalcMenuItem(e.schema),this.addShowAllMenuItem(t),this.menuItems},s.prototype.visitMeasure=function(e){var t=this.property.expr;return this.addSparklineMenuItem(e.schema),this.addConditionalFormattingMenuItems(t),this.addShowValueAsMenuItem(e.schema),this.addQuickCalcMenuItem(e.schema),this.addShowAllMenuItem(t),this.menuItems},s.prototype.visitPercentile=function(e){var t=this.property.expr;return this.addConditionalFormattingMenuItems(t),this.menuItems},s.prototype.visitSelectRef=function(e){return[]},s.prototype.visitTransformOutputRoleRef=function(e){return[]},s.prototype.visitPercentOfGrandTotal=function(e){return this.addPercentTotalMenuItems(e.baseExpr)},s.prototype.visitPercentOfRoleTotal=function(e){return this.addPercentTotalMenuItems(e.baseExpr)},s.prototype.visitFilteredEval=function(e){return this.addFilteredEvalMenuItems()},s.prototype.visitArithmetic=function(e){return this.menuItems},s.prototype.visitNativeVisualCalc=function(e){return this.addEditVisualCalcMenuItems(),this.menuItems},s.prototype.visitConstant=function(e){return this.menuItems},s.prototype.visitSparklineData=function(e){return this.addEditSparklineMenuItem(),this.menuItems},s.prototype.isFieldParameterOperations=function(){return 16777216==(16777216&this.supportedOperations)||8388608==(8388608&this.supportedOperations)},s.prototype.addEditVisualCalcMenuItems=function(){t.isNativeVisualCalc(this.property.expr)&&this.featureSwitchService.featureSwitches.visualCalculationsAuthoring&&this.featureSwitchService.featureSwitches.visualCalculations&&(this.menuItems.push(this.createSeparatorMenuItem()),this.menuItems.push(this.createEditCalculationMenuItem()))},s.prototype.createEditCalculationMenuItem=function(){var e=p(this.property),t=(e.key={action:33554432},this.visual.query);return null!=t&&(t=t.projections[this.property.role].all()[this.property.startIndex],e.disabled=this.visualCalcEagerService.shouldDisableEditing(t.queryRef,this.visualContainer)),e.text=this.localizationService.get("FieldWell_EditVisualCalculation"),e},s.prototype.addFieldParameterMenuItems=function(){this.property.expr.getConceptualProperty(this.schema)&&(this.menuItems.push(this.createSeparatorMenuItem()),16777216==(16777216&this.supportedOperations)?this.menuItems.push(this.createColumnToParameter()):8388608==(8388608&this.supportedOperations)&&this.menuItems.push(this.createParameterToColumn()))},s.prototype.addFilteredEvalMenuItems=function(){return this.addAggregateMenuItems(),this.menuItems},s.prototype.addPercentTotalMenuItems=function(e){var t=S.fieldExpr(e),t=(this.addConditionalFormattingMenuItems(t),this.addAggregateMenuItems(),this.addShowValueAsMenuItem(v.getSchema(e)),this.addShowAllMenuItem(t),this.addHierarchiesMenuItems(this.property.hierarchyLevels),v.getProperty(e));return t&&this.addVariationsMenuItems(t),this.menuItems},s.prototype.addAggregateMenuItems=function(){var e,t=a(this.property.expr,this.schema,this.aggrOps,!_.isEmpty(this.property.hierarchyLevels),this.dataRole.kind,this.dataRole.requiredTypes,this.localizationService,this.property,this.forceAggregateItems);_.isEmpty(t)||(this.menuItems.push(this.createSeparatorMenuItem()),(e=this.menuItems).push.apply(e,t||[]))},s.prototype.addConditionalFormattingMenuItems=function(e){_.isEmpty(this.conditionalFormattingOptions)||e.getMetadata(this.schema)&&!m.hasGroupByItems(this.visual.query)&&(this.menuItems.push(this.createSeparatorMenuItem()),this.addSetConditionalFormattingMenuItem(),this.addRemoveConditionalFormattingMenuItem())},s.prototype.addSetConditionalFormattingMenuItem=function(){if(!_.isEmpty(this.conditionalFormattingOptions))for(var e=p(this.property),t=(e.text=this.localizationService.get("FieldWell_ConditionalFormatting"),this.menuItems.push(e),e.children=[]),i=0,n=this.conditionalFormattingOptions;i<n.length;i++){var r=n[i];t.push(this.createConditionalFormattingMenuItem(r.repetition.propertyDescriptor.displayName,4096,r))}},s.prototype.addRemoveConditionalFormattingMenuItem=function(){if(!_.isEmpty(this.conditionalFormattingOptions)){var e=p(this.property);if(e.text=this.localizationService.get("FieldWell_RemoveConditionalFormatting"),this.menuItems.push(e),_.some(this.conditionalFormattingOptions,(function(e){return null!=e.propertyDefinition}))){var t=e.children=[];t.push(this.createConditionalFormattingMenuItem(C.data.createDisplayNameGetter("All"),8192));for(var i=0,n=this.conditionalFormattingOptions;i<n.length;i++){var r=n[i],a=this.createConditionalFormattingMenuItem(r.repetition.propertyDescriptor.displayName,16384,r);a.disabled=null==r.propertyDefinition,t.push(a)}}else e.disabled=!0}},s.prototype.createConditionalFormattingMenuItem=function(e,t,i){var n=p(this.property);return n.key={action:t,conditionalFormattingOptions:i},n.text=C.data.getDisplayName(e,this.localizationService),n},s.prototype.addShowAllMenuItem=function(e){e=u.isMeasure(e);m.hasGroupByItems(this.visual.query)||this.dataRole.kind!==C.VisualDataRoleKind.Grouping&&(this.dataRole.kind!==C.VisualDataRoleKind.GroupingOrMeasure||e)||(this.menuItems.push(this.createSeparatorMenuItem()),this.menuItems.push(this.createShowAllMenuItem()))},s.prototype.addHierarchiesMenuItems=function(e){var t;_.isEmpty(e)||(t=_.head(e),(t=i.expandExpr(this.schema,t.expr.arg))instanceof Array&&t.length===e.length)||this.bucket.supportsMultipleItems&&(this.menuItems.push(this.createSeparatorMenuItem()),this.menuItems.push(this.createRestoreHierarchyMenuItem()))},s.prototype.addShowValueAsMenuItem=function(e){_.isEmpty(this.property.hierarchyLevels)&&this.property.expr.getConceptualProperty(this.schema)&&(e=(e=this.schema.schema(e))&&e.capabilities.supportsScopedEval,!m.hasGroupByItems(this.visual.query))&&e&&this.dataRole.kind!==C.VisualDataRoleKind.Grouping&&(e=this.property.expr,e=this.showValueAsService.createShowValueAsMenuItems(e,this.schema,this.visual.visualType),_.isEmpty(e)||(this.menuItems.push(this.createSeparatorMenuItem()),this.menuItems.push(this.createShowValueAsMenuItem(e))))},s.prototype.addQuickCalcMenuItem=function(e){this.property.expr.getConceptualProperty(this.schema)&&((e=this.schema.schema(e))&&e.capabilities.canEdit&&!e.isExtensionSchema||this.canAuthorReportMeasuresOnSchema(e))&&(this.menuItems.push(this.createSeparatorMenuItem()),this.menuItems.push(this.createQuickCalcMenuItem()))},s.prototype.canAuthorReportMeasuresOnSchema=function(e){return e.capabilities.isExtendable||e.isExtensionSchema},s.prototype.addSparklineMenuItem=function(e){this.featureSwitchService.featureSwitches.sparklines&&this.dataRole.supportsSparklines&&(e=this.schema.schema(e))&&e.capabilities.supportsSparklineData&&(this.menuItems.push(this.createSeparatorMenuItem()),(e=p(this.property)).key={action:2097152},e.text=this.localizationService.get("Sparkline_AddOption"),this.menuItems.push(e))},s.prototype.addEditSparklineMenuItem=function(){var e;this.featureSwitchService.featureSwitches.sparklines&&(this.menuItems.push(this.createSeparatorMenuItem()),(e=p(this.property)).key={action:4194304},e.text=this.localizationService.get("Sparkline_EditOption"),this.menuItems.push(e))},s.prototype.addVariationsMenuItems=function(e){var t=S.fromColumn(e),i=t.getConceptualProperty(this.schema);if(i){var n=i.column;if(n&&!_.isEmpty(n.variations)){for(var r=S.entity(e.schema,e.entity),e=this.createVariationMenuItem(i.displayName,t),a=[],o=0,s=n.variations;o<s.length;o++){var l=s[o];if(l.navigationProperty&&l.navigationProperty.targetEntity){var u=l.navigationProperty.targetEntity;if(this.dataRole.kind!==C.VisualDataRoleKind.Measure)for(var c=0,p=_.filter(u.hierarchies,(function(e){return!e.hidden}));c<p.length;c++){var h=p[c],d=S.hierarchy(S.propertyVariationSource(r,l.name,i.name),h.name);a.push(this.createVariationMenuItem(h.name,d))}for(var v=S.entity(r.schema,u.name),m=0,g=_.filter(u.properties,(function(e){return!e.hidden}));m<g.length;m++){var y=g[m],f=S.columnRef(v,y.name);a.push(this.createVariationMenuItem(y.displayName,f))}}}_.isEmpty(a)||(this.menuItems.push(this.createSeparatorMenuItem()),this.menuItems.push(e),(t=this.menuItems).push.apply(t,a||[]))}}},s.prototype.addGroupsMenuItems=function(e){var t,i,n=this.schema.schema(e.schema);!1!==(n&&n.capabilities.canEdit&&n.capabilities.supportsGrouping)&&(n=this.featureSwitchService.featureSwitches.enableGroupAuthoring,t=[],i=this.property.expr.getConceptualProperty(this.schema),n&&(!r.canExprBeGrouped(this.schema,this.property.expr)||this.property.hierarchyLevels&&0<this.property.hierarchyLevels.length||t.push(this.createGroupsMenuItem()),r.isGroupOrBinColumn(e.entity,i,this.groupingDesignStateService))&&t.push(this.createEditGroupsMenuItem()),r.isClusteringColumn(e.entity,i,this.groupingDesignStateService)&&t.push(this.createEditClusteringMenuItem()),0<t.length)&&(this.menuItems.push(this.createSeparatorMenuItem()),(n=this.menuItems).push.apply(n,t||[]))},s.prototype.createShowValueAsMenuItem=function(e){var t=p(this.property);t.key={action:16};return t.text=this.localizationService.get("FieldWell_ShowValueAs"),t.children=e,t},s.prototype.createQuickCalcMenuItem=function(){var e=p(this.property);e.key={action:64};return e.text=this.localizationService.get("QuickCalc_NewMeasure"),e},s.prototype.createGroupsMenuItem=function(){var e=p(this.property);return e.key={action:256},e.text=this.localizationService.get("ContextMenuItem_CreateGroups"),e},s.prototype.createEditGroupsMenuItem=function(){var e=p(this.property);return e.text=this.localizationService.get("ContextMenuItem_EditGroups"),e.key={action:512},e},s.prototype.createEditClusteringMenuItem=function(){var e=p(this.property);return e.text=this.localizationService.get("Clustering_EditClusters"),e.key={action:1024},e},s.prototype.createRestoreHierarchyMenuItem=function(){var e=p(this.property);return e.text=this.localizationService.get("FieldWell_RestoreHierarchy"),e.key={action:2048},e},s.prototype.createVariationMenuItem=function(e,t){var i=p(this.property);return i.text=e,i.key={action:128,variationExpr:t},i},s.prototype.createShowAllMenuItem=function(){var e=p(this.property);return e.key={action:8},e.text=this.localizationService.get("FieldWell_ShowAll"),e},s.prototype.createDeleteMenuItem=function(){var e=p(this.property);return e.key={action:1},e.text=this.localizationService.get("FieldWell_Remove"),e},s.prototype.createSeparatorMenuItem=function(){var e=p(this.property);return e.type=1,e},s.prototype.createRenameMenuItem=function(){var e=p(this.property);return e.key={action:32768},e.text=this.localizationService.get("FieldWell_RenameForThisVisual"),e},s.prototype.createParameterToColumn=function(){var e=p(this.property);return e.key={action:8388608},e.text=this.localizationService.get("FieldParameter_ConvertParameterToColumn"),e},s.prototype.createColumnToParameter=function(){var e=p(this.property);return e.key={action:16777216},e.text=this.localizationService.get("FieldParameter_ConvertColumnToParameter"),e},s.prototype.createMoveToBucketsMenuItem=function(){for(var e=[],t=0,i=this.buckets;t<i.length;t++){var n,r=i[t];this.bucket.equals(r)||((n=p(this.property)).text=r.displayName,n.key={action:262144,moveFieldBucketOptions:{role:r.role,targetIndex:r.properties?r.properties.length:0,displayName:r.displayName}},e.push(n))}return e},s.prototype.createMoveToGroupMenuItem=function(){var e=p(this.property);return e.key={action:524288},e.text=this.localizationService.get("ItemAction_MoveTo"),e.children=this.createMoveToBucketsMenuItem(),e},s.prototype.createMoveUpMenuItem=function(){var e=p(this.property),t=(e.text=this.localizationService.get("ItemAction_Move_Up"),{action:65536}),i=this.findFieldPropertyIndexInBucket();return i<=0?e.disabled=!0:(i=this.bucket.properties[i-1],t.moveFieldPropertyOptions={role:i.role,startIndex:i.startIndex,hierarchyLevelsLength:i.hierarchyLevels?i.hierarchyLevels.length:0}),e.key=t,e},s.prototype.createMoveDownMenuItem=function(){var e=p(this.property),t=(e.text=this.localizationService.get("ItemAction_Move_Down"),{action:131072}),i=this.findFieldPropertyIndexInBucket();return i>=this.bucket.properties.length-1?e.disabled=!0:(i=this.bucket.properties[i+1],t.moveFieldPropertyOptions={role:i.role,startIndex:i.startIndex,hierarchyLevelsLength:i.hierarchyLevels?i.hierarchyLevels.length:0}),e.key=t,e},s.prototype.createMoveToTopMenuItem=function(){var e=p(this.property),t=(e.text=this.localizationService.get("ItemAction_Move_Top"),{action:65536}),i=this.bucket.properties[0];return this.property.equals(i)?e.disabled=!0:t.moveFieldPropertyOptions={role:i.role,startIndex:i.startIndex,hierarchyLevelsLength:i.hierarchyLevels?i.hierarchyLevels.length:0},e.key=t,e},s.prototype.createMoveToBottomMenuItem=function(){var e=p(this.property),t=(e.text=this.localizationService.get("ItemAction_Move_Bottom"),{action:131072}),i=this.bucket.properties[this.bucket.properties.length-1];return this.property.equals(i)?e.disabled=!0:t.moveFieldPropertyOptions={role:i.role,startIndex:i.startIndex,hierarchyLevelsLength:i.hierarchyLevels?i.hierarchyLevels.length:0},e.key=t,e},s.prototype.findFieldPropertyIndexInBucket=function(){var t=this;return _.findIndex(this.bucket.properties,(function(e){return t.property.equals(e)}))},s.prototype.createMoveGroupMenuItem=function(){var e=p(this.property);return e.key={action:524288},e.text=this.localizationService.get("ItemAction_Move"),e.children=[this.createMoveUpMenuItem(),this.createMoveDownMenuItem(),this.createMoveToTopMenuItem(),this.createMoveToBottomMenuItem()],e},g=s,e.createDropDownItems=function(e,t,i,n,r,a,o,s,l,u,c,p,h,d){return{items:v.visit(e.expr,new g(e,t,i,n,r,a,o,s,l,u,c,p,h,d))}}})(powerbi=powerbi||{}),(function(e){var t,n,i,e=e.explore||(e.explore={});function r(e,t,i){for(var n=[],r=3;r<arguments.length;r++)n[r-3]=arguments[r];this.kind=e,this.name=i.format(t,n)}function a(e){return i.call(this,void 0,"ShowValueAs_Calculation_None",e)||this}function o(e){return t.call(this,0,"ShowValueAs_Calculation_PercentOfGrandTotal",e)||this}function s(e,t,i){e=n.call(this,1,"ShowValueAs_Calculation_PercentOfRoleTotal",e,i)||this;return e.roles=t,e}(e=e.viewModels||(e.viewModels={})).ShowValueAsCalculation=r,__extends(a,i=r),e.ShowValueAsNoCalculation=a,__extends(o,t=r),e.ShowValueAsPercentOfGrandTotalCalculation=o,__extends(s,n=r),e.ShowValueAsPercentOfRoleTotalCalculation=s})(powerbi=powerbi||{}),(function(h){var s,S,a,l,u,E,t,b,c,e,n;function r(e,t,i){var n=!0,r=t&&t.featureSwitches.userFavoriteResourcePackagesEnabled&&e.custom&&i.isFavoritePublicCustomVisual(e.name),a=t&&t.featureSwitches.userFavoriteResourcePackagesEnabled&&e.custom&&e.favoriteId||r,r=t&&t.featureSwitches.userFavoriteResourcePackagesEnabled&&e.custom&&!e.favoriteId&&!r,o=t&&t.featureSwitches.tenantOutOfBoxVisualsEnabled&&e.custom&&e.isOutOfBox,t=t&&t.featureSwitches.personalVisualizationPaneEnabled&&i.isUnpinnedVisual(e.name);return n=e.custom&&!o&&r||t&&!a?!1:n}function i(e,t,i){this.sections=[],this.activeSection=S.VisualizationPaneSectionType.Fields,this.previousSection=S.VisualizationPaneSectionType.Fields,this.pagePaneSections=[],this.activePageSection=S.PagePaneSectionType.Fields,this.previousPageSection=S.PagePaneSectionType.Fields,this.title="Format",this.icon="PBIFormat",this.visualPluginFilter=r,this.nonPersonalVisualizationPaneFilter=function(e,t,i){return!r(e,t,i)},this.isPaneExpanded=e,this.isPaneVisible=t,this.showCloseButton=i}function p(e,t){return{contract:e,selected:!1,displayName:e.displayName,menuItems:S.ExplorationContainerViewModelFactory.createNavigationMenuItems(t)}}function o(e,t,i,n,r){return{isPaneVisible:r=void 0===r?!1:r,isPaneExpanded:n=void 0===n?!0:n,title:e,icon:t,closePaneLabel:i}}function d(){return{isPaneExpanded:!0,isPaneVisible:!0,title:"Data",icon:"PBIData"}}function v(e,t,i){return new n(e=void 0===e?!1:e,t=void 0===t?!0:t,i=void 0===i?!1:i)}function m(e,t,i,n,r){var a=T(t,n=void 0===n?h.common.getLocalize():n);switch(e){case u.table.name:case u.tableEx.name:return{class:"table",title:a};case u.matrix.name:case u.pivotTable.name:return{class:"matrix",title:a};case u.scatterChart.name:return{class:"scatter",title:a};case u.barChart.name:return{class:"columnHoriz",title:a};case u.clusteredBarChart.name:return{class:"clusteredBarHoriz",title:a};case u.hundredPercentStackedBarChart.name:return{class:"column100Horiz",title:a};case u.ribbonChart.name:return{class:"ribbon",title:a};case u.columnChart.name:return{class:"columnVert",title:a};case u.clusteredColumnChart.name:return{class:"clusteredBarVert",title:a};case u.dataDotClusteredColumnComboChart.name:return{class:"dataDotClusteredColumnCombo",title:a};case u.dataDotStackedColumnComboChart.name:return{class:"dataDotStackedColumnCombo",title:a};case u.hundredPercentStackedColumnChart.name:return{class:"column100Vert",title:a};case u.realTimeLineChart.name:case u.lineChart.name:return{class:"line",title:a};case u.areaChart.name:return{class:"area",title:a};case u.stackedAreaChart.name:return{class:"stackedArea",title:a};case u.lineClusteredColumnComboChart.name:return{class:"lineClusteredColumnCombo",title:a};case u.lineStackedColumnComboChart.name:return{class:"lineStackedColumnCombo",title:a};case u.pieChart.name:return{class:"pie",title:a};case u.treemap.name:return{class:"tree",title:a};case u.sunburst.name:return{class:"sunburst",title:a};case u.map.name:return{class:"map",title:a};case u.filledMap.name:return{class:"filledMap",title:a};case u.azureMap.name:return{class:"azureMap",title:a};case u.shapeMap.name:return{class:"shapeMap",title:a};case u.funnel.name:return{class:"funnel",title:a};case u.gauge.name:return{class:"gauge",title:a};case u.multiRowCard.name:return{class:"card",title:a};case u.card.name:case u.cardVisual.name:return{class:"calloutCard",title:a};case u.waterfallChart.name:return{class:"waterfall",title:a};case u.slicer.name:return{class:"slicerVert",title:a};case u.donutChart.name:return{class:"donut",title:a};case u.kpi.name:return{class:"kpi",title:a};case u.scriptVisual.name:return{class:"rScriptImageVisual",title:a};case u.pythonVisual.name:return{class:"pythonImageVisual",title:a};case u.debugVisual.name:return{class:"debugger",title:a};case u.textbox.name:return{class:"smartNarratives",title:a};case u.basicShape.name:case u.shape.name:case u.actionButton.name:case u.image.name:return{class:null,title:a};case u.keyDriversVisual.name:return{class:"keyDrivers",title:a};case u.qnaVisual.name:return{class:"qna",title:a};case u.decompositionTreeVisual.name:return{class:"decompositionTree",title:a};case u.scorecard.name:return{class:"scorecard",title:a};case u.rdlVisual.name:return{class:"rdlVisual",title:null!=r&&r.featureSwitches.operationalReportStringTest?T(c("Operational_Report"),n):a};case u.aiNarratives.name:return{class:"aiNarratives",title:a};default:if(i&&i.isTrustedVisual(e)){var o=i.getVisualTypeOptions(e);if(o)return{class:o.class,title:o.titleKey?n.get(o.titleKey):e,watermarkKey:o.watermarkKey}}return}}function g(e,t,i,n){t=m(e.name,e.titleKey,t,i,n),i=e.custom?e.displayName||e.name.match(/([A-z\s]+)/g)[0]:void 0;return t?(i&&(t.title=i),t):(n=null!=i?i:e.name,{class:e.class,title:n})}function y(e,t,i,n,r,a){for(var o=[],s=0,l=e;s<l.length;s++){var u=l[s];n&&!n(u,t,i)||o.push(f(u,t,i,r,a))}return o}function f(e,t,i,n,r){var a=(r=void 0===r?h.common.getLocalize():r).get("AddToFavorites_ContextMenu"),o=r.get("RemoveFromFavorites_ContextMenu"),s=r.get("AboutVisualDialog_About"),l={plugin:e,enabled:!0,active:!1,menuItems:[]},n=g(e,n,r,t),r=(l.class=n.class,l.title=n.title,n.watermarkKey&&(e.watermarkKey=n.watermarkKey),t&&t.featureSwitches.userFavoriteResourcePackagesEnabled&&e.custom&&i.isFavoritePublicCustomVisual(e.name)),n=t&&t.featureSwitches.userFavoriteResourcePackagesEnabled&&e.custom&&e.favoriteId||r,r=t&&t.featureSwitches.userFavoriteResourcePackagesEnabled&&e.custom&&!e.favoriteId&&!r,u=t&&t.featureSwitches.tenantOutOfBoxVisualsEnabled&&e.custom&&e.isOutOfBox,c=t&&t.featureSwitches.personalVisualizationPaneEnabled&&i.isUnpinnedVisual(e.name),t=t&&t.featureSwitches.personalVisualizationPaneEnabled&&!i.isUnpinnedVisual(e.name),i=null,n=(e.custom&&n?i=C(o,4):e.custom&&!u&&r?i=C(a,3):c?i=C(a,7):e.custom&&!u||!t||(i=C(o,6)),i&&l.menuItems.push(i),C(s,5));return l.menuItems.push(n),l.tooltipConfig={tooltipTitle:l.title,tooltipShowOnFocus:!0},l}function C(e,t){return{text:e,hasGlyph:!1,labelClass:"visualContextMenu itemLabel",action:t,type:DropDownMenuItemType.Item,checked:!1,hrefTarget:jsCommon.DOMConstants.selfValue}}function w(o,s,l){l.hostServices={getFilters:function(e,t){return e.calculateVisualContainerFilter(o,s,l.contract,t)},getDataSourceVariables:function(){return o.dataSourceVariables},getVisualRelationshipFilterAction:function(e,t,i){return t.relationshipFilterAction(s,e,l.contract,i)},selectDataPoint:function(e,t,i,n,r,a){e.setFilterOnSelectData(o,t,s,l.contract,i,n,r,a)},setVisualRelationshipFilterAction:function(e,t,i,n){return n.setVisualRelationship(s,e,t,i)}}}function x(e,t,i,n){var r=new S.ExploreCanvas(t,i);if(t.visualContainers&&(r.visualContainers=l.extendWithId(_(t.visualContainers).map((function(e){return P(e,i,n)})).filter((function(e){return!!e})).value()),r.visualContainerGroups=1===i?__spreadArray([],r.visualContainers,!0):V(t.visualContainerGroups,r.visualContainers,i,n),!_.isEmpty(r.visualContainers)))for(var a=0,o=r.visualContainers;a<o.length;a++)w(e,t,o[a]);return r}function V(e,i,n,r){for(var a=[],t=0,o=e;t<o.length;t++)!(function(t){var e;s.contracts.isVisualContainer(t)?(e=_.find(i,(function(e){return e.contract===t})))&&a.push(e):(e=F(t,V(t.children,i,n,r)))&&a.push(e)})(o[t]);return a}function F(e,t,i){if(e.layouts.withId(i=void 0===i?0:i)){for(var n=new S.VisualContainerGroup(e,i,t),r=0,a=t;r<a.length;r++)a[r].parentGroup=n;return n}}function P(e,t,i){void 0===t&&(t=0);var n=new a,r=e.layouts.withId(t);if(r)return r=r.position,n.position({y:r.y,x:r.x}),n.zIndex(r.z||0),n.viewport({height:r.height,width:r.width}),new S.VisualContainer(e,n,t,i)}function T(e,t){return void 0===t&&(t=h.common.getLocalize()),h.data.getDisplayName(e,t)}function A(e,t){var i=e.getDisplayName()?-1:1,n=t.getDisplayName()?-1:1;return i!=n?i-n:(i=e.getDisplayName()||e.getRestatement()||"",n=t.getDisplayName()||t.getRestatement()||"",i.localeCompare(n))}s=h.explore||(h.explore={}),S=s.viewModels||(s.viewModels={}),a=h.common.models.ApplyStyle,l=jsCommon.ArrayExtensions,u=h.visuals.plugins,E=h.data.SQExpr,t=jsCommon.StringExtensions,b=h.explore.util.VisualContainerUtils,c=h.data.createDisplayNameGetter,S.isPersonalVisualizationPaneVisual=r,Object.defineProperty(i.prototype,"activeSectionIndex",{get:function(){var t=this,e=_.findIndex(this.sections,(function(e){return e.sectionType===t.activeSection}));return-1!==e?e:0},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"activePageSectionIndex",{get:function(){var t=this,e=_.findIndex(this.pagePaneSections,(function(e){return e.sectionType===t.activePageSection}));return-1!==e?e:0},enumerable:!1,configurable:!0}),n=i,S.VisualizationPaneViewModel=n,(e=S.ViewModelFactory||(S.ViewModelFactory={})).createExplorationContainer=function(){return{exploration:null,options:null,taskPane:d(),visualizationPane:v(),sectionStatus:{currentSectionNumber:-1,isEditing:!1},isNavPaneCollapsed:!0,performancePane:o("PerformanceAnalyzerPane_Title","PBIPerformanceAnalyzer","PerformanceAnalyzerPane_Close"),bookmarksPane:o("ExplorationBookmarksPane_Title","AudioBookmark","ExplorationBookmarksPane_Close"),canvasItemsPane:o("ExplorationCanvasItemsPane_Title","LaunchSelectionPane","ExplorationCanvasItemsPane_Close"),syncGroupPane:o("SyncGroupPane_Title","PBISyncSlicer","SyncGroupPane_Close"),insightsPane:o("Generic_Insights","PBIAnomalyExplain","InsightsPane_Close"),reflexPane:o("Reflex_Config_Title",void 0,"Reflex_Pane_Close"),quickExplorePane:o("Summarize"),quickMeasuresPane:o("QuickMeasure","PBINewQuickMeasure","QuickMeasuresPane_Close"),buildSkittlePane:o("Skittles_Build_Title","PBIBuild",void 0,!1),chartElementsSkittlePane:o("Skittles_ChartElements_Title","PBIAddToChart",void 0,!1),assistedCreationPane:o("AssistedCreation_Pane_Title","addchartplaceholder","AssistedCreation_Pane_Close"),reportCreationCopilotPane:o("ReportCreationCopilotPane_Title","PBIAnomalyExplain"),customizePane:o("Customize_PaneSwitcher","LaunchSelectionPane","ExplorationCanvasItemsPane_Close")}},e.convertSectionToViewModel=p,e.createExplorePane=o,e.createTaskPane=d,e.createVisualizationPane=v,e.createVisualTypesContainer=function(e){return{visuals:e}},e.getCustomVisualTypes=function(e){return y(_.filter(e,(function(e){return e.custom})))},e.getVisualTypeInfoByName=m,e.getVisualTypeInfo=g,e.getAvailableVisualTypes=y,e.getVisualType=f,e.convertExploration=function(e,t,i,n,r){var a=_.map(e.sections,(function(e){return p(e,r)})),o=e.sections;if(o&&0<o.length){var s=void 0!==i?i:0;if(s<o.length)for(var l=x(e,o[s],t,n),u=o.length-1;0<=u;--u)a[u].selected=u===s}return{contract:e,sections:a,exploreCanvas:l}},e.convertSectionToExploreCanvas=x,e.convertVisualContainerGroups=V,e.convertVisualContainerGroup=F,e.convertVisualContainerStandalone=P,e.convertVisualContainer=function(e,t,i,n){if(i=P(i,n))return w(e,t,i),i},e.getDisplayName=T,e.createFilterPane=function(e,t){return{isVisualVisible:!1,reportFilters:(t=void 0===t?!0:t)?[]:null,pageFilters:[],drillthroughFilters:[],visualFilters:[],activeFilterPane:void 0,addFilterLabel:e.get("FieldDropZone_AddFields"),addDrillthroughFilterLabel:e.get("FieldDropZone_DrillthroughLink_Watermark")}},e.createVisualFilters=function(e,t,n,i,r,a,o,s,l){for(var u=(null==(u=t.filters)?void 0:u.filter((function(e){return null!=e})))||[],c=[],p={container:t,scopeType:0},h=b.getAutoVisualFilterContainers(t,a,n,s),a=b.getAutoCrossDrillVisualFilterContainers(e,t,o,n),d=function(e){return S.FilterViewModelFactory.convertFilterContainer(e,n,i,p,r,s,l,b.getVisualCapabilities(t,r),t.config.singleVisual)},v=0,m=u;v<m.length;v++)!(function(t){var e=d(t);if(c.push(e),h){if(t.expression&&!_.isEmpty(t.expression.validate(n,s)))return;var i=_.findIndex(h,(function(e){return E.equals(e.expression,t.expression)}));-1===i?0===t.howCreated&&(e.howCreated=t.howCreated=1):(1===t.howCreated&&(e.howCreated=t.howCreated=0),2!==t.howCreated&&h.splice(i,1))}})(m[v]);if(h=h||[],e=(e=a||[]).concat(h),_.isEmpty(p.container.filters)&&(p.container.filters=[]),(o=p.container.filters).push.apply(o,h||[]),e)for(var g=0,y=e;g<y.length;g++){var f=y[g],C=d(f);C.howCreated=f.howCreated,c.push(C)}return c.sort(A),c},e.createFilters=function(e,t,i,n,r,a,o,s){var l=[];if(e&&e.container&&e.container.filters){for(var u=0,c=e.container.filters;u<c.length;u++){var p=c[u];null!=s&&p.howCreated!==s||(p.name||(p.name=h.explore.FilterUtils.getNextFilterName(e.container.filters)),p=S.FilterViewModelFactory.convertFilterContainer(p,t,i,e,n,r,a,o,null),l.push(p))}l.sort(A)}return l},e.createUniqueId=function(e){return _.map(e,(function(e){return t.replaceAll(e,"-","\\-")})).join("-")},e.sortFilterByDisplayName=A,e.sortFilterByOrdinal=function(e,t){var i=void 0===e.contract.ordinal?1:-1,n=void 0===t.contract.ordinal?1:-1;return-1==i&&-1==n?e.contract.ordinal-t.contract.ordinal:i-n}})(powerbi=powerbi||{}),(function(t){var e,i;function n(e){e&&(this.color=e.color.solid.color,this.visible=e.show,this.radius=e.radius)}e=(e=t.explore||(t.explore={})).viewModels||(e.viewModels={}),Object.defineProperty(n.prototype,"thickness",{get:function(){return n.Width},enumerable:!1,configurable:!0}),n.prototype.getNumericPaddingFromBorder=function(){return n.calculatePadding(this.radius)},n.prototype.getBorderStyle=function(){var e;if(this.visible)return e=t.common.utils.ColorUtility.applyTransparency(this.color,1),n.Width+"px "+n.Style+" "+e},n.prototype.getPaddingFromBorder=function(){var e=n.calculatePadding(this.radius);if(this.visible)return"".concat(e,"px")},n.prototype.getBorderRadius=function(){if(this.visible)return"".concat(this.radius||t.visuals.VisualBorderUtil.DefaultRadius,"px")},e.VisualBorder=n,(i=e.VisualBorder||(e.VisualBorder={})).Width=1,i.Style="solid",i.DefaultPadding=0,i.paddingMultiple=Math.sin(Math.PI/180*45),i.calculatePadding=function(e){return Math.ceil(e-e*i.paddingMultiple)}})(powerbi=powerbi||{}),(function(t){var e,i,n,r,a,o;function s(e,t,i){this.contract=e,this.currentCanvasLayout=t,this.children=i,this.uiScale=a.DefaultCanvasUiScale}function l(e){return!!e.children}e=t.explore||(t.explore={}),i=e.viewModels||(e.viewModels={}),n=t.common.models.ApplyStyle,r=e.util.CanvasVisualsUtility,a=t.explore.constants.ExploreCanvasConstants,o=t.explore.util.VisualContainerUtils,s.prototype.setSelected=function(e){this.isSelected=e},Object.defineProperty(s.prototype,"id",{get:function(){return this.contract.id},enumerable:!1,configurable:!0}),Object.defineProperty(s.prototype,"name",{get:function(){return this.contract.name},enumerable:!1,configurable:!0}),Object.defineProperty(s.prototype,"isHidden",{get:function(){return this.contract.isHidden},enumerable:!1,configurable:!0}),Object.defineProperty(s.prototype,"position",{get:function(){var e=this.currentCanvasLayout;return this.contract.layouts.withId(e).position},set:function(e){var t=this.currentCanvasLayout;this.contract.layouts.withId(t).position=e},enumerable:!1,configurable:!0}),Object.defineProperty(s.prototype,"isPositioned",{get:function(){var e=this.position;return 0!==e.width&&0!==e.height},enumerable:!1,configurable:!0}),s.prototype.startResize=function(){this.originalPosition=this.position;for(var e=0,t=this.children;e<t.length;e++)t[e].startResize()},s.prototype.getScaledPosition=function(){return this.scaledPosition||this.convertToScaledPosition(this.position)},s.prototype.convertToScaledPosition=function(e){return r.convertToScaledPosition(e,this.uiScale,!0)},s.prototype.updateViewportForUserResize=function(e){e=this.convertToScaledPosition(__assign(__assign({},e),{x:0,y:0}));this.updateStyle(e)},s.prototype.updateViewState=function(){this.scaledPosition=this.convertToScaledPosition(this.position);var e=t.Prototype.inherit(this.scaledPosition);this.updateStyle(e),this.setTooltip()},s.prototype.updateStyle=function(e){this.applyStyle||(this.applyStyle=new n);e=o.getVisualStyleAttributes(e,void 0,this.background&&this.background.colorRGB,this.border&&this.border.getBorderStyle(),this.border&&this.border.getBorderRadius(),this.border&&this.border.getPaddingFromBorder());this.applyStyle.addAttributes(e),this.applyStyle.apply()},s.prototype.setTooltip=function(){var e;this.tooltip=null==(e=null==(e=null==(e=this.contract.evaluatedObjects)?void 0:e.general)?void 0:e.altText)?void 0:e.toString()},s.prototype.clone=function(){var e=new s(this.contract,this.currentCanvasLayout,this.children);return _.assign(e,this)},i.VisualContainerGroup=s,i.traverseVisualContainerGroups=function e(t,i,n){for(var r=n&&n.visibleOnly,a=0,o=t;a<o.length;a++){var s=o[a];r&&s.isHidden||(i(s),l(s)&&e(s.children,i,n))}},i.isVisualContainerGroup=l,i.isVisualContainer=function(e){return!e.children}})(powerbi=powerbi||{}),(function(u){var C,S,h,o,i,a,s,l,c,r,n,p,d,v,m,g,y,f,E,b,w,e,x,V;function F(e,t,i,n){e=V.call(this,e,{footerStyle:null,headerBackgroundStyle:null,headerForegroundStyle:null,headerItemContainerStyle:null,popOutBarSubtitle:"",popOutBarTitle:"",position:null,style:t,titleStyle:null,visualViewportStyle:null,subTitleStyle:null,visualsDividerStyle:null,visualTitleAreaStyle:null})||this;return e.uiScale=r.DefaultCanvasUiScale,e.currentCanvasLayout=i,e.currentEditMode=0,e.visualTitleWrapped=[],e.visualSubTitleWrapped=[],e.currentZone=n,e.servicesState=S.Uninitialized,e}C=u.explore||(u.explore={}),h=C.viewModels||(C.viewModels={}),o=u.common.models.ApplyStyle,i=jsCommon.BrowserUtils,a=jsCommon.Color,s=u.visuals.ColorHelper,l=jsCommon.CssConstants,c=u.data.DataViewObjectDescriptors,r=u.explore.constants.ExploreCanvasConstants,n=u.a11y.util.FocusUtility,p=u.visuals.FontProperties,d=jsCommon.KeyUtils,v=u.TextMeasurementService,m=u.explore.util.VisualContainerUtils,g=C.contracts.VisualDivider,y=C.contracts.VisualLink,f=C.contracts.VisualSubTitle,E=C.contracts.VisualTitle,b=jsCommon.WordBreaker,w=u.explore.util.VisualContainerUtils.VisualElementSpacing,e={key:void 0,defaultValue:!0,forceVisible:((e={})[1]=!0,e)},x={visualInformationButton:__assign(__assign({},e),{key:"showVisualInformationButton"}),visualWarningButton:__assign(__assign({},e),{key:"showVisualWarningButton"}),visualErrorButton:__assign(__assign({},e),{key:"showVisualErrorButton"}),drillRoleSelector:__assign(__assign({},e),{key:"showDrillRoleSelector"}),drillUpButton:__assign(__assign({},e),{key:"showDrillUpButton"}),drillToggleButton:__assign(__assign({},e),{key:"showDrillToggleButton"}),drillDownLevelButton:__assign(__assign({},e),{key:"showDrillDownLevelButton"}),drillDownExpandButton:__assign(__assign({},e),{key:"showDrillDownExpandButton"}),pinButton:__assign(__assign({},e),{key:"showPinButton"}),filterRestatementButton:__assign(__assign({},e),{key:"showFilterRestatementButton"}),focusModeButton:__assign(__assign({},e),{key:"showFocusModeButton"}),copyVisualImageButton:__assign(__assign({},e),{key:"showCopyVisualImageButton"}),seeDataLayoutToggleButton:__assign(__assign({},e),{key:"showSeeDataLayoutToggleButton"}),optionsMenu:__assign(__assign({},e),{key:"showOptionsMenu"}),commentButton:__assign(__assign({},e),{key:"showCommentButton"}),tooltipButton:{key:"showTooltipButton",defaultValue:!1},personalizeVisualButton:__assign(__assign({},e),{key:"showPersonalizeVisualButton"}),smartNarrativeButton:{key:"showSmartNarrativeButton",defaultValue:!1}},(e=S=S||{})[e.Uninitialized=0]="Uninitialized",e[e.Initialized=1]="Initialized",V=h.ViewModel,__extends(F,V),F.prototype.resolveDataAppliedEvent=function(){this.visual.dataAppliedEvent&&this.visual.dataAppliedEvent.resolve()},F.prototype.getRunningVisual=function(){return this.runningVisual},Object.defineProperty(F.prototype,"errorInfo",{get:function(){return this.runningVisual&&this.runningVisual.getErrorInfo()},set:function(e){var t=this.getRunningVisual();t&&t.setErrorInfo(e)},enumerable:!1,configurable:!0}),Object.defineProperty(F.prototype,"visualPausedWarning",{get:function(){return this.visualPausedWarningModel},set:function(e){this.visualPausedWarningModel=e;var t=this.getRunningVisual();t&&t.setHasPendingChanges(void 0!==e)},enumerable:!1,configurable:!0}),F.prototype.setThemeCollection=function(e){this.themeCollection=e,this.runningVisual&&this.runningVisual.setThemeCollection(e)},F.prototype.startResize=function(){this.originalPosition=this.position},F.prototype.getVisualType=function(){return m.getVisualType(this.contract)},F.getVisualBodyOffset=function(e,t){return F.useStylableHeader(t)||e.canShowVisualContainerHeaderInset()?{top:0,height:0,width:0,left:0}:{top:this.VisualContainerHeaderHeight,height:-this.VisualContainerHeaderHeight,width:0,left:0}},Object.defineProperty(F.prototype,"id",{get:function(){return this.contract.id},enumerable:!1,configurable:!0}),Object.defineProperty(F.prototype,"name",{get:function(){return this.contract.name},enumerable:!1,configurable:!0}),Object.defineProperty(F.prototype,"position",{get:function(){var e=this.currentCanvasLayout;return this.contract.layouts.withId(e).position},set:function(e){var t=this.currentCanvasLayout;this.contract.layouts.withId(t).position=e},enumerable:!1,configurable:!0}),F.prototype.getScaledPosition=function(e){return this.convertToScaledPosition(this.position,e=void 0===e?!0:e)},Object.defineProperty(F.prototype,"editMode",{get:function(){return this.currentEditMode},enumerable:!1,configurable:!0}),Object.defineProperty(F.prototype,"headerTitleMaxLines",{get:function(){return this.isTitleWrappingEnabled?3:1},enumerable:!1,configurable:!0}),Object.defineProperty(F.prototype,"headerSubTitleMaxLines",{get:function(){return this.isSubTitleWrappingEnabled?3:1},enumerable:!1,configurable:!0}),F.prototype.setEditMode=function(e){this.currentEditMode=e,m.updateVisual(this.runningVisual,this.runningVisual.getViewport(),u.VisualUpdateType.ViewMode,this.visualHostServices,this.editMode)},Object.defineProperty(F.prototype,"isPositioned",{get:function(){var e=this.position;return 0!==e.width&&0!==e.height},enumerable:!1,configurable:!0}),Object.defineProperty(F.prototype,"isPoppedOut",{get:function(){var e=this.contract.visibility;return null!=e&&0!==e&&4!==e},enumerable:!1,configurable:!0}),Object.defineProperty(F.prototype,"bringToFront",{get:function(){var e=this.contract.config.singleVisual.evaluatedObjects;return!e||!e.general||!e.general.keepLayerOrder},enumerable:!1,configurable:!0}),Object.defineProperty(F.prototype,"isHidden",{get:function(){return C.contracts.VisualContainer.isHidden(this.contract.config.singleVisual)},enumerable:!1,configurable:!0}),Object.defineProperty(F.prototype,"isTitleWrappingEnabled",{get:function(){return this.visualTitle&&!!this.visualTitle.titleWrap},enumerable:!1,configurable:!0}),Object.defineProperty(F.prototype,"isSubTitleWrappingEnabled",{get:function(){return this.visualSubTitle&&!!this.visualSubTitle.titleWrap},enumerable:!1,configurable:!0}),F.prototype.visualTitleVisible=function(){var e=this.contract.config.singleVisual,t=e.evaluatedObjects&&e.evaluatedObjects.title,i=t&&t.text,e=this.visualPlugin&&this.visualPlugin.capabilities(e.visualType),n=!1;return(t&&i||this.visualTitle&&this.visualTitle.text)&&(n=!0),!E.isHidden(t,e&&e.suppressDefaultTitle)&&e&&(!e.suppressDefaultTitle||e.suppressDefaultTitle&&i)&&""!==i&&n&&!this.isPoppedOut},F.prototype.visualSubTitleVisible=function(){var e,t=this.contract.config.singleVisual,i=t.evaluatedObjects&&t.evaluatedObjects.subTitle,n=i&&i.text,r=t.evaluatedObjects&&t.evaluatedObjects.title,t=this.visualPlugin&&this.visualPlugin.capabilities(t.visualType);return!(null==(e=this.featureSwitchService)||!e.featureSwitches.vcPadding)&&(e=!1,(i&&n||this.visualSubTitle&&this.visualSubTitle.text&&this.visualSubTitle.show)&&(e=!0),!f.isVisualSubTitleHidden(i))&&""!==n&&e&&!E.isHidden(r,t&&t.suppressDefaultTitle)&&!this.isPoppedOut},F.prototype.visualTitleAreaVisible=function(){var e=this.contract.config.singleVisual,t=e.evaluatedObjects&&e.evaluatedObjects.title,e=this.visualPlugin&&this.visualPlugin.capabilities(e.visualType);return!E.isHidden(t,e&&e.suppressDefaultTitle)&&!this.isPoppedOut},F.prototype.visualDividerVisible=function(){var e,t=this.contract.config.singleVisual,i=t.evaluatedObjects&&t.evaluatedObjects.divider,n=t.evaluatedObjects&&t.evaluatedObjects.title,t=this.visualPlugin&&this.visualPlugin.capabilities(t.visualType);return!(null==(e=this.featureSwitchService)||!e.featureSwitches.vcPadding||!i||g.isVisualDividerHidden(i)||E.isHidden(n,t&&t.suppressDefaultTitle)||this.isPoppedOut)},F.prototype.supportsKeyboardNavigation=function(){var e=this.contract.config.singleVisual,e=this.visualPlugin&&this.visualPlugin.capabilities(e.visualType);return e&&e.supportsKeyboardFocus},Object.defineProperty(F.prototype,"supportsCustomPadding",{get:function(){var e;return null==(e=this.featureSwitchService)?void 0:e.featureSwitches.vcPadding},enumerable:!1,configurable:!0}),F.prototype.setServices=function(e,t,i,n,r,a,o,s,l,u,c,p,h,d,v,m,g,y,f){this.visualHostServices=C.helpers.VisualHostInsideZoneAdapter.wrapHostServices(e,p),this.visualAdapterHostServices=g,this.visualPlugin=t,this.visualPluginOps=i,this.viewModeState=n,this.formFactor=r,this.visibility=a,this.runningVisuals=o,this.explorationCapabilities=m,this.visualAuthoring=l,this.filterGenerator=u,this.themeService=c,this.showClientWarnings=h,this.sortServices=d,this.selectionServices=v,this.dataViewServices=y,this.servicesState=S.Initialized,this.bodyScaleChanged=f,this.featureSwitchService=s},F.prototype.setSelected=function(e){this.isSelected=e},F.prototype.handleKeyDown=function(e){switch(function(e){switch(e.keyCode){case 122:return e.altKey&&e.shiftKey?0:void 0;case 70:return i.isCtrlOrMeta(e)?1:void 0}}(e)){case 0:this.visibility.set(this.contract,8);break;case 1:this.toggleVisualSearch(e)}if(this.shouldHandleKeydown(e)){if(this.isTextboxVisual())return(t=this.getTextboxVisual())&&t.focus();if(this.isContractQnaVisual()){var t=this.getQnaVisual();if(t)return t.focus()}}},F.prototype.toggleVisualSearch=function(e){var t;this.contract&&this.contract.config&&this.contract.config.singleVisual&&(t=this.contract.config.singleVisual.visualType,t=this.visualPlugin&&this.visualPlugin.capabilities(t))&&this.filterGenerator.tryGetSelfFilterEnabledProperty(t)&&(this.visualAuthoring.toggleSlicerVisualSearch(this.contract,this.filterGenerator,this.visualPlugin),e.preventDefault(),e.stopPropagation())},F.prototype.shouldHandleKeydown=function(e){var t;return!(!this.runningVisual||0===this.viewModeState.getMode()||(t=e.keyCode,d.isArrowKey(t))||d.isNudgeModifierKey(t)||27===t||9===t||18===t||13===t||i.isCtrlOrMeta(e)||(t=this.contract.toolbar&&this.contract.toolbar.element)&&n.isFocusInTree(t))},F.prototype.setVisualTitle=function(e){var t,i="";(this.visualTitle=e)&&(_.isEmpty(this.readOnlyState.popOutBarSubtitle)&&e.titleComponents&&e.titleComponents.subtitle?(t=e.titleComponents.subtitle,this.readOnlyState.popOutBarSubtitle=t,e.titleComponents&&e.titleComponents.title?i=e.titleComponents.title:e.text&&(i=e.text)):e.text?i=e.text:e.titleComponents&&e.titleComponents.title&&(i=e.titleComponents.title)),this.readOnlyState.popOutBarTitle=i},F.prototype.setVisualSubTitle=function(e){var t="";(this.visualSubTitle=e)&&e.text&&(t=e.text),this.readOnlyState.popOutBarSubtitle=t},F.prototype.setTooltip=function(){var e=m.getVisualType(this.contract),t=this.getVisualLinkTypeLabel(e)||"",i=null==(i=null==(i=this.visualPlugin)?void 0:i.capabilities(e))?void 0:i.ariaRole,n=this.visualPlugin&&this.visualPlugin.getPlugin(e),n=(n&&(r=(r=this.ariaMetadata&&this.ariaMetadata.subtitleDisplayNameGetter)?" ".concat(h.ViewModelFactory.getDisplayName(r)):"",e=h.ViewModelFactory.getVisualType(n).title+r),this.visualTitle),r=void 0!==(null==n?void 0:n.text)&&"".concat(n.text," ")||"",n=this.contract.config.singleVisual,n=n.evaluatedObjects&&n.evaluatedObjects.general&&n.evaluatedObjects.general.altText?" ".concat(n.evaluatedObjects.general.altText):"";this.tooltip="".concat(r).concat(t).concat(e).concat(n),this.ariaLabel="".concat(r).concat(t).concat(n),this.ariaRole="group",this.ariaRoleDescription=null!=i?i:e,"table"===this.ariaRoleDescription.trim().toLowerCase()&&(this.ariaRoleDescription="")},F.prototype.getVisualLinkTypeLabel=function(e){e=this.visualPlugin&&this.visualPlugin.capabilities(e);if(e&&e.supportsVisualLink){var t,e=this.contract.config.singleVisual,e=e.evaluatedObjects&&e.evaluatedObjects.visualLink;if(e&&e.show)return t=y.getType(e),e=_.find(y.Type.members(),(function(e){return e.value===t})).displayName,"".concat(h.ViewModelFactory.getDisplayName(e)," ")}},F.prototype.setHeaderTooltip=function(){var e=this.contract.config.singleVisual,t=e.evaluatedObjects&&e.evaluatedObjects.visualHeader,e=e.evaluatedObjects&&e.evaluatedObjects.visualHeaderTooltip;t&&t.showTooltipButton&&e?this.headerTooltip=e:this.headerTooltip=void 0},F.prototype.redrawVisual=function(){this.runningVisual&&m.updateVisual(this.runningVisual,this.runningVisual.getViewport(),u.VisualUpdateType.Resize,this.visualHostServices,this.editMode)},F.prototype.updateVisualViewportForUserResize=function(e){var t=this.themeService&&this.themeService.getVisualStyle(this.themeCollection),i=this.runningVisual,i=(this.enableVisualScaling?(e.width/=this.uiScale.x,this.visualBorder&&(e.width-=2*this.visualBorder.thickness),this.useStylableHeader()||(e.height-=F.VisualContainerHeaderHeight),e.height/=this.uiScale.y,this.visualBorder&&(e.height-=2*this.visualBorder.thickness)):this.useStylableHeader()||(e.height-=F.VisualContainerHeaderHeight),this.isFooterVisible&&this.isFooterVisible()&&(e.height-=F.VisualContainerFooterHeight),this.visualViewport=this.getVisualViewport(e.width,e.height,1,t),i&&(this.viewportResized=!0,m.updateVisual(i,this.visualViewport,u.VisualUpdateType.Resize,this.visualHostServices,this.editMode,1)),this.applyVisualBodyStyle(this.readOnlyState,e),this.applyFooterStyle(this.readOnlyState,e.width),this.position),e=this.overridePosition||this.convertToScaledPosition(i);this.applyTitleStyle(this.readOnlyState,e.width,t),this.applyVisualTitleAreaStyle(this.readOnlyState),null!=(i=this.featureSwitchService)&&i.featureSwitches.vcPadding&&(this.applySubTitleStyle(this.readOnlyState,e.width,t),this.applyDividerStyle(this.readOnlyState,t))},F.prototype.shouldUseCache=function(){return m.shouldUseQueryCache(this.contract,this.options.disableQueryCacheUpdates)},F.prototype.adjustForVisualContainerHeader=function(e,t,i){this.formFactor&&this.formFactor.getCurrentLayoutCapabilities().canShowVisualContainerHeaderInset()||(i&&(e.y+=t),e.height-=t)},F.prototype.convertToScaledPosition=function(e,t){void 0===t&&(t=!0);var i=this.viewModeState&&this.viewModeState.getConfig().displayOptions.disablePixelValueRounding,e=C.util.CanvasVisualsUtility.convertToScaledPosition(e,this.uiScale,!i);return this.adjustForVisualContainerHeader(e,this.useStylableHeader()?0:-F.VisualContainerHeaderHeight,t),e},F.prototype.reset=function(){var e=this.visual;e&&(e.data=void 0,e.dataTransforms=void 0,e.hostServices=u.visuals.defaultVisualHostServices,e.visualAdapterHostServices={getNextDataSegment:function(){return new u.Promise(function(e,t){return t(new Error("Visual reset"))})},startProgressBar:_.noop,stopProgressBar:_.noop}),this.runningVisuals&&this.runningVisuals.removeVisual(this.contract),this.runningVisual=void 0,this.showClientWarnings=void 0,this.visualHostServices=void 0,this.visualAdapterHostServices=void 0,this.lastBodyScale=void 0,this.bodyScaleChanged=void 0},F.prototype.updateViewStateCore=function(e){var t,i,n,r,a,o,s,l;this.servicesState===S.Initialized&&(l=(l=this.viewModeState&&this.viewModeState.getConfig())&&l.displayOptions,t=this.themeService&&this.themeService.getVisualStyle(this.themeCollection),i=this.contract,n=this.position,r=this.overridePosition||this.convertToScaledPosition(n),a=u.Prototype.inherit(r),o=!this.useStylableHeader()||this.isPoppedOut,this.enableVisualScaling?this.overridePosition?(o&&(a.height-=F.VisualContainerHeaderHeight),a.height/=this.uiScale.y,a.width/=this.uiScale.x):(a=u.Prototype.inherit(n),this.formFactor&&this.formFactor.getCurrentLayoutCapabilities().canShowVisualContainerHeaderInset()&&o&&(a.height-=F.VisualContainerHeaderHeight/this.uiScale.y)):o&&(a.height-=F.VisualContainerHeaderHeight),this.isFooterVisible&&this.isFooterVisible()&&(a.height-=F.VisualContainerFooterHeight),!this.isPoppedOut||l&&l.hideInFocusBar||(o=h.VisualContainer.PopOutBarHeight,this.enableVisualScaling&&(o/=this.uiScale.y),a.height-=o),this.visualViewport=this.getVisualViewport(a.width,a.height,this.uiScale.x,t),l=i.config.singleVisual,e.isFilterVisual=!1,l&&(this.showWatermark=!1,this.canPin=!0,o=l.visualType,(s=this.visualPlugin&&this.visualPlugin.capabilities(o))&&(e.isFilterVisual=null!=c.findFilterOutput(s.objects)),l.query?(l=l.query.defn)&&(l=l.orderBy(),e.actualSortDirection=l&&l.length?l[0].direction:void 0):this.visualPluginOps&&this.visualPluginOps.isQueryVisual(o)&&"debugVisual"!==o&&(this.canPin=!1,this.showVisualCalcEditor()?this.showWatermark=!1:this.viewModeState&&s?this.showWatermark=!(s.supportsLandingPage&&(1===this.viewModeState.getMode()||s.supportsEmptyDataView)):this.showWatermark=!0),this.updateVisualDefinition(this.visualViewport),!this.visual||this.runningVisuals.getVisual(this.contract)&&this.runningVisual||(this.runningVisual=m.wrapRunningVisual(this.visual,this.visualHostServices,this.editMode,this.contract.config.singleVisual,this.hostServices,this.filterGenerator,this.showClientWarnings,this.sortServices,this.selectionServices,this.dataViewServices),this.runningVisuals.setVisual(this.contract,this.runningVisual)),this.setViewport(e,this.visualViewport)),e.position=__assign(__assign({},r),{z:null!=this.zIndexOverride?this.zIndexOverride:n.z||0,angle:n.angle||0}),this.applyTitleStyle(e,r.width,t),this.applyVisualTitleAreaStyle(e),null!=(l=this.featureSwitchService)&&l.featureSwitches.vcPadding&&(this.applySubTitleStyle(e,r.width,t),this.applyDividerStyle(e,t)),this.applyVisualBodyStyle(e,a),this.applyFooterStyle(e,a.width),this.applyHeaderStyle(e),this.setHeaderItemVisibility(e),this.setTooltip(),this.setHeaderTooltip(),i&&i.postProcessing&&this.configureInitializationSpinner(i.postProcessing),this.bodyScaleChanged&&this.uiScale.x!==this.lastBodyScale&&this.bodyScaleChanged(),this.lastBodyScale=this.uiScale.x)},F.prototype.isHeaderItemVisible=function(e){return!this.readOnlyState.itemVisibility||this.readOnlyState.itemVisibility[e]},F.prototype.isDeprecationWarningVisible=function(){return 1===this.viewModeState.getMode()&&void 0!==this.customVisualDeprecatedWarningInfo},F.prototype.isWarningVisible=function(){return this.isHeaderItemVisible("visualWarningButton")&&void 0!==this.warningInfo},F.prototype.isErrorVisible=function(){return this.isHeaderItemVisible("visualErrorButton")&&void 0!==this.transformWarningInfo},F.prototype.isInfoVisible=function(){return this.isHeaderItemVisible("visualInformationButton")&&void 0!==this.visualInfo},F.prototype.isInfoVersionsVisible=function(){return this.isHeaderItemVisible("visualInformationButton")&&void 0!==this.versionsInfo},F.prototype.isHeaderTooltipVisible=function(){return this.isHeaderItemVisible("tooltipButton")},F.prototype.isAnyIconVisible=function(){return this.isDeprecationWarningVisible()||this.isWarningVisible()||this.isErrorVisible()||this.isInfoVersionsVisible()||this.isInfoVisible()||this.isHeaderTooltipVisible()},F.prototype.anyHeaderItemVisible=function(e){if(e)for(var t=0,i=e;t<i.length;t++){var n=i[t];if(this.isHeaderItemVisible(n))return!0}return!1},F.prototype.isTextboxVisual=function(){return this.contract.config.singleVisual.visualType===u.visuals.plugins.textbox.name},F.prototype.getTextboxVisual=function(){return this.tryGetUnwrappedVisual()},F.prototype.isContractAnalysisVisual=function(){var e=this.contract.config.singleVisual.visualType;return this.visualPluginOps.isAnalysisVisual(e)},F.prototype.isDefinitionAnalysisVisual=function(){var e=this.visual&&this.visual.type;return this.visualPluginOps.isAnalysisVisual(e)},F.prototype.isContractQnaVisual=function(){var e=this.contract.config.singleVisual.visualType;return this.visualPluginOps.isQnaVisual(e)},F.prototype.getQnaVisual=function(){return this.tryGetUnwrappedVisual()},F.prototype.isDefinitionQnaVisual=function(){var e=this.visual&&this.visual.type;return this.visualPluginOps.isQnaVisual(e)},F.prototype.setInitialLoadTelemetryParent=function(e){this.visual,this.visual.initialLoadActivity=e},F.prototype.tryGetUnwrappedVisual=function(){var e=null==(e=this.runningVisual)?void 0:e.getAdapter();return e?e.unwrap?e.unwrap():e:void 0},F.prototype.setHeaderItemVisibility=function(e){var t,i=(i=e.itemVisibility)||(e.itemVisibility={}),n=this.viewModeState&&this.viewModeState.getMode(),e=this.contract.config.singleVisual,r=this.useStylableHeader()?e.evaluatedObjects&&e.evaluatedObjects.visualHeader:void 0;for(t in x){var a=x[t],o=a.key,s=a.defaultValue,a=a.forceVisible,l=void 0;l=a&&void 0!==a[n]?a[n]:void 0!==(a=r&&r[o])?a:s,i[t]=l}},F.prototype.applyHeaderStyle=function(e){var t=this.contract.config.singleVisual,t=this.useStylableHeader()?t.evaluatedObjects&&t.evaluatedObjects.visualHeader:void 0;this.applyItemContainerStyle(e,t),this.applyHeaderBackgroundStyle(e,t),this.applyHeaderForegroundStyle(e,t)},F.prototype.applyItemContainerStyle=function(e,t){var i,n,r={"background-color":"","border-color":""};this.useStylableHeader()&&t&&(!t.background&&null==t.transparency&&null==t.border||(i=t.background&&t.background.solid?a.parseColorString(t.background.solid.color):{R:255,G:255,B:255},n=t.border&&t.border.solid?a.parseColorString(t.border.solid.color):i,null!=t.transparency?n.A=i.A=1-t.transparency/100:(null==i.A&&(i.A=1),null==n.A&&(n.A=1)),r["background-color"]=a.rgbString(i),r["border-color"]=a.rgbString(n))),e.headerItemContainerStyle||(e.headerItemContainerStyle=new o),e.headerItemContainerStyle.addAttributes(r),e.headerItemContainerStyle.apply()},F.prototype.applyHeaderBackgroundStyle=function(e,t){var i,n={"background-color":""};this.useStylableHeader()&&t&&(t.background||null!=t.transparency)&&(i=t.background&&t.background.solid?a.parseColorString(t.background.solid.color):F.VisualHeaderBackgroundColor,null!=t.transparency?i.A=1-t.transparency/100:null==i.A&&(i.A=1-F.VisualHeaderTransparency/100),n["background-color"]=a.rgbString(i),i=null==(t=this.themeService)?void 0:t.getVisualStyle(this.themeCollection))&&(n[":hover"]=s.getThemeColor(i,"backgroundNeutral")),e.headerBackgroundStyle||(e.headerBackgroundStyle=new o),e.headerBackgroundStyle.addAttributes(n),e.headerBackgroundStyle.apply()},F.prototype.applyHeaderForegroundStyle=function(e,t){var i={color:""};this.useStylableHeader()&&t&&t.foreground&&t.foreground.solid&&(i.color=t.foreground.solid.color),e.headerForegroundStyle||(e.headerForegroundStyle=new o),e.headerForegroundStyle.addAttributes(i),e.headerForegroundStyle.apply()},F.prototype.applyVisualBodyStyle=function(e,t){e.visualViewportStyle||(e.visualViewportStyle=new o);var i=null==(i=this.themeService)?void 0:i.getVisualStyle(this.themeCollection),i=(null!=i&&i.isHighContrast&&this.visualDropShadow&&(this.visualDropShadow.color=s.getThemeColor(i,"foreground")),this.visualBorder&&this.visualBorder.getPaddingFromBorder()),n=(null!=(n=this.featureSwitchService)&&n.featureSwitches.vcPadding&&(n=this.getVisualBodyPadding(),i="".concat(n.top,"px ").concat(n.right,"px ").concat(n.bottom,"px ").concat(n.left,"px")),m.getVisualStyleAttributes(t,this.enableVisualScaling?this.uiScale.x:void 0,this.visualBackground&&this.visualBackground.colorRGB,this.visualBorder&&this.visualBorder.getBorderStyle(),this.visualBorder&&this.visualBorder.getBorderRadius(),i,this.visualDropShadow&&this.visualDropShadow.getBoxShadow()));e.visualViewportStyle.addAttributes(n),e.visualViewportStyle.apply()},F.prototype.applyFooterStyle=function(e,t){var i,n;this.isFooterVisible&&this.isFooterVisible()&&(i={},e.footerStyle||(e.footerStyle=new o),n=this.enableVisualScaling?this.uiScale.x:1,i.transform="scale("+n+")",i.width=t+"px",e.footerStyle.addAttributes(i),e.footerStyle.apply())},F.prototype.applyTitleStyle=function(e,t,i){var n,r,a={};this.visualTitleVisible()?(null!=(n=this.featureSwitchService)&&n.featureSwitches.vcPadding&&(a[l.paddingBottomProperty]=this.getSpacing(w.Title)),a[l.visibilityProperty]=l.visibleValue,n=(n=this.contract.config.singleVisual).evaluatedObjects&&n.evaluatedObjects.title||{},i=this.getTitleFontProperties(n,i),a[l.fontSizeProperty]="".concat(i.size.pt,"pt")||"",a[l.fontFamilyProperty]="".concat(i.family)||"",a[l.colorProperty]="".concat(i.color)||"",a[l.textAlignProperty]=n.alignment||"",a[l.backgroundColorProperty]=n.background&&n.background.solid&&n.background.solid.color||"",r=this.isTitleWrappingEnabled?this.visualTitleWrapped.length:1,a[l.heightProperty]=r*m.getTitleHeight(i),this.insetHeaderSize?this.isTitleWrappingEnabled||(r=(t-this.insetHeaderSize.width)/this.uiScale.x,a[l.widthProperty]=r+"px"):a[l.widthProperty]="",a[l.fontWeightProperty]=n.bold?l.boldValue:"",a[l.fontStyleProperty]=n.italic?l.italicValue:"",a[l.textDecoration]=n.underline?l.underlineValue:""):a[l.visibilityProperty]=l.hiddenValue,e.titleStyle||(e.titleStyle=new o),e.titleStyle.addAttributes(a),e.titleStyle.apply()},F.prototype.applySubTitleStyle=function(e,t,i){var n,r,a={};this.visualSubTitleVisible()&&null!=(n=this.featureSwitchService)&&n.featureSwitches.vcPadding?(a[l.paddingBottomProperty]=this.getSpacing(w.SubTitle),a[l.visibilityProperty]=l.visibleValue,n=(n=this.contract.config.singleVisual).evaluatedObjects&&n.evaluatedObjects.subTitle||{},i=this.getSubTitleFontProperties(n,i),a[l.fontSizeProperty]="".concat(i.size.pt,"pt")||"",a[l.fontFamilyProperty]="".concat(i.family)||"",a[l.colorProperty]="".concat(i.color)||"",a[l.textAlignProperty]=n.alignment||"",r=this.isSubTitleWrappingEnabled?this.visualSubTitleWrapped.length:1,a[l.heightProperty]=r*m.getTitleHeight(i),this.insetHeaderSize?this.isSubTitleWrappingEnabled||(r=(t-this.insetHeaderSize.width)/this.uiScale.x,a[l.widthProperty]=r+"px"):a[l.widthProperty]="",a[l.fontWeightProperty]=n.bold?l.boldValue:"",a[l.fontStyleProperty]=n.italic?l.italicValue:"",a[l.textDecoration]=n.underline?l.underlineValue:""):a[l.visibilityProperty]=l.hiddenValue,e.subTitleStyle||(e.subTitleStyle=new o),e.subTitleStyle.addAttributes(a),e.subTitleStyle.apply()},F.prototype.applyDividerStyle=function(e,t){var i,n,r,a={};this.visualDividerVisible()&&null!=(i=this.featureSwitchService)&&i.featureSwitches.vcPadding?(a[l.paddingBottomProperty]=this.getSpacing(w.Divider),a[l.visibilityProperty]=l.visibleValue,r=(i=(i=this.contract.config.singleVisual).evaluatedObjects&&i.evaluatedObjects.divider).width||1,n=i.style||"Solid",t=i.color&&i.color.solid&&i.color.solid.color||t.colorPalette.foregroundNeutralSecondary.value,a[l.borderTopProperty]="".concat(r,"px ").concat(n," ").concat(t),!(!1===i.ignorePadding)?(r=this.getVisualBodyPadding(),a[l.marginLeftProperty]="-".concat(r.left||0,"px"),a[l.marginRightProperty]="-".concat(r.right||0,"px")):(a[l.marginLeftProperty]="",a[l.marginRightProperty]="")):a[l.visibilityProperty]=l.hiddenValue,e.visualsDividerStyle||(e.visualsDividerStyle=new o),e.visualsDividerStyle.addAttributes(a),e.visualsDividerStyle.apply()},F.prototype.applyVisualTitleAreaStyle=function(e){var t,i={};this.visualTitleVisible()&&null!=(t=this.featureSwitchService)&&t.featureSwitches.vcPadding?(t=(t=this.contract.config.singleVisual).evaluatedObjects&&t.evaluatedObjects.title||{},i[l.backgroundColorProperty]=t.background&&t.background.solid&&t.background.solid.color||"",t=this.getVisualBodyPadding(),i[l.marginTopProperty]="-".concat(t.top||0,"px"),i[l.paddingTopProperty]="".concat(t.top||0,"px"),i[l.marginLeftProperty]="-".concat(t.left||0,"px"),i[l.paddingLeftProperty]="".concat(t.left||0,"px"),i[l.marginRightProperty]="-".concat(t.right||0,"px"),i[l.paddingRightProperty]="".concat(t.right||0,"px")):(i[l.backgroundColorProperty]="",i[l.marginTopProperty]="",i[l.paddingTopProperty]="",i[l.marginLeftProperty]="",i[l.paddingLeftProperty]="",i[l.marginRightProperty]="",i[l.paddingRightProperty]=""),e.visualTitleAreaStyle||(e.visualTitleAreaStyle=new o),e.visualTitleAreaStyle.addAttributes(i),e.visualTitleAreaStyle.apply()},F.prototype.getSpacing=function(e){var t=this.contract.config.singleVisual,t=t.evaluatedObjects&&t.evaluatedObjects.spacing;return m.getVisualSpacing(e,t)},F.prototype.getVisualBodyPadding=function(){this.featureSwitchService.featureSwitches.vcPadding;var e=this.contract.config.singleVisual;return m.getVisualBodyPadding(this.visualPadding,null==(e=e.evaluatedObjects)?void 0:e.padding,this.visualBorder&&this.visualBorder.getNumericPaddingFromBorder())},F.prototype.updateVisualDefinition=function(e){var t,i,n=this.contract.config.singleVisual,r=n.visualType;this.visual?((i=this.visual).type!==n.visualType?(i.data=null)!=(t=this.visualHostServices)&&t.onClearLicenseNotification():this.showWatermark&&null!=(t=this.visualHostServices)&&t.onClearLicenseNotification(),i.type=r,i.stylePresetName=n.evaluatedObjects&&n.evaluatedObjects.stylePreset&&n.evaluatedObjects.stylePreset.name,i.hostServices=this.visualHostServices,i.visualAdapterHostServices=this.visualAdapterHostServices,i.orderIndependentSelectorMatching=n.queryOptions&&n.queryOptions.keepProjectionOrder,this.visualPluginOps&&(this.visual.visualRequiresData=this.visualPluginOps.isQueryVisual(r)),this.visual.visualHasData=!!n.query,this.visual.currentZone=this.currentZone):this.visualHostServices&&(this.visual={viewport:e,type:r,visualName:this.contract.name,dataTransforms:{objects:n.objects},hostServices:this.visualHostServices,visualAdapterHostServices:this.visualAdapterHostServices,interactivityOptions:{dragDataPoint:!1,selection:!0,isVisualInteractive:!0},allowInvalidDataView:!0,visualPlugin:this.visualPlugin,themeCollection:this.themeCollection,orderIndependentSelectorMatching:n.queryOptions&&n.queryOptions.keepProjectionOrder},this.visualPluginOps&&(this.visual.visualRequiresData=this.visualPluginOps.isQueryVisual(r)),this.visual.visualHasData=!!n.query)},F.prototype.setViewport=function(e,t){this.runningVisual&&this.setVisualViewport(this.runningVisual,t)},F.prototype.setVisualViewport=function(e,t){var i,n,r;e&&t&&(i=this.viewportResized,this.viewportResized=void 0,r=this.enableVisualScaling?this.uiScale.x:1,!i&&(n=e.getViewport())&&n.height===t.height&&n.width===t.width&&n.scale===r||e.setViewport(__assign(__assign({},t),{scale:r}),i))},F.prototype.getVisualViewport=function(e,t,i,n){var r,a=this.contract.config.singleVisual,o=0,s=(this.visualBorder&&this.visualBorder.visible&&(o=this.visualBorder.getNumericPaddingFromBorder()),this.isPaddingDisabled?2*o:2*(o+h.VisualContainer.VisualContainerDefaultPadding)),o=this.isPaddingDisabled?2*o:2*(o+h.VisualContainer.VisualContainerDefaultPadding),l=(null!=(l=this.featureSwitchService)&&l.featureSwitches.vcPadding&&(s=(l=this.getVisualBodyPadding()).left+l.right,o=l.top+l.bottom),0),u=0,c=0,p=0,e=e-s,n=(this.visualTitleVisible()&&(r=this.getTitleFontProperties(this.visualTitle,n),this.updateVisualTitleWrapping(e,r),u=m.getTitleHeight(r),u*=this.visualTitleWrapped.length||1,null!=(r=this.featureSwitchService))&&r.featureSwitches.vcPadding&&(u+=this.getSpacing(w.Title)),this.visualSubTitleVisible()&&null!=(r=this.featureSwitchService)&&r.featureSwitches.vcPadding&&(r=this.getSubTitleFontProperties(this.visualSubTitle,n),this.updateSubVisualTitleWrapping(e,r),c=m.getTitleHeight(r),c=(c*=this.visualSubTitleWrapped.length||1)+this.getSpacing(w.SubTitle)),this.visualDividerVisible()&&null!=(n=this.featureSwitchService)&&n.featureSwitches.vcPadding&&(l=null!=(r=(a.evaluatedObjects&&a.evaluatedObjects.divider).width)?r:0,l+=this.getSpacing(w.Divider)),this.visualPausedWarning&&(p+=F.VisualBannerHeight),t-o-u-p-c-l),a=this.viewModeState&&this.viewModeState.getConfig().displayOptions.showDetailVisualOnFullScreen;return this.hasDetailVisual()&&!a&&(1===(this.contract.detailVisualLayout||1)?n=(n-o)/2:e=(e-s)/2),{width:Math.max(e,0),height:Math.max(n,0),scale:i}},F.prototype.getTitleFontProperties=function(e,t){var i=u.DataViewObject.getValue(e,"bold"),n=u.DataViewObject.getValue(e,"italic"),r=u.DataViewObject.getValue(e,"underline"),a={color:"fontColor",family:"fontFamily",size:"fontSize"},i=(i&&(a.bold="bold"),n&&(a.italic="italic"),r&&(a.underline="underline"),s.create(t));return u.visuals.FontProperties.createFromObjectOrStyle(e,a,i,t,void 0,C.util.VisualContainerUtils.DefaultTitleTextClass,C.util.VisualContainerUtils.DefaultTitleFontProperties)},F.prototype.getSubTitleFontProperties=function(e,t){var i=u.DataViewObject.getValue(e,"bold"),n=u.DataViewObject.getValue(e,"italic"),r=u.DataViewObject.getValue(e,"underline"),a={color:"fontColor",family:"fontFamily",size:"fontSize"},i=(i&&(a.bold="bold"),n&&(a.italic="italic"),r&&(a.underline="underline"),s.create(t));return u.visuals.FontProperties.createFromObjectOrStyle(e,a,i,t,C.util.VisualContainerUtils.DefaultSubTitleThemeColor,C.util.VisualContainerUtils.DefaultSubTitleTextClass,C.util.VisualContainerUtils.DefaultTitleFontProperties)},F.prototype.updateVisualTitleWrapping=function(e,t){var i,n;this.visualTitle&&this.visualTitle.text&&(i=p.toTextProperties(t),(n=new o).addAttributes({width:"".concat(e,"px")}),n.addAttributes({fontSize:"".concat(t.size.px,"px")}),n.addAttributes({fontWeight:"".concat(t.weight)}),1===this.headerTitleMaxLines?this.visualTitleWrapped=[{text:this.visualTitle.text.trim(),style:n}]:(t=b.splitByWidth(this.visualTitle.text,i,v.measureSvgTextWidth,e,this.headerTitleMaxLines,null,!0),this.visualTitleWrapped=t.map((function(e){return{text:e.trim(),style:n}}))))},F.prototype.updateSubVisualTitleWrapping=function(e,t){var i,n;this.visualSubTitle&&this.visualSubTitle.text&&(i=p.toTextProperties(t),(n=new o).addAttributes({width:"".concat(e,"px")}),n.addAttributes({fontSize:"".concat(t.size.px,"px")}),n.addAttributes({fontWeight:"".concat(t.weight)}),1===this.headerSubTitleMaxLines?this.visualSubTitleWrapped=[{text:this.visualSubTitle.text.trim(),style:n}]:(t=b.splitByWidth(this.visualSubTitle.text,i,v.measureSvgTextWidth,e,this.headerSubTitleMaxLines,null,!0),this.visualSubTitleWrapped=t.map((function(e){return{text:e.trim(),style:n}}))))},F.prototype.hasDetailVisual=function(){return this.showDetailVisual()||this.showVisualCalcEditor()},F.prototype.showDetailVisual=function(){return 2===this.contract.visibility||8===this.contract.visibility},F.prototype.showVisualCalcEditor=function(){return 16===this.contract.visibility},F.prototype.useStylableHeader=function(){return F.useStylableHeader(this.explorationCapabilities)},F.useStylableHeader=function(e){return e&&e.getCapabilities().visualContainerOptions.useStylableHeader},F.prototype.configureInitializationSpinner=function(e){var t=this;this.showInitializationSpinner=!0,e.catch((function(e){})).finally((function(){t.showInitializationSpinner=!1,t.contract.postProcessing=void 0}))},F.VisualContainerHeaderHeight=20,F.VisualContainerFooterHeight=34,F.VisualContainerDefaultPadding=5,F.PopOutBarHeight=40,F.HeaderInTitleScaleThreshold=.9,F.VisualBannerHeight=38,F.VisualBannerPaddingTopPopOutMode=3,F.VisualHeaderBackgroundColor={R:255,G:255,B:255},F.VisualHeaderTransparency=0,e=F,h.VisualContainer=e})(powerbi=powerbi||{}),(function(e){var t;e=(e=e.explore||(e.explore={})).viewModels||(e.viewModels={}),(t=e.VisualizationPaneSectionType||(e.VisualizationPaneSectionType={}))[t.Fields=0]="Fields",t[t.Format=1]="Format",t[t.Analytics=2]="Analytics",(t=e.PagePaneSectionType||(e.PagePaneSectionType={}))[t.Fields=0]="Fields",t[t.Format=1]="Format"})(powerbi=powerbi||{}),(function(t){var i,e,n,r,a,o,s,p;function c(e,t,i,n,r,a,o,s,l,u){this.clipboardService=e,this.selectionService=t,this.viewModeState=i,this.undoRedoService=n,this.visualAuthoring=r,this.eventBridge=a,this.visibilityService=o,this.formFactor=s,this.layoutAuthoring=l,this.telemetryService=u,this.debouncedLogScanKeyEvent=_.debounce(this.logScanKeyEvent,c.DebounceWait)}i=t.explore||(t.explore={}),e=i.services||(i.services={}),n=t.explore.util.CanvasVisualsUtility,r=jsCommon.DOMConstants,a=jsCommon.FocusNavigationUtility,o=t.a11y.util.FocusUtility,s=i.services.selectionUtils,e.createCanvasKeyHandlerService=function(e,t,i,n,r,a,o,s,l,u,c){return new p(e,t,n,r,a,o,s,l,u,c)},c.prototype.getVisualInteractivityDisabled=function(){return this.visualInteractivityDisabled},c.prototype.setVisualInteractivityDisabled=function(e){this.visualInteractivityDisabled=!!e},c.prototype.onKeyDown=function(e,t){if(this.debouncedLogScanKeyEvent(e),this.isSaveEvent(e))return this.onSave(),this.preventStopAndReturnFalse(e);if(this.isClearEvent(e))return this.onClear(),this.preventStopAndReturnFalse(e);var i=this.formFactor.getCurrentLayoutCapabilities();if(0!==this.viewModeState.getMode()){if(this.isDeleteEvent(e)&&!this.isFocusedOnTextElement()&&!this.visibilityService.get())return i.canRemoveVisualFromLayout()?this.onRemoveFromLayout(e,t):i.canDelete()&&this.onDelete(e,t),this.preventStopAndReturnFalse(e);var n=e.which;if(this.isCtrlOrMeta(e)&&!this.isFocusedOnTextElement()){var r=!_.isEmpty(this.selectionService.getSelectedElements());switch(n){case 65:return this.onSelectAll(e,t),this.preventStopAndReturnFalse(e);case 67:return!i.canCutCopyPaste()||!r||(this.onCopy(e),this.preventStopAndReturnFalse(e));case 88:return!i.canCutCopyPaste()||!r||(this.onCut(e),this.preventStopAndReturnFalse(e));case 86:return i.canCutCopyPaste()&&this.onPaste(e),this.preventStopAndReturnFalse(e);case 89:return this.onRedo(),this.preventStopAndReturnFalse(e);case 90:return this.onUndo(),this.preventStopAndReturnFalse(e);case 191:return this.onShowQna(),this.preventStopAndReturnFalse(e);case 40:return e.shiftKey?(this.onApplyAllSlicers(),this.preventStopAndReturnFalse(e)):!0;case 71:return e.shiftKey?this.onUnGroup():this.onGroup(),this.preventStopAndReturnFalse(e);case 77:return this.onMergeGroup(),this.preventStopAndReturnFalse(e)}}}return i.canPassUnhandledKeysToSelectedVisual()?this.allowSelectedVisualContainerToHandle(e,t):void 0},c.prototype.logScanKeyEvent=function(e){0!==this.viewModeState.getMode()||this.isFocusedOnTextElement()||e.ctrlKey||e.metaKey||e.altKey||!_.includes(r.scanModeKeys,e.keyCode)||this.telemetryService.logEvent(t.telemetry.EXScanModeKeyPressed)},c.prototype.isFocusedOnTextElement=function(){var e=document.activeElement;return a.isElementContentEditable(e)||a.isTextElement(e)},c.prototype.allowSelectedVisualContainerToHandle=function(e,t){if(!this.visualInteractivityDisabled&&o.isFocusInTree(".visualContainer")){var i=s.getSelectedVisual(this.selectionService);if(i){t=n.findVisualContainerViewModel(t.visualContainers,i);if(t)return t.handleKeyDown(e)}}},c.prototype.preventStopAndReturnFalse=function(e){return e&&(e.preventDefault(),e.stopPropagation()),!1},c.prototype.onApplyAllSlicers=function(){this.eventBridge.publishToChannel(e.events.applyAllSlicersClicked)},c.prototype.onUndo=function(){this.undoRedoService.undo()},c.prototype.onRedo=function(){this.undoRedoService.redo()},c.prototype.onCopy=function(e){this.canCopyOrCut()&&this.clipboardService.copy()},c.prototype.onCut=function(e){this.canCopyOrCut()&&this.clipboardService.cut()},c.prototype.onPaste=function(e){this.clipboardService.paste()},c.prototype.onRemoveFromLayout=function(e,t){this.layoutAuthoring.removeLayoutFromSelectedVisuals(t)},c.prototype.onDelete=function(e,t){var i=this;this.undoRedoService.register("CanvasKeyDelete",(function(){i.visualAuthoring.deleteSelectedVisuals(t)}))},c.prototype.onSelectAll=function(e,t){t=t.visualContainerGroups?_.map(t.visualContainerGroups,(function(e){return e.contract})):_.map(t.visualContainers,(function(e){return e.contract}));s.selectCanvasItems(t,this.selectionService)},c.prototype.onSave=function(){this.eventBridge.publishToChannel(e.events.saveKeyPressedEvent)},c.prototype.onClear=function(){this.eventBridge.publishToChannel(e.events.resetUserStateKeyPressedEvent)},c.prototype.onShowQna=function(){this.eventBridge.publishToChannel(e.events.addQnaContainer,{creationSource:7})},c.prototype.onGroup=function(){this.layoutAuthoring.groupCanvasItems(s.getSelectedCanvasItems(this.selectionService))},c.prototype.onUnGroup=function(){var t=this,e=s.getSelectedCanvasItems(this.selectionService);_.forEach(e,(function(e){e=i.contracts.isVisualContainerGroup(e)?e:e.parentGroup;e&&t.layoutAuthoring.ungroupCanvasItems(e)}))},c.prototype.onMergeGroup=function(){this.layoutAuthoring.canMergeCanvasItems()&&this.layoutAuthoring.mergeCanvasItemContainers(s.getSelectedCanvasItems(this.selectionService))},c.prototype.isSaveEvent=function(e){return this.isOnlyCtrlOrMeta(e)&&83===e.which},c.prototype.isDeleteEvent=function(e){return!e.ctrlKey&&46===e.which},c.prototype.canCopyOrCut=function(){return!this.visibilityService.get()},c.prototype.isClearEvent=function(e){return e.altKey&&e.shiftKey&&82===e.which},c.prototype.isCtrlOrMeta=function(e){var t=e.ctrlKey,i=e.metaKey;return e&&(t&&!i||!t&&i)},c.prototype.isOnlyCtrlOrMeta=function(e){return this.isCtrlOrMeta(e)&&!e.altKey&&!e.shiftKey},c.DebounceWait=100,p=c})(powerbi=powerbi||{}),(function(e){var t,s;function i(e,t,i,n,r,a){this.eventBridge=e,this.explorationNavigation=t,this.formFactorProvider=i,this.visibility=n,this.viewModeState=r,this.overlayService=a,this.displayAreaScale=1,this.wallpaperScale=1}e=e.explore||(e.explore={}),(t=e.services||(e.services={})).createCanvasScaleService=function(e,t,i,n,r,a,o){return new s(e,t,n,r,a,o)},i.prototype.setDisplayAreaScaleFactor=function(e){this.displayAreaScale=e,this.eventBridge.publishToChannel(t.events.canvasZoomScaleUpdated,e)},i.prototype.setWallpaperScaleFactor=function(e){this.wallpaperScale=e},i.prototype.getDisplayAreaScaleFactor=function(){return this.displayAreaScale},i.prototype.getWallpaperScaleFactor=function(){return this.wallpaperScale},i.prototype.getDisplayOption=function(){var e;return 1===this.formFactorProvider.getCurrentLayout()&&1===this.viewModeState.getMode()||null!=this.canvasZoom?3:this.visibility.get()?0:null!=this.overrideDisplayOption?this.overrideDisplayOption:(e=this.explorationNavigation.getCurrentSection())?e.size.displayOption:void 0},i.prototype.setDisplayOption=function(e){var t=this.explorationNavigation.getCurrentSection();t&&(this.canvasZoom=void 0,this.overlayService.hideAllDropdowns(),t.size.displayOption=e)},i.prototype.setCanvasZoom=function(e){this.overlayService.hideAllDropdowns(),this.canvasZoom=e},i.prototype.getCanvasZoom=function(){return this.canvasZoom},s=i})(powerbi=powerbi||{}),(function(e){(e=(e=(e=e.explore||(e.explore={})).services||(e.services={})).events||(e.events={})).visualCustomCommand={type:2,name:"visualCustomCommand"},e.preparePersonalVisuals={type:2,name:"preparePersonalVisuals"},e.copyVisualAsImage={type:2,name:"copyVisualAsImage"},e.VisualContainerAdded={type:2,name:"VisualContainerAdded"}})(powerbi=powerbi||{}),(function(e){var i;function t(e,t){var i=!t||t.featureSwitches.contentAuthoringUIEnabled,n=!!e&&!!e.isGuestUser,t=!!t&&t.featureSwitches.elevatedGuestsTenantEnabled,t=n&&!t,e=!(!e||void 0===e.userLicense)&&"Free"===e.userLicense();this.options={shouldSetFocus:!0,showAppBar:!0,showStatusBar:!1,showTaskPane:!0,showVisualizationPane:!0,showNavContentPane:!0,visualContainerOptions:{showMenu:!0,showPin:!0,showContextMenu:!0,disablePin:t||!i,disableQueryCacheUpdates:!1},showBackButtonOnAppBar:!1,disablePin:t||!i,disableSharePointEmbed:n,disableSecurePublishToWeb:n||!i,disableQRGeneration:n,disableSaveAs:t||e,disableSwitchMode:t||!i,disableAnalyzeInExcel:n,expandTaskPane:!0,expandVisualizationPane:!0,allowVisualContainerPreload:!1,allowNewLoadingExperience:!1,persistentUserStateEnabled:!1,persistentUserStateThrottlingEnabled:!1,defaultPersonalBookmarkEnabled:!1,disableEditVariables:!0,disableChangeDetectionDialog:!0,showCopyVisualImageButton:!1}}((e=e.explore||(e.explore={})).services||(e.services={})).createExplorationCapabilitiesService=function(e,t){return new i(e,t)},t.prototype.setCapabilities=function(e){_.merge(this.options,e)},t.prototype.getCapabilities=function(){return this.options},i=t})(powerbi=powerbi||{}),(function(e){var t;function i(e,t){this.emptySpaceMinWidth=e,this.emptySpaceMinHeight=t}((e=e.explore||(e.explore={})).services||(e.services={})).createLayoutInsertionHelper=function(){return new t(150,150)},i.prototype.getEmptySpaces=function(e,t){for(var i=this.getNonOverlapingRects(e,t),n=[],r=0,a=this.filterWithMinimumWidth(i);r<a.length;r++){var o=a[r],o=this.extendRect(o,i);o.height>=this.emptySpaceMinHeight&&n.push(o)}return n},i.prototype.getNonOverlapingRects=function(e,t){if(!t.length)return[];for(var i=[e],n=0,r=t;n<r.length;n++){for(var a=r[n],o=[],s=0,l=i;s<l.length;s++)var u=l[s],o=o.concat(this.splitRectangleOnIntersection(u,a));i=o}return i},i.prototype.getIntersectingRectangle=function(e,t){var i=Math.max(e.x,t.x),n=Math.min(e.x+e.width,t.x+t.width),r=Math.max(e.y,t.y),e=Math.min(e.y+e.height,t.y+t.height);return i<=n&&r<=e?{x:i,y:r,width:n-i,height:e-r}:null},i.prototype.extendRect=function(e,t){for(var i,n=!1,r=0,a=t;r<a.length;r++){var o,s,l,u,c=a[r];c===e||(s=o=!1,this.doIntersect(c,e)&&(o=c.y+c.height===e.y,s=c.y===e.y+e.height),c.width<e.width)||(s?(l={x:e.x,y:e.y,width:e.width,height:e.height+c.height},(u=this.getIntersectingRectangle(l,c))&&u.width===l.width&&(n=!0,i=l)):o&&(l={x:e.x,y:c.y,width:e.width,height:e.height+c.height},u=this.getIntersectingRectangle(l,c))&&u.width===l.width&&(n=!0,i=l))}return n?this.extendRect(i,t):e},i.prototype.doIntersect=function(e,t){return!(t.x>e.x+e.width||t.x+t.width<e.x||t.y>e.y+e.height||t.y+t.height<e.y)},i.prototype.filterWithArea=function(e){for(var t=[],i=0,n=e;i<n.length;i++){var r=n[i];0<r.width&&0<r.height&&t.push(r)}return t},i.prototype.filterWithMinimumWidth=function(e){for(var t=[],i=0,n=e;i<n.length;i++){var r=n[i];r.width>=this.emptySpaceMinWidth&&t.push(r)}return t},i.prototype.splitRectangleOnIntersection=function(e,t){t=this.getIntersectingRectangle(e,t);return t?this.filterWithArea([{x:e.x,y:e.y,width:e.width,height:t.y-e.y},{x:e.x,y:t.y+t.height,width:e.width,height:e.y+e.height-(t.y+t.height)},{x:e.x,y:t.y,width:t.x-e.x,height:t.height},{x:t.x+t.width,y:t.y,width:e.x+e.width-(t.x+t.width),height:t.height}]):[e]},t=i})(powerbi=powerbi||{}),(function(d){var v,e,a,o,r,m,s,g,y,u;function l(e,t,i,n,r,a,o,s,l){this.conceptualSchemaProxy=e,this.displayNameService=t,this.dataProxy=i,this.resourcePackagesService=n,this.visualQueryGenerator=r,this.visualPlugin=a,this.visualPluginOps=o,this.visualCapabilitiesService=s,this.featureSwitchService=l}v=d.explore||(d.explore={}),e=v.services||(v.services={}),a=jsCommon.ArrayExtensions,o=d.data.QueryProjectionsByRole,r=d.visualHost.utils.ResourcePackageUtils,m=d.visualHost.ThemeUtils,s=jsCommon.Trace,g=d.data.dsr.transformDataQueryToSemanticQueryDataShapeCommand,y=v.util.VisualContainerUtils,e.canPinVisualType=function(e,t,i,n){return null!=n&&null!=e.getPlugin(n)&&!i.hasFilterCapabilities(n)&&n!==d.visuals.plugins.basicShape.name&&n!==d.visuals.plugins.pageNavigator.name&&n!==d.visuals.plugins.bookmarkNavigator.name&&!t.isAnalysisVisual(n)&&!t.isQnaVisual(n)},e.createPinVisualService=function(e,t,i,n,r,a,o,s,l){return new u(e,t,i,r,a,o,s,l,n)},l.prototype.getPinData=function(e,t,i,n,r,a,o,s,l,u){var c,p,h=e.config.singleVisual,u=(o?(c=o.options.query.command,r=(s=y.describeForPinning(this.displayNameService,s,h.query,h.columnProperties,this.visualPlugin.capabilities(h.visualType),this.featureSwitchService.featureSwitches,r?r.filterMetadata:null)).queryMetadata,p=_.clone(e),u&&0<(u=(!!o.filterContext&&!!o.filterContext.dataFilters&&o.filterContext.dataFilters.map((function(e){return e.filter}))||[]).concat(!!o.filterContext&&o.filterContext.highlightFilters||[])).length&&(p.filters=u.map((function(e){return v.FilterUtils.deriveFromSQFilters(e.from(),e.where(),null)})).reduce((function(e,t){return e.concat(t)}))),c={dataTransforms:o.transforms,dataViewSource:a?a.dataViewSource:null,elements:s.visualElements,query:c,queryMetadata:r,themeCollection:m.cloneThemeCollection(n),tileLayoutType:t,visualContainer:p},d.data.DataViewObjectDefinitions.getValue(e.config.singleVisual.vcObjects,{objectName:"title",propertyName:"text"},void 0)||this.setPinDataHeadings(a,r,c)):c={dataViewSource:{data:void 0},themeCollection:m.cloneThemeCollection(n),tileLayoutType:t,visualContainer:e},d.explore.dataReaderPlugins.getExplorationDataReaderDataSource(i)),o=u&&u.getModelExtensions(),s=u&&u.getDataSourceVariables();return o&&(c.modelExtensions=o),s&&(c.dataSourceVariables=s),this.addResourcePackageIdsToPinData(h.visualType,c,l)},l.prototype.setPinDataHeadings=function(e,t,i){e=e&&e.dataViewSource&&e.dataViewSource.data.descriptor;if(e)var e=new d.data.dsr.QueryDescription(t,e),n=e.getMeasureRestatements(),r=e.getFilterRestatements(),a=e.getGroupRestatements();else{for(var o=[],s=[],l=0,u=t.Select;l<u.length;l++){var c=u[l];3===c.Type||1===c.Type?o.push(c.Restatement):4!==c.Type&&2048!==c.Type||s.push(c.Restatement)}0<s.length&&(a=s),0<o.length&&(n=o)}n?i.tileHeading=this.joinList(n):a&&(i.tileHeading=this.joinList(a)),r&&(i.tileFilterDetails=this.joinList(r)),n&&a&&(i.tileSubDisplay=d.common.getLocalize().format("TileHeadings_By",[this.joinList(a)]))},l.prototype.joinList=function(e){return e.join(d.common.getLocalize().get("ListJoin_Separator"))},l.prototype.pinVisualContainer=function(e,t,i,n,r,a){var o=this;this.getPinDataAsync(e,t,i,n,r,a).then((function(e){o.handler&&o.handler.pinVisual(e)}),(function(){}))},l.prototype.getPinDataAsync=function(s,l,u,c,p,h){return __awaiter(this,void 0,d.Promise,(function(){var t,i,n,r,a,o;return __generator(this,(function(e){switch(e.label){case 0:return t=l.config.singleVisual,i=t.visualType,n=i===d.visuals.plugins.image.name?1:0,[4,this.conceptualSchemaProxy.get(s)];case 1:return(r=e.sent(),this.visualQueryGenerator.shouldExecute(t,s)&&(a=d.common.GridLayoutConstants.getDefaultGridItemViewport(d.common.GridLayoutConstants.getMediumLandscapeGridItem()),a=this.visualQueryGenerator.execute({config:t,dataSources:s,schema:r,additionalFilters:u,dataWindow:a,ignoreViewportForCache:!0,allowClientSideFilters:!1})),a)?(o=a.options.query.command,o=g(o),this.modifyPinnedVisualDataShapeBinding(o.Binding,t.query,r,i),[4,this.dataProxy.execute(a.options)]):[3,3];case 2:return o=e.sent(),[2,this.getPinData(l,n,s,c,u,o,a,r,p,h)];case 3:return[2,this.getPinData(l,n,s,c,null,null,null,null,p)]}}))}))},l.prototype.canPinVisualType=function(e){return d.explore.services.canPinVisualType(this.visualPlugin,this.visualPluginOps,this.visualCapabilitiesService,e)},l.prototype.setHandler=function(e){this.handler=e},l.prototype.modifyPinnedVisualDataShapeBinding=function(e,t,i,n){var r;e&&(r=this.visualPlugin.capabilities(n),l.isTableOrMatrix(n)?(e.DataReduction||(e.DataReduction={}),e.DataReduction.Primary={Window:{Count:100}}):l.supportsScalarCategoryAxis(r)&&(n=t.projections,r=t.defn.select(),e.DataReduction&&(e.DataReduction.Primary&&e.DataReduction.Primary.BinnedLineSample||e.DataReduction.Intersection&&e.DataReduction.Intersection.BinnedLineSample)||n&&!_.isEmpty(r)&&(t=o.getRole(n,"Category"))&&!_.isEmpty(t.all())&&(n=t.getLastActiveQueryReference()||t.all()[0].queryRef,t=a.findItemWithName(r,n))&&(r=t.expr.getMetadata(i))&&0===r.kind&&r.type.dateTime&&(e.DataReduction||(e.DataReduction={}),e.DataReduction.Primary={Bottom:{}})))},l.prototype.addResourcePackageIdsToPinData=function(e,t,i){var n,r=[];return this.visualPlugin.isCustomVisual(e)&&(e=this.resourcePackagesService.getPackage(e))&&0<e.id&&r.push(e.id),i&&(n=t.themeCollection).customTheme&&this.addResourcePackageIdIfNeeded(i,n.customTheme.type,(function(e){return e.name===n.customTheme.name}),r),_.isEmpty(r)||(t.resourcePackageIds=_.uniq(r)),t},l.prototype.addResourcePackageIdIfNeeded=function(e,t,i,n){e=r.findResourcePackage(e,t);e&&null==e.id&&s.error("Resource package should have an ID"),e&&null!=e.id&&_.find(e.items,i)&&n.push(e.id)},l.supportsScalarCategoryAxis=function(e){return e.objects&&e.objects.categoryAxis&&e.objects.categoryAxis.properties&&void 0!==e.objects.categoryAxis.properties.axisType},l.isTableOrMatrix=function(e){var t=d.visuals.plugins;return e===t.table.name||e===t.matrix.name||e===t.tableEx.name||e===t.pivotTable.name},u=l})(powerbi=powerbi||{}),(function(l){var e,t,u,c,p,h,d,i,a;function n(e,t,i,n){this.localizationService=e,this.telemetryService=t,this.visualAuthoring=i,this.visualPlugin=n}e=l.explore||(l.explore={}),t=e.services||(e.services={}),u=l.data.FieldExprPattern,c=e.viewModels.ShowValueAsNoCalculation,p=e.viewModels.ShowValueAsPercentOfGrandTotalCalculation,h=e.viewModels.ShowValueAsPercentOfRoleTotalCalculation,d=l.data.SQExprConverter,i=l.data.SQExprUtils,t.createShowValueAsService=function(e,t,i,n,r){return new a(e,i,n,r)},n.prototype.createShowValueAsMenuItems=function(e,t,i){var n=u.getSchema(d.asFieldPattern(e));if(!t.schema(n).capabilities.supportsScopedEval)return[];var r=[];if(this.aggregateSupportsShowValueAs(e,t)){n=new c(l.common.getLocalize()),e=(r.push(this.showValueAsMenuItemBuilder(n)),new p(l.common.getLocalize())),t=(r.push(this.showValueAsMenuItemBuilder(e)),this.visualPlugin.capabilities(i)),n=t&&t.dataRoleTotals;if(!_.isEmpty(n))for(var a=0,o=n;a<o.length;a++){var s=o[a],s=new h(this.localizationService,s.roles,l.data.getDisplayName(s.displayName,this.localizationService));r.push(this.showValueAsMenuItemBuilder(s))}}return r},n.prototype.applyShowValueAs=function(t,i,n){return __awaiter(this,void 0,l.Promise,(function(){return __generator(this,(function(e){switch(e.label){case 0:return[4,this.visualAuthoring.applyShowValueAs(t,i,n)];case 1:return e.sent()&&this.telemetryService.logEvent(l.telemetry.EXChangeQuickCalc,{original:this.showValueAsKindToTelemetryId(i.kind),target:this.showValueAsKindToTelemetryId(n.kind)}),[2]}}))}))},n.prototype.showValueAsMenuItemBuilder=function(e){var t={type:0};return t.key={action:32,showValueAs:e},t.text=e.name,t},n.prototype.aggregateSupportsShowValueAs=function(e,t){t=e.getMetadata(t);return t&&t.type&&t.type.numeric&&i.isMeasure(e)},n.prototype.showValueAsKindToTelemetryId=function(e){switch(e){case void 0:return"None";case 0:return"PercentOfGrandTotal";case 1:return"PercentOfRoleTotal"}},a=n})(powerbi=powerbi||{}),(function(e){var t,n,r,i;function a(e,t){this.visualContainer=e,this.visualPluginOps=t}t=(t=e.explore||(e.explore={})).services||(t.services={}),n=e.data.DataViewQueryEngine,r=e.explore.util.VisualContainerUtils,t.createVisualContainerDataSelectionService=function(e,t){return new i(e,t)},a.prototype.getSelectedValues=function(e,t){var i;return t&&e.valueDetails?(t=this.filterThroughValueDetails(e.valueDetails,e.metadata),this.amendIdentityToValueDetails(e,t)):(t=r.getVisualType(this.visualContainer.contract),i=r.getVisualQuery(this.visualContainer.contract),t=this.visualPluginOps.dataViewKinds(t,i),n.query(this.getDataViews(),e,t))},a.prototype.filterThroughValueDetails=function(e,t){return t?_.filter(e,(function(e){return _.includes(t,e.queryName)})):e},a.prototype.amendIdentityToValueDetails=function(e,t){for(var i=[],n=0,r=t;n<r.length;n++){var a=r[n];i.push({queryName:a.queryName,identity:a.identity||e.dataMap&&_.values(e.dataMap)[0][0],expr:a.expr,value:a.value,formattedValue:a.formattedValue})}return i},a.prototype.getDataViews=function(){var e=this.visualContainer&&this.visualContainer.getRunningVisual();return e&&e.getDataViews()},i=a,t.VisualContainerDataSelectionService=i})(powerbi=powerbi||{}),(function(i){var n,c,o,k,e,h,s,l,u,p,d,X,v,m,g,L,y,R,f,C,S,E,b,w;function t(e,t,i,n,r,a,o,s,l,u){u=c.call(this,"Slicer_SearchBox_Text",void 0,"itemIcon glyphicon pbi-glyph-search glyph-small",u&&u.search)||this;return u.visualContainer=e,u.filterGenerator=t,u.overlayService=i,u.undoRedo=n,u.visualAuthoring=r,u.visualPlugin=a,u.menuOptions=o,u.contextActivityService=s,u.source=l,u.selected=u.isSearchOn,u}function r(e,t,i,n,r,a,o,s,l,u,c,p){p=h.call(this,"ExportData_MenuItem",void 0,"itemIcon glyphicon pbi-glyph-export glyph-small",p&&p.exportData)||this;return p.visualContainer=e,p.conceptualSchemaProxy=t,p.dataSources=i,p.eventBridge=n,p.featureSwitchService=r,p.filterGenerator=a,p.overlayService=o,p.menuOptions=s,p.explorationSettings=l,p.contextActivityService=u,p.source=c,p}function a(e,t,i,n,r,a){a=s.call(this,"AddComment",void 0,"itemIcon glyphicon glyph-small pbi-glyph-comment",a&&a.addComment)||this;return a.visualContainer=e,a.eventBridge=t,a.menuOptions=i,a.contextActivityService=n,a.source=r,a}function x(e,t,i,n,r,a,o,s){s=l.call(this,"Reflex_Trigger",void 0,"itemIcon glyphicon glyph-small pbi-glyph-lightning-bolt",s&&s.reflexTrigger)||this;return s.visualContainer=e,s.selection=t,s.paneVisibilityService=i,s.featureSwitchService=n,s.explorationCapabilitiesService=r,s.contextActivityService=a,s.source=o,s}function V(e,t,i,n,r,a,o){o=u.call(this,"Edit_ToolTip",void 0,"itemIcon glyphicon pbi-glyph-edit glyph-mini",o&&o.enterAdvancedEditMode)||this;return o.visualContainer=e,o.eventBridge=t,o.overlayService=i,o.menuOptions=n,o.contextActivityService=r,o.source=a,o}function F(e,t,i,n,r,a,o){o=p.call(this,"Remove_visual",void 0,"itemIcon glyphicon pbi-glyph-close glyph-mini",o&&o.removeVisual)||this;return o.visualContainer=e,o.eventBridge=t,o.undoRedo=i,o.menuOptions=n,o.contextActivityService=r,o.source=a,o}function P(e,t,i,n,r,a,o,s){e=d.call(this,e,void 0,t,s&&s.clusters)||this;return e.visualContainer=i,e.eventBridge=n,e.menuOptions=r,e.contextActivityService=a,e.source=o,e}function H(e,t,i,n,r,a){return X.call(this,"Visual_Cluster_FindGroups","itemIcon glyphicon pbi-glyph-scatter glyph-small",e,t,i,n,r,a)||this}function T(e,t,i,n,r,a){a=v.call(this,"Spotlight",void 0,"itemIcon glyphicon pbi-glyph-flashlight glyph-small",a&&a.spotlight)||this;return a.visualContainer=e,a.visibility=t,a.menuOptions=i,a.contextActivityService=n,a.source=r,a.selected=a.isSpotlightOn,a}function A(e,t,i,n,r,a,o){o=m.call(this,"ChatInTeams",void 0,"itemIcon glyphicon glyph-small pbi-glyph-teamslogo",o&&o.shareToTeams)||this;return o.visualContainer=e,o.visibility=t,o.eventBridge=i,o.menuOptions=n,o.contextActivityService=r,o.source=a,o}function D(e,t,i,n,r,a,o,s,l,u,c,p){e=g.call(this,e,void 0,t,c&&c.sort,void 0,void 0,p)||this;return e.sortDirection=i,e.visualContainer=n,e.eventBridge=r,e.overlayService=a,e.menuOptions=o,e.sortGroup=s,e.contextActivityService=l,e.source=u,e.selected=e.isHighlighted,e}function z(e,t,i,n,r,a,o,s,l){return L.call(this,"Sort_Desc","itemIcon glyphicon pbi-glyph-ztoa glyph-small",2,e,t,i,n,r,a,o,s,l)||this}function U(e,t,i,n,r,a,o,s){return R.call(this,"Sort_Asc","itemIcon glyphicon pbi-glyph-atoz glyph-small",1,e,t,i,n,r,a,o,s)||this}function M(e,t,i,n,r,a,o){var s=C.call(this,"MobileFooter_SortBy",void 0,void 0,o&&o.sort)||this;return s.visualContainer=e,s.eventBridge=t,s.overlayService=i,s.menuOptions=n,s.contextActivityService=r,s.source=a,s.displayOverride=o,s}function I(e,t,i,n,r,a,o,s){var l=S.call(this,"Sort_Group"+r.displayName,void 0,void 0,s&&s.sort)||this;return l.visualContainer=e,l.eventBridge=t,l.overlayService=i,l.menuOptions=n,l.sortGroup=r,l.contextActivityService=a,l.source=o,l.displayOverride=s,l}function N(e,t,i,n,r,a,o,s){s=E.call(this,t.displayName,void 0,void 0,s&&s.sort)||this;return s.visualContainer=e,s.sortField=t,s.sortDirectionKey=i,s.eventBridge=n,s.overlayService=r,s.contextActivityService=a,s.source=o,s.selected=s.sortField.active,s}function O(e,t,i,n,r,a,o){o=w.call(this,"AutomatedInsights_AppBar_GetInsights",void 0,"itemIcon glyphicon pbi-glyph-insight glyph-small",o&&o.insightsAnalysis)||this;return o.visualContainer=e,o.menuOptions=t,o.lazyScoped=i,o.telemetryService=n,o.contextActivityService=r,o.source=a,o}function B(e,t,i,n){return t.createActivity({name:"VisualAction",visualName:e,data:{action:i,source:n}})}n=i.explore||(i.explore={}),o=n.services||(n.services={}),k=i.explore.services.selectionUtils,c=o.VisualContainerMenuCommand,__extends(t,c),t.prototype.execute=function(){return __awaiter(this,void 0,i.Promise,(function(){var t;return __generator(this,(function(e){return this.overlayService,this.undoRedo,this.visualAuthoring,t=B(this.visualContainer.name,this.contextActivityService,"ToggleSearch",this.source),this.visualAuthoring.toggleSlicerVisualSearch(this.visualContainer.contract,this.filterGenerator,this.visualPlugin),this.overlayService.hideAllDropdowns(),this.announceSelectionState(this.visualContainer.visualHostServices,this.isSearchOn),t.resolve(),[2]}))}))},t.prototype.isVisible=function(){return __awaiter(this,void 0,i.Promise,(function(){return __generator(this,(function(e){return[2,this.menuOptions.canSearch&&c.prototype.isVisible.call(this)]}))}))},Object.defineProperty(t.prototype,"isSearchOn",{get:function(){var e,t=this.visualContainer.contract.config.singleVisual;return t&&t.objects&&(e=n.util.VisualContainerUtils.getVisualCapabilities(this.visualContainer.contract,this.visualPlugin))&&(e=this.filterGenerator.tryGetSelfFilterEnabledProperty(e))&&(t=i.data.DataViewObjectDefinitions.getValue(t.objects,e,null))&&t.value||!1},enumerable:!1,configurable:!0}),e=t,o.ToggleSearchCommand=e,h=o.VisualContainerMenuCommand,__extends(r,h),r.prototype.execute=function(){return __awaiter(this,void 0,i.Promise,(function(){var t,i,n,r,a;return __generator(this,(function(e){switch(e.label){case 0:this.conceptualSchemaProxy,this.dataSources,this.eventBridge,this.overlayService,t=B(this.visualContainer.name,this.contextActivityService,"ExportVisualData",this.source),i=this.visualContainer.getRunningVisual(),n=this.visualContainer.visualTitle,n=null!=n?n.text:"",r=this.dataSources.get(),e.label=1;case 1:return e.trys.push([1,3,4,5]),[4,this.conceptualSchemaProxy.get(r)];case 2:return a=e.sent(),this.eventBridge.publishToChannel(o.events.exportVisualData,{visualData:{data:i.getData(),dataTransforms:i.getDataTransforms()},visualContainer:this.visualContainer.contract,visualTitle:n,additionalFilters:this.visualContainer.hostServices.getFilters(this.filterGenerator,a)}),[3,5];case 3:return e.sent(),[3,5];case 4:return this.overlayService.hideAllDropdowns(),t.resolve(),[7];case 5:return[2]}}))}))},r.prototype.isVisible=function(){return __awaiter(this,void 0,i.Promise,(function(){return __generator(this,(function(e){return[2,this.menuOptions.canExport&&h.prototype.isVisible.call(this)]}))}))},r.prototype.isDisabled=function(){return __awaiter(this,void 0,i.Promise,(function(){return __generator(this,(function(e){switch(e.label){case 0:return[4,h.prototype.isDisabled.call(this)];case 1:return[2,e.sent()||this.explorationSettings&&this.explorationSettings.exportDataMode&&2===this.explorationSettings.exportDataMode||this.menuOptions.exportDataDenied||this.featureSwitchService.featureSwitches.disableExportDataOnVisualError&&this.visualHasError()||!!this.visualContainer.visualPausedWarning]}}))}))},r.prototype.visualHasError=function(){return!!this.visualContainer.errorInfo},r.prototype.getToolTip=function(t){return __awaiter(this,void 0,i.Promise,(function(){return __generator(this,(function(e){switch(e.label){case 0:return[4,this.isDisabled()];case 1:return e.sent()?this.menuOptions.exportDataDenied?[2,t.get("ExportData_DeniedTooltip")]:this.visualHasError()?[2,t.get("VisualContainer_ExportDataDisabled_VisualError_Tooltip")]:[2,t.get("VisualContainer_ExportDataDisabled_Tooltip")]:[2,null]}}))}))},e=r,o.ExportVisualDataCommand=r,s=o.VisualContainerMenuCommand,__extends(a,s),a.prototype.execute=function(){return __awaiter(this,void 0,i.Promise,(function(){var t;return __generator(this,(function(e){return this.eventBridge,t=B(this.visualContainer.name,this.contextActivityService,"AddCommentVisual",this.source),this.eventBridge.publishToChannel(o.events.addCommentVisual,{visualContainerId:this.visualContainer.id}),t.resolve(),[2]}))}))},a.prototype.isVisible=function(){return this.menuOptions.canAddComment&&s.prototype.isVisible.call(this)},e=a,o.AddCommentVisualCommand=a,l=o.VisualContainerMenuCommand,__extends(x,l),x.prototype.execute=function(){return __awaiter(this,void 0,i.Promise,(function(){var t;return __generator(this,(function(e){return t=B(this.visualContainer.name,this.contextActivityService,"ReflexTriggerAction",this.source),k.selectCanvasItem(this.visualContainer.contract,this.selection),this.paneVisibilityService.isPaneVisible(5)||this.paneVisibilityService.togglePaneVisibility(5),t.resolve(),[2]}))}))},x.prototype.isVisible=function(){var n;return __awaiter(this,void 0,i.Promise,(function(){var t,i;return __generator(this,(function(e){return t=(null==(n=this.featureSwitchService.featureSwitches)?void 0:n.projectTridentOverall)&&(null==(n=this.featureSwitchService.featureSwitches)?void 0:n.displayProjectTridentUIEnabled)||!!/trident=(1|true)/.test(location.search),i=this.explorationCapabilitiesService.getCapabilities(),[2,!!this.featureSwitchService.featureSwitches.reflexPBI&&t&&!0===i.reflex&&l.prototype.isVisible.call(this)]}))}))},e=x,o.ReflexTriggerCommand=x,u=o.VisualContainerMenuCommand,__extends(V,u),V.prototype.execute=function(){return __awaiter(this,void 0,i.Promise,(function(){var t;return __generator(this,(function(e){return this.eventBridge,t=B(this.visualContainer.name,this.contextActivityService,"EnterAdvancedEditMode",this.source),this.eventBridge.publishToChannel(o.events.editModeChanged,{editMode:1,visualContainer:this.visualContainer.contract}),this.overlayService.hideAllDropdowns(),t.resolve(),[2]}))}))},V.prototype.isVisible=function(){return __awaiter(this,void 0,i.Promise,(function(){return __generator(this,(function(e){return[2,this.menuOptions.canEdit&&u.prototype.isVisible.call(this)]}))}))},V.prototype.isDisabled=function(){return __awaiter(this,void 0,i.Promise,(function(){return __generator(this,(function(e){return[2,!!this.visualContainer.visualPausedWarning||u.prototype.isDisabled.call(this)]}))}))},e=V,o.EnterAdvancedEditModeCommand=V,p=o.VisualContainerMenuCommand,__extends(F,p),F.prototype.execute=function(){return __awaiter(this,void 0,i.Promise,(function(){var t,i=this;return __generator(this,(function(e){return this.eventBridge,this.undoRedo,t=B(this.visualContainer.name,this.contextActivityService,"DeleteVisualContainer",this.source),this.undoRedo.register("DeleteVisualContainer",(function(){i.eventBridge.publishToChannel(o.events.deleteVisualContainer,i.visualContainer.contract)})),t.resolve(),[2]}))}))},F.prototype.isVisible=function(){return __awaiter(this,void 0,i.Promise,(function(){return __generator(this,(function(e){return[2,this.menuOptions.canDelete&&p.prototype.isVisible.call(this)]}))}))},e=F,o.DeleteVisualContainerCommand=F,d=o.VisualContainerMenuCommand,__extends(P,d),P.prototype.execute=function(){return __awaiter(this,void 0,i.Promise,(function(){var t;return __generator(this,(function(e){return this.eventBridge,t=B(this.visualContainer.name,this.contextActivityService,"ClustersSpatial",this.source),this.eventBridge.publishToChannel(o.events.getClusters,{visualContainer:this.visualContainer.contract}),t.resolve(),[2]}))}))},P.prototype.isVisible=function(){return __awaiter(this,void 0,i.Promise,(function(){return __generator(this,(function(e){return[2,this.menuOptions.canCluster&&d.prototype.isVisible.call(this)]}))}))},e=P,o.ClustersSpatialClustersCommand=e,__extends(H,X=e),e=H,o.GetClustersCommand=H,v=o.VisualContainerMenuCommand,__extends(T,v),T.prototype.execute=function(){return __awaiter(this,void 0,i.Promise,(function(){var t;return __generator(this,(function(e){return this.visibility,t=B(this.visualContainer.name,this.contextActivityService,"ToggleSpotlight",this.source),4===this.visualContainer.contract.visibility?this.visibility.clear():this.visibility.set(this.visualContainer.contract,4),this.announceSelectionState(this.visualContainer.visualHostServices,this.isSpotlightOn),t.resolve(),[2]}))}))},T.prototype.isVisible=function(){return __awaiter(this,void 0,i.Promise,(function(){return __generator(this,(function(e){return[2,this.menuOptions.canSpotlight&&v.prototype.isVisible.call(this)]}))}))},Object.defineProperty(T.prototype,"isSpotlightOn",{get:function(){return 4===this.visualContainer.contract.visibility},enumerable:!1,configurable:!0}),e=T,o.ToggleSpotlightCommand=T,m=o.VisualContainerMenuCommand,__extends(A,m),A.prototype.execute=function(){return __awaiter(this,void 0,i.Promise,(function(){var t;return __generator(this,(function(e){return this.eventBridge,this.visibility,t=B(this.visualContainer.name,this.contextActivityService,"ShareToTeamsVisual",this.source),this.visibility.set(this.visualContainer.contract,4),this.eventBridge.publishToChannel(o.events.shareToTeamsVisual),t.resolve(),[2]}))}))},A.prototype.isVisible=function(){return this.menuOptions.canShareToTeams&&m.prototype.isVisible.call(this)},e=A,o.ShareToTeamsVisualCommand=A,g=o.VisualContainerMenuCommand,__extends(D,g),D.prototype.execute=function(){return __awaiter(this,void 0,i.Promise,(function(){var t,i;return __generator(this,(function(e){return this.eventBridge,t=B(this.visualContainer.name,this.contextActivityService,"Sort",this.source),this.overlayService.hideAllDropdowns(),i=this.getSortByField(),i={visualContainer:this.visualContainer.contract,sortableField:i,sortDirection:this.sortDirection,sortGroup:this.sortGroup},this.eventBridge.publishToChannel(o.events.toggleSortDirectionVisualContainer,i),t.resolve(),[2]}))}))},D.prototype.isVisible=function(){return __awaiter(this,void 0,i.Promise,(function(){return __generator(this,(function(e){return[2,this.menuOptions.canSort&&g.prototype.isVisible.call(this)]}))}))},D.prototype.isDisabled=function(){return __awaiter(this,void 0,i.Promise,(function(){return __generator(this,(function(e){switch(e.label){case 0:return[4,g.prototype.isDisabled.call(this)];case 1:return[2,e.sent()||void 0===this.getSortByField()]}}))}))},Object.defineProperty(D.prototype,"activeSortableField",{get:function(){return _.find(this.sortGroup.fields,(function(e){return e.active}))},enumerable:!1,configurable:!0}),Object.defineProperty(D.prototype,"isHighlighted",{get:function(){return void 0!==this.activeSortableField&&this.activeSortableField.sortDirection===this.sortDirection},enumerable:!1,configurable:!0}),D.prototype.getSortByField=function(){if(this.sortGroup.fields)return 1===_.size(this.sortGroup.fields)?this.sortGroup.fields[0]:this.activeSortableField},e=D,o.SortAscendingDescendingCommand=e,__extends(z,L=e),y=z,o.SortDescendingCommand=y,__extends(U,R=e),f=U,o.SortAscendingCommand=f,C=o.VisualContainerMenuCommand,__extends(M,C),M.prototype.execute=function(){return __awaiter(this,void 0,i.Promise,(function(){return __generator(this,(function(e){return[2]}))}))},M.prototype.isVisible=function(){return __awaiter(this,void 0,i.Promise,(function(){var t;return __generator(this,(function(e){switch(e.label){case 0:return(t=this.menuOptions.canSort)?[4,C.prototype.isVisible.call(this)]:[3,2];case 1:t=e.sent(),e.label=2;case 2:return t?[2,1<_.size(this.menuOptions.sortSetting.sortableFields)]:[2,!1]}}))}))},M.prototype.getChildren=function(){return __awaiter(this,void 0,i.Promise,(function(){var t,i,n,r=this;return __generator(this,(function(e){return t=this.menuOptions.sortSetting.sortableFields,i=1===this.visualContainer.readOnlyState.actualSortDirection?"Sort_Asc":"Sort_Desc",n=_.some(this.menuOptions.sortSetting.sortableFields,(function(e){return e.active})),[2,_.map(t,(function(e){return new b(r.visualContainer,e,n?i:void 0,r.eventBridge,r.overlayService,r.contextActivityService,r.source,r.displayOverride)}))]}))}))},e=M,o.SortByCommandCollection=M,S=o.VisualContainerMenuCommand,__extends(I,S),I.prototype.execute=function(){return __awaiter(this,void 0,i.Promise,(function(){return __generator(this,(function(e){return[2]}))}))},I.prototype.title=function(e){return e.format("Sort_Group",e.get(this.sortGroup.displayName))},I.prototype.isVisible=function(){return __awaiter(this,void 0,i.Promise,(function(){var t;return __generator(this,(function(e){switch(e.label){case 0:return(t=this.menuOptions.canSort)?[4,S.prototype.isVisible.call(this)]:[3,2];case 1:t=e.sent(),e.label=2;case 2:return t?[2,!0]:[2,!1]}}))}))},I.prototype.getChildren=function(){return __awaiter(this,void 0,i.Promise,(function(){var t,i,n,r,a;return __generator(this,(function(e){for(t=[],i=0,n=this.sortGroup.fields;i<n.length;i++)r=n[i],a=1===r.sortDirection?"Sort_Asc":"Sort_Desc",t.push(new b(this.visualContainer,r,a,this.eventBridge,this.overlayService,this.contextActivityService,this.source,this.displayOverride));return t.push(new y(this.visualContainer,this.eventBridge,this.overlayService,this.menuOptions,this.sortGroup,this.contextActivityService,this.source,this.displayOverride,1),new f(this.visualContainer,this.eventBridge,this.overlayService,this.menuOptions,this.sortGroup,this.contextActivityService,this.source,this.displayOverride)),[2,t]}))}))},e=I,o.GroupedSortByCommandCollection=I,E=o.VisualContainerMenuCommand,__extends(N,E),N.prototype.execute=function(){return __awaiter(this,void 0,i.Promise,(function(){var t,i;return __generator(this,(function(e){return this.sortField,this.eventBridge,t=B(this.visualContainer.name,this.contextActivityService,"SortBy",this.source),this.overlayService.hideAllDropdowns(),i={sortableField:this.sortField,sortDirection:this.visualContainer.readOnlyState.actualSortDirection,visualContainer:this.visualContainer.contract},this.eventBridge.publishToChannel(o.events.toggleSortVisualContainer,i),t.resolve(),[2]}))}))},N.prototype.title=function(e){return this.sortField.displayName},N.prototype.getToolTip=function(t){return __awaiter(this,void 0,i.Promise,(function(){return __generator(this,(function(e){return this.sortDirectionKey?[2,this.sortField.displayName+", "+t.get(this.sortDirectionKey)]:[2,this.title(t)]}))}))},b=N,o.SortByCommand=b,w=o.VisualContainerMenuCommand,__extends(O,w),O.prototype.execute=function(){return __awaiter(this,void 0,i.Promise,(function(){var t;return __generator(this,(function(e){switch(e.label){case 0:return this.telemetryService.logEvent(i.telemetry.EXGetInsightsMenuCommand,{visualType:n.util.VisualContainerUtils.getVisualType(this.visualContainer.contract),visualName:this.visualContainer.contract.name}),t=B(this.visualContainer.name,this.contextActivityService,"GetAutomatedInsights",this.source),[4,this.lazyScoped("automatedInsightsQuery")];case 1:return e.sent().showAutomatedInsights({entryPoint:"VisualOptionsMenu",queryOptions:{summarySelectionOptions:{visualsToSummarize:[this.visualContainer.contract]},updateProcessingState:!0},enforcePremiumLicensing:!0,viewOnlyNoteworthy:!1}),t.resolve(),[2]}}))}))},O.prototype.isVisible=function(){return __awaiter(this,void 0,i.Promise,(function(){return __generator(this,(function(e){return[2,this.menuOptions.canGetInsights&&w.prototype.isVisible.call(this)]}))}))},e=O,o.GetInsightsCommand=O})(powerbi=powerbi||{}),(function(n){var e,r,t;function i(e){this.services=e,this.instanceId=void 0}e=(e=n.explore||(n.explore={})).services||(e.services={}),r={"0.00 %;-0.00 %;0.00 %":"Percentage","0.0 %;-0.0 %;0.0 %":"Percentage1"},i.initialize=function(e){i.initialized||(i.initialized=!0,n.visuals.valueFormatter.setLocaleOptions(i.createLocaleOptions(e)),n.visuals.ToolTipComponent.localizationOptions=i.createTooltipLocaleOptions(e),n.data.DataViewTransform.setLocalizationOptions(i.createDataViewTransformLocalizationOptions(e)))},i.createLocaleOptions=function(t){return{null:t.get("NullValue"),true:t.get("BooleanTrue"),false:t.get("BooleanFalse"),NaN:t.get("NaNValue"),infinity:t.get("InfinityValue"),negativeInfinity:t.get("NegativeInfinityValue"),beautify:function(e){return i.beautify(t,e)},describe:function(e){return i.describeUnit(t,e)},restatementComma:t.get("PowerBI_TwoStrings_SeperateWithCommaAndVisualSpace"),restatementCompoundAnd:t.get("FilterRestatement_CompoundAnd"),restatementCompoundOr:t.get("Generic_Or")}},i.createTooltipLocaleOptions=function(e){return{highlightedValueDisplayName:e.get(n.visuals.ToolTipComponent.highlightedValueDisplayNameResorceKey)}},i.createDataViewTransformLocalizationOptions=function(e){return{quarterPrefix:e.get(n.visuals.ForecastHelper.quarterHierarchyLevelPrefixResorceKey)}},i.prototype.getLocalizedString=function(e){for(var t,i=[],n=1;n<arguments.length;n++)i[n-1]=arguments[n];return(t=this.services.localizationService).format.apply(t,__spreadArray([e],i||[],!1))},i.prototype.requestFocus=function(e){jsCommon.FocusManager.focus(e)},i.prototype.alertScreenReader=function(e){},i.prototype.alertWithDebounce=function(e,t){this.services.screenReaderService&&this.services.screenReaderService.alertWithDebounce(e,t)},i.prototype.onDragStart=function(){},i.prototype.getVisualLinkProperties=function(){},i.prototype.canSelect=function(){return!1},i.prototype.onSelecting=function(){},i.prototype.onSelect=function(){},i.prototype.onSwitchFocusModeState=function(){},i.prototype.canExpandCollapse=function(e){return!!this.services.canExpandCollapse&&this.services.canExpandCollapse(e)},i.prototype.setNodeExpansionState=function(e){},i.prototype.setLevelExpansionState=function(e){},i.prototype.onContextMenu=function(){},i.prototype.loadMoreData=function(){},i.prototype.loadWindow=function(e){},i.prototype.setShouldDeferData=function(){},i.prototype.persistProperties=function(e){},i.prototype.onCustomSort=function(e){},i.prototype.getViewMode=function(){return 0},i.prototype.getEditMode=function(){return 0},i.prototype.setWarnings=function(e){},i.prototype.getWarnings$=function(){},i.prototype.setToolbar=function(e){},i.prototype.shouldRetainSelection=function(){return!1},i.prototype.geocoder=function(){return this.services.geocoder},i.prototype.geolocation=function(){return this.services.geolocation},i.prototype.locale=function(){return n.common.getUnmappedCultureInfo()},i.prototype.promiseFactory=function(){return this.services.promiseFactory},i.prototype.ignoreDefaultFilter=function(){return!1},i.prototype.getIdentityDisplayNames=function(e){},i.prototype.setIdentityDisplayNames=function(e){},i.prototype.setFilterExpressionMetadata=function(){},i.prototype.getFilterExpressionMetadata=function(){},i.prototype.decompositionService=function(){},i.prototype.dropdown=function(){},i.prototype.tooltips=function(){return this.services.visualHostTooltipService},i.prototype.telemetry=function(){},i.prototype.authenticationService=function(){return this.services.authenticationService},i.prototype.localStorageService=function(){},i.prototype.acquireAADTokenService=function(){},i.prototype.eventService=function(){},i.prototype.licenseManagerService=function(){},i.prototype.drill=function(e){},i.prototype.loader=function(){return this.services.moduleLoader},i.prototype.getUIComponentFactory=function(){},i.prototype.applyJsonFilter=function(e,t,i,n){},i.prototype.applyIdentityFilter=function(e,t,i,n){},i.prototype.launchUrl=function(e){},i.prototype.refreshHostData=function(){},i.prototype.getJSONFilter=function(e,t){return this.promiseFactory().reject()},i.prototype.onHyperlinkClick=function(e,t){},i.prototype.visualTimeSynchronization=function(){},i.prototype.isVisualEnabled=function(){return this.promiseFactory().resolve(!0)},i.prototype.dataMultiSelectMode=function(){return 0},i.prototype.networkAvailability=function(){},i.prototype.downloadService=function(){},i.prototype.setAriaMetadata=function(e){},i.prototype.artifactService=function(){},i.prototype.getSectionsMetadata$=function(){},i.prototype.getBookmarksMetadata$=function(){},i.prototype.onNotifyLicense=function(e){this.services.onNotifyLicense&&this.services.onNotifyLicense(e)},i.prototype.onClearLicenseNotification=function(){this.services.onClearLicenseNotification&&this.services.onClearLicenseNotification()},i.prototype.onNotifyFeatureBlocked=function(e){this.services.onNotifyFeatureBlocked&&this.services.onNotifyFeatureBlocked(e)},i.prototype.getSubSelectionService=function(){},i.prototype.webAccessService=function(){},i.prototype.getAzureMapToken=function(){},i.prototype.localStorageV2Service=function(){},i.prototype.aiNarrativesService=function(){},i.beautify=function(e,t){var i=r[t];return i&&(n.visuals.valueFormatter.beautifyTrace(i),e.getOptional(i))||t},i.describeUnit=function(e,t){var i=-1===t?"Auto":t.toString(),n=e.getOptional("DisplayUnitSystem_E"+i+"_Title"),t=t<=0?"{0}":e.getOptional("DisplayUnitSystem_E"+i+"_LabelFormat");if(n||t)return{title:n,format:t}},t=i,e.VisualHostServices=t,e.createVisualHostServices=function(e){return new t(e)}})(powerbi=powerbi||{}),(function(w){var x,V,F,P,T;function e(){}function A(e){var t=e.sectionStatus.currentSectionNumber;return t<0&&0<e.exploration.sections.length&&(t=0),e.exploration.sections[t]}x=w.explore||(w.explore={}),V=x.util||(x.util={}),F=w.ItemGroupingManager,P=w.explore.services.selectionUtils,T=w.visualHost.utils.ResourcePackageUtils,e.createUndoRedoHandler=function(p,h,d,v,m,g,a,y,f,C,S,t,E,b){var i=this;return{takeSnapshot:function(e){var t=A(p).contract.name,i=w.explore.services.selectionUtils.getSelectedCanvasItems(h),n=[],i=(i&&(n=_.map(i,(function(e){return e.name}))),m.getContext()),e=e&&null!=e.canvasLayout?e.canvasLayout:g&&g.getCurrentLayout(),r=a.serializeExploration(p.exploration.contract,{withVisibility:!0,withTransientPages:!0,withTransientFilters:!0});return{contract:r,linguisticSchema:f.getSchema(p.exploration.contract.reportId),selectedSlide:t,selectedVisualsIndex:[],selectedCanvasItemsName:n,drillToDetailsState:i?i.toSnapshot(y):void 0,canvasLayout:e,getReferences:function(){var e=a.deserializeExploration(r,[],!0);return a.getReferencedStaticResources(e)}}},rollback:function(u){m.clearContext();var c=a.deserializeExploration(u.contract,[],!0),e=a.getReferencedStaticResources(c);t.restoreReferences(e).then((function(){return __awaiter(i,void 0,w.Promise,(function(){var t,i,n,r,a,o,s,l;return __generator(this,(function(e){switch(e.label){case 0:return v.featureSwitches.mobileAuthoringFormattingUI&&1===u.canvasLayout?[4,(function(i,n){return __awaiter(this,void 0,w.Promise,(function(){var t;return __generator(this,(function(e){switch(e.label){case 0:return[4,i.get("mobileVcObjectsProxy")];case 1:return(t=e.sent()).isSupported()?[2,t.wrap(n)]:[2]}}))}))})(E,c)]:[3,2];case 1:c=e.sent(),e.label=2;case 2:for(n in l=y.getCurrentExploration(),t=T.getStaticResources(l.resourcePackages),i=T.getStaticResources(c.resourcePackages),t)r=t[n],i[n]||V.ResourcePackageUtils.ensureResourcePackages(c).push(_.clone(r)),T.findResourcePackage(c.resourcePackages,r.type,r.name).items=_.map(r.items,(function(e){return _.clone(e)}));return S.removeAllCustomVisuals(),a=_.filter(c.resourcePackages,(function(e){return T.isCustomVisualResourcePackage(e)})),s=a,v.featureSwitches.consumePublicCvsWithoutRps&&c.publicCustomVisuals&&(o=(o=b.createPublicResourcePackagesByName(c.publicCustomVisuals)).filter((function(t){return!a.some((function(e){return e.name===t.name}))})),s=s.concat(o)),S.ensurePlugins(s).finally((function(){C.publishToChannel(x.services.events.preparePersonalVisuals)})),o=x.SectionUtils.findSectionIndexForSectionName(c,u.selectedSlide),p.sectionStatus.currentSectionNumber=o,p.exploration=x.viewModels.ViewModelFactory.convertExploration(c,u.canvasLayout,o),p.exploration.contract.themeCollection.highContrastTheme=l.themeCollection.highContrastTheme,p.exploration.contract.themeCollection.highContrastTheme||delete p.exploration.contract.themeCollection.highContrastTheme,f.setSchema(c.reportId,u.linguisticSchema),s=y.getCurrentSection(),l=A(p),y.loadExploration(p.exploration.contract),y.goto(l.contract,{updateUrl:s.name!==l.contract.name}),d.updateCrossDrillOfSectionOperation(l.contract),setTimeout((function(){var e=p.exploration.exploreCanvas.visualContainerGroups,t=[],i=u.selectedCanvasItemsName;if(0<i.length){for(var n=0,r=i;n<r.length;n++){var a=r[n],a=F.find(a,e);a&&t.push(a.contract)}P.selectCanvasItems(t,h),u.drillToDetailsState&&m.setContext(w.drillDetailsModuleFactory().snapshotToContext(u.drillToDetailsState,y))}else h.clearSelection();g.changeFormFactor(u.canvasLayout,p)}),0),[2]}}))}))}))}}},V.ExploreUndoRedoHandlerUtility=e})(powerbi=powerbi||{}),(function(e){var t,i,n,r;t=e.explore||(e.explore={}),i=t.viewModels||(t.viewModels={}),n=t.contracts.FilterType,r=e.data.RelativeFilterType,(i.RelativeFilterViewModelUtil||(i.RelativeFilterViewModelUtil={})).relativeFilterTypeToFilterType=function(e){switch(e){case r.Time:return n.RelativeTime;case r.Date:return n.RelativeDate;default:r.Unsupported;return null}}})(powerbi=powerbi||{}),(function(i){var e,a;function o(e,t){(t=void 0===t?!0:t)&&(e.stopPropagation(),e.preventDefault());t=e.dataTransfer.getData("pbi-tree-node");if(t){e=JSON.parse(t).fieldExpr;if(e)return i.data.services.SemanticQuerySerializer.deserializeExpr(e)}}function s(e,t){var e=e.getBoundingClientRect(),i=0;return e.top+e.height/2>t.pageY?i|=1:i|=4,e.left+e.width/2>t.pageX?i|=8:i|=2,i}function l(e,t){e&&!e.classList.contains(t)&&(e.classList.remove(a.Append.class),e.classList.remove(a.None.class),e.classList.remove(a.Prepend.class),e.classList.remove(a.Replace.class),e.classList.add(t))}function u(e){l(e.previousElementSibling,a.None.class),l(e,a.None.class),l(e.nextElementSibling,a.None.class)}e=(e=i.explore||(i.explore={})).helpers||(e.helpers={}),a=jsCommon.HighlightClasses,e.enableDropFromModernFieldList=function(i,n,r){i.addEventListener("drop",(function(e){var t=o(e);t&&n(e,t,s(i,e))})),i.addEventListener("dragover",(function(e){if(r){var t=i;switch(r(s(i,e))){case 0:l(t.previousElementSibling,a.None.class),l(t,a.None.class),l(t.nextElementSibling,a.None.class);break;case 2:l(t.previousElementSibling,a.Append.class),l(t,a.Prepend.class),l(t.nextElementSibling,a.None.class);break;case 3:l(t.previousElementSibling,a.None.class),l(t,a.Append.class),l(t.nextElementSibling,a.Prepend.class);break;case 1:l(t.previousElementSibling,a.None.class),l(t,a.Replace.class),l(t.nextElementSibling,a.None.class);break;default:u(t)}}e.preventDefault()})),r&&(i.addEventListener("dragleave",(function(){return u(i)})),i.addEventListener("dragexit",(function(){return u(i)})),i.addEventListener("dragend",(function(){return u(i)})))},e.disableDropFromModernFieldList=function(e){e.removeAllListeners("drop"),e.removeAllListeners("dragover"),e.removeAllListeners("dragleave"),e.removeAllListeners("dragexit"),e.removeAllListeners("dragend")},e.getModernFieldListExpr=o})(powerbi=powerbi||{}),(function(e){((e=(e=e.explore||(e.explore={})).helpers||(e.helpers={})).VisualHostInsideZoneAdapter||(e.VisualHostInsideZoneAdapter={})).wrapHostServices=function(r,n){function a(e){for(var t=[],i=1;i<arguments.length;i++)t[i-1]=arguments[i];return n.run(e,r,t)}return{getLocalizedString:function(e){for(var t=[],i=1;i<arguments.length;i++)t[i-1]=arguments[i];return r.getLocalizedString.apply(r,__spreadArray([e],t||[],!1))},tooltips:function(){return r.tooltips()},getSectionsMetadata$:function(){return r.getSectionsMetadata$()},getBookmarksMetadata$:function(){return r.getBookmarksMetadata$()},getSubSelectionService:function(){return r.getSubSelectionService()},alertScreenReader:function(e){return a(r.alertScreenReader,e)},alertWithDebounce:function(e,t){return a(r.alertWithDebounce,e,t)},requestFocus:function(e){return a(r.requestFocus,e)},onDragStart:function(e){return a(r.onDragStart,e)},getVisualLinkProperties:function(){return a(r.getVisualLinkProperties)},canSelect:function(e){return a(r.canSelect,e)},onSelecting:function(e){return a(r.onSelecting,e)},onSelect:function(e){return a(r.onSelect,e)},onSwitchFocusModeState:function(e){return a(r.onSwitchFocusModeState,e)},canExpandCollapse:function(e){return a(r.canExpandCollapse,e)},setNodeExpansionState:function(e){return a(r.setNodeExpansionState,e)},setLevelExpansionState:function(e){return a(r.setLevelExpansionState,e)},onContextMenu:function(e){return a(r.onContextMenu,e)},loadMoreData:function(){return a(r.loadMoreData)},loadWindow:function(e){return a(r.loadWindow,e)},setShouldDeferData:function(e){return a(r.setShouldDeferData,e)},persistProperties:function(e,t){return a(r.persistProperties,e,t)},onCustomSort:function(e){return a(r.onCustomSort,e)},getViewMode:function(){return a(r.getViewMode)},getEditMode:function(){return a(r.getEditMode)},setWarnings:function(e){return a(r.setWarnings,e)},getWarnings$:function(){return a(r.getWarnings$)},setToolbar:function(e,t){return a(r.setToolbar,e,t)},shouldRetainSelection:function(){return a(r.shouldRetainSelection)},geocoder:function(){return a(r.geocoder)},geolocation:function(){return a(r.geolocation)},locale:function(){return a(r.locale)},promiseFactory:function(){return a(r.promiseFactory)},ignoreDefaultFilter:function(){return a(r.ignoreDefaultFilter)},getIdentityDisplayNames:function(e){return a(r.getIdentityDisplayNames,e)},setIdentityDisplayNames:function(e){return a(r.setIdentityDisplayNames,e)},dropdown:function(){return a(r.dropdown)},telemetry:function(){return a(r.telemetry)},authenticationService:function(){return a(r.authenticationService)},localStorageService:function(){return a(r.localStorageService)},eventService:function(){return a(r.eventService)},licenseManagerService:function(){return a(r.licenseManagerService)},loader:function(){return a(r.loader)},getUIComponentFactory:function(){return a(r.getUIComponentFactory)},applyJsonFilter:function(e,t,i,n){return a(r.applyJsonFilter,e,t,i,n)},applyIdentityFilter:function(e,t,i,n){return a(r.applyIdentityFilter,e,t,i,n)},launchUrl:function(e){return a(r.launchUrl,e)},instanceId:r.instanceId,refreshHostData:function(){return a(r.refreshHostData)},decompositionService:function(){return a(r.decompositionService)},getJSONFilter:function(e,t){return a(r.getJSONFilter,e,t)},visualCapabilitiesChanged:function(){return a(r.visualCapabilitiesChanged)},onHyperlinkClick:function(e,t){return a(r.onHyperlinkClick,e,t)},visualTimeSynchronization:function(){return a(r.visualTimeSynchronization)},setFilterExpressionMetadata:function(e){return a(r.setFilterExpressionMetadata,e)},getFilterExpressionMetadata:function(){return a(r.getFilterExpressionMetadata)},isVisualEnabled:function(){return a(r.isVisualEnabled)},dataMultiSelectMode:function(){return a(r.dataMultiSelectMode)},networkAvailability:function(){return a(r.networkAvailability)},downloadService:function(){return a(r.downloadService)},setAriaMetadata:function(e){return a(r.setAriaMetadata,e)},artifactService:function(){return a(r.artifactService)},onNotifyLicense:function(e){return a(r.onNotifyLicense,e)},onClearLicenseNotification:function(){return a(r.onClearLicenseNotification)},onNotifyFeatureBlocked:function(e){return a(r.onNotifyFeatureBlocked,e)},webAccessService:function(){return a(r.webAccessService)},drill:function(e){return a(r.drill,e)},getAzureMapToken:function(){return a(r.getAzureMapToken)},acquireAADTokenService:function(){return r.acquireAADTokenService()},localStorageV2Service:function(){return r.localStorageV2Service()},aiNarrativesService:function(){return a(r.aiNarrativesService)}}}})(powerbi=powerbi||{}),(function(e){var h,t,r,o;function d(e,t,i){var n=r.call(this)||this;return n.schema=e,n.displayName=t,n.metadata=i,n.dataPoints=[],n.isExclude=!1,n}h=e.explore||(e.explore={}),t=h.services||(h.services={}),o=e.visuals.valueFormatter,r=e.data.DefaultSQExprVisitor,__extends(d,r),d.prototype.visitNot=function(e){this.isExclude=!0,e.arg.accept(this)},d.prototype.visitOr=function(e){e.left.accept(this),e.right.accept(this)},d.prototype.visitIn=function(e){var t=this;if(!_.isEmpty(e.values)){for(var i,n,r,a=[],o=e.args,s=_.map(o,(function(e){return t.displayName.getDisplayName(e,t.schema,null,null,null,{includeVariationSource:!0})})),l=this,u=0,c=e.values;u<c.length;u++){var p=c[u];p=p,r=n=i=void 0,i=s,n=_.map(p,(function(e){return e.value})),(r=h.FilterUtils.findValuesInFilterCache(o,p,l.metadata))&&(i=_.map(r.columns,(function(e){return t.displayName.getDisplayName(e,t.schema,null,null,null,{includeVariationSource:!0})})),n=r.values),a.push({columns:o,values:p,text:d.getDataPointText(i,n)})}(e=this.dataPoints).push.apply(e,a||[])}},d.getDataPointText=function(e,t){for(var i="",n=0;n<e.length;n++){var r=t[n],a=e[n];i+=o.format(r)+" ("+a+") + "}return i=i.slice(0,i.length-3)},t.IncludeExcludeSQExprVisitor=d})(powerbi=powerbi||{}),(function(g){g.drillDetailsModuleFactory=function(){var c=g,e=(c.common.contracts,c.data),t=c.explore,p=(t.contracts,t.services.events),i=t.util,n=jsCommon.ArrayExtensions,r=g.explore.FilterUtils,a=g.explore.services.selectionUtils,o=t.SectionUtils,h=e.SQExpr,d=jsCommon.Utility,v=i.VisualContainerUtils,s=(l.prototype.toSnapshot=function(e){var t,i=this;if(e.getCurrentSection()===this.targetSection)return e=e.getCurrentExploration(),t=o.findSectionIndexForSection(e,this.sourceSection),e=o.findSectionIndexForSection(e,this.targetSection),{sourceSectionIndex:t,sourceVisualIndex:_.findIndex(this.sourceSection.visualContainers,(function(e){return e===i.sourceVisualContainer})),targetSectionIndex:e,targetVisualIndex:_.findIndex(this.targetSection.visualContainers,(function(e){return e===i.targetVisualContainer}))}},l.fromSnapshot=function(e,t){var i,n;if(e)return n=(i=(t=t.getCurrentExploration()).sections[e.sourceSectionIndex]).visualContainers[e.sourceVisualIndex],e=(t=t.sections[e.targetSectionIndex]).visualContainers[e.targetVisualIndex],new l(i,n,t,e,0)},l);function l(e,t,i,n,r){this.sourceSection=e,this.sourceVisualContainer=t,this.targetSection=i,this.targetVisualContainer=n,this.navigationState=r}u.prototype.drillToDetails=function(i,n,e){var r=this;if(!_.isEmpty(i)){var t=_.head(i);if(t&&!_.isEmpty(t.metadata)){var a=v.getVisualQuery(n);if(a&&a.defn){if(_.isEmpty(t.dataMap)){if(!a.projections)return;var o,s=v.getDataRolesForVisual(n,this.visualPluginService),l=_(s).filter((function(e){return e.kind!==c.VisualDataRoleKind.Measure})).map((function(e){return e.name})).value();for(o in a.projections)if(!_.isEmpty(a.projections[o])&&_.includes(l,o))return}var u=a.defn.select().withName(_.head(t.metadata));u&&h.isAggregation(u.expr)&&this.conceptualSchemaProxy.get(e).then((function(e){var t=r.visualAuthoringOperations.drillToDetails(d.generateGuid(),e,[u.expr],i,n);t&&(r.addCrossFilters(n,r.explorationNavigationService.getCurrentSection(),t,!1,e),r.drillToDetailsCore(i,n,t))}),(function(){return _.noop}))}}}},u.prototype.generateDetailsTable=function(e,t,i,n){e=this.mockVisualContainer(e),t=this.visualAuthoringOperations.drillToDetails(d.generateGuid(),t,i,null,e,n);if(t)return t.config.singleVisual},u.prototype.clear=function(){var e;this.drillToDetailsContext&&(this.drillToDetailsContext.navigationState=1,e=o.findSectionIndexForSection(this.explorationNavigationService.getCurrentExploration(),this.drillToDetailsContext.sourceSection),this.eventBridge.publishToChannel(p.switchSection,{index:e}))},u.prototype.getContext=function(){return this.drillToDetailsContext},u.prototype.setContext=function(e){this.drillToDetailsContext=e},u.prototype.clearContext=function(){this.drillToDetailsContext=null},u.prototype.hasContext=function(){return!!this.drillToDetailsContext},u.prototype.getDetailsTableTargetMeasures=function(e){var e=this.mockVisualContainer(e),t=v.getVisualQuery(e);if(t&&t.defn){e=v.getDataRolesForVisual(e,this.visualPluginService);if(!_.isEmpty(e)){for(var i=[],n=0,r=_(e).filter((function(e){return(e.kind===c.VisualDataRoleKind.Measure||e.kind===c.VisualDataRoleKind.GroupingOrMeasure)&&0!==e.joinPredicate})).map((function(e){return e.name})).value();n<r.length;n++){var a=r[n],a=t.projections[a];if(!_.isEmpty(a))for(var o=0,s=a.all();o<s.length;o++){var l=s[o],l=t.defn.select().withName(l.queryRef);if(l&&h.isAggregation(l.expr))return[l.expr];l&&h.isMeasure(l.expr)&&i.push(l.expr)}}return i}}},u.prototype.mockVisualContainer=function(e){e={name:d.generateGuid(),config:{singleVisual:e},layouts:n.createWithId(),filters:[]};return e.layouts.push({id:0,position:{x:0,y:0,width:0,height:0}}),e},u.prototype.onSectionChanged=function(){var e=this;if(this.drillToDetailsContext){this.explorationNavigationService.getCurrentSection();switch(this.drillToDetailsContext.navigationState){case 0:window.setTimeout((function(){a.selectCanvasItem(e.drillToDetailsContext.targetVisualContainer,e.selectionService),e.visibility.set(e.drillToDetailsContext.targetVisualContainer,1)}),0);break;case 1:var t=this.explorationNavigationService.getCurrentExploration(),i=o.findSectionIndexForSection(t,this.drillToDetailsContext.targetSection),n=o.findSectionIndexForSection(t,this.drillToDetailsContext.sourceSection),r=this.drillToDetailsContext.sourceVisualContainer;this.drillToDetailsContext=null,this.eventBridge.publishToChannel(p.deleteSection,{targetSectionIndex:i}),window.setTimeout((function(){o.findSectionIndexForSection(e.explorationNavigationService.getCurrentExploration(),e.explorationNavigationService.getCurrentSection())===n&&a.selectCanvasItem(r,e.selectionService),e.undoRedo.clear()}),0)}}},u.prototype.onPopOutModeChanged=function(){this.drillToDetailsContext&&this.explorationNavigationService.getCurrentSection()!==this.drillToDetailsContext.sourceSection&&this.visibility.get()!==this.drillToDetailsContext.targetVisualContainer&&this.clear()},u.prototype.drillToDetailsCore=function(e,t,i){var n,r,a=this.explorationNavigationService.getCurrentSection();a&&(n=this.explorationNavigationService.getAllSections(),r=this.explorationSerializer.serializePage(a,1),r={name:"Drill to Details",displayName:"Drill to Details",filters:(r=this.explorationSerializer.deserializePage(r)).filters,size:r.size,visualContainers:[i],visualContainerGroups:[i],transient:!0},o.setUniqueNewSectionCanvasItemNames(r,n),this.drillToDetailsContext=new s(a,t,r,i,0),this.eventBridge.publishToChannel(p.insertSection,r))},u.prototype.addCrossFilters=function(e,t,i,n,r){t=this.filterGenerator.getVisualContainerCrossFilters(t,e,r);if(t.dataFilters)for(var a=0,o=t.dataFilters;a<o.length;a++){var s=o[a];this.addVisualFilters(i,s,r,!1)}if(n){t.highlightFilters;for(var l=0,u=t.highlightFilters;l<u.length;l++){s=u[l];this.addVisualFilters(i,s,r,!1)}}},u.prototype.addVisualFilters=function(e,t,i,n){t&&t.filter&&(t=r.convertFilterData(t,e.filters,0),r.add(e,t))};var m=u;function u(e,t,i,n,r,a,o,s,l,u){var c=this;this.conceptualSchemaProxy=e,this.visualAuthoringOperations=t,this.undoRedo=i,this.selectionService=n,this.explorationNavigationService=r,this.explorationSerializer=a,this.visibility=o,this.eventBridge=s,this.filterGenerator=l,this.visualPluginService=u,this.eventBridge.createChannelSubscriptionManager().subscribe(p.canvasChanged,(function(){return c.onSectionChanged()})).subscribe(p.visibilityChanged,(function(){return c.onPopOutModeChanged()})).subscribe(p.explorationUnloaded,(function(e,t){return c.clearContext()}))}return{create:function(e,t,i,n,r,a,o,s,l,u){return new m(e,u,n,r,a,t,o,s,l,i)},createContext:function(e,t,i,n,r){return new s(e,t,i,n,r)},snapshotToContext:s.fromSnapshot}}})(powerbi=powerbi||{}),(function(h){var d,i,t,r,n,l;function e(e,t,i,n,r,a,o,s){this.contextActivityService=e,this.eventBridge=t,this.selection=i,this.formFactor=n,this.telemetryService=r,this.explorationActivity=a,this.sectionsSubject=o,this.currentSectionSubject=s,this.history=[],this.sections$=o.asObservable(),this.currentSection$=s.asObservable(),a.registerExplorationNavigationService(this)}d=h.explore||(h.explore={}),i=d.services||(d.services={}),t=h.common.utils.IdUtility,r=contextActivity.isOpenReportActivity,n={updateUrl:!0,action:i.SectionNavigationAction.Unknown},i.createExplorationNavigationService=function(e,t,i,n,r,a,o,s){return new l(e,t,i,n,r,a,o,s)},e.prototype.registerExplorationViewModel=function(e){this.getViewModel=e},e.prototype.updateActiveSection=function(o){var s,l,e,t,i,n,u=this,c=this.getViewModel(),p=c.exploration.contract;!o.forceUpdate&&p.activeSectionIndex===o.targetSectionIndex||(s=null==o.clearSelection||o.clearSelection,l=-1<o.targetSectionIndex&&o.targetSectionIndex<p.sections.length,t=(e=this.exploration.sections[o.targetSectionIndex]).objectId,n=e.displayName,this.contextActivityService.upsertExplorationProperties({reportPageId:t,reportPageName:n}),o.parentContextActivity&&o.parentContextActivity.isRunning()&&(o.parentContextActivity.setProperty("reportPageId",t),o.parentContextActivity.setProperty("reportPageName",n)),this.changeReportPageActivity&&this.changeReportPageActivity.isRunning()&&this.changeReportPageActivity.cancel(),this.changeReportPageActivity&&this.changeReportPageActivity.isRunning()||(t={name:"Change Report Page"},o.parentContextActivity?r(o.parentContextActivity)&&o.parentContextActivity.isRunning()?this.changeReportPageActivity=o.parentContextActivity.createChildActivity(t):this.changeReportPageActivity=o.parentContextActivity:this.changeReportPageActivity=this.contextActivityService.createActivity(t)),i=d.util.VisualContainerUtils.getVisualTypesAndCountsFromSection(e),n=Object.keys(i).reduce((function(e,t){return"__hidden"!==t?e+i[t]:e}),0),this.changeReportPageActivity.isRunning()&&(this.changeReportPageActivity.setProperty("visualTypesAndCount",JSON.stringify(i)),this.changeReportPageActivity.setProperty("totalVisibleVisualCount",n)),o.parentContextActivity&&o.parentContextActivity.isRunning()&&(o.parentContextActivity.setProperty("visualTypesAndCount",JSON.stringify(i)),o.parentContextActivity.setProperty("totalVisibleVisualCount",n)),this.explorationActivity.changeSection((function(e){var t=u.getCurrentSection();if(o.suppressHistory||t&&!t.transient&&u.history.push({name:t.name}),l){u.selection&&!1!==s&&!_.isEmpty(u.selection.getSelectedElements())&&u.selection.clearSelection();var i=c.exploration.sections;if(!_.isEmpty(i))for(var n=i.length-1;0<=n;--n)i[n].selected=n===o.targetSectionIndex;c.sectionStatus.currentSectionNumber=o.targetSectionIndex;var r=p.sections[o.targetSectionIndex],a=null!==o.canvasLayout&&void 0!==o.canvasLayout?o.canvasLayout:u.formFactor.getCurrentLayout();c.exploration.exploreCanvas=d.viewModels.ViewModelFactory.convertSectionToExploreCanvas(p,r,a,o.currentZone),(null==o.clearCrossFilter||o.clearCrossFilter)&&t&&t.crossFilterSource&&(t.crossFilterSource.highlight=void 0),r&&((a=e.event.info).width=r.size.width,a.height=r.size.height,a.displayOption=r.size.displayOption),u.goto(r,{action:o.navigationAction,newReport:o.newReport,parentActivity:e,parentContextActivity:u.changeReportPageActivity,isInitialUpdateSection:o.isInitialUpdateSection})}}),(function(){return u.telemetryService.startChildActivity(o.parentActivity&&o.parentActivity.event,h.telemetry.EXUpdateActiveSection,{targetSectionIndex:o.targetSectionIndex,forceUpdate:o.forceUpdate,suppressHistory:o.suppressHistory,canvasLayout:o.canvasLayout,clearSelection:s,isCancelled:!1,sectionGuid:l&&p.sections[o.targetSectionIndex].objectId})}),this.changeReportPageActivity))},e.prototype.updateExplorationActiveSectionIndex=function(e){e.exploration,e.section;var t,i,n,r=e.exploration,a=h.explore.SectionUtils.findSectionIndexForSectionName(r,e.section);null!=a&&r&&r.sections&&r.sections[a].transient||(r.activeSectionIndex=a,e.suppressTelemetry)||(t=(t=r.sections[a])?t.objectId:void 0,i=r.report?r.report.originalReportObjectId:void 0,n=r.report&&r.report.ownerInfo?r.report.ownerInfo.groupObjectId:void 0,this.telemetryService.logChildEvent(e.parentActivity&&e.parentActivity.event,h.telemetry.ExploreHostChangeReportPage,{reportId:r.reportId,reportGuid:e.reportGUID,sectionIndex:a,sectionGuid:t,groupObjectId:e.groupObjectId,isReadonlyGroup:e.isReadonlyGroup,permissions:e.reportPermissions,scrubUserInfo:e.scrubUserInfo,newReport:e.newReport,originalReportGuid:i,originalGroupObjectId:n}))},e.prototype.goto=function(e,t){this.updateSectionViewSession(),t&&t.parentContextActivity&&this.telemetryData&&(t.parentContextActivity.setProperty("reportPageViewSessionId",this.telemetryData.exsid),t.parentContextActivity.setProperty("isInitialUpdateSection",!!t.isInitialUpdateSection)),t=t?_.merge({},n,t):n,this.currentSection=e,this.currentSectionSubject.next(e),this.raiseEvent(),t.updateUrl&&(e={name:e.name,displayName:e.displayName,action:t.action,newReport:t.newReport,parentActivity:t.parentActivity,parentContextActivity:t.parentContextActivity,isInitialUpdateSection:t.isInitialUpdateSection},this.eventBridge.publishToChannel(i.events.sectionChanged,e))},e.prototype.back=function(e){var t,i;_.isEmpty(this.history)||(t=this.history.pop(),(i=_.findIndex(this.exploration.sections,(function(e){return e.name===t.name})))<0)||this.updateActiveSection({targetSectionIndex:i,forceUpdate:!1,suppressHistory:!0,parentActivity:e})},e.prototype.loadExploration=function(e,t){this.telemetryData=void 0,this.exploration=e,this.currentZone=e&&t,e&&e.sections&&0<=e.activeSectionIndex&&(t=e.sections[e.activeSectionIndex],this.currentSection=t,this.currentSectionSubject.next(t)),this.emitUpdatedSections(),this.raiseExplorationLoadedEvent(e)},e.prototype.startExplorationSession=function(e){e&&void 0===e.exid&&(e.exid=t.generateShortId(5)),this.telemetryData=e},e.prototype.updateExplorationTelemetryData=function(e){this.telemetryData||(this.telemetryData={}),_.assign(this.telemetryData,e)},e.prototype.getExplorationTelemetryData=function(){return this.telemetryData},e.prototype.getCurrentSection=function(){var e;return this.currentSection||((e=this.exploration)&&_.inRange(e.activeSectionIndex,0,e.sections.length)?e.sections[e.activeSectionIndex]:void 0)},e.prototype.getSectionByName=function(t){return _.find(this.exploration.sections,(function(e){return e.name===t}))},e.prototype.getAllSections=function(){return this.exploration&&this.exploration.sections},e.prototype.getAllVisualContainers=function(i){return this.exploration&&this.exploration.sections?i?this.exploration.sections.reduce((function(e,t){return e.concat(t.visualContainers.filter((function(e){return e.config.singleVisual.visualType===i})))}),[]):this.exploration.sections.reduce((function(e,t){return e.concat(t.visualContainers)}),[]):[]},e.prototype.getCurrentExploration=function(){return this.exploration},e.prototype.getCurrentExploreCanvas=function(){return this.getViewModel,this.getViewModel().exploration.exploreCanvas},e.prototype.showExplorationMask=function(){this.getViewModel,this.getViewModel().showMask=!0},e.prototype.hideExplorationMask=function(){this.getViewModel,this.getViewModel().showMask=!1},e.prototype.getCurrentZone=function(){return this.currentZone},e.prototype.emitUpdatedSections=function(){this.sectionsSubject.next(this.getAllSections())},e.prototype.raiseEvent=function(){this.eventBridge.publishToChannel(i.events.canvasChanged)},e.prototype.raiseExplorationLoadedEvent=function(e){this.eventBridge.publishToChannel(i.events.explorationLoaded,e)},e.prototype.updateSectionViewSession=function(){var e;this.telemetryData&&(e=t.generateShortId(5),this.telemetryData.exsid=e,this.contextActivityService.upsertExplorationProperties({reportPageViewSessionId:e}))},l=e})(powerbi=powerbi||{}),(function(o){var e,L,R,H,a,r,s,l,u,c,p,h,d,v,m,g,y,f,C,S,E,b,w,x,V,F,P,T,A,D,M,I,N,O,z,U,j,W,G,Q,K,B,k,X;function t(t,e,i,n){var r=this;this.asyncFeatureSwitchService=t,this.resourceLoader=e,this.promiseFactory=i,this.resourceLoader=e,this.promiseFactory=i,this.trustedConvertibleVisualTypes=[],this.customConvertibleVisualTypes=[],this.globalConvertibleVisualTypes=[],this.storage=new a,this.initBuiltInPlugins=this.asyncFeatureSwitchService.getFeatureSwitches().then((function(e){return n=n||new X(t),r.getConvertibleCoreVisualTypeNames(e)})).then((function(e){for(var t in r.globalConvertibleVisualTypes=e,o.visuals.plugins)r.storage.loadPlugin(t,n.getPlugin(t))}))}function i(e,t,i){this.featureSwitchService=e,this.mapControlFactory=t,this.visualSandbox=i}e=(e=o.explore||(o.explore={})).services||(e.services={}),L=o.visuals.PivotTableOptions,R=o.visualHost.utils.ResourcePackageUtils,H=o.visuals.TableExOptions,a=o.visualHost.visualPluginServiceHelpers.VisualPluginStorage,r=o.visuals.createActionButton,s=o.visuals.createPivotTable,l=o.visuals.createTableEx,u=o.visuals.createMatrix,c=o.visuals.createTable,p=o.visuals.createAccessibleTable,h=o.visuals.createCard,d=o.visuals.createCardVisual,v=o.visuals.createGauge,m=o.visuals.createDonutChart,g=o.visuals.createMultiRowCard,y=o.visuals.createFunnelChart,f=o.visuals.createMap,C=o.visuals.createAzureMap,S=o.visuals.createShapeMap,E=o.visuals.createTreemap,b=o.visuals.createSlicer,w=o.visuals.createTextbox,x=o.visuals.createScriptVisual,V=o.visuals.createKpi,F=o.visuals.createDecompositionTree,P=o.visuals.createShapeVisual,T=o.visuals.createSunburst,A=o.visuals.createCartesianChart,D=o.visuals.createWebColumnChartAnimator,M=o.visuals.createCartesianChartBehaviorFactory,I=o.visuals.createColumnChartWebBehaviorFactory,N=o.visuals.createDataDotChartWebBehaviorFactory,O=o.visuals.createLineChartWebBehaviorFactory,z=o.visuals.createScatterChartWebBehaviorFactory,U=o.visuals.createWaterfallChartWebBehaviorFactory,j=o.visuals.createAzureMapBehavior,W=o.visuals.createShapeMapBehavior,G=o.visuals.createTreeMapWebAnimator,Q=o.visuals.createTreeMapWebBehavior,K=o.visuals.createSunburstBehavior,B=o.visuals.createAINarratives,e.createExplorationVisualPluginService=function(e,t,i,n,r){return new k(e,i,t,new X(e,n,r))},t.prototype.getConvertibleCoreVisualTypeNames=function(e){var t=[o.visuals.plugins.barChart.name,o.visuals.plugins.columnChart.name,o.visuals.plugins.clusteredBarChart.name,o.visuals.plugins.clusteredColumnChart.name,o.visuals.plugins.hundredPercentStackedBarChart.name,o.visuals.plugins.hundredPercentStackedColumnChart.name,o.visuals.plugins.lineChart.name,o.visuals.plugins.areaChart.name,o.visuals.plugins.stackedAreaChart.name,o.visuals.plugins.lineStackedColumnComboChart.name,o.visuals.plugins.lineClusteredColumnComboChart.name,o.visuals.plugins.ribbonChart.name];e&&e.dataDotChartEnabled&&t.push.apply(t,[o.visuals.plugins.dataDotClusteredColumnComboChart.name,o.visuals.plugins.dataDotStackedColumnComboChart.name]),e&&e.histogram&&t.push(o.visuals.plugins.histogram.name),t.push.apply(t,[o.visuals.plugins.waterfallChart.name,o.visuals.plugins.funnel.name,o.visuals.plugins.scatterChart.name,o.visuals.plugins.pieChart.name,o.visuals.plugins.donutChart.name]),e&&e.sunburstVisualEnabled&&t.push(o.visuals.plugins.sunburst.name),t.push(o.visuals.plugins.treemap.name),t.push.apply(t,[o.visuals.plugins.map.name,o.visuals.plugins.filledMap.name]),e&&e.shapeMapVisualEnabled&&t.push(o.visuals.plugins.shapeMap.name),e&&e.hideAzureMapVisual||t.push(o.visuals.plugins.azureMap.name),t.push.apply(t,[o.visuals.plugins.gauge.name,o.visuals.plugins.card.name,o.visuals.plugins.multiRowCard.name,o.visuals.plugins.kpi.name,o.visuals.plugins.slicer.name]),e&&e.pivotTableVisualEnabled?(t.push(o.visuals.plugins.tableEx.name),t.push(o.visuals.plugins.pivotTable.name)):(t.push(o.visuals.plugins.table.name),t.push(o.visuals.plugins.matrix.name)),e&&e.scriptVisualEnabled&&e.scriptVisualAuthoringEnabled&&(t.push(o.visuals.plugins.scriptVisual.name),t.push(o.visuals.plugins.pythonVisual.name)),e&&e.keyDrivers&&t.push(o.visuals.plugins.keyDriversVisual.name),t.push(o.visuals.plugins.decompositionTreeVisual.name),e&&e.qnaVisual&&t.push(o.visuals.plugins.qnaVisual.name),e&&e.daxTransformEnabled&&t.push(o.visuals.plugins.textbox.name),e&&e.aiNarrativesVisual&&t.push(o.visuals.plugins.aiNarratives.name),e&&e.scorecardVisual&&t.push(o.visuals.plugins.scorecard.name),e&&e.rdlNativeVisual&&t.push(o.visuals.plugins.rdlVisual.name),e&&e.newCard&&t.push(o.visuals.plugins.cardVisual.name);o.localStorageService.getData("VISUAL_DEVELOPER_MODE_ENABLED")&&t.push(o.visuals.plugins.debugVisual.name);e=this.promiseFactory.defer();return e.resolve(t),e.promise},t.prototype.getNonConvertibleCoreVisualTypeNames=function(){return[o.visuals.plugins.actionButton.name,o.visuals.plugins.bookmarkNavigator.name,o.visuals.plugins.image.name,o.visuals.plugins.pageNavigator.name,o.visuals.plugins.shape.name]},t.prototype.getVisuals=function(){return this.storage.getLoadedPlugins()},t.prototype.getConvertibleVisuals=function(){for(var t=this,e=[],i=0,n=this.globalConvertibleVisualTypes;i<n.length;i++){var r=n[i];this.storage.hasPlugin(r)&&!_.includes(e,r)&&e.push(r)}for(var a=0,o=this.trustedConvertibleVisualTypes;a<o.length;a++){var s=o[a];this.storage.hasPlugin(s)&&!_.includes(e,s)&&e.push(s)}for(var l=0,u=this.customConvertibleVisualTypes;l<u.length;l++){var c=u[l];this.storage.hasPlugin(c)&&!_.includes(e,c)&&e.push(c)}return e.map((function(e){return t.storage.getLoadedPlugin(e)}))},t.prototype.getConvertibleVisualsAsync=function(){return __awaiter(this,void 0,o.Promise,(function(){return __generator(this,(function(e){switch(e.label){case 0:return[4,this.ensureBuiltInPlugins()];case 1:return e.sent(),[2,this.getConvertibleVisuals()]}}))}))},t.prototype.getCoreVisualTypes=function(){return __spreadArray(__spreadArray([],this.getNonConvertibleCoreVisualTypeNames(),!0),this.globalConvertibleVisualTypes,!0)},t.prototype.ensureBuiltInPlugins=function(){return this.initBuiltInPlugins},t.prototype.ensureTrustedVisualPlugins=function(e){a.ensureTrustedVisualPlugins(this.storage,e);for(var t=0,i=e;t<i.length;t++){var n=i[t];this.addTrustedConvertibleVisualType(n.name)}},t.prototype.ensurePlugins=function(e,i){var n=this,r=(this.promiseFactory,[]);if(e&&e.length)for(var a=this,t=0,o=e;t<o.length;t++)!(function(e){var t;R.isCustomVisualResourcePackage(e)&&(t=a.ensurePlugin(e,i).then((function(){return n.addCustomConvertibleVisualType(e.name)})),r.push(t))})(o[t]);return this.promiseFactory.allSettled(r)},t.prototype.ensurePlugin=function(e,t){return a.ensurePlugin(this.storage,this.promiseFactory,this.resourceLoader,e,t)},t.prototype.addTrustedConvertibleVisualType=function(e){this.trustedConvertibleVisualTypes.indexOf(e)<0&&this.trustedConvertibleVisualTypes.push(e)},t.prototype.addCustomConvertibleVisualType=function(e){this.customConvertibleVisualTypes.indexOf(e)<0&&this.customConvertibleVisualTypes.push(e)},t.prototype.capabilities=function(e){e=this.getPlugin(e);return e?e.capabilities:void 0},t.prototype.removeAllCustomVisuals=function(){for(var e=0,t=this.customConvertibleVisualTypes;e<t.length;e++){var i=t[e];this.storage.unloadPlugin(i)}this.customConvertibleVisualTypes=[]},t.prototype.removePlugin=function(t){this.getPlugin(t)&&(this.storage.unloadPlugin(t),_.remove(this.customConvertibleVisualTypes,(function(e){return e===t})))},t.prototype.getTelemetryHostInformation=function(){return{name:"Exploration"}},t.prototype.isCustomVisual=function(e){return o.visualHost.utils.isCustomVisual(this.getPlugin(e),e)},t.prototype.isScriptVisual=function(e){return o.visualHost.utils.isScriptVisual(this.getPlugin(e))},t.prototype.isScriptVisualQueryable=function(e){return o.visualHost.utils.isScriptVisualQueryable(e,this.asyncFeatureSwitchService.featureSwitches)},t.prototype.isLightWeightRenderingVisual=function(e){return o.visualHost.utils.isLightWeightRenderingVisual(this.getPlugin(e))},t.prototype.getInteractivityOptions=function(){return{overflow:"hidden",isVisualInteractive:!0}},t.prototype.getCustomizeConvertTo=function(e,t){var i=this.getPlugin(t);return i.getCustomizeConvertTo?i.getCustomizeConvertTo(e,t,this.asyncFeatureSwitchService.featureSwitches):void 0},t.prototype.loadPluginByNameIfAny=function(e){this.getPlugin(e)||(this.storage.hasPlugin(e)?this.storage.loadPlugin(e):o.visuals.plugins[e]&&this.storage.loadPlugin(e,o.visuals.plugins[e]))},t.prototype.getPlugin=function(e){return this.storage.getLoadedPlugin(e)},t.prototype.getStorage=function(){return this.storage},k=t,e.ExplorationVisualPluginService=k,i.prototype.getPlugin=function(e){var t=this,a=this.featureSwitchService.featureSwitches?_.clone(this.featureSwitchService.featureSwitches):{};switch(e){case o.visuals.plugins.barChart.name:return o.visualHost.visualPluginServiceHelpers.getPluginCopyWithFeatureSwitches(o.visuals.plugins.barChart,(function(e){e=e.module;return e.createCartesianChart({chartType:6,isScrollable:!0,dataPointLassoSelect:!0,animator:e.createWebColumnChartAnimator(),tooltipsEnabled:!0,behaviorFactory:e.createCartesianChartBehaviorFactory([e.createColumnChartWebBehaviorFactory()],a),featureSwitches:a})}),a,A?function(){return __awaiter(t,void 0,void 0,(function(){var t,i,n;return __generator(this,(function(e){switch(e.label){case 0:return t=A,n={chartType:6,isScrollable:!0,dataPointLassoSelect:!0},[4,o.visuals.createWebColumnChartAnimator()];case 1:return n.animator=e.sent(),n.tooltipsEnabled=!0,i=M,[4,o.visuals.createColumnChartWebBehaviorFactory()];case 2:return[4,i.apply(void 0,[[e.sent()],a])];case 3:return[2,t.apply(void 0,[(n.behaviorFactory=e.sent(),n.featureSwitches=a,n)])]}}))}))}:void 0);case o.visuals.plugins.card.name:return o.visualHost.visualPluginServiceHelpers.getPluginCopyWithFeatureSwitches(o.visuals.plugins.card,(function(e){return e.module.createCard({isScrollable:!0,animator:new o.visuals.BaseAnimator,tooltipsEnabled:!0,interactivityEnabled:!0,featureSwitches:a})}),a,h?function(){return h({isScrollable:!0,animator:new o.visuals.BaseAnimator,tooltipsEnabled:!0,interactivityEnabled:!0,featureSwitches:a})}:void 0);case o.visuals.plugins.cardVisual.name:return o.visualHost.visualPluginServiceHelpers.getPluginCopyWithFeatureSwitches(o.visuals.plugins.cardVisual,(function(e){return e.module.createCardVisual({isScrollable:!0,animator:new o.visuals.BaseAnimator,tooltipsEnabled:!0,interactivityEnabled:!0,featureSwitches:a})}),a,d?function(){return d({isScrollable:!0,animator:new o.visuals.BaseAnimator,tooltipsEnabled:!0,interactivityEnabled:!0,featureSwitches:a})}:void 0);case o.visuals.plugins.clusteredBarChart.name:return o.visualHost.visualPluginServiceHelpers.getPluginCopyWithFeatureSwitches(o.visuals.plugins.clusteredBarChart,(function(e){e=e.module;return e.createCartesianChart({chartType:5,isScrollable:!0,dataPointLassoSelect:!0,tooltipsEnabled:!0,animator:e.createWebColumnChartAnimator(),behaviorFactory:e.createCartesianChartBehaviorFactory([e.createColumnChartWebBehaviorFactory()],a),featureSwitches:a})}),a,A?function(){return __awaiter(t,void 0,void 0,(function(){var t,i,n;return __generator(this,(function(e){switch(e.label){case 0:return t=A,n={chartType:5,isScrollable:!0,dataPointLassoSelect:!0,tooltipsEnabled:!0},[4,D()];case 1:return n.animator=e.sent(),i=M,[4,I()];case 2:return[4,i.apply(void 0,[[e.sent()],a])];case 3:return[2,t.apply(void 0,[(n.behaviorFactory=e.sent(),n.featureSwitches=a,n)])]}}))}))}:void 0);case o.visuals.plugins.clusteredColumnChart.name:return o.visualHost.visualPluginServiceHelpers.getPluginCopyWithFeatureSwitches(o.visuals.plugins.clusteredColumnChart,(function(e){e=e.module;return e.createCartesianChart({chartType:3,isScrollable:!0,dataPointLassoSelect:!0,tooltipsEnabled:!0,animator:e.createWebColumnChartAnimator(),behaviorFactory:e.createCartesianChartBehaviorFactory([e.createColumnChartWebBehaviorFactory()],a),featureSwitches:a})}),a,A?function(){return __awaiter(t,void 0,void 0,(function(){var t,i,n;return __generator(this,(function(e){switch(e.label){case 0:return t=A,n={chartType:3,isScrollable:!0,dataPointLassoSelect:!0,tooltipsEnabled:!0},[4,o.visuals.createWebColumnChartAnimator()];case 1:return n.animator=e.sent(),i=M,[4,I()];case 2:return[4,i.apply(void 0,[[e.sent()],a])];case 3:return[2,t.apply(void 0,[(n.behaviorFactory=e.sent(),n.featureSwitches=a,n)])]}}))}))}:void 0);case o.visuals.plugins.columnChart.name:return o.visualHost.visualPluginServiceHelpers.getPluginCopyWithFeatureSwitches(o.visuals.plugins.columnChart,(function(e){e=e.module;return e.createCartesianChart({chartType:4,isScrollable:!0,dataPointLassoSelect:!0,tooltipsEnabled:!0,animator:e.createWebColumnChartAnimator(),behaviorFactory:e.createCartesianChartBehaviorFactory([e.createColumnChartWebBehaviorFactory()],a),featureSwitches:a})}),a,A?function(){return __awaiter(t,void 0,void 0,(function(){var t,i,n;return __generator(this,(function(e){switch(e.label){case 0:return t=A,n={chartType:4,isScrollable:!0,dataPointLassoSelect:!0,tooltipsEnabled:!0},[4,D()];case 1:return n.animator=e.sent(),i=M,[4,I()];case 2:return[4,i.apply(void 0,[[e.sent()],a])];case 3:return[2,t.apply(void 0,[(n.behaviorFactory=e.sent(),n.featureSwitches=a,n)])]}}))}))}:void 0);case o.visuals.plugins.dataDotClusteredColumnComboChart.name:return o.visualHost.visualPluginServiceHelpers.getPluginCopyWithFeatureSwitches(o.visuals.plugins.dataDotClusteredColumnComboChart,(function(e){e=e.module;return e.createCartesianChart({chartType:16,isScrollable:!0,tooltipsEnabled:!0,animator:e.createWebColumnChartAnimator(),behaviorFactory:e.createCartesianChartBehaviorFactory([e.createColumnChartWebBehaviorFactory(),e.createDataDotChartWebBehaviorFactory()],a),featureSwitches:a})}),a,A?function(){return __awaiter(t,void 0,void 0,(function(){var t,i,n,r;return __generator(this,(function(e){switch(e.label){case 0:return t=A,r={chartType:16,isScrollable:!0,tooltipsEnabled:!0},[4,D()];case 1:return r.animator=e.sent(),i=M,[4,I()];case 2:return n=[e.sent()],[4,N()];case 3:return[4,i.apply(void 0,[n.concat([e.sent()]),a])];case 4:return[2,t.apply(void 0,[(r.behaviorFactory=e.sent(),r.featureSwitches=a,r)])]}}))}))}:void 0);case o.visuals.plugins.dataDotStackedColumnComboChart.name:return o.visualHost.visualPluginServiceHelpers.getPluginCopyWithFeatureSwitches(o.visuals.plugins.dataDotStackedColumnComboChart,(function(e){e=e.module;return e.createCartesianChart({chartType:17,isScrollable:!0,tooltipsEnabled:!0,animator:e.createWebColumnChartAnimator(),behaviorFactory:e.createCartesianChartBehaviorFactory([e.createColumnChartWebBehaviorFactory(),e.createDataDotChartWebBehaviorFactory()],a),featureSwitches:a})}),a,A?function(){return __awaiter(t,void 0,void 0,(function(){var t,i,n,r;return __generator(this,(function(e){switch(e.label){case 0:return t=A,r={chartType:17,isScrollable:!0,tooltipsEnabled:!0},[4,D()];case 1:return r.animator=e.sent(),i=M,[4,I()];case 2:return n=[e.sent()],[4,N()];case 3:return[4,i.apply(void 0,[n.concat([e.sent()]),a])];case 4:return[2,t.apply(void 0,[(r.behaviorFactory=e.sent(),r.featureSwitches=a,r)])]}}))}))}:void 0);case o.visuals.plugins.donutChart.name:return o.visualHost.visualPluginServiceHelpers.getPluginCopyWithFeatureSwitches(o.visuals.plugins.donutChart,(function(){return new o.visuals.DonutChart({animator:new o.visuals.WebDonutChartAnimator,isScrollable:!0,tooltipsEnabled:!0,behavior:new o.visuals.DonutChartWebBehavior})}),a,m?function(){return m({animator:new o.visuals.WebDonutChartAnimator,isScrollable:!0,tooltipsEnabled:!0,behavior:new o.visuals.DonutChartWebBehavior})}:void 0);case o.visuals.plugins.funnel.name:return o.visualHost.visualPluginServiceHelpers.getPluginCopyWithFeatureSwitches(o.visuals.plugins.funnel,(function(){return new o.visuals.FunnelChart({animator:new o.visuals.WebFunnelAnimator,behavior:new o.visuals.FunnelWebBehavior,tooltipsEnabled:!0})}),a,y?function(){return y({animator:new o.visuals.WebFunnelAnimator,behavior:new o.visuals.FunnelWebBehavior,tooltipsEnabled:!0})}:void 0);case o.visuals.plugins.gauge.name:return o.visualHost.visualPluginServiceHelpers.getPluginCopyWithFeatureSwitches(o.visuals.plugins.gauge,(function(e){return e.module.createGauge({animator:new o.visuals.BaseAnimator,tooltipsEnabled:!0,behavior:new o.visuals.GaugeBehavior},a)}),a,v?function(){return v({animator:new o.visuals.BaseAnimator,tooltipsEnabled:!0,behavior:new o.visuals.GaugeBehavior},a)}:void 0);case o.visuals.plugins.kpi.name:return o.visualHost.visualPluginServiceHelpers.getPluginCopyWithFeatureSwitches(o.visuals.plugins.kpi,(function(){return new o.visuals.KPIStatusWithHistory({interactivityEnabled:!0},a)}),a,V?function(){return V({interactivityEnabled:!0})}:void 0);case o.visuals.plugins.hundredPercentStackedBarChart.name:return o.visualHost.visualPluginServiceHelpers.getPluginCopyWithFeatureSwitches(o.visuals.plugins.hundredPercentStackedBarChart,(function(e){e=e.module;return e.createCartesianChart({chartType:7,isScrollable:!0,dataPointLassoSelect:!0,tooltipsEnabled:!0,animator:e.createWebColumnChartAnimator(),behaviorFactory:e.createCartesianChartBehaviorFactory([e.createColumnChartWebBehaviorFactory()],a),featureSwitches:a})}),a,A?function(){return __awaiter(t,void 0,void 0,(function(){var t,i,n;return __generator(this,(function(e){switch(e.label){case 0:return t=A,n={chartType:7,isScrollable:!0,dataPointLassoSelect:!0,tooltipsEnabled:!0},[4,o.visuals.createWebColumnChartAnimator()];case 1:return n.animator=e.sent(),i=M,[4,o.visuals.createColumnChartWebBehaviorFactory()];case 2:return[4,i.apply(void 0,[[e.sent()],a])];case 3:return[2,t.apply(void 0,[(n.behaviorFactory=e.sent(),n.featureSwitches=a,n)])]}}))}))}:void 0);case o.visuals.plugins.hundredPercentStackedColumnChart.name:return o.visualHost.visualPluginServiceHelpers.getPluginCopyWithFeatureSwitches(o.visuals.plugins.hundredPercentStackedColumnChart,(function(e){e=e.module;return e.createCartesianChart({chartType:8,isScrollable:!0,dataPointLassoSelect:!0,tooltipsEnabled:!0,animator:e.createWebColumnChartAnimator(),behaviorFactory:e.createCartesianChartBehaviorFactory([e.createColumnChartWebBehaviorFactory()],a),featureSwitches:a})}),a,A?function(){return __awaiter(t,void 0,void 0,(function(){var t,i,n;return __generator(this,(function(e){switch(e.label){case 0:return t=A,n={chartType:8,isScrollable:!0,dataPointLassoSelect:!0,tooltipsEnabled:!0},[4,o.visuals.createWebColumnChartAnimator()];case 1:return n.animator=e.sent(),i=M,[4,o.visuals.createColumnChartWebBehaviorFactory()];case 2:return[4,i.apply(void 0,[[e.sent()],a])];case 3:return[2,t.apply(void 0,[(n.behaviorFactory=e.sent(),n.featureSwitches=a,n)])]}}))}))}:void 0);case o.visuals.plugins.lineChart.name:return o.visualHost.visualPluginServiceHelpers.getPluginCopyWithFeatureSwitches(o.visuals.plugins.lineChart,(function(e){e=e.module;return e.createCartesianChart({chartType:0,isScrollable:!0,dataPointLassoSelect:!0,tooltipsEnabled:!0,animator:new o.visuals.BaseAnimator,behaviorFactory:e.createCartesianChartBehaviorFactory([e.createLineChartWebBehaviorFactory()],a),featureSwitches:a})}),a,A?function(){return __awaiter(t,void 0,void 0,(function(){var t,i,n;return __generator(this,(function(e){switch(e.label){case 0:return t=A,n={chartType:0,isScrollable:!0,dataPointLassoSelect:!0,tooltipsEnabled:!0,animator:new o.visuals.BaseAnimator},i=M,[4,o.visuals.createLineChartWebBehaviorFactory()];case 1:return[4,i.apply(void 0,[[e.sent()],a])];case 2:return[2,t.apply(void 0,[(n.behaviorFactory=e.sent(),n.featureSwitches=a,n)])]}}))}))}:void 0);case o.visuals.plugins.areaChart.name:return o.visualHost.visualPluginServiceHelpers.getPluginCopyWithFeatureSwitches(o.visuals.plugins.areaChart,(function(e){e=e.module;return e.createCartesianChart({chartType:1,isScrollable:!0,dataPointLassoSelect:!0,tooltipsEnabled:!0,animator:new o.visuals.BaseAnimator,behaviorFactory:e.createCartesianChartBehaviorFactory([e.createLineChartWebBehaviorFactory()],a),featureSwitches:a})}),a,A?function(){return __awaiter(t,void 0,void 0,(function(){var t,i,n;return __generator(this,(function(e){switch(e.label){case 0:return t=A,n={chartType:1,isScrollable:!0,dataPointLassoSelect:!0,tooltipsEnabled:!0,animator:new o.visuals.BaseAnimator},i=M,[4,O()];case 1:return[4,i.apply(void 0,[[e.sent()],a])];case 2:return[2,t.apply(void 0,[(n.behaviorFactory=e.sent(),n.featureSwitches=a,n)])]}}))}))}:void 0);case o.visuals.plugins.stackedAreaChart.name:return o.visualHost.visualPluginServiceHelpers.getPluginCopyWithFeatureSwitches(o.visuals.plugins.stackedAreaChart,(function(e){e=e.module;return e.createCartesianChart({chartType:2,isScrollable:!0,dataPointLassoSelect:!0,tooltipsEnabled:!0,animator:new o.visuals.BaseAnimator,behaviorFactory:e.createCartesianChartBehaviorFactory([e.createLineChartWebBehaviorFactory()],a),featureSwitches:a})}),a,A?function(){return __awaiter(t,void 0,void 0,(function(){var t,i,n;return __generator(this,(function(e){switch(e.label){case 0:return t=A,n={chartType:2,isScrollable:!0,dataPointLassoSelect:!0,tooltipsEnabled:!0,animator:new o.visuals.BaseAnimator},i=M,[4,O()];case 1:return[4,i.apply(void 0,[[e.sent()],a])];case 2:return[2,t.apply(void 0,[(n.behaviorFactory=e.sent(),n.featureSwitches=a,n)])]}}))}))}:void 0);case o.visuals.plugins.lineClusteredColumnComboChart.name:return o.visualHost.visualPluginServiceHelpers.getPluginCopyWithFeatureSwitches(o.visuals.plugins.lineClusteredColumnComboChart,(function(e){e=e.module;return e.createCartesianChart({chartType:14,isScrollable:!0,dataPointLassoSelect:!0,tooltipsEnabled:!0,animator:e.createWebColumnChartAnimator(),behaviorFactory:e.createCartesianChartBehaviorFactory([e.createColumnChartWebBehaviorFactory(),e.createLineChartWebBehaviorFactory()],a),featureSwitches:a})}),a,A?function(){return __awaiter(t,void 0,void 0,(function(){var t,i,n,r;return __generator(this,(function(e){switch(e.label){case 0:return t=A,r={chartType:14,isScrollable:!0,dataPointLassoSelect:!0,tooltipsEnabled:!0},[4,o.visuals.createWebColumnChartAnimator()];case 1:return r.animator=e.sent(),i=M,[4,o.visuals.createColumnChartWebBehaviorFactory()];case 2:return n=[e.sent()],[4,o.visuals.createLineChartWebBehaviorFactory()];case 3:return[4,i.apply(void 0,[n.concat([e.sent()]),a])];case 4:return[2,t.apply(void 0,[(r.behaviorFactory=e.sent(),r.featureSwitches=a,r)])]}}))}))}:void 0);case o.visuals.plugins.lineStackedColumnComboChart.name:return o.visualHost.visualPluginServiceHelpers.getPluginCopyWithFeatureSwitches(o.visuals.plugins.lineStackedColumnComboChart,(function(e){e=e.module;return e.createCartesianChart({chartType:15,isScrollable:!0,dataPointLassoSelect:!0,tooltipsEnabled:!0,animator:e.createWebColumnChartAnimator(),behaviorFactory:e.createCartesianChartBehaviorFactory([e.createColumnChartWebBehaviorFactory(),e.createLineChartWebBehaviorFactory()],a),featureSwitches:a})}),a,A?function(){return __awaiter(t,void 0,void 0,(function(){var t,i,n,r;return __generator(this,(function(e){switch(e.label){case 0:return t=A,r={chartType:15,isScrollable:!0,dataPointLassoSelect:!0,tooltipsEnabled:!0},[4,o.visuals.createWebColumnChartAnimator()];case 1:return r.animator=e.sent(),i=M,[4,o.visuals.createColumnChartWebBehaviorFactory()];case 2:return n=[e.sent()],[4,o.visuals.createLineChartWebBehaviorFactory()];case 3:return[4,i.apply(void 0,[n.concat([e.sent()]),a])];case 4:return[2,t.apply(void 0,[(r.behaviorFactory=e.sent(),r.featureSwitches=a,r)])]}}))}))}:void 0);case o.visuals.plugins.multiRowCard.name:return o.visualHost.visualPluginServiceHelpers.getPluginCopyWithFeatureSwitches(o.visuals.plugins.multiRowCard,(function(){return new o.visuals.MultiRowCard({interactivityEnabled:!0,behavior:new o.visuals.MultiRowCardBehavior})}),a,g?function(){return g({interactivityEnabled:!0,behavior:new o.visuals.MultiRowCardBehavior})}:void 0);case o.visuals.plugins.pieChart.name:return o.visualHost.visualPluginServiceHelpers.getPluginCopyWithFeatureSwitches(o.visuals.plugins.pieChart,(function(){return new o.visuals.DonutChart({sliceWidthRatio:0,animator:new o.visuals.WebDonutChartAnimator,isScrollable:!0,tooltipsEnabled:!0,behavior:new o.visuals.DonutChartWebBehavior})}),a,m?function(){return m({sliceWidthRatio:0,animator:new o.visuals.WebDonutChartAnimator,isScrollable:!0,tooltipsEnabled:!0,behavior:new o.visuals.DonutChartWebBehavior})}:void 0);case o.visuals.plugins.ribbonChart.name:return o.visualHost.visualPluginServiceHelpers.getPluginCopyWithFeatureSwitches(o.visuals.plugins.ribbonChart,(function(e){e=e.module;return e.createCartesianChart({chartType:9,isScrollable:!0,tooltipsEnabled:!0,animator:e.createWebColumnChartAnimator(),behaviorFactory:e.createCartesianChartBehaviorFactory([e.createColumnChartWebBehaviorFactory()],a),featureSwitches:a})}),a,A?function(){return __awaiter(t,void 0,void 0,(function(){var t,i,n;return __generator(this,(function(e){switch(e.label){case 0:return t=A,n={chartType:9,isScrollable:!0,tooltipsEnabled:!0},[4,o.visuals.createWebColumnChartAnimator()];case 1:return n.animator=e.sent(),i=M,[4,o.visuals.createColumnChartWebBehaviorFactory()];case 2:return[4,i.apply(void 0,[[e.sent()],a])];case 3:return[2,t.apply(void 0,[(n.behaviorFactory=e.sent(),n.featureSwitches=a,n)])]}}))}))}:void 0);case o.visuals.plugins.scatterChart.name:return o.visualHost.visualPluginServiceHelpers.getPluginCopyWithFeatureSwitches(o.visuals.plugins.scatterChart,(function(e){e=e.module;return e.createCartesianChart({chartType:10,isScrollable:!0,dataPointLassoSelect:!0,tooltipsEnabled:!0,animator:new o.visuals.BaseAnimator,behaviorFactory:e.createCartesianChartBehaviorFactory([e.createScatterChartWebBehaviorFactory()],a),featureSwitches:a})}),a,A?function(){return __awaiter(t,void 0,void 0,(function(){var t,i,n;return __generator(this,(function(e){switch(e.label){case 0:return t=A,n={chartType:10,isScrollable:!0,dataPointLassoSelect:!0,tooltipsEnabled:!0,animator:new o.visuals.BaseAnimator},i=M,[4,z()];case 1:return[4,i.apply(void 0,[[e.sent()],a])];case 2:return[2,t.apply(void 0,[(n.behaviorFactory=e.sent(),n.featureSwitches=a,n)])]}}))}))}:void 0);case o.visuals.plugins.treemap.name:return o.visualHost.visualPluginServiceHelpers.getPluginCopyWithFeatureSwitches(o.visuals.plugins.treemap,(function(e){e=e.module;return new e.Treemap({animator:e.webAnimator(),isScrollable:!0,behavior:e.webBehavior(),tooltipsEnabled:!0,cartesianConditionalFormatting:a.cartesianConditionalFormatting,dataPointLassoSelect:!0})}),a,E?function(){return __awaiter(t,void 0,void 0,(function(){var t,i;return __generator(this,(function(e){switch(e.label){case 0:return t=E,i={},[4,G()];case 1:return i.animator=e.sent(),i.isScrollable=!0,[4,Q()];case 2:return[2,t.apply(void 0,[(i.behavior=e.sent(),i.tooltipsEnabled=!0,i.cartesianConditionalFormatting=a.cartesianConditionalFormatting,i.dataPointLassoSelect=!0,i)])]}}))}))}:void 0);case o.visuals.plugins.filterSlicer.name:return o.visualHost.visualPluginServiceHelpers.getPluginCopyWithFeatureSwitches(o.visuals.plugins.filterSlicer,(function(){return new o.visuals.Slicer({lockKeyboardNavigation:!1,featureSwitches:a})}),a,b?function(){return b({lockKeyboardNavigation:!1,featureSwitches:a})}:void 0);case o.visuals.plugins.accessibleTable.name:return o.visualHost.visualPluginServiceHelpers.getPluginCopyWithFeatureSwitches(o.visuals.plugins.accessibleTable,(function(e){return new e.module.AccessibleTable}),a,p?function(){return p()}:void 0);case o.visuals.plugins.sunburst.name:return o.visualHost.visualPluginServiceHelpers.getPluginCopyWithFeatureSwitches(o.visuals.plugins.sunburst,(function(e){e=e.module;return new e.Sunburst({isScrollable:!0,behavior:e.behavior()})}),a,T?function(){return __awaiter(t,void 0,void 0,(function(){var t,i;return __generator(this,(function(e){switch(e.label){case 0:return t=T,i={isScrollable:!0},[4,K()];case 1:return[2,t.apply(void 0,[(i.behavior=e.sent(),i)])]}}))}))}:void 0);case o.visuals.plugins.waterfallChart.name:return o.visualHost.visualPluginServiceHelpers.getPluginCopyWithFeatureSwitches(o.visuals.plugins.waterfallChart,(function(e){e=e.module;return e.createCartesianChart({chartType:13,isScrollable:!0,tooltipsEnabled:!0,behaviorFactory:e.createCartesianChartBehaviorFactory([e.createWaterfallChartWebBehaviorFactory()],a),featureSwitches:a})}),a,A?function(){return __awaiter(t,void 0,void 0,(function(){var t,i,n;return __generator(this,(function(e){switch(e.label){case 0:return t=A,n={chartType:13,isScrollable:!0,tooltipsEnabled:!0},i=M,[4,U()];case 1:return[4,i.apply(void 0,[[e.sent()],a])];case 2:return[2,t.apply(void 0,[(n.behaviorFactory=e.sent(),n.featureSwitches=a,n)])]}}))}))}:void 0);case o.visuals.plugins.map.name:return o.visualHost.visualPluginServiceHelpers.getPluginCopyWithFeatureSwitches(o.visuals.plugins.map,(function(){return new o.visuals.Map({behavior:new o.visuals.MapBehavior,dataPointLassoSelect:!0,tooltipsEnabled:!0,isLegendScrollable:!0,mapControlFactory:t.mapControlFactory})}),a,f?function(){return f({behavior:new o.visuals.MapBehavior,dataPointLassoSelect:!0,tooltipsEnabled:!0,isLegendScrollable:!0,mapControlFactory:t.mapControlFactory})}:void 0);case o.visuals.plugins.filledMap.name:return o.visualHost.visualPluginServiceHelpers.getPluginCopyWithFeatureSwitches(o.visuals.plugins.filledMap,(function(){return new o.visuals.Map({filledMap:!0,behavior:new o.visuals.MapBehavior,dataPointLassoSelect:!0,tooltipsEnabled:!0,filledMapDataLabelsEnabled:a&&a.filledMapDataLabelsEnabled,isLegendScrollable:!0,mapControlFactory:t.mapControlFactory})}),a,f?function(){return f({filledMap:!0,behavior:new o.visuals.MapBehavior,dataPointLassoSelect:!0,tooltipsEnabled:!0,filledMapDataLabelsEnabled:a&&a.filledMapDataLabelsEnabled,isLegendScrollable:!0,mapControlFactory:t.mapControlFactory})}:void 0);case o.visuals.plugins.azureMap.name:return o.visualHost.visualPluginServiceHelpers.getPluginCopyWithFeatureSwitches(o.visuals.plugins.azureMap,(function(e){e=e.module;return e.createAzureMap({behavior:e.createAzureMapBehavior(),tooltipsEnabled:!0,isLegendScrollable:!0,mapControlFactory:t.mapControlFactory})}),a,C?function(){return __awaiter(t,void 0,void 0,(function(){var t,i;return __generator(this,(function(e){switch(e.label){case 0:return t=C,i={},[4,j()];case 1:return[2,t.apply(void 0,[(i.behavior=e.sent(),i.tooltipsEnabled=!0,i.isLegendScrollable=!0,i.mapControlFactory=this.mapControlFactory,i)])]}}))}))}:void 0);case o.visuals.plugins.shape.name:return o.visualHost.visualPluginServiceHelpers.getPluginCopyWithFeatureSwitches(o.visuals.plugins.shape,(function(e){return e.module.createShape()}),a,P?function(){return P()}:void 0);case o.visuals.plugins.actionButton.name:return o.visualHost.visualPluginServiceHelpers.getPluginCopyWithFeatureSwitches(o.visuals.plugins.actionButton,(function(e){return new e.module.ActionButton}),a,r?function(){return r()}:void 0);case o.visuals.plugins.shapeMap.name:return o.visualHost.visualPluginServiceHelpers.getPluginCopyWithFeatureSwitches(o.visuals.plugins.shapeMap,(function(e){e=e.module;return new e.ShapeMap({behavior:new e.ShapeMapBehavior,tooltipsEnabled:!0})}),a,S?function(){return __awaiter(t,void 0,void 0,(function(){var t,i;return __generator(this,(function(e){switch(e.label){case 0:return t=S,i={},[4,W()];case 1:return[2,t.apply(void 0,[(i.behavior=e.sent(),i.tooltipsEnabled=!0,i)])]}}))}))}:void 0);case o.visuals.plugins.slicer.name:return o.visualHost.visualPluginServiceHelpers.getPluginCopyWithFeatureSwitches(o.visuals.plugins.slicer,(function(){return new o.visuals.Slicer({featureSwitches:a,preventVirtualKeyboardOnTheFirstTap:!0,isSlicer:!0})}),a,b?function(){return b({featureSwitches:a,preventVirtualKeyboardOnTheFirstTap:!0,isSlicer:!0})}:void 0);case o.visuals.plugins.matrix.name:return o.visualHost.visualPluginServiceHelpers.getPluginCopyWithFeatureSwitches(o.visuals.plugins.matrix,(function(){return new o.visuals.Matrix({})}),a,u?function(){return u()}:void 0);case o.visuals.plugins.table.name:return o.visualHost.visualPluginServiceHelpers.getPluginCopyWithFeatureSwitches(o.visuals.plugins.table,(function(){return new o.visuals.Table({})}),a,c?function(){return c()}:void 0);case o.visuals.plugins.pivotTable.name:var i=L.createDefaultConstructorOptions();return o.visualHost.visualPluginServiceHelpers.getPluginCopyWithFeatureSwitches(o.visuals.plugins.pivotTable,(function(){return new o.visuals.PivotTable(i,a)}),a,s?function(){return s(i,a)}:void 0);case o.visuals.plugins.tableEx.name:var n=H.createDefaultConstructorOptions();return o.visualHost.visualPluginServiceHelpers.getPluginCopyWithFeatureSwitches(o.visuals.plugins.tableEx,(function(){return new o.visuals.TableEx(n,a)}),a,l?function(){return l(n,a)}:void 0);case o.visuals.plugins.scriptVisual.name:return o.visualHost.visualPluginServiceHelpers.getPluginCopyWithFeatureSwitches(o.visuals.plugins.scriptVisual,(function(e){return new e.module.ScriptVisual}),a,x?function(){return x()}:void 0);case o.visuals.plugins.pythonVisual.name:return o.visualHost.visualPluginServiceHelpers.getPluginCopyWithFeatureSwitches(o.visuals.plugins.pythonVisual,(function(e){return new e.module.ScriptVisual}),a,x?function(){return x()}:void 0);case o.visuals.plugins.debugVisual.name:return o.visualHost.visualPluginServiceHelpers.getPluginCopyWithFeatureSwitches(o.visuals.plugins.debugVisual,(function(){return new o.visuals.system.DebugVisual(t.visualSandbox)}),a,void 0);case o.visuals.plugins.textbox.name:return o.visualHost.visualPluginServiceHelpers.getPluginCopyWithFeatureSwitches(o.visuals.plugins.textbox,(function(e){return e.module.createTextbox({supportsNarrativeExpressions:a.daxTransformEnabled,supportsFormattingChangeIndication:a.mobileAuthoringFormattingUI})}),a,w?function(){return w({supportsNarrativeExpressions:a.daxTransformEnabled,supportsFormattingChangeIndication:a.mobileAuthoringFormattingUI})}:void 0);case o.visuals.plugins.keyDriversVisual.name:return o.visualHost.visualPluginServiceHelpers.getPluginCopyWithFeatureSwitches(o.visuals.plugins.keyDriversVisual,(function(e){return e.module.createAnalysisVisual()}),a,void 0);case o.visuals.plugins.decompositionTreeVisual.name:return o.visualHost.visualPluginServiceHelpers.getPluginCopyWithFeatureSwitches(o.visuals.plugins.decompositionTreeVisual,(function(e){return new e.module.DecompositionTree}),a,F?function(){return F()}:void 0);case o.visuals.plugins.qnaVisual.name:return o.visualHost.visualPluginServiceHelpers.getPluginCopyWithFeatureSwitches(o.visuals.plugins.qnaVisual,(function(e){return e.module.createQnaVisual()}),a,void 0);case o.visuals.plugins.histogram.name:return o.visualHost.visualPluginServiceHelpers.getPluginCopyWithFeatureSwitches(o.visuals.plugins.histogram,(function(e){e=e.module;return e.createCartesianChart({chartType:19,isScrollable:!0,tooltipsEnabled:!0,animator:e.createWebColumnChartAnimator(),behaviorFactory:e.createCartesianChartBehaviorFactory([e.createColumnChartWebBehaviorFactory()],a),featureSwitches:a})}),a,A?function(){return __awaiter(t,void 0,void 0,(function(){var t,i,n;return __generator(this,(function(e){switch(e.label){case 0:return t=A,n={chartType:19,isScrollable:!0,tooltipsEnabled:!0},[4,o.visuals.createWebColumnChartAnimator()];case 1:return n.animator=e.sent(),i=M,[4,o.visuals.createColumnChartWebBehaviorFactory()];case 2:return[4,i.apply(void 0,[[e.sent()],a])];case 3:return[2,t.apply(void 0,[(n.behaviorFactory=e.sent(),n.featureSwitches=a,n)])]}}))}))}:void 0);case o.visuals.plugins.aiNarratives.name:return o.visualHost.visualPluginServiceHelpers.getPluginCopyWithFeatureSwitches(o.visuals.plugins.aiNarratives,(function(e){return new e.module.AINarratives}),a,B?function(){return B()}:void 0);default:return o.Prototype.inherit(o.visuals.plugins[e])}},X=i,e.ExplorationVisualPluginProvider=X})(powerbi=powerbi||{}),(function(d){d.visualSyncServiceModuleFactory=function(){var e=d.data,t=(i=d.explore).contracts,E=e.DataViewObjectDefinitions,b=e.DataViewObjectDescriptors.findFilterOutput,w=i.services.ExplorationState,a=e.SemanticFilter,o=e.SQExpr,i=e.SQExprRewriter,x=(t.VisualContainer,d.explore.util.VisualContainerUtils),u=(n.prototype.generateUniqueGroupName=function(e,t,i){for(var n=this.getVisualSyncField(t),r=n?this.displayNameService.getDisplayName(n,e,this.visualPlugin.capabilities(t.visualType)):"Group",a=r,o=1;a in i;)a=r+o++;return a},n.prototype.syncFilterState=function(C,S){return __awaiter(this,void 0,d.Promise,(function(){var t,i,n,r,a,o,s,l,u,c,p,h,d,v,m,g,y,f;return __generator(this,(function(e){switch(e.label){case 0:return(t=C.config.singleVisual,this.canSyncVisual(t))?!t.syncGroup||(i=this.getOtherSectionsInSyncGroup(t),_.isEmpty(i))?[2]:[4,this.conceptualSchemaProxy.get(this.dataSources.get())]:[2];case 1:for(n=e.sent(),r=this.explorationStateManager.captureFilterState(t),S=S&&t.syncGroup.filterChanges,a=this.visualPlugin.capabilities(t.visualType),o={clearUnmatchedData:!1,suppressActiveSection:!0,suppressDisplay:!0,targetVisualNames:[]},s=b(a.objects),l=s&&E.getValue(r.objects.merge,s,null),u=[],c=0,p=i;c<p.length;c++)for(h=p[c],x.clearSectionQueryCaches(h.section),d=0,v=h.visualContainers;d<v.length;d++){if(m=v[d],g=S&&this.syncFilters(m,C.filters),y=r,l){if(f=E.getValue(m.config.singleVisual.objects,s,null),f=this.replaceSemanticFilterField(C.config.singleVisual.query.defn,l,m.config.singleVisual.query.defn,f,n),l&&!f){g&&this.visualAuthoringOperations.notifyVisualContainers([m]);continue}f!==l&&((y=w.cloneSingleVisual(y,this.visualPlugin,this.featureSwitchService)).cachedFilterDisplayItems=void 0,y.filterExpressionMetadata=void 0,E.setValue(y.objects.merge,s,null,f))}o.targetVisualNames.push(m.name),u.push({visual:m,state:y,impacted:g})}return _.isEmpty(u)||this.explorationStateManager.applyFilterState(u,n,o),[2]}}))}))},n.prototype.syncVisualFiltersState=function(e,t){void 0===t&&(t=!0),e.config;var i=e.config.singleVisual,n=[];if(this.canSyncVisual(i)&&i.syncGroup.filterChanges){for(var r=0,a=this.getOtherSectionsInSyncGroup(i);r<a.length;r++){var o=a[r];if(!_.isEmpty(o.visualContainers))for(var s=0,l=o.visualContainers;s<l.length;s++){var u=l[s];this.syncFilters(u,e.filters)&&n.push(u)}}t&&this.visualAuthoringOperations.notifyVisualContainers(n)}},n.prototype.syncFilters=function(e,t){var i=_.isEmpty(t);if(e.config.singleVisual.syncGroup.filterChanges){if(i&&!_.isEmpty(e.filters))return e.filters=[],!0;if(!i)return i=this.explorationSerializer.deserializeFilterCollection(this.explorationSerializer.serializeFilterCollection(t),[],!0),e.filters=i,!0}return!1},n.prototype.getVisualsAffectByFieldChanges=function(e){e=e.config.singleVisual;return this.canSyncVisual(e)&&e.syncGroup.fieldChanges?_.filter(this.getOtherVisualsInSyncGroup(e),(function(e){return e.config.singleVisual.syncGroup.fieldChanges})):[]},n.prototype.canSyncVisual=function(e){return!!e.syncGroup&&(e=this.visualPlugin.capabilities(e.visualType),e)&&e.supportsSynchronizingFilterState},n.prototype.getOtherVisualsInSyncGroup=function(e){return this.getVisualsInSectionsSyncGroup(this.getOtherSectionsInSyncGroup(e))},n.prototype.getVisualsInSectionsSyncGroup=function(e){for(var t=[],i=0,n=e;i<n.length;i++){var r=n[i];t.push.apply(t,r.visualContainers||[])}return t},n.prototype.getOtherSectionsInSyncGroup=function(t){if(!t.syncGroup)return[];if(!t.syncGroup.groupName)return[];for(var e=[],i=0,n=this.explorationNavigation.getCurrentExploration().sections;i<n.length;i++){var r=n[i],a=_.filter(r.visualContainers,(function(e){e=e.config.singleVisual;return e!==t&&e.syncGroup&&e.syncGroup.groupName===t.syncGroup.groupName&&e.visualType===t.visualType}));_.isEmpty(a)||e.push({section:r,visualContainers:a})}return e},n.prototype.getVisualSyncField=function(e){e=e.query.defn.select();return 0===e.length?null:e[0].expr},n.prototype.replaceSemanticFilterField=function(e,t,i,n,r){return t&&(e=e.select(),i=i.select(),e.length===i.length?1<e.length?_.differenceWith(e,i,(function(e,t){return o.equals(e.expr,t.expr)})).length?void 0:t:1===e.length?o.equals(e[0].expr,i[0].expr)?t:(e=s.extract(t))?n?(n=s.extract(n))?p.replace(t,e,n):void 0:1!==(n=t.conditions()).length||1!==(i=i[0].expr.getKeyColumns(r)).length?void 0:(r=p.replaceCondition(n[0],e,i[0]),a.fromSQExpr(r)):void 0:void 0:void 0)},n);function n(e,t,i,n,r,a,o,s,l){this.explorationStateManager=e,this.explorationNavigation=t,this.explorationSerializer=i,this.featureSwitchService=n,this.visualPlugin=r,this.conceptualSchemaProxy=a,this.dataSources=o,this.displayNameService=s,this.visualAuthoringOperations=l}__extends(l,r=i),l.extract=function(e){var t=new l;return e.rewrite(t),t.foundSingleField&&t.fieldExpr},l.prototype.visitHierarchyLevel=function(e){return this.setFieldExpr(e),e},l.prototype.visitColumnRef=function(e){return this.setFieldExpr(e),e},l.prototype.setFieldExpr=function(e){this.fieldExpr?o.equals(this.fieldExpr,e)||(this.foundSingleField=!1):(this.fieldExpr=e,this.foundSingleField=!0)};var r,s=l;function l(){return r.call(this)||this}c=e.SQExprRewriter,__extends(h,c),h.replace=function(e,t,i){return o.equals(t,i)?e:(t=new h(t,i),e.rewrite(t))},h.replaceCondition=function(e,t,i){return o.equals(t,i)?e:(t=new h(t,i),e.accept(t))},h.prototype.visitColumnRef=function(e){if(o.equals(e,this.before))return this.after};var c,p=h;function h(e,t){var i=c.call(this)||this;return i.before=e,i.after=t,i}return{create:function(e,t,i,n,r,a,o,s,l){return new u(e,t,i,n,r,a,o,s,l)}}}})(powerbi=powerbi||{}),(function(c){var p,s,e,l,u,h,r;function d(i,n){return __awaiter(this,void 0,c.Promise,(function(){var t;return __generator(this,(function(e){switch(e.label){case 0:return(t=i.get())?[4,n.get(t)]:[2];case 1:return[2,e.sent()]}}))}))}function v(e,t,i,n,r){void 0===r&&(r=!0),_.isEmpty(e)||(i=i.get(),n.addConfigToCategoricalFilters(e,t,i,r))}function m(t,e){var i=e.getCurrentExploration(),e=e.getCurrentSection();e&&(i=p.PodUtils.findPodForSectionName(i,e.name))&&!_.isEmpty(i.parameters)&&(e=_.find(i.parameters,(function(e){return e.boundFilter===t.contract.name})))&&t.updateIsLinkedAsAggregation(!!e.asAggregation)}function g(e,t){return 0===e?0:1!==e||t?1===e?2:2===e?3:-1:1}p=c.explore||(c.explore={}),s=p.util||(p.util={}),l=c.explore.services.events,u=c.explore.util.ScriptVisualsUtil,h=p.services.selectionUtils,r=jsCommon.StringExtensions,(e=s.FilterPaneUtil||(s.FilterPaneUtil={})).onFilterContainerChanged=function(t,e,i,n,r,a){var o;2===t.scope.scopeType&&s.VisualContainerUtils.clearExplorationQueryCaches(i),1===t.changeType||2===t.changeType&&!(function(e,t){for(var i=0,n=t;i<n.length;i++)if(n[i].contract===e)return 1;return})(t.filter,e)?(i=s.VisualContainerUtils.getVisualCapabilities(a,n.visualPlugin),m(i=p.viewModels.FilterViewModelFactory.convertFilterContainer(t.filter,r,n.displayNameService,t.scope,n.visualPlugin,n.aggrOps,n.localizationService,i,a&&a.config.singleVisual),n.explorationNavigation),0===t.scope.scopeType&&t.scope.container!==a||(e.push(i),v(e,r,n.dataSources,n.visualAuthoring))):0===t.changeType&&_.remove(e,(function(e){return e.contract===t.filter})),a=t,r=(i=n).explorationNavigation,e=r.getCurrentExploration(),r=r.getCurrentSection(),n=a.scope.scopeType,o=h.getSelectedVisual(i.selection),n=u.getScriptVisualIds(n,e,r,o,i.scriptVisuals),_.isEmpty(n)||(e=a.changeType.toString(),r=a.parentActivity&&a.parentActivity.event,i.telemetryService.logChildEvent(r,c.telemetry.EXFilterScriptVisual,{action:e,visualIds:JSON.stringify(n)}))},e.getFilterDisplayName=function(e,t,i,n,r,a,o,s,l){return e.displayName||p.viewModels.FilterViewModelFactory.convertFilterContainer(e,i,r,t,o,n,a,s,l).displayName},e.getPageScopeFilters=function(l,u){return __awaiter(this,void 0,c.Promise,(function(){var a,o,s;return __generator(this,(function(e){switch(e.label){case 0:return(a=l.explorationNavigation.getCurrentSection(),o=[],a)?[4,d(l.dataSources,l.conceptualSchemaProxy)]:[2,o];case 1:s=e.sent(),v(o=p.viewModels.ViewModelFactory.createFilters({scopeType:1,container:a},s,l.displayNameService,l.visualPlugin,l.aggrOps,l.localizationService,null,u),s,l.dataSources,l.visualAuthoring,!1);var t=o,i=l.explorationNavigation;if(!_.isEmpty(t))for(var n=0,r=t;n<r.length;n++)m(r[n],i);return[2,o]}}))}))},e.getConceptualSchema=d,e.addConfigToFilters=v,e.setDrillthroughMetadata=m,e.addFilterToScopeFromDrop=function(n,r,a,o,s,l,u){return __awaiter(this,void 0,c.Promise,(function(){var t,i;return __generator(this,(function(e){switch(e.label){case 0:return s?(t={scopeType:n,container:r},i=o.get(),a?[4,l.addDrillthroughFilter(s,t,i)]:[3,2]):[2];case 1:return[2,e.sent()];case 2:return[4,l.addFilter(s,t,i,u)];case 3:return[2,e.sent()]}}))}))},e.removeFilter=function(t,e,i,n,r,a){var o=_.find(i.filters,(function(e){return e.name===t}));return!!o&&n.removeFilter(o,{scopeType:e,container:i},r,a)},e.updateCategoricalFiltersIfNeeded=function(e,t,i,n){if(!_.isEmpty(i)&&(10===n.changeType||1===n.changeType||2===n.changeType||0===n.changeType))for(var r=g(n.scope.scopeType,5===n.filter.howCreated),a=0,o=i;a<o.length;a++){var s=o[a];r<g(t,5===s.howCreated)||p.FilterUtils.isCategoricalFilter(s.contract.type)&&s.contract!==n.filter&&(s={filter:s.contract,changeType:4,scope:s.getFilterContainerScope(),parentActivity:n.parentActivity},e.eventBridge.publishToChannel(l.filterContainerChanged,s))}},e.shouldHideFilterBySearchInput=function(e,t,i){var n;return!(!t||/^\s*$/.test(t)||(n=e.contract.displayName||e.displayName,_.isEmpty(n)&&(n=e.getRestatement()),r.containsIgnoreCase(n,t)))}})(powerbi=powerbi||{}),(function(S){var e,E;e=S.explore||(S.explore={}),((E=e.viewModels||(e.viewModels={})).FieldListViewModelDisplayFolderMerger||(E.FieldListViewModelDisplayFolderMerger={})).mergeDisplayFolders=function(e,i,t,n){var r=new E.FieldListViewModelMerger.VmListMerger(e.displayFolders),a=_.keyBy(e.displayFolders,(function(e){return e.name}));if(!_.isEmpty(t))for(var o=0,s=t;o<s.length;o++)for(var l=function(t){var e=i.indexOf(i.filter((function(e){return e.name===t.name}))[0]);0<=e?i[e]=(function i(n,e){if(e){for(var t=0,r=e.properties;t<r.length;t++){var a=r[t];n.properties.push(a)}for(var o=0,s=e.hierarchies;o<s.length;o++){var l=s[o];n.hierarchies.push(l)}for(var u=function(t){var e=n.displayFolders.indexOf(n.displayFolders.filter((function(e){return e.name===t.name}))[0]);0<=e?n.displayFolders[e]=i(n.displayFolders[e],t):n.displayFolders.push(t)},c=0,p=e.displayFolders;c<p.length;c++){var h=p[c];u(h)}}return n})(i[e],t):i=i.concat(t)},u=0,c=s[o].entity.displayFolders;u<c.length;u++)l(c[u]);if(!_.isEmpty(i))for(var p=0,h=i;p<h.length;p++){var d=h[p];r.add(function e(t,i,n,r,a){var o=r[n.name];if(o){o.contract=n;var s=new E.FieldListViewModelMerger.VmListMerger(o.children);if(n.properties)for(var r=_.filter(o.children,(function(e){return 1!==e.fieldType&&2!==e.fieldType})),l=_.keyBy(r,(function(e){return e.name})),u=0,c=n.properties;u<c.length;u++){var p=c[u],h=l[p.name];h||(p=_.head(t.findFields(p.name,o.schemaName))||_.head(t.findFields(p.name,S.explore.constants.ExplorationSchemaName))||_.head(t.findKpis(p.name,o.schemaName)),(h=p.clone()).parent=o),s.add(h)}if(n.hierarchies)for(var r=_.filter(o.children,(function(e){return 2===e.fieldType})),l=_.keyBy(r,(function(e){return e.name})),d=0,v=n.hierarchies;d<v.length;d++){var m=v[d],g=l[m.name];g||(m=_.head(t.findHierarchies(m.name,o.schemaName)),(g=m.clone()).parent=o),s.add(g)}if(n.displayFolders)for(var r=_.filter(o.children,(function(e){return 1===e.fieldType})),l=_.keyBy(r,(function(e){return e.name})),y=0,f=n.displayFolders;y<f.length;y++){var C=f[y];s.add(e(t,o,C,l,a))}o.children=s.merge();r=new E.FieldListViewModelMerger.VmAlphabeticalSorter;r.sortProperties(o.children)}else o=a.convertConceptualDisplayFolder(n,t.contractSchema,i,t);return o}(e,void 0,d,a,n))}e.displayFolders=r.merge(),(t=e.properties).push.apply(t,e.displayFolders||[])}})(powerbi=powerbi||{}),(function(e){var w,s,l,x,V;function t(e,t,i,n,r,a){this.factory=e,this.sorter=t,this.disableEditing=i,this.disableDragging=n,this.disableSelectionOnFocus=r,this.schemaChanges=a?a.changes:[]}function i(){}function n(e,t){this.vmLookup=this.getPropertiesDictionary(e),this.renames=this.getRenamesDictionary(e,t)}function r(e){this.oldItems=e,this.newItems=[]}e=e.explore||(e.explore={}),(e=(w=e.viewModels||(e.viewModels={})).FieldListViewModelMerger||(w.FieldListViewModelMerger={})).mergeModel=function(e,t,i,n,r,a,o){return new s(i,new l,r,a,o,n).mergeFieldList(e,t)},t.prototype.mergeFieldList=function(e,t){return e&&t||(e={schema:void 0,isLoaded:!1}),t&&_.some(t.schemas)&&(e.schema=this.mergeSchemas(e,t),e.isLoaded=!0),e},t.prototype.mergeSchemas=function(e,t){var i=e.schema;if(i){for(var n=w.FieldListViewModelUtils.getExtensions(t.schemas),e=w.FieldListViewModelUtils.sortExtensionSchemasAtEnd(t.schemas),r=(i.contract=_.find(e,(function(e){return!w.FieldListViewModelUtils.isExtension(e)})),new V(i.entities)),a=0,o=e;a<o.length;a++)for(var s=o[a],l=0,u=s.entities;l<u.length;l++){var c=u[l];w.FieldListViewModelUtils.isExtension(c)&&!w.FieldListViewModelUtils.isAbandoned(c)||(c=this.mergeEntity(i,s,c,n),s===i.contract&&r.add.apply(r,c||[]))}i.entities=r.merge(),this.sorter.sortEntities(i.entities)}else i=this.factory.createModel(t,this.disableEditing,this.disableDragging,this.disableSelectionOnFocus);return i},t.prototype.mergeEntity=function(e,t,i,n){var r=this.findEntityVm(e,i);if(r){r.contract=i,r.contractSchema=t;var a=new V(r.properties),o=new V(r.columnsAndMeasures),s=new V(r.hierarchies),l=new x(r,this.schemaChanges);if(!w.FieldListViewModelUtils.isExtension(i))for(var u=0,c=i.properties;u<c.length;u++){var p=c[u],h=this.mergePropertyMeasureOrKpi(r,t,p,l);a.add.apply(a,h||[]),o.add.apply(o,h||[])}for(var d=0,v=i.hierarchies;d<v.length;d++){var m=v[d],m=this.mergeHierarchy(r,t,m,l);a.add.apply(a,m||[]),s.add.apply(s,m||[])}var g=n.entities[w.FieldListViewModelUtils.getExtensionKey(t.name,i.name)];if(g)for(var y=0,f=g;y<f.length;y++)for(var C=f[y],S=0,E=C.entity.properties;S<E.length;S++){var p=E[S],b=this.mergeExtensionMeasure(r,C.schema,p,l);a.add.apply(a,b||[]),o.add.apply(o,b||[])}r.columnsAndMeasures=o.merge((function(e){return!e.parent})),r.hierarchies=s.merge((function(e){return!e.parent})),r.properties=a.merge((function(e){return!e.parent})),w.FieldListViewModelDisplayFolderMerger.mergeDisplayFolders(r,i.displayFolders,g,this.factory),this.sorter.sortProperties(r.properties),w.FieldListViewModelUtils.removeDuplicateProperties(r.properties,r.displayFolders),w.FieldListViewModelUtils.flattenFolders(r),w.FieldListViewModelUtils.updatePropertiesWithChildren(r)}else r=this.factory.convertConceptualEntity(i,t,e,n);return[r]},t.prototype.findEntityVm=function(e,t){var i=t.name,n=_.find(this.schemaChanges,(function(e){return e.entityRename&&e.entityRename.after===t.name})),n=(n&&(i=n.entityRename.before),e.findEntity(i));return n&&w.FieldListViewModelUtils.isAbandoned(n.contract)!==w.FieldListViewModelUtils.isAbandoned(t)?null:n},t.prototype.mergePropertyMeasureOrKpi=function(e,t,i,n){if(!w.FieldListViewModelUtils.isExtension(i))return(r=i).measure&&r.measure.kpi?this.mergeKpi(e,t,i,n):i.kpiValue?void 0:this.mergeProperty(e,t,i,n);var r},t.prototype.mergeProperty=function(e,t,i,n){n=n.findVms(t.name,i.name,0),n=_.filter(n,(function(e){return!e.isExtension}));if(_.isEmpty(n))n=[this.factory.convertConceptualProperty(i,t,e)];else for(var r=0,a=n;r<a.length;r++){for(var o=a[r],s=(o.contract=i,o.schema=t,new V(o.children)),l=0,u=w.FieldListViewModelUtils.getPropertyVariations(i);l<u.length;l++){var c=u[l];s.add(this.mergeVariationHierarchy(o,t,c))}o.children=s.merge()}return n},t.prototype.mergeVariationHierarchy=function(e,t,i){var n=_.find(e.children,(function(e){return e instanceof w.FieldListConceptualHierarchy&&e.variation===i.name}));return n?this.updateHierarchyVm(e.entity,n,i.defaultHierarchy,t):n=this.factory.convertConceptualVariationHierarchy(i,t,e),n},t.prototype.mergeExtensionMeasure=function(e,t,i,n){n=n.findVms(t.name,i.name,0),n=_.filter(n,(function(e){return e.isExtension}));return _.isEmpty(n)?n=[this.factory.convertConceptualExtensionMeasure(i,t,e)]:_.forEach(n,(function(e){e.contract=i,e.schema=t})),n},t.prototype.mergeKpi=function(e,t,i,n){n=n.findVms(t.name,i.name,4);if(_.isEmpty(n))n=[this.factory.convertConceptualKpi(i,t,e)];else for(var r=0,a=n;r<a.length;r++){var o=a[r],s=(o.contract=i,o.schema=t,new V(o.kpiMeasures));s.add(this.mergeKpiMeasure(t,o,i,2)),i.measure.kpi.goal&&s.add(this.mergeKpiMeasure(t,o,i.measure.kpi.goal,1)),i.measure.kpi.status&&s.add(this.mergeKpiMeasure(t,o,i.measure.kpi.status,0)),i.measure.kpi.trend&&s.add(this.mergeKpiMeasure(t,o,i.measure.kpi.trend,3)),_.some(s,(function(e){return null===e}))?o.kpiMeasures=this.factory.convertConceptualKpi(i,t,e).kpiMeasures:o.kpiMeasures=s.merge()}return n},t.prototype.mergeKpiMeasure=function(e,t,i,n){t=_.find(t.kpiMeasures,(function(e){return e.kpiType===n}));return t?(t.contract=i,t.schema=e,t):null},t.prototype.mergeHierarchy=function(t,e,i,n){n=n.findVms(e.name,i.name,2);if(_.isEmpty(n)){var r=this.factory.convertConceptualHierarchy(i,e,t);_.some(this.schemaChanges,(function(e){return e.hierarchyCreate&&e.hierarchyCreate.entity===t.name&&e.hierarchyCreate.name===r.name}))&&(r.expanded=!0),n=[r]}else for(var a=0,o=n;a<o.length;a++){var s=o[a];this.updateHierarchyVm(t,s,i,e)}return n},t.prototype.updateHierarchyVm=function(e,t,i,n){t.contract=i,t.schema=n;for(var r=_.keyBy(t.hierarchyLevels,(function(e){return e.name})),a=new V(t.hierarchyLevels),o=0,s=i.levels;o<s.length;o++){var l=s[o],l=this.mergeHierarchyLevel(e,t,n,l,r);a.add(l)}t.hierarchyLevels=a.merge()},t.prototype.mergeHierarchyLevel=function(e,t,i,n,r){e=this.findHierarchyLevel(e,t,i,n,r);return e?(e.contract=n.column,e.hierarchyLevelContract=n,e.schema=i):e=this.factory.convertConceptualHierarchyLevel(n,i,t),e},t.prototype.findHierarchyLevel=function(t,i,e,n,r){var a=n.name,n=_.find(this.schemaChanges,(function(e){return e.hierarchyLevelRename&&e.hierarchyLevelRename.entity===t.contract.name&&e.hierarchyLevelRename.hierarchy===i.contract.name&&e.hierarchyLevelRename.after===a}));return r[a=n?n.hierarchyLevelRename.before:a]},s=t,i.prototype.sortEntities=function(e){},i.prototype.sortProperties=function(e){e&&e.sort((function(e,t){return w.FieldListViewModelUtils.compareAlphabeticallyIgnoreCase(e.displayName,t.displayName)}))},l=i,e.VmAlphabeticalSorter=l,n.prototype.findVms=function(e,t,i){e=this.getKey(e,t,i),t=this.renames[e]||e;return this.vmLookup[t]},n.prototype.getPropertiesDictionary=function(e){for(var t=this,i=_.clone(e.properties),n=0,r=e.columnsAndMeasures;n<r.length;n++){var a=r[n];i.push(a)}for(var o=0,s=e.hierarchies;o<s.length;o++){var l=s[o];i.push(l)}for(var u=0,c=e.displayFolders;u<c.length;u++){var p=c[u];i.push(p),i.push.apply(i,p.getAllChildren()||[])}i=_.uniq(i);return _.groupBy(i,(function(e){return t.getVmKey(e)}))},n.prototype.getRenamesDictionary=function(t,e){for(var i={},n=0,r=_.filter(e,(function(e){return e.propertyRename&&e.propertyRename.entity===t.name}));n<r.length;n++){var a=r[n],o=this.getFieldType(a.propertyRename.objectType),s=this.getKey(a.propertyRename.schema,a.propertyRename.before,o);i[this.getKey(a.propertyRename.schema,a.propertyRename.after,o)]=s}return i},n.prototype.getVmKey=function(e){return this.getKey(e.schemaName,e.name,e.fieldType)},n.prototype.getKey=function(e,t,i){return t+":"+i+(e?"|"+e:"")},n.prototype.getFieldType=function(e){switch(e){default:return 0;case"KPI":return 4;case"Hierarchy":return 2;case"Level":return 3}},x=n,r.prototype.add=function(){for(var e,t=[],i=0;i<arguments.length;i++)t[i]=arguments[i];return!!t&&(t=_.filter(t,(function(e){return!!e})),(e=this.newItems).push.apply(e,t||[]),!0)},r.prototype.merge=function(e){e&&(this.newItems=_.filter(this.newItems,e));e=this.oldItems;return e?e.splice.apply(e,__spreadArray([0,e.length],this.newItems||[],!1)):_.isEmpty(this.newItems)||(e=this.newItems),e},V=r,e.VmListMerger=V})(powerbi=powerbi||{}),(function(e){var a,t,o,s;function i(e){e&&(this.visible=e.show,this.position=e.position,this.color=e.color.solid.color,this.preset=e.preset,this.transparency=e.transparency,this.shadowSpread=e.shadowSpread,this.shadowBlur=e.shadowBlur,this.angle=e.angle,this.shadowDistance=e.shadowDistance)}a=e.explore||(e.explore={}),t=a.viewModels||(a.viewModels={}),o=e.common.utils.ColorUtility,s=e.explore.util.VisualDropShadowUtil,i.prototype.getBoxShadow=function(){if(this.visible){if(this.preset!==a.contracts.VisualDropShadow.CustomPreset){var e=s.getPresetSettings(this.preset,this.position);if(e)for(var t in e)this[t]=e[t]}var i=this.position===a.contracts.VisualDropShadow.InnerPosition?"inset ":"",n=o.convertTransparencyToOpacity(this.transparency),r=Math.PI/180*this.angle;return i+Math.cos(r)*this.shadowDistance+"px "+Math.sin(r)*this.shadowDistance+"px "+this.shadowBlur+"px "+this.shadowSpread+"px "+o.hexToRGBString(this.color,n)}return""},t.VisualDropShadow=i})(powerbi=powerbi||{});
this.parseTimeMarkers = this.parseTimeMarkers || {};
var marker = this.parseTimeMarkers['powerbiportal.explore.bundle.min.js'] || (this.parseTimeMarkers['powerbiportal.explore.bundle.min.js'] = {});
marker.endEval = window.jsCommon && window.jsCommon.performance && window.jsCommon.performance.now ? window.jsCommon.performance.now() : Date.now(); marker.isExternal = false;
